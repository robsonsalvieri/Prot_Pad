#include "FDAXFIS.CH"
/*/


Ŀ
Funo    FdaFisAdd   Autor  Henry Fila            Data  18.10.2004 
Ĵ
Descrio  Adiciona o item na funcao fiscal                             
Ĵ
 Uso       Generico                                                     
Ĵ
 ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL.                       
Ĵ
 PROGRAMADOR   DATA    BOPS   MOTIVO DA ALTERACAO                     
Ĵ
                                                                      
ٱ


/*/

Function FdaFisAdd(cProduto,cTes, nQtdVen, nPrcVen, nDesconto, nSeguro, nFrete, nDespesa, nValMerc, aFdaNfCab, aFdaNfItem)

dbSelectArea("HB1")
dbSetOrder(1) 
HB1->( dbSeek(RetFilial("HB1")+cProduto) )

aadd(aFdaNfItem,{cProduto,;       //Produto
                HB1->HB1_GRTRIB ,; //Grupo de Tributacao
				nPrcVen,;
				nQtdVen,;
				nDesconto,;
				nValMerc,;				
				nFrete,;
				nDespesa,;
				nSeguro,;
				cTes	,;
				0,;	      //Base do ICMS
				0,;	      //Aliquota do ICMS
				0,;       //Valor do Icms
				0,;       //Base do IPI 
				0,;       //Aliquora do IPI
				0,;       //Valor do IPI
				0})       //Base Original do PIS para aplicacao da reducao 

FdaFisRecal(aFdaNfCab,aFdaNfItem)
FdaIt2Cab(aFdaNfCab,aFdaNfItem)

Return

/*/


Ŀ
Funo    FdaIt2Cab   Autor  Henry Fila            Data  18.10.2004 
Ĵ
Descrio  Acumula os dados dos itens no cabecalho                      
Ĵ
 Uso       Generico                                                     
Ĵ
 ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL.                       
Ĵ
 PROGRAMADOR   DATA    BOPS   MOTIVO DA ALTERACAO                     
Ĵ
                                                                      
ٱ


/*/

Function FdaIt2Cab(aFdaNfCab,aFdaNfItem)

Local nX := 0 
                                  
nX := Len(aFdaNfItem)

FdaSomaIt(nX,aFdaNfCab,aFdaNfItem)

Return

/*/


Ŀ
Funo    FdaSomaIt   Autor  Henry Fila            Data  18.10.2004 
Ĵ
Descrio  Soma os dados dos itens                                      
Ĵ
 Uso       Generico                                                     
Ĵ
 ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL.                       
Ĵ
 PROGRAMADOR   DATA    BOPS   MOTIVO DA ALTERACAO                     
Ĵ
                                                                      
ٱ


/*/
Function FdaSomaIt(nItem,aFdaNfCab,aFdaNfItem)

aFdaNfCab[ NF_BASEICM ]  := aFdaNfCab[ NF_BASEICM ] + aFdaNfItem[nItem, IT_BASEICM ]
aFdaNfCab[ NF_VALICM  ]  := aFdaNfCab[ NF_VALICM  ] + aFdaNfItem[nItem, IT_VALICM  ]	
aFdaNfCab[ NF_BASEIPI ]  := aFdaNfCab[ NF_BASEIPI ] + aFdaNfItem[nItem, IT_BASEIPI ]  
aFdaNfCab[ NF_VALIPI  ]  := aFdaNfCab[ NF_VALIPI  ] + aFdaNfItem[nItem, IT_VALIPI  ]	

Return
