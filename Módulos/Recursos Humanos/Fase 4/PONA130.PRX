#INCLUDE 'PONA130.CH'
#INCLUDE "PROTHEUS.CH"
#INCLUDE "PONCALEN.CH"
   
#DEFINE Confirma 1
#DEFINE Redigita 2
#DEFINE Abandona 3
Static lPnaGrv := ExistBlock( "PNA130GRV" )
Static lPnaAboM		:= Existblock( "PNA130ABOM" )

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ Pona130  ³ Autor ³ Mauro Sergio          ³ Data ³ 09.09.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Manutencao dos Apontamentos                                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³         ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL.             ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Programador ³ Data   ³ BOPS ³  Motivo da Alteracao                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Marinaldo   ³21/04/04³Melhor³Tratamento de Lock e Delecao de Registros ³±± 
±±³ 		   ³--------³------|										  ³±±
±±³Luiz Gustavo³14/11/06³Melhor³Inclusao da funcao MenuDef() para versao  ³±±
±±³			   ³--------³------³ 9.12                      				  ³±±
±±³Mauricio MR ³30/03/07³Melhor³Ajuste na implementacao do Menu Funcional.³±±
±±³Leandro DR  ³05/11/07³Melhor³Inclusao dos campos processo, posto, perio|±±
±±³            ³        ³      ³do, num. pagto e roteiro. Separacao do pro³±±
±±³            ³        |      ³cessamento da montagem de tela, processo  ³±±
±±³            ³        |      ³agrupado na funcao pn130montagetdados()   ³±±
±±³Leandro DR  ³15/02/08³Melhor³Alteracao para que ordenacao seja feita   |±±
±±³            ³        ³      ³pelo campo DATAAPO e nao ORDEM.			  ³±±
±±³			   ³--------³------³ 11.5                      				  ³±±
±±³Emerson Camp³29/12/10³29591/³Ajuste para nova interface 11. Com a      ³±±
±±³			   ³--------³--2010³aplicação do parametro MV_ECMFTPP que     ³±±
±±³            ³--------³------³afirma ser a versão 11.5 do Protheus      ³±±
±±³Alex Fagunde³09/05/11³010946³Estava zerando o campo: ctd justifi       ³±±
±±³            ³        ³      ³Localizacao: Mexico                       ³±±
±±³Glaucia M.  ³06/07/11³015527³Readequacao das telas para diversas		  ³±±
±±³			   ³        ³SDTCVW³resolucoes.								  ³±±
±±³Leandro DR  ³24/08/11³Melhor³Ajuste para considerar div. de apontamento³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±/*/
Function Pona130()
Private aRotina		:= MenuDef() //Funcao MenuDef contendo aRotina
NewPona130( "PONA130" )
Return (Nil)

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ NewPona130()	³Autor³                   ³ Data ³30/03/2007³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³ Programa principal separado para tratamento da funcao      ³
³          ³ MenuDef().                                                 ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³< Vide Parametros Formais >									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³PONA130, PONA190                                                    ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³aRotina														³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >									³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/

Function NewPona130( cChamada )

Local aArea			 := GetArea()
Local aIndexSRA		 := {}
Local cFiltraSRA	 := ""

Private aDatas		 := {}
Private aColsRFK	 := {}
Private aHeaderRFK	 := {}
Private cCadastro	 := ""
Private cPrefix		 := ""
Private cAliasApont	 := ""
Private cProg		 := IF( cChamada == NIL , FunName() , cChamada )
Private cPonmes		 := ''
Private cCond		 := ''
Private dDataIni	 := CtoD("//")
Private dDataFim	 := CtoD("//")
Private dPerIni		 := Ctod("//")
Private dPerFim		 := Ctod("//")
Private lPona190	 := fContemStr( cProg , "PONA190" , .T. )
Private lPeriodo     := .T.
Private lTemRFK		 := VerRFKStruct()
Private nColPro      := 0
Private oPeriodo	 := RHPERIODO():New()
Private oCalendError:= PONERROR():New()

oCalendError:InitLogErrors(LoadCalError()) //Carrega tabela de erros

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³So executa se o Modo de Acesso do SPC e SRA foram iguais e se este  ulti³
³mo nao estiver vazio 													 ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
IF ( ValidArqPon() .and. ChkVazio('SRA') )

	Private bFiltraBrw	:= {|| Nil }		
	Private aTabPadrao	:= {}

    If  !lPona190
		cCadastro 	:= OemToAnsi(STR0011)	//"Manuten‡„o dos Apontamentos"
		cAliasApont	:= "SPC"
		cCond 		:= '1'  //Pesquisa de Periodos Abertos na GPRCHFiltro
	Else   
		cCadastro	:= OemToAnsi(STR0093)	//"Manuten‡„o Acumulado dos Apontamentos"
		cAliasApont	:= "SPH"
		cCond		:= '2'  //Pesquisa de Periodos Fechados na GPRCHFiltro
	Endif
	
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³Obtem o Prefixo dos Campos												 ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	cPrefix := ( PrefixoCpo( cAliasApont ) + "_" )

	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Inicializa o filtro utilizando a funcao FilBrowse                      ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	cFiltraRh	:= ChkRh(cProg,"SRA","1")
	bFiltraBrw	:= {|| FilBrowse("SRA",@aIndexSRA,@cFiltraRH) }
	Eval(bFiltraBrw)
	
	If lPona190
		/*
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Verifica se deve imprimir por Periodo ou Por Datas           ³
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		If fSetPerData(@nColPro, STR0093,;      //"Manuten‡„o Acumulado dos Apontamentos"
							     NIL	,;
					   		     NIL    ,;
					   		     NIL 	 ;
					  ) == 0 
			Return
		EndIf
		If !( nColPro == 1 )
			lPeriodo := .F.
			aDatas := {oPeriodo:dDataIni,oPeriodo:dDataFim}
		EndIf
	EndIf
	dbSelectArea("SRA")
	mBrowse( 6, 1,22,75,"SRA",,,,,,fCriaCor() )
	
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Deleta o filtro utilizando a funcao FilBrowse                     	 ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	EndFilBrw("SRA",aIndexSra)



EndIF

RestArea( aArea )

Return( NIL )

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³PN130Atu  ³ Autor ³ Mauro Sergio          ³ Data ³ 23.04.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Programa de (Vis.,Inc.,Alt. e Del. de  dependentes         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ gp020Atu(ExpC1,ExpN1,ExpN2)                                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ ExpC1 = Alias do arquivo                                   ³±±
±±³          ³ ExpN1 = Numero do registro                                 ³±±
±±³          ³ ExpN2 = Numero da opcao selecionada                        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Pona130                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Function Pn130Atu(cAlias,nReg,nOpcx)

Local aSvKeys		:= GetKeys()

Local aAdvSize		:= {}
Local aInfoAdvSize	:= {}
Local aObjSize		:= {}
Local aObjCoords	:= {}

Local aAdv1Size			:= {}
Local aInfo1AdvSize		:= {}
Local aObj1Size			:= {}
Local aObj1Coords		:= {}

Local aAdv2Size			:= {}
Local aInfo2AdvSize		:= {}
Local aObj2Size			:= {}
Local aObj2Coords		:= {}

Local aAdv4Size			:= {}
Local aInfo4AdvSize		:= {}
Local aObj4Size			:= {}
Local aObj4Coords		:= {}    


Local aGdAltera		:= {}
Local aPesqIdx 		:= {}
Local aPesqOrd		:= {}
Local cFil			:= SRA->RA_FILIAL
Local cMat      	:= SRA->RA_MAT
Local cNome     	:= SRA->RA_NOME
Local cPesqCampo	:= space(40)
Local cPesqOrd
Local dPerIniPar	:= Ctod("//")  
Local dPerFimPar	:= Ctod("//")

//-- Variaveis para Verificacao de Bloqueios
Local lMarcacao			:= .F.
Local lApontamento		:= .F.
Local lAbono			:= .F.
Local lAxPesqui 		:= .F. 
Local lSeeAll			:= .T.
Local lValPer		    := .T.
Local nSavRec   		:= RecNo()
Local _lGrava			:= .T.

Local oDlg
Local oFont
Local oGroup
Local oPesqCbx
Local oPesqGet
Local oPer
Local oNrPagto
Local oRoteiro
Local oDatas
Local oDtIni
Local oDtFim

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Blocos de Codigo                                            ³
//³================                                            ³
//³Serao utilizados na acao do botoes de movimentacao, "Avanca"³
//³"Retrocede", "Avanca Todos" e "Retrocede Todos".            ³
//³O Bloco "bFica" sera utilizado quando forem alterados os    ³
//³campos data de referencia, semana e tipo de lancamento.     ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Local bRetrocOne := {|| Pn130VerGrava(nOpcX), nRegAnt:=SRA->(Recno()),  SRA->(dbskip(-1)),   pn130MntGD( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet,.T. ), oGet:oBrowse:Refresh(),oDLG:Refresh()}
Local bRetrocAll := {|| Pn130VerGrava(nOpcX), nRegAnt:=SRA->(Recno()),  SRA->( dbGoTop()),   pn130MntGD( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet,.T. ), oGet:oBrowse:Refresh(),oDLG:Refresh()}
Local bAvancaOne := {|| Pn130VerGrava(nOpcX), nRegAnt:=SRA->(Recno()),  SRA->(dbskip()),     If( SRA->(! EOF()),aCols:= {},.T.), pn130MntGD( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet,.T. ), oGet:oBrowse:Refresh(),oDLG:Refresh()}
Local bAvancaAll := {|| Pn130VerGrava(nOpcX), nRegAnt:=SRA->(Recno()),  SRA->(dbGoBottom()), pn130MntGD( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet , .T.),oGet:oBrowse:Refresh(),oDLG:Refresh()}
Local bFica      := {||                                       						  pn130MntGD( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet , .T.),If(lDaRefresh,(oGet:oBrowse:Refresh(),oDLG:Refresh()),.t.)}

Local bAguarde   := {|| Eval( bChangePer ) }
Local bChangePer := {|| If(		(lDaRefresh := PonChangePer()),;
									 MsAguarde( { || Pn130VerGrava(nOpcX, .F.),nRegAnt:=SRA->(Recno()),;
								     				 pn130MntGD( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet,.F. ) } ),;
								.T. ;
							);
					}

Private aTabCalend	:= {}
Private aAC       	:= {STR0003 ,STR0001 } // "Abandona"###"Confirma"
Private aColsRec  	:= {}   //--Array que contem o Recno() dos registros da aCols
Private aColsAnt  	:= {}
Private aVirtual  	:= {}
Private cPosto 		:= SRA->RA_POSTO
Private cRot		:= ""
Private cAntRoteiro := Nil
Private cProcesso	:= SRA->RA_PROCES
Private cAntProcesso := Nil
Private cPeriodo
Private cAntPeriodo  := Nil
Private cNumPagto	:= ""
Private cAntNumPagto := Nil
Private cDatas
Private dDataIni
Private dDataFim
Private lDaRefresh	:= .F.
Private lExit		:= .F.
Private lAPOLock	:= .F.
Private nPosSRA   	:= SRA->(RECNO())
Private nRegAnt		:= 0
Private nOpca 		:= 0
Private oGet
DEFAULT lPnaGrv	:= ExistBlock( "PNA130GRV" )
DEFAULT lPnaAboM	:= Existblock( "PNA130ABOM" )
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Monta a entrada de dados do arquivo                          ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Private aGETS[0],aHeader[0],Continua:=.F.,nUsado:=0
Private aCOLS := {}

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Monta as Dimensoes dos Objetos         					   ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
aAdvSize		:= MsAdvSize()
aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 5 , 5 }
aAdd( aObjCoords , { 000 , 025 , .T. , .F. } ) //1-Linha -Dados Funcionario
aAdd( aObjCoords , { 000 , 030 , .T. , .F. } )	//2-Periodo 
aAdd( aObjCoords , { 000 , 000 , .T. , .T. } )	//3-Apontamentos
aAdd( aObjCoords , { 000 , 027 , .T. , .F. } )	//4-Rodape
aObjSize		:= MsObjSize( aInfoAdvSize , aObjCoords )
	
//Divisao da 1. linha em 5 colunas
aAdv1Size		:= aClone(aObjSize[1])
aInfo1AdvSize	:= { aAdv1Size[2] , aAdv1Size[1] , aAdv1Size[4] , aAdv1Size[3] , 1.25 , 1.25 }
aAdd( aObj1Coords , { 040 , 000 , .F. , .T. } ) 	//1-Mat
aAdd( aObj1Coords , { 000 , 000 , .T. , .T. } )	//2-Nome
aAdd( aObj1Coords , { 040 , 000 , .F. , .T. } )	//3-Adm
aAdd( aObj1Coords , { 040 , 000 , .F. , .T. } )	//4-Proc
aAdd( aObj1Coords , { 040 , 000 , .F. , .T. } )	//5- Posto 
aObj1Size		:= MsObjSize( aInfo1AdvSize , aObj1Coords,,.T. )
	
//Divisao da 2. linha em 4 colunas
aAdv2Size		:= aClone(aObjSize[2])
aInfo2AdvSize	:= { aAdv2Size[2] , aAdv2Size[1] , aAdv2Size[4] , aAdv2Size[3] , 1.25 , 1.25 }
aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } ) 	//1-Per
aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )	//2-Pagto
aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )	//3-Procedim
aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )	//4-Periodos
aObj2Size		:= MsObjSize( aInfo2AdvSize , aObj2Coords,,.T. )
	
	
//Divisao da 4. linha em 6 colunas
aAdv4Size		:= aClone(aObjSize[4])
aInfo4AdvSize	:= { aAdv4Size[2] , aAdv4Size[1] , aAdv4Size[4] , aAdv4Size[3] , 10 , 10}
aAdd( aObj4Coords , { 000 , 000 , .T. , .T. } )
aAdd( aObj4Coords , { 090 , 000 , .F. , .T. } )
aAdd( aObj4Coords , { 090 , 000 , .F. , .T. } )
aAdd( aObj4Coords , { 090 , 000 , .F. , .T. } )
aAdd( aObj4Coords , { 025 , 000 , .F. , .T. } )
aAdd( aObj4Coords , { 000 , 000 , .T. , .T. } )	
aObj4Size		:= MsObjSize( aInfo4AdvSize , aObj4Coords,,.T. )	


While .T.

	//Caso nao exista periodo valido, fecha o programa.
	If !pn130MontaGetDados( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , oGet , .T.)
		Return(.F.)
	Else
		cAntProcesso	:= cProcesso
		cAntPeriodo		:= cPeriodo
		cAntNumPagto	:= cNumPagto
		cAntRoteiro     := cRot			
	EndIf	
	
	If lExit
		Exit
	EndIf

	DEFINE FONT oFont NAME "Arial" SIZE 0,-11 BOLD
	DEFINE MSDIALOG oDlg TITLE cCadastro From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF oMainWnd PIXEL

	@ aObj1Size[1,1],aObj1Size[1,2]	GROUP oGroup TO aObj1Size[1,3],aObj1Size[1,4] LABEL OemToAnsi(STR0020) OF oDlg PIXEL	// "Matricula:"
	oGroup:oFont:= oFont
	
	@ aObj1Size[2,1],aObj1Size[2,2] 	GROUP oGroup TO aObj1Size[2,3],aObj1Size[2,4] LABEL OemToAnsi(STR0013) OF oDlg PIXEL	// "Nome:"
	oGroup:oFont:= oFont 
	
	@ aObj1Size[3,1],aObj1Size[3,2] 	GROUP oGroup TO aObj1Size[3,3],aObj1Size[3,4] LABEL OemToAnsi(STR0092) OF oDlg PIXEL	// "Admiss„o:"
	oGroup:oFont:= oFont
	
	@ aObj1Size[4,1],aObj1Size[4,2]	GROUP oGroup TO aObj1Size[4,3],aObj1Size[4,4] LABEL OemToAnsi(STR0191) OF oDlg PIXEL 	// "Processo:"
	oGroup:oFont:= oFont
	
	@ aObj1Size[5,1],aObj1Size[5,2] 	GROUP oGroup TO aObj1Size[5,3],aObj1Size[5,4] LABEL OemToAnsi(STR0192) OF oDlg PIXEL 	// "Posto:"
	oGroup:oFont:= oFont

	@ aObj1Size[1,1]+10,aObj1Size[1,2]+5	SAY StrZero(Val(SRA->RA_MAT),Len(SRA->RA_MAT))	SIZE 050,10 OF oDlg PIXEL FONT oFont
	@ aObj1Size[2,1]+10,aObj1Size[2,2]+5	SAY OemToAnsi(SRA->RA_NOME) 					SIZE 146,10 OF oDlg PIXEL FONT oFont
	@ aObj1Size[3,1]+10,aObj1Size[3,2]+5	SAY Dtoc(fDtaAdmis()) 							SIZE 050,10 OF oDlg PIXEL FONT oFont
	@ aObj1Size[4,1]+10,aObj1Size[4,2]+5	SAY OemToAnsi(SRA->RA_PROCES) 					SIZE 050,10 OF oDlg PIXEL FONT oFont
	@ aObj1Size[5,1]+10,aObj1Size[5,2]+5	SAY OemToAnsi(SRA->RA_POSTO)					SIZE 050,10 OF oDlg PIXEL FONT oFont
	

	If lPeriodo
		 /*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	       ³ Codigo do Periodo, Numero de Pagamento, Roteiro, Data Inicio e Data Fim do periodo ³
		   ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		@ aObj2Size[1,1],aObj2Size[1,2]	GROUP oGroup TO aObj2Size[1,3],aObj2Size[1,4] LABEL OemToAnsi(STR0193) OF oDlg PIXEL	// Codigo do Periodo:
		oGroup:oFont:= oFont
		@ aObj2Size[2,1],aObj2Size[2,2]	GROUP oGroup TO aObj2Size[2,3],aObj2Size[2,4] LABEL OemToAnsi(STR0194) OF oDlg PIXEL	// Numero de Pagamento:
		oGroup:oFont:= oFont
		@ aObj2Size[3,1],aObj2Size[3,2]	GROUP oGroup TO aObj2Size[3,3],aObj2Size[3,4] LABEL OemToAnsi(STR0195) OF oDlg PIXEL  // Roteiro:
		oGroup:oFont:= oFont
		@ aObj2Size[4,1],aObj2Size[4,2]	GROUP oGroup TO aObj2Size[4,3],aObj2Size[4,4] LABEL OemToAnsi(STR0006) OF oDlg PIXEL	// Periodo:
		oGroup:oFont:= oFont
	
			@ aObj2Size[1,1]+10,aObj2Size[1,2]+5 ;
				MSGET 	oPer Var cPeriodo ;
				PICTURE GetSx3Cache( "RCH_PER" , "X3_PICTURE" ) F3 "RCH" ;
				WHEN lPona190 ;
	  	 		VALID  	ExistCpo( "RCH", cProcesso + cPeriodo, 2) .AND. ;
	  			Eval(bAguarde);
	    		SIZE 	050,10 OF oDlg PIXEL HASBUTTON
		
			@ aObj2Size[2,1]+10,aObj2Size[2,2]+5;
				MSGET 	oNrPagto Var cNumPagto ;
				PICTURE GetSx3Cache( "RCH_NUMPAG" , "X3_PICTURE" ) F3 "RCH01" ;
				WHEN lPona190 ;
			 	VALID  	ExistCpo( "RCH", cProcesso + cPeriodo + cNumPagto, 3) .AND.;
				Eval(bAguarde);
			   	SIZE 	050,10 OF oDlg PIXEL  HASBUTTON
			
			@ aObj2Size[3,1]+12,aObj2Size[3,2]+5 	SAY	oRoteiro Var cRot  SIZE 	060,10 OF oDlg PIXEL FONT oFont
		
			@ aObj2Size[4,1]+12,aObj2Size[4,2]+5 SAY oDatas Var cDatas SIZE 060,10 OF oDlg PIXEL FONT oFont
	
	
	Else
			@ aObj2Size[1,1],aObj2Size[1,2]	GROUP oGroup TO aObj2Size[2,3],aObj2Size[2,4] LABEL OemToAnsi(STR0198) OF oDlg PIXEL	// Data Inicial
			oGroup:oFont:= oFont
			@ aObj2Size[3,1],aObj2Size[3,2]	GROUP oGroup TO aObj2Size[4,3],aObj2Size[4,4] LABEL OemToAnsi(STR0199) OF oDlg PIXEL	// Data Final
			oGroup:oFont:= oFont

			@ aObj2Size[1,1]+10,aObj2Size[1,2]+5 ;
				MSGET 	oDtIni Var dDataIni ;
				VALID ( !Empty( dDataIni ) .AND. ( dDataIni <= dDataFim ) ) .AND.;
		  		Eval(bAguarde);
		    	SIZE 	050,10 OF oDlg PIXEL  HASBUTTON
			@  aObj2Size[3,1]+10,aObj2Size[3,2]+5 ;
				MSGET 	oDtFim Var dDataFim ;
				VALID ( !Empty( dDataFim ) .and. ( dDataIni <= dDataFim ) ) .AND.;
		  		Eval(bAguarde);
		      	SIZE 	050,10 OF oDlg PIXEL HASBUTTON 
	      	
	EndIf

    oGet := MSGetDados():New(aObjSize[3,1],aObjSize[3,2],aObjSize[3,3],aObjSize[3,4],nOpcx,"aPont130Ok" ,"pn130TudOk" ,"",If(nOpcx=2.Or.nOpcx=5,Nil,.T.),aGdAltera,1,,99999,,,,"fDelAponta()")
 
    //-- Posiciona Inicialmente na Coluna do Codigo do Evento Informado ou Abono
    Pn130PosCursor(oGet:oBrowse)
    
	/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	  ³ Define grupo do rodape          ³
	  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	@ aObjSize[4,1] , aObjSize[4,2]+1.25	GROUP oGroup TO aObjSize[4,3], aObjSize[4,4]-1.25 LABEL OemToAnsi(STR0197) OF oDlg PIXEL	 //"Pesquisar Funcionarios"
	oGroup:oFont:= oFont 

	/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	  ³ Lista Botoes de posicionamento do funcionario ³
	  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	@ aObj4Size[2,1], aObj4Size[2,2] 		BUTTON oBtnPgPrev 	PROMPT OemToAnsi("<<")	 SIZE 021.5,009 DESIGN ACTION Eval(bRetrocAll) OF oDlg PIXEL
	@ aObj4Size[2,1], aObj4Size[2,2]+21.5	BUTTON oBtnPrev		PROMPT OemToAnsi("<")	 SIZE 021.5,009 DESIGN ACTION Eval(bRetrocOne) OF oDlg PIXEL
	@ aObj4Size[2,1], aObj4Size[2,2]+43	BUTTON oBntNext 	PROMPT OemToAnsi(">")	 SIZE 021.5,009 DESIGN ACTION Eval(bAvancaOne) OF oDlg PIXEL
	@ aObj4Size[2,1], aObj4Size[2,2]+63.5	BUTTON oBtnPgNext 	PROMPT OemToAnsi(">>")	 SIZE 021.5,009 DESIGN ACTION Eval(bAvancaALL) OF oDlg PIXEL

   	AxPesqOrd("SRA",@aPesqIdx,,lSeeAll,@aPesqOrd)
   	cPesqOrd := aPesqOrd[1]

	@ aObj4Size[3,1], aObj4Size[3,2] 	COMBOBOX oPesqCbx 	VAR cPesqOrd ITEMS aPesqOrd SIZE 100,36 	PIXEL OF oDlg ON CHANGE If(lAxPesqui,(DbSelectArea(cAlias),DbSetOrder(aPesqIdx[oPesqCbx:nAt][1]), MbrSetAllCols(cAlias,aIdxCol,,__oObjBrow),__oObjBrow:Refresh()),)
	@ aObj4Size[4,1], aObj4Size[4,2] 	MSGET    oPesqGet 	VAR cPesqCampo 				SIZE 100,09 	PIXEL OF oDlg 
   	@ aObj4Size[5,1], aObj4Size[5,2] 	BUTTON   "Ok" 									SIZE 021.5,009 	PIXEL OF oDlg ACTION (Pn130VerGrava(nOpcX),nRegAnt:=SRA->(Recno()),AxPesqSeek("SRA",.F.,cPesqCampo,,aPesqIdx,oPesqCbx:nAt,lSeeAll,),Gp640Movimenta(bFica))    
    

    bSet15 := {|| nOpca:=If(nOpcx=5,2,1),If(oGet:TudoOK(),(oDlg:End(),RestKeys(aSvKeys,.T.)),nOpca := 0)}
    bSet24 := {|| ,RestKeys(aSvKeys,.T.), oDlg:End()}
    aButtons := Pn130ChoiBar(oDlg,nOpcx)

	ACTIVATE MSDIALOG oDlg ON INIT  EnchoiceBar(oDlg, bSet15, bSet24, Nil, aButtons) CENTERED

   
   IF (nOpcA == Confirma .And. nOpcx # 2) .Or. (nOpca = 2 .And. nOpcx = 5)
		/*/
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Ponto de Entrada para manipulacao da gravacao		           ³
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
		IF ( lPnaGrv )
			IF ( ValType( lRet := ExecBlock("PNA130GRV",.F.,.F.,{ cAlias, cPrefix, nOpcx } ) ) == "L" )
				_lGrava := lRet
				lRet    := NIL
			EndIF
		EndIF	
   EndIf
   //--Se nao for Exclusao
   If nOpcx # 5
        IF nOpca == Redigita
            LOOP
        ELSEIF nOpca == Confirma .And. nOpcx # 2
            Begin Transaction
				If _lGrava 
                //--Gravacao
                pn130Grava(cAliasApont,nOpcx)
                //--Processa Gatilhos
                EvalTrigger()
    			EndIf
            End Transaction
        Endif
   //--Se for Exclusao
   Elseif nOpca = 2 .And. nOpcx = 5
        Begin Transaction
			If _lGrava 
	            pn130Dele()
			EndIf
        End Transaction
   Endif

   Exit
EndDo

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Libera Locks						                         ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If lApontamento
   FreeLocks( cAliasApont, Nil, .T. ) 
Endif
If lMarcacao   
	FreeLocks( IF( cAliasApont=='SPC', "SP8" , "SPG" ) ,  Nil, .T. )
Endif	
If lAbono
	FreeLocks( 'SPK' , Nil, .T. ) 
Endif	

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Restaura a integridade da janela                             ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
cAlias := "SRA"
dbSelectArea(cAlias)
( cAlias )->( dbGoto( nSavRec ) )


RestKeys( aSvKeys , .T. )

//Zera aCols com os apontamentos informados antes de sair
aColsRFK := {} 

Return( .T. )

/*/
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³pn130Dele ³ Autor ³ Mauro                 ³ Data ³ 24.04.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Deleta os Registro dos Apontamentos                        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ pn130Dele                                                  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function pn130Dele()
    
Local aDelSPK		:= {}
Local aArea			:= GetArea()
Local aAreaSP8		:= SP8->( GetArea() )
Local aAreaSPK		:= SPK->( GetArea() )
Local dDataApo		:= CtoD("//")
Local cMsgErr		:= ""
Local nCnt			:= 0
Local lDelInfUsu	:= .F.	

SPK->(dbSetOrder(RetOrdem("SPK", "PK_FILIAL+PK_MAT+DTOS(PK_DATA)+PK_CODEVE+STR(PK_HORINI,5,2)+PK_TPMARCA+PK_CC+PK_DEPTO+PK_POSTO+PK_CODFUNC")))
SP8->(dbSetOrder(3))

If (cAliasApont)->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) ,.F. ) )
	//"Excluir, alˆm dos apontamentos calculados pelo sistema, os apontamentos informados pelo usu rio?"
	lDelInfUsu := MsgNoYes( OemToAnsi( STR0014 ) , cCadastro ) 
	While (cAliasApont)->( !Eof() .and. &(cPrefix+"FILIAL") + &(cPrefix+"MAT") == SRA->( RA_FILIAL + RA_MAT ) )
		IF ( !Empty( (cAliasApont)->( &(cPrefix+"PDI" ) ) ) .and. !( lDelInfUsu ) )
			IF (cAliasApont)->( RecLock( cAliasApont , .F. ) )
				(cAliasApont)->( &(cPrefix+"PD"		) )	:= (cAliasApont)->( &(cPrefix+"PDI" ) )
				(cAliasApont)->( &(cPrefix+"QUANTC"	) )	:= 0
				(cAliasApont)->( &(cPrefix+"FLAG"	) )	:= "I"
				(cAliasApont)->( MsUnlock() )
			EndIF
			(cAliasApont)->( dbSkip() )
			Loop
		EndIF
		If (cAliasApont)->( &(cPrefix+"DATA") >= dPerIni .and. &(cPrefix+"DATA") <= dPerFim )
			//-- Obtem os registros de abono a serem eliminados
			IF SPK->(dbSeek((cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")+DTOS(&(cPrefix+"DATA"))+&(cPrefix+"PD"))))
				While SPK->( PK_FILIAL+PK_MAT+Dtos(PK_DATA)+PK_CODEVE) == ((cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")+DTOS(&(cPrefix+"DATA"))+&(cPrefix+"PD")))
					//-- Somente Acrescenta no array de delecao se o tipo de marcacao (vazia ou nao) e centro de custo do abono
					//-- forem identicos ao do apontamento. Isto evita que tenhamos registros em duplicidade
					//-- qdo  trabalhamos com marcacao por centro de custo e/ou tipo de marcacao, onde, Filial+
                    //-- Mat + Data + Evento se repentem. 
					If  SPK->( PK_TPMARCA + PK_CC ) == (cAliasApont)->(&(cPrefix+"TPMARCA")+&(cPrefix+"CC"))
					    aAdd(aDelSPK, SPK->(Recno()))
					Endif
					SPK->(dbSkip())
				End While
			EndIF

            IF !lPona190
	            //Retira o Flag de Marcacao Apontada do SP8
	            dDataApo := GetInfoPosTab(CALEND_POS_DATA_APO,"1E",(cAliasApont)->(&(cPrefix+"DATA")),aTabCalend)
	            IF !Empty( dDataApo )
	            	IF SP8->( dbSeek( (cAliasApont)->( &(cPrefix+"FILIAL")+&(cPrefix+"MAT") ) + DtoS(dDataApo) ) )
	            		While SP8->( !Eof() .and. P8_FILIAL + P8_MAT + DtoS(P8_DATAAPO) == ( (cAliasApont)->( &(cPrefix+"FILIAL")+&(cPrefix+"MAT") ) + DtoS(dDataApo) )  )
	            			IF RecLock("SP8",.F.,.T.)
	            				SP8->P8_APONTA := "N"
	            				SP8->( MsUnLock() )
	            			EndIF
	            			SP8->( dbSkip() )
	            		EndDo
	            	EndIF
	            EndIF
			EndIF

			IF RecLock((cAliasApont),.F.,.T.)
				IF !(cAliasApont)->( FkDelete( @cMsgErr ) )
					(cAliasApont)->( RollBackDelTran( cMsgErr ) )
				EndIF
				(cAliasApont)->( MsUnlock() )
			EndIF	
		
		EndIF
		If lTemRFK
			//Deleta os possíveis apontamentos informados/divisao de apontamentos
			fDelRFK(cAliasApont,cPrefix)
		EndIf
		(cAliasApont)->(dbSkip())
	EndDo
EndIf

//-- Elimina os abonos relacionados
For nCnt := 1 To Len(aDelSPK)
	SPK->(dbGoTo(aDelSPK[nCnt]))
	IF RecLock('SPK',.F.)
		IF !SPK->( FkDelete( @cMsgErr ) )
			SPK->( RollBackDelTran( cMsgErr ) )
		EndIF
		SPK->( MsUnLock() )
	EndIF
Next nCnt

//Restaura os Dados de Entrada
RestArea( aAreaSP8 )
RestArea( aAreaSPK )
RestArea(  aArea   ) 
      
Return( NIL )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿±±
±±³                   ROTINAS DE CRITICA DE CAMPOS                        ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³PN130Grava³ Autor ³ J. Ricardo            ³ Data ³ 06.08.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Grava no arquivo de Dependentes                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ gp020Grava                                                 ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Function pn130Grava(cAlias,nOpcx,aMainSPC,aColsRecSPC,aHeaderSPK,aMainSPK,aColsSPK,aHeaderSP8,aColsSP8,lArquivo)


Local aArea		  := GetArea()
Local aAreaSPK	  := SPk->( GetArea() )
Local aAreaSP8	  := SP8->( GetArea() )
Local aAreaSPA	  := SPA->( GetArea() )
Local aDelSPK     := {}
Local nPosData    := GDFieldPos(cPrefix+'DATA')
Local nPosAbono   := GDFieldPos(cPrefix+'ABONO')
Local nPosQtAbono := GDFieldPos(cPrefix+'QTABONO')
Local nPosPD      := GDFieldPos(cPrefix+'PD')  
Local nPosQtC     := GDFieldPos(cPrefix+'QUANTC')  
Local nPosQtI     := GDFieldPos(cPrefix+'QUANTI')
Local nPosCC      := GDFieldPos(cPrefix+'CC')
Local nPosFun	  := GDFieldPos(cPrefix+'CODFUNC')
Local nPosDepto	  := GDFieldPos(cPrefix+'DEPTO')
Local nPosPosto	  := GDFieldPos(cPrefix+'POSTO')
Local nPosProces  := GDFieldPos(cPrefix+'PROCES')
Local nPosPer	  := GDFieldPos(cPrefix+'PERIODO')
Local nPosRot	  := GDFieldPos(cPrefix+'ROTEIR')
Local nPosNrPag	  := GDFieldPos(cPrefix+'NUMPAG')
Local nPosTpMarca := GDFieldPos(cPrefix+'TPMARCA')
Local nOrdemSPK	  := SPK->(Indexord())
Local ny          := 0
Local nMaxArray   := Len(aHeader)
Local nLenAnt	  := Len( aColsAnt )	
Local aAbonoSPK	  := {}
Local lFound      := .T.
Local lLock		  := .F.
Local nElem		  := 0   
Local cCCAnt      := ''  
Local cFunAnt     := ''
Local cDeptoAnt	  := ''
Local cPostoAnt   := ''
Local cProcesAnt  := ''
Local cPerAnt     := ''
Local cRotAnt     := ''
Local cNrPagAnt   := ''
Local dDataApo	  := CtoD("//")
Local cMsgErr	  := ""	
Local bBlocoOrdem := { || NIL }

//-- Para Tratamento em memoria

Local dDataApoAnt	:= CtoD("//")
Local cRegra		:= ''
Local lMovel        := .F. 
Local lReaPonta		:= .T.
Local aAbonos		:= {}
Local cFilSPA		:= fFilFunc("SPA")
//-- Variaveis para posiocionamento dos campos no aHeader
Local nAPosData		:= 0
Local nAPosCodA		:= 0
Local nAPosMotA		:= 0
Local nAPosHrIn		:= 0
Local nAPosHrFm		:= 0
Local nAPosHrAb		:= 0
Local nAPosFlag		:= 0
Local nAPosCODEVE	:= 0
Local nAPosTpMarca	:= 0
Local nAPosCC 		:= 0
Local nAPosFun		:= 0
Local nAPosDepto	:= 0
Local nAPosPosto	:= 0
Local nAPosProces   := 0
Local nAPosPer	    := 0
Local nAPosRot	    := 0
Local nAPosNrPag	:= 0
Local nMPosOrdem	:= 0
Local nMPosAponta	:= 0
Local nMPosDataApo	:= 0
//-- Variaveis para controle de Loop
Local nX			:= 0   
Local n				:= 0
Local nLenX			:= 0           
//-- Variaveis para controle de Processamento
Local lSPKFound		:= .F.                  
//-- Variaveis Auxiliares para montagem de arrays
Local aColsTMP		:= {}
Local aColsAux		:= {}
Local nSPK			:= 0  

Local cArqSP8		:= ""
Local nOrderSP8		:= 0  
Local nOrderIdx		:= 0 

DEFAULT lArquivo := .T.

//Monta Bloco para retorno da ordem
bBlocoOrdem := { || dDataApo := GetInfoPosTab(CALEND_POS_DATA_APO,"1E",(cAliasApont)->(&(cPrefix+"DATA")),aTabCalend) }

If !lArquivo
	nAPosData		:= GdFieldPos( "PK_DATA"   	,aHeaderSPK)
	nAPosCodA		:= GdFieldPos( "PK_CODABO" 	,aHeaderSPK)
 	nAPosMotA		:= GdFieldPos( "PK_MOTABO" 	,aHeaderSPK) 
 	nAPosHrIn		:= GdFieldPos( "PK_HORINI" 	,aHeaderSPK)
 	nAPosHrFm		:= GdFieldPos( "PK_HORFIM" 	,aHeaderSPK)
 	nAPosHrAb		:= GdFieldPos( "PK_HRSABO" 	,aHeaderSPK)
 	nAPosFlag		:= GdFieldPos( "PK_FLAG" 	,aHeaderSPK)
 	nAPosCODEVE		:= GdFieldPos( "PK_CODEVE" 	,aHeaderSPK)            
 	nAPosTpMarca	:= GdFieldPos( "PK_TPMARCA"	,aHeaderSPK)            
 	nAPosCC 		:= GdFieldPos( "PK_CC"		,aHeaderSPK)       
 	nAPosFun 		:= GdFieldPos( "PK_CODFUNC"	,aHeaderSPK)
	nAPosDepto	    := GDFieldPos( "PK_DEPTO"   ,aHeaderSPK)
	nAPosPosto	  	:= GDFieldPos( "PK_POSTO"   ,aHeaderSPK)
	nAPosProces  	:= GDFieldPos( "PK_PROCES"  ,aHeaderSPK)
	nAPosPer	  	:= GDFieldPos( "PK_PERIODO" ,aHeaderSPK)
	nAPosRot	  	:= GDFieldPos( "PK_ROTEIR"  ,aHeaderSPK)
	nAPosNrPag	  	:= GDFieldPos( "PK_NUMPAG"  ,aHeaderSPK) 	       
 	nMPosOrdem		:= GdFieldPos( "P8_ORDEM"	,aHeaderSP8)  
 	nMPosAponta		:= GdFieldPos( "P8_APONTA"	,aHeaderSP8)
 	nMPosDataApo	:= GdFieldPos( "P8_DATAAPO" ,aHeaderSP8)
 	aColsRec		:= aColsRecSPC
Endif 

//Seleciona a Area  para cAlias
dbSelectArea(cAlias)

nOrderSP8 := RetOrdem("SP8", "P8_FILIAL+P8_MAT+DTOS(P8_DATAAPO)+DTOS(P8_DATA)+STR(P8_HORA,5,2)", .T.)
If nOrderSP8 > 0
	SP8->( dbSetOrder( 03 ) )
Else
	cArqSP8   := CriaTrab( "", .F. )
	SP8->(IndRegua( "SP8", cArqSP8, "P8_FILIAL+P8_MAT+DTOS(P8_DATAAPO)+DTOS(P8_DATA)+STR(P8_HORA,5,2)", NIL, NIL, NIL, .F.))
	nOrderIdx := RetIndex( "SP8" ) + 1
	SP8->( DbSetOrder( nOrderIdx ) )	
EndIf
SPK->( dbSetOrder(RetOrdem("SPK","PK_FILIAL+PK_MAT+DTOS(PK_DATA)+PK_CODEVE+STR(PK_HORINI,5,2)+PK_TPMARCA+PK_CC+PK_DEPTO+PK_POSTO+PK_CODFUNC")))

//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
//                                L E I T U R A   DE   A P O N T A M E N T O S 
//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
For n:=1 TO Len(aCols)

	//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
    // REGRA 01 : Reapontar Marcacoes:
	//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
    /*  Requisitos:
         Arquivo:                    
   	     1) Apontamento Deletado ou Nao
         2) Qualquer Tipo de Horario 
         3) Apontamento Abonado ou que Anteriormente tenha sido Abonado 
         Acao:
             1) Alterar o Flag das Marcacoes para ""    
                                                                 
         Em Memoria:
   	     1) Apontamento Deletado ou Nao
         2) Horario Movel no dia da ordem
         3) Apontamento Abonado ou que Anteriormente tenha sido Abonado 
         4) Pelo Menos 1 Motivo de Abono que abone Horas
         Acao:
             1) Alterar o Flag das Marcacoes para ""    
	*/
	//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß                  
   
    //Obtem a Regra de Apontamento da Ordem lida e Verifica o Tipo de Horario

	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³                            "E M   M E M O R I A"                              ³
	³Verifica o Tipo de Horario de Acordo com a Regra Vigente em Determinado Dia:   ³
	³                                                                               ³
	³Horario Movel --> Se Apontamento Abonado, forcamos o reapontamento das         ³
	³marcacoes pela alteracao do flag para " ".                                     ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	*/

	If ( !( lArquivo ) .and. !Empty(dDataApo) .and. ( dDataApo <> dDataApoAnt ) )
	   dDataApoAnt := dDataApo
	   //-- Obtem a Regra vigente na Ordem corrente e verifica se tem horario movel        	  
	   //-- para posterior alteracao do flag da marcacao afim de forcar o reapontamento    	  
	   dDataApo	:= CalendRetCpo( Substr(cAlias,-2) + "_DATAAPO",,,Substr(cAlias,-2) )      	  
       cRegra 	:= CalendRetCpo( "REGRA",,,Substr(cAlias,-2) )         
       SPA->( MsSeek( cFilSPA + cRegra , .F. ) )                                         	  
       lMovel:= .F.                                                                       	  
       If SPA->( PA_HRMOVEL == "S" .and. ( PA_ANTMOVE + PA_POSMOVE ) > 0 )                
          lMovel:=.T.                                                                       
       Endif    
       
       //-- Assumimos o Flag de Reapontamento se Horario Movel
	   lReaponta:= lMovel                                                                            
	   
	Endif

	//-- Apontamentos PRE-EXISTENTES
	If n <= Len(aColsRec)
        If lArquivo
	        dbSelectArea( cAlias )
	        (cAlias)->( dbGoto(aColsRec[n,4]) )
	       	lLock := RecLock(cAlias,.F.,.T.)    
        Else //Em Memoria Trabalha com o Array
            //Posiciona no Apontamento em ArrayMain
            nElem:= aColsRecSPC[n]
        Endif
	        //--Se DELETADO
        If aCols[n,nUsado+1]
			If lArquivo
				//-- Obtem os registros de abono a serem eliminados
				If SPK->(dbSeek((cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")+DTOS(&(cPrefix+"DATA"))+&(cPrefix+"PD"))))
					While SPK->(PK_FILIAL+PK_MAT+Dtos(PK_DATA)+PK_CODEVE) == (cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")+DTOS(&(cPrefix+"DATA"))+&(cPrefix+"PD"))
	
						If SPK->(PK_TPMARCA+PK_CC) == (cAliasApont)->(&(cPrefix+"TPMARCA")+&(cPrefix+"CC") )
						   aAdd(aDelSPK, SPK->(Recno()))
						Endif   
						SPK->(dbSkip())
					Enddo
				Endif
            Else //-- Em Memoria Trabalha com Array  
                 //-- Obtem Abonos (baseado no apontamento original) para Serem Deletados e Altera Flag de marcacoes para reapontar qdo horario movel e abono abona horas
                 	fGetAbonos( aMainSPK, @aDelSPK, aMainSPC[nElem, nPosData], aMainSPC[nElem, nPosPD], aMainSPC[nElem, nPosTpMarca], aMainSPC[nElem, nPosCC], Iif(nPosFun > 0, aMainSPC[nElem, nPosFun],), Iif(nPosDepto > 0, aMainSPC[nElem, nPosDepto],), Iif(nPosPosto > 0, aMainSPC[nElem, nPosPosto],), Iif(nPosProces > 0, aMainSPC[nElem, nPosProces],), Iif(nPosPer > 0, MainSPC[nElem, nPosPer],), Iif(nPosRot > 0, aMainSPC[nElem, nPosRot],), Iif(nPosNrPag > 0, aMainSPC[nElem, nPosNrPag],), dDataApo, @aColsSP8, nMPosDataApo, nMPosAponta, lMovel, lReaponta )   
            Endif

			IF !lPona190
	            //Retira o Flag de Marcacao Apontada do SP8
	            If lArquivo
		           fApoMarcacao( NIL , NIL , bBlocoOrdem , NIL , NIL , NIL , cAliasApon , cPrefix , lArquivo )
			    Endif    
		    EndIF

            If ( lArquivo ) .and. ( lLock )
				IF !(cAliasApont)->( FkDelete( @cMsgErr ) )
					(cAliasApont)->( RollBackDelTran( cMsgErr ) )
				EndIF
            	(cAliasApont)->( MsUnLock() )
            Endif

            Loop
        
        Endif
    
    Else//--Apontamentos NOVOS 
    
       //--Se NAO DELETADO
       If !aCols[n,nUsado+1]
            If lArquivo
	            IF ( lLock := RecLock(cAlias,.T.,.T.) )
	            	(cAliasApont)->(&(cPrefix+"FILIAL") )	:= SRA->RA_FILIAL
	            	(cAliasApont)->(&(cPrefix+"MAT"))		:= SRA->RA_MAT
	            EndIF	
			Else//-- Em Memoria trabalha com Array                       
			    //-- Adiciona Linha em Matriz Auxiliar
			    aAdd(aColsAux,aCols[n])
			Endif

       Else // DELETADO
			
			IF !lPona190
	        	 //Retira o Flag de Marcacao Apontada do SP8
	            If lArquivo
		           fApoMarcacao( NIL , NIL , bBlocoOrdem , NIL , NIL , NIL , cAliasApon , cPrefix , lArquivo )
				Else //--Em Memoria 
				     //-- Obtem Abonos (baseado no apontamento lido) Altera Flag de marcacoes para reapontar qdo horario movel e abono abona horas
				     //-- NAO DEVERA EXISTIR ABONOS
                     fGetAbonos(aMainSPK,			, aCols[n, nPosData], aCols[n, nPosPD], aCols[n, nPosTpMarca], aCols[n, nPosCC], Iif(nPosFun > 0, aCols[n, nPosFun],), Iif(nPosDepto > 0, aCols[n, nPosDepto],), Iif(nPosPosto > 0, aCols[n, nPosPosto],), Iif(nPosProces > 0, aCols[n, nPosProces],), Iif(nPosPer > 0, aCols[n, nPosPer],), Iif(nPosRot > 0, aCols[n, nPosRot],), Iif(nPosNrPag > 0, aCols[n, nPosNrPag],), dDataApo,@aColsSP8, nMPosDataApo, nMPosAponta, lMovel, @lReaponta)   
				Endif
			EndIF	
            Loop
       Endif
    Endif

	//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß                  
	//  GRAVACAO DOS DEMAIS CAMPOS 
	//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß                  
    //-- Procede Gravacao dos Demais Campos do Apontamento (Novo ou Pre-existente)
    If ( ( lArquivo ) .and. ( lLock ) )
	    For ny := 1 To nMaxArray
	        cCampo    := AllTrim(aHeader[ny][2])
	        //-- Campo quantidade de horas abonadas sera gravada na manutencao de abonos
	        If Ascan(aVirtual,cCampo) == 0 .Or. cCampo # (cPrefix+'QTABONO')
	            xConteudo := aCols[n,ny]
	            &cCampo := xConteudo
	        Endif
	    Next ny
	    (cAlias)->( MsUnlock() )
    Endif

    //-- Para Lancamentos Pre-existentes verifica alteracao de conteudo
	IF n <= nLenAnt .and. !fCompArray( aCols[n] , aColsAnt[n] ) //Quando Houver Diferencas
        IF !lPona190
	        //Retira o Flag de Marcacao Apontada do SP8
            If lArquivo
	           fApoMarcacao( NIL , NIL , bBlocoOrdem , NIL , NIL , NIL , cAliasApon , cPrefix , lArquivo )
		    Else//-- Em Memoria
		        //-- Obtem TODOS os Abonos para DATA+EVENTO+TPMARC+CC e Altera Flag de marcacoes para reapontar qdo horario movel e abono abona horas
                fGetAbonos(aMainSPK	,			, aCols[n, nPosData], aCols[n, nPosPD], aCols[n, nPosTpMarca], aCols[n, nPosCC], Iif(nPosFun > 0, aCols[n, nPosFun],), Iif(nPosDepto > 0, aCols[n, nPosDepto],), Iif(nPosPosto > 0, aCols[n, nPosPosto],), Iif(nPosProces > 0, aCols[n, nPosProces],), Iif(nPosPer > 0, aCols[n, nPosPer],), Iif(nPosRot > 0, aCols[n, nPosRot],), Iif(nPosNrPag > 0, aCols[n, nPosNrPag],), dDataApo,@aColsSP8	, nMPosDataApo, nMPosAponta, lMovel, @lReaponta)
		    Endif   
    	EndIF
    EndIF

    //ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß                  
	//  TRATA ABONOS
	//ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß                  
    If lArquivo                    
		SPK->(dbSetOrder(RetOrdem("SPK","PK_FILIAL+PK_MAT+DTOS(PK_DATA)+PK_CODEVE+STR(PK_HORINI,5,2)+PK_TPMARCA+PK_CC+PK_DEPTO+PK_POSTO+PK_CODFUNC")))
    Endif
    
    //-- Se o Apontamento  possui Abono
	If !Empty(nPosAbono) .and. !Empty(aCols[n,nPosAbono])
		If lArquivo
			//-- Posiciona no SPK para o Evento
			SPK->(dbSeek(SRA->RA_FILIAL+SRA->RA_MAT+DTOS(aCols[n,nPosData])+aCols[n,nPosPD]))
	    Else//-- Em Memoria posiciona no Evento  
	        //-- Obtem TODOS os Abonos para DATA+EVENTO e Altera Flag de marcacoes para reapontar qdo horario movel e abono abona horas
            //aAbonos		:= aClone(	fGetAbonos(aMainSPK	,			, aCols[n, nPosData]		,aCols[n, nPosPD]			,aCols[n, nPosTpMarca]			, aCols[n, nPosCC]			,aCols[n, nPosFun]			,cOrdem,@aColsSP8	,nMPosOrdem,nMPosAponta,lMovel,@lReaponta)   )
            aAbonos		:= aClone(	fGetAbonos(aMainSPK	,			, aCols[n, nPosData], aCols[n, nPosPD], NIL					 , NIL			   ,NIL				  ,NIL				   , NIL				, NIL				  , NIL				 , NIL 				, NIL 				 , dDataApo, @aColsSP8, nMPosDataApo, nMPosAponta, lMovel, @lReaponta)   )
    		nLenX 		:= Len( aAbonos ) 								        
	    	lSPKFound	:= !Empty(nLenX)
	    Endif

    	lFound:= .F. //-- Variavel sinalizadora de existencia de abonos para o evento de mesma Marcacao e C.C.
        //-- Se Econtrou Abonos Pre-Existentes verifica Tipo de Marcacao e C.C.
        If lArquivo
	        If SPK->(Found())
		        //-- Restaura o C.C. para o valor original do Apontamento
		    	cCCAnt:= (cAliasApont)->(&(cPrefix+"CC") )
		    	cFunAnt:= (cAliasApont)->(&(cPrefix+"CODFUNC") )		    	
		    	cDeptoAnt:= (cAliasApont)->(&(cPrefix+"DEPTO") )
		    	cPostoAnt:= (cAliasApont)->(&(cPrefix+"POSTO") )	    	

				If ( n <= nLenAnt )
				   	If aCols[n,nPosCC]<>aColsAnt[n,nPosCC] 
				      	//-- Se houve, compara pelo valor anterior do C.C. 
					   	cCCAnt:=aColsAnt[n,nPosCC] 
					Endif
					If nPosFun > 0 .And. aCols[n,nPosFun]<>aColsAnt[n,nPosFun] 
				      	//-- Se houve, compara pelo valor anterior da Funcao 
					   	cFunAnt:=aColsAnt[n,nPosFun] 
					Endif
					If nPosDepto > 0 .And. aCols[n,nPosDepto] <> aColsAnt[n,nPosDepto]
						cDeptoAnt:=aColsAnt[n,nPosDepto]
					EndIf
					If nPosPosto > 0 .And. aCols[n,nPosPosto] <> aColsAnt[n,nPosPosto]
						cPostoAnt:=aColsAnt[n,nPosPosto]
					EndIf
					If nPosProces > 0 .And. aCols[n,nPosProces] <> aColsAnt[n,nPosProces]
						cProcesAnt:=aColsAnt[n,nPosProces]
					EndIf
					If nPosPer > 0 .And. aCols[n,nPosPer] <> aColsAnt[n,nPosPer]
						cPerAnt:=aColsAnt[n,nPosProces]
					EndIf
					If nPosRot > 0 .And. aCols[n,nPosRot] <> aColsAnt[n,nPosRot]
						cRotAnt:=aColsAnt[n,nPosRot]
					EndIf
					If nPosNrPag > 0 .And. aCols[n,nPosNrPag] <> aColsAnt[n,nPosNrPag]
						cNrPagAnt:=aColsAnt[n,nPosNrPag]
					EndIf
				Endif  
		    	//-- Corre Todos os Abonos com o mesmo Evento
		    	While SPK->(PK_FILIAL+PK_MAT+Dtos(PK_DATA)+PK_CODEVE) == (cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")+DTOS(&(cPrefix+"DATA"))+&(cPrefix+"PD"))
					//-- Verifica se trata da mesma Marcacao e C.C.
					//-- Para Abonos ja Cadastrados
				 
					If SPK->( PK_TPMARCA+PK_CC+PK_DEPTO+PK_POSTO+PK_CODFUNC) == (cAliasApont)->(&(cPrefix+"TPMARCA")+cCCAnt+cDeptoAnt+cPostoAnt+cFunAnt )
					   lFound:=.T.
					   Exit
					Endif   
					SPK->(dbSkip())
				Enddo
	        
	        Endif
        Else 
        	If lSPKFound 
        		//-- Restaura o C.C. para o valor original do Apontamento
        		//-- Registros Ja Existentes vale o anterior se nao vale o do acols
		    	cCCAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosCC],aCols[n,nPosCC])
				If n<=nLenAnt
				   	If aCols[n,nPosCC]<>aColsAnt[n,nPosCC] 
				      //-- Se houve, compara pelo valor anterior do C.C. 
					   cCCAnt:=aColsAnt[n,nPosCC] 
					Endif
				Endif  
				If nPosFun > 0 
					cFunAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosFun],aCols[n,nPosFun])
					If n<=nLenAnt
						If aCols[n,nPosFun]<>aColsAnt[n,nPosFun] 
						//-- Se houve, compara pelo valor anterior da Funcao
						cFunAnt:=aColsAnt[n,nPosFun] 
						Endif
					Endif
				Endif
				If nPosDepto > 0 				
					cDeptoAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosDepto],aCols[n,nPosDepto])
					If n<=nLenAnt
						If aCols[n,nPosDepto]<>aColsAnt[n,nPosDepto] 
						cDeptoAnt:=aColsAnt[n,nPosDepto] 
						Endif
					Endif  
				Endif
				If nPosPosto > 0 	
					cPostoAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosPosto],aCols[n,nPosPosto])
					If n<=nLenAnt
						If aCols[n,nPosPosto]<>aColsAnt[n,nPosPosto] 
						cPostoAnt:=aColsAnt[n,nPosPosto] 
						Endif
					Endif  
				Endif
				If nPosProces > 0 	
					cProcesAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosProces],aCols[n,nPosProces])
					If n<=nLenAnt
						If aCols[n,nPosProces]<>aColsAnt[n,nPosProces] 
						cProcesAnt:=aColsAnt[n,nPosProces] 
						Endif
					Endif  
				Endif
				If nPosPer > 0 	
					cPerAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosPer],aCols[n,nPosPer])
					If n<=nLenAnt
						If aCols[n,nPosPer]<>aColsAnt[n,nPosPer] 
						cPerAnt:=aColsAnt[n,nPosPer] 
						Endif
					Endif
				Endif
				If nPosRot > 0 	
					cRotAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosRot],aCols[n,nPosRot])
					If n<=nLenAnt
						If aCols[n,nPosRot]<>aColsAnt[n,nPosRot]
						cRotAnt:=aColsAnt[n,nPosRot]
						Endif
					Endif  
				Endif
				If nPosNrPag > 0 	
					cNrPagAnt:= If( n <= Len(aColsRec),aMainSPC[nElem,nPosNrPag],aCols[n,nPosNrPag])
					If n<=nLenAnt
						If aCols[n,nPosNrPag]<>aColsAnt[n,nPosNrPag] 
						cNrPagAnt:=aColsAnt[n,nPosNrPag] 
						Endif
					Endif				
				Endif
		    	//-- Corre Todos os Abonos com o mesmo Evento    
		    	//01-Cod
		    	//02-Qtde Horas
		    	//03-Horas Ini
		        //04-Horas Fim
		    	//05-Data
		    	//06-CC
		    	//07-TpMarca
		    	//08-Recno

				For nX := 1 To nLenX    
			        If   ( aAbonos[ nX , 07 ] # aCols[ n, nPosTpMarca ] .or. ;
			        		aAbonos[ nX , 06 ] # cCCAnt .or. ;
			        		aAbonos[ nX , 12 ] # cDeptoAnt .or. ;
			        		aAbonos[ nX , 13 ] # cPostoAnt .or. ;
			        		aAbonos[ nX , 11 ] # cFunAnt )
	                     Loop
	                EndIf    
	                //-- Encontrou Abono Rapido para o Apontamento lido
	                lFound:=.T.
	                Exit
				Next nX
		    	
        	Endif
        Endif   
        //-- Se Nao Existem Abonos Pre-existentes Trata-se de um abono rapido
        //-- Nesse Caso cria abono em SPk/Array Abon baseado no codigo do Abono Rapido fornecido
	    If !lFound 
		   If lArquivo
			   If RecLock('SPK',.T.)
					SPK->PK_FILIAL  := SRA->RA_FILIAL
					SPK->PK_MAT     := SRA->RA_MAT
					SPK->PK_DATA    := aCols[n,nPosData]
					SPK->PK_CODABO  := aCols[n,nPosAbono]
					SPK->PK_HRSABO  := aCols[n,nPosQtAbono]
					SPK->PK_HORINI  := 0
					SPK->PK_HORFIM  := 0
					SPK->PK_CODEVE  := aCols[n,nPosPD]  
					SPK->PK_CC      := aCols[n,nPosCC]
					SPK->PK_TPMARCA := aCols[n,nPosTpMarca]
					If nPosFun > 0
						SPK->PK_CODFUNC := aCols[n,nPosFun]
					EndIf
					SPK->PK_FLAG    := "I"
					If nPosDepto > 0
						SPK->PK_DEPTO	:= aCols[n,nPosDepto]
					EndIf
					If nPosPosto > 0
						SPK->PK_POSTO	:= aCols[n,nPosPosto]
					EndIf
					If nPosProces > 0
						SPK->PK_PROCES	:= aCols[n,nPosProces]
					EndIf
					If nPosPer > 0
						SPK->PK_PERIODO	:= aCols[n,nPosPer]
					EndIf
					If nPosRot > 0
						SPK->PK_ROTEIR	:= aCols[n,nPosRot]
					EndIf
					If nPosNrPag > 0
						SPK->PK_NUMPAG	:= aCols[n,nPosNrPag]
					EndIf
					SPK->(MsUnLock())
				Endif
		    Else 
			    //-- Em Memoria Cria Abono 
			    //-- Verifica se Ja existe algum abono no SPK
			    If !Empty(aMainSPK[1,nAPosCodA])        
			       //-- Realiza uma copia do primeiro elemento
			       aColsTmp:=Aclone(aMainSPK[1])         
			       //-- Adiciona esse novo elemento
			       AADD(aMainSPK,aColsTmp)    
			    Endif
			    //-- Altera Dados do Abono Rapido   
				nSPK:=Len(aMainSPK)
				aMainSPK[nSPK,nAPosData]		:=	aCols[n,nPosData]
				aMainSPK[nSPK,nAPosCodA]  		:=	aCols[n,nPosAbono]
				aMainSPK[nSPK,nAPosHrAb] 		:=	aCols[n,nPosQtAbono]
				aMainSPK[nSPK,nAPosHrIn]		:=	0
				aMainSPK[nSPK,nAPosHrFm]		:=	0
				aMainSPK[nSPK,nAPosCODEVE] 		:=	aCols[n,nPosPD]	 
				aMainSPK[nSPK,nAPosCC] 			:=	aCols[n,nPosCC]
				If nPosDepto > 0
					aMainSPK[nSPK,nAPosDepto]		:=	aCols[n,nPosDepto]
				EndIf
				If nPosPosto > 0 					
					aMainSPK[nSPK,nAPosPosto] 		:=	aCols[n,nPosPosto]
				EndIf
				If nPosProces > 0 
					aMainSPK[nSPK,nAPosProces]		:=	aCols[n,nPosProces]
				EndIf
				If nPosPer > 0 
					aMainSPK[nSPK,nAPosPer]		    :=	aCols[n,nPosPer]
				EndIf
				If nPosRot > 0 
					aMainSPK[nSPK,nAPosRot] 		:=	aCols[n,nPosRot]
				EndIf
				If nPosNrPag > 0 
					aMainSPK[nSPK,nAPosNrPag]		:=	aCols[n,nPosNrPag]				
				EndIf
				aMainSPK[nSPK,nAPosTpMarca]  	:=	aCols[n,nPosTpMarca]
				aMainSPK[nSPK,nAPosFlag] 		:= "I"   
				aMainSPK[nSPK,nAPosMotA]		:= SPACE(Len(SP6->P6_DESC)) 
				If nPosFun > 0
					aMainSPK[nSPK,nAPosFun] 		:=	aCols[n,nPosFun]				
				EndIf
				aMainSPK[nSPK,Len(aHeaderSPK) +1 ]   := .F.   
				
				If SP6->(dbSeek(fFilFunc('SP6')+	aCols[n,nPosAbono]))
				   aMainSPK[nSPK,nAPosMotA] := SP6->P6_DESC
				Endif
				
			     //-- Verifica o Tipo de Apontamento no dia Corrente
			    IF lMovel .AND. lReaPonta .AND. SP6->P6_ABHORAS =='S'
	               //-- Procura pelas Marcacoes de Mesma Ordem
		   		   //-- Altera o Flag das Marcacoes de mesma ordem
	       		   lReaponta:=fApoMarcacao( aMainSPK ,nAPosCodA,&('{||"'+dDataApo+'"}'),@aColsSP8,nmPosDataApo,nmPosAponta,,,.F.)   
	       		   
			    Endif
		    Endif		
		Else   
		    //--Se Houve Alteracao no Centro de Custo, Função, Depto ou Posto
		    //--Armazena todos os Registros de Abonos que deverao sofre alteracao de C.C.
		    //--Somente Valido para para elementos pre-existentes
		    
		    If (n <= nLenAnt) .AND. ( aCols[ n, nPosCC ] <> aColsAnt[ n , nPosCC ] .or.;
		    							(nPosFun > 0 .And. aCols[ n, nPosFun ] <> aColsAnt[ n, nPosFun ]) .or.;
		    							(nPosDepto > 0 .And. aCols[ n, nPosDepto ] <> aColsAnt[ n, nPosDepto ]) .or.;
		    							(nPosPosto > 0 .And. aCols[ n, nPosPosto ] <> aColsAnt[ n, nPosPosto ]) )
	      	   If lArquivo
		      	   Do While ! SPK->(Eof()) .AND. ;
		 				( (SRA->RA_FILIAL+SRA->RA_MAT+DTOS(aCols[n,nPosData])+aCols[n,nPosPD]) ==;
		   		          (SPK->PK_FILIAL+SPK->PK_MAT+DTOS(SPK->PK_DATA)+SPK->PK_CODEVE)  ;
		   			    )	       
	 					If (nPosFun > 0 .And. SPK->(PK_TPMARCA+PK_CC+PK_DEPTO+PK_POSTO+PK_CODFUNC) == (aCols[n,nPosTpMarca]+aColsAnt[n,nPosCC]+aColsAnt[n,nPosDepto]+aColsAnt[n,nPosPosto]+aColsAnt[n,nPosFun])) .Or. (nPosFun > 0 .And. SPK->(PK_TPMARCA+PK_CC) == (aCols[n,nPosTpMarca]+aColsAnt[n,nPosCC]))
	 					    aAdd(aAbonoSPK,{aCols[n,nPosCC],SPK->(Recno()),Iif(nPosFun > 0, aCols[n,nPosFun],),Iif(nPosDepto > 0, aCols[n,nPosDepto],),Iif(nPosPosto > 0, aCols[n,nPosPosto],),Iif(nPosProces > 0, aCols[n,nPosProces],),Iif(nPosPer > 0, aCols[n,nPosPer],),Iif(nPosRot > 0, aCols[n,nPosRot],),Iif(nPosNrPag > 0, aCols[n,nPosNrPag],)})
	 					Endif    
						
						SPK->(dbSkip())
				   Enddo	
               Else 
                   	//-- Recupera todos os abonos com o C.C. Anterior para posterior alteracao
				   	For nX := 1 To nLenX    
		        		IF  aAbonos[ nX , 07 ] # aCols[ n, nPosTpMarca ] .or. ;
			        		aAbonos[ nX , 06 ] # cCCAnt .or. ;
			        		aAbonos[ nX , 12 ] # cDeptoAnt .or. ;
			        		aAbonos[ nX , 13 ] # cPostoAnt .or. ;
			        		aAbonos[ nX , 11 ] # cFunAnt
                     		Loop
                		Endif 
				        //-- Encontrou Abono guarda referencia da linha no array Main
				        //-- (8o.Elemento do array aAbonos) e o novo C.C. para posterior
				        //-- autalizacao do C.C. dos Abonos com o C.C. do apontamento 
		                aAdd(aAbonoSPK,{aCols[n,nPosCC],aAbonos[nX,8],Iif(nPosFun > 0, aCols[n,nPosFun],),Iif(nPosFun > 0, aCols[n,nPosDepto],),Iif(nPosFun > 0, aCols[n,nPosPosto],),Iif(nPosFun > 0, aCols[n,nPosProces],),Iif(nPosFun > 0, aCols[n,nPosPer],),Iif(nPosFun > 0, aCols[n,nPosRot],),Iif(nPosFun > 0, aCols[n,nPosNrPag],)})
					Next nX
               Endif
	    	Endif
		Endif
	ElseIF !lArquivo //-- Em Memoria
	    //-- Se o Abono foi Eliminado
	    If !Empty(nPosAbono) .and. Empty(aCols[n,nPosAbono]) .AND. n<=nLenAnt   	
	       //-- Se Existia Abono
	       If !Empty(aColsAnt[n,nPosAbono])
	          //-- Forca Reapontamento
	          //-- Corre Todas as Marcacoes de Mesma ordem e altera Flag para
		 	  //-- que sejam apontadas novamente 
		 	  Aeval(aColsSP8, { |aMarcacoes| If( aMarcacoes[ nMPosDataApo  ] == dDataApo,aMarcacoes[ nMPosAponta]:='N',Nil) })
	       Endif
	   Endif
	Endif   
Next n

If lArquivo 
	SPK->(dbsetorder(nOrdemSPK))
Endif

//-- Elimina os abonos relacionados
nY := 0
For nY := 1 To Len(aDelSPK)
	If lArquivo
		SPK->(dbGoTo(aDelSPK[nY]))
		IF RecLock('SPK',.F.)
			IF !SPK->( FkDelete( @cMsgErr ) )
				SPK->( RollBackDelTran( cMsgErr ) )
			EndIF
			SPK->(MsUnLock())
		EndIF	
	Else
	     aMainSPK[ aDelSPK[nY] , Len(aHeaderSPK) + 1 ]:=.T.
	Endif
Next nY

//-- Altera C.C.
//-- ATENCAO: A troca de C.C., SOMENTE apos a manutencao, se faz necessaria pois o C.C.
//-- faz parte da chave de pesquisa e pode-se perder a referencia entre o apontamento e
//-- seus abonos. O Recno armazenado eh a maneira de nos referirmos ao registro
//-- que tera o seu C.C alterado. Ex:
//--  Apontamentos  C.C.Ant. C.C. Atual     Abonos .C.C.
//--  409           1000     2000           001    1000
//--  409           1000     2000           001    1000
//--  409           2000     1000           002    2000
//--  409           2000     1000           002    2000
//--  No exemplo, acima, pede-se que sejam invertidos os centros de custos.
//--  Sem o Recno como referencia iriamos, primeiro, conseguir alterar todos os 
//--  abonos do C.C 1000 para 2000. Mas ao procedermos o mesmo com o Abono 002 
//--  encontrariamos 4 C.C. 2000 e nao saberiamos quais os 2 C.C que deveriam ser 
//-- alterados para 1000.  
nY := 0
For nY := 1 To Len(aAbonoSPK)
    If lArquivo
		SPK->(dbGoTo(aAbonoSPK[nY,2]))
		IF RecLock('SPK',.F.)
			SPK->PK_CC:= aAbonoSPK[nY,1]
			SPK->PK_CODFUNC:= aAbonoSPK[nY,3]
			SPK->PK_DEPTO:= aAbonoSPK[nY,4]
			SPK->PK_POSTO:= aAbonoSPK[nY,5]
			SPK->PK_PROCES:= aAbonoSPK[nY,6]
			SPK->PK_PERIODO:= aAbonoSPK[nY,7]
			SPK->PK_ROTEIR:= aAbonoSPK[nY,8]
			SPK->PK_NUMPAG:= aAbonoSPK[nY,9]
			SPK->(MsUnLock())
		EndIF	
	Else 
	    aMainSPK[ aAbonoSPK[nY,2] , nAPosCC		]	:= aAbonoSPK[nY,1]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosFun	]	:= aAbonoSPK[nY,3]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosDepto	]	:= aAbonoSPK[nY,4]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosPosto	]	:= aAbonoSPK[nY,5]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosProces	]	:= aAbonoSPK[nY,6]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosPer	]	:= aAbonoSPK[nY,7]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosRot	]	:= aAbonoSPK[nY,8]
   	    aMainSPK[ aAbonoSPK[nY,2] , nAPosNrPag	]	:= aAbonoSPK[nY,9]   	       	       	    
	Endif
Next nY

If !Empty(aColsRFK)
	fGrvRFK()
EndIf

If nOrderSP8 == 0
	dbSelectArea("SP8")
	SET FILTER TO
	RetIndex("SP8")
	FErase(cArqSP8+OrdBagExt())
EndIf

RestArea( aAreaSPA )
RestArea( aAreaSP8 )
RestArea( aAreaSPK )
RestArea(  aArea   )

Return( NIL )                                       
                     
/*
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³FGetAbonos   ³ Autor ³ Mauricio MR           ³ Data ³ 15.08.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Obtem Abonos e Altera Flag de Marcacoes para Reapontar        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Pn130/Pn280                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function  fGetAbonos(aSPK,aDelSPK, dData,cPd,cTpMarca,cCC,cCodFun,cDepto,cPosto,cProces,cPeriodo,cRoteiro,cNrPag,dDataApo,aColsSP8,nmPosDataApo,nmPosAponta,lMovel,lReaponta) 
Local aAbonos		:= {}
Local bCopbAboCols	:= bAboCols
Local nAbonos		:= 0
Local nLenAbonos	:= 0   
Local nAposCodA		:= 1 // Conforme retorno da fABonos o 1o. Elemento corresponde ao Cod.Abono
Local nX			:= 0
Local lRetAponta	:= .F.
DEFAULT aDelSPK		:= {}

//-- Altera Temporariamente o Bloco de Retorno de Array padrao para consulta de abonos
bAboCols	:= {||aSPK}
nAbonos		:= fAbonos(dData,cPD,,@aAbonos,cTpMarca,cCC,,cCodFun,cDepto,cPosto,cProces,cPeriodo,cRoteiro,cNrPag)
//-- Restaura Bloco de Retorno de Array
bAbocols	:= bCopbAboCols
nLenAbonos	:= Len(aAbonos)
//-- Carrega os numeros das linhas correspondentes do Array Principal de Abonos 
For nX:=1 to nLenAbonos

    //-- Carrega os numeros das linhas correspondentes aos Abonos no Array Principal
    aAdd( aDelSPK, aAbonos[nX, 8] ) 

    //-- Para Horario Movel Forca Apontamento
    If lMovel  .AND. lReaponta
       //-- Altera o Flag das Marcacoes de mesma ordem 
       //-- Como ja estamos no abono enviamos o mesmo como um elemento de um array unitario
      lRetAponta:=fApoMarcacao( {aAbonos[nX]} ,nAposCodA,&('{||"'+dDataApo+'"}'),@aColsSP8,nmPosDataApo,nmPosAponta,,,.F.)   
	  //-- Altera o Flag para reapontar marcacoes se um dos abonos abonar horas
	  If !lReaponta .AND. lRetAponta
	     lReaponta:=lRetAponta
	  Endif   
	Endif 	

Next nX     

Return aAbonos

/*
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fApoMarcacao ³ Autor ³ Mauricio MR           ³ Data ³ 15.08.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Altera o Flag das Marcacoes para Forcar o Reapontamento       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Pn130/Pn280                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fApoMarcacao(aAbonos,nAPosCodA,bBlocoOrdem,aColsSP8,nmPosDataApo,nmPosAponta,cAliasApon,cPrefix,lArquivo)   
Local nY		:= 0
Local nX		:= 0
Local nLenX		:= 0
Local lForcou	:= .F.
Local dDataApo	:= Eval(bBlocoOrdem)

DEFAULT lArquivo	:= .T.
DEFAULT aAbonos		:= {}
DEFAULT nAPosCodA	:= 0
DEFAULT aColsSP8	:= {}
DEFAULT nmPosDataApo:= 0
DEFAULT nmPosAponta	:= 0
DEFAULT cAliasApon	:= IF(lPona190,  "SPH" , "SPC" )
DEFAULT cPrefix		:= PrefixoCpo( cAliasApon + "_" )


// *** Em Arquivo
If  lArquivo         
	  //-- Retorno se forca reapontamento
	  lForcou:= .T.
      If !Empty(dDataApo)
	      //-- Corre todas as Marcacoes de mesma Ordem
		  IF SP8->( dbSeek( (cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")) + DtoS(dDataApo) ) )
		 	 While SP8->( !Eof() .and. P8_FILIAL + P8_MAT + DtoS(P8_DATAAPO) == ( (cAliasApont)->(&(cPrefix+"FILIAL")+&(cPrefix+"MAT")) + DtoS(dDataApo) ) )
				IF RecLock("SP8",.F.,.T.)
					SP8->P8_APONTA := "N"
					SP8->( MsUnLock() )
				EndIF
				SP8->( dbSkip() )
			EndDo
		  EndIF
      Endif
Else// *** Em Memoria
   nLenX:=Len(aAbonos)
   //-- Corre Todos os Abonos 
   For nX:=1 To nLenX        
        //-- Obtem o Codigo do Abono
        cCodAbono:=aAbonos[nX,nAPosCodA]
		//-- Se o Abono Abona Horas
		If SP6->( dbSeek( fFilFunc('SP6') + cCodAbono ) .AND. P6_ABHORAS =='S')
		   //-- Corre Todas as Marcacoes de Mesma Ordem e Altera Flag para Forcar o Reapontamento
		   IF ( nY := aScan( aColsSP8 , { |x| x[ nMPosDataApo  ] == dDataApo } ) ) > 0
				
		      //-- Retorno se forca reapontamento
		 	  lForcou:= .T.
		   
	 		  //-- Corre Todas as Marcacoes de Mesma ordem e altera Flag para
		 	  //-- que sejam apontadas novamente 
		 	  Aeval(aColsSP8, { |aMarcacoes| If( aMarcacoes[ nMPosDataApo  ] == dDataApo,aMarcacoes[ nMPosAponta]:='N',Nil) })
		   Endif
		Endif
   Next 	
Endif

Return lForcou



/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³aPont130Ok³ Autor ³ J. Ricardo            ³ Data ³ 06.08.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Critica linha digitada                                      ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Apont130Ok(o)

Local nX			:= 0
Local nPosData		:= GDFieldPos(cPrefix+'DATA')
Local nPosPD		:= GDFieldPos(cPrefix+'PD')
Local nPosCC		:= GDFieldPos(cPrefix+'CC')
Local nPosFun		:= GDFieldPos(cPrefix+'CODFUNC')
Local nPosDepto	  	:= GDFieldPos(cPrefix+'DEPTO')
Local nPosPosto	  	:= GDFieldPos(cPrefix+'POSTO')
Local nPosProces  	:= GDFieldPos(cPrefix+'PROCES')
Local nPosPer	 	:= GDFieldPos(cPrefix+'PERIODO')
Local nPosRot	  	:= GDFieldPos(cPrefix+'ROTEIR')
Local nPosNrPag	 	:= GDFieldPos(cPrefix+'NUMPAG')
Local nPosTpMarc	:= GDFieldPos(cPrefix+'TPMARCA')
Local nPosPDI		:= GDFieldPos(cPrefix+'PDI')
Local nPosQuantc	:= GDFieldPos(cPrefix+'QUANTC') 
Local nPosQuantI	:= GDFieldPos(cPrefix+'QUANTI')  
Local nPosQtAbono	:= GDFieldPos(cPrefix+'QTABONO')
Local nPosAbono 	:= GDFieldPos(cPrefix+'ABONO')
Local nRepet		:= 0
Local lRet			:= .T.

//-- Caso n„o seja Deletado
If !aCols[n,Len(aCols[n])]

	Begin Sequence
		
		//-- Impede a existencia de Data/ C¢digo / C.C. ou Tp.Marcacao repetidos
		nRepet := 0
		IF nPosData > 0 .and. nPosPD > 0 .and. nPosCC > 0 .and. nPosTpMarc > 0 .and. nPosFun > 0
			aEval(aCols,{|x| nRepet += If(!x[nUsado+1].and.x[nPosData]==aCols[n,nPosData].and.x[nPosPD]==aCols[n,nPosPD].and.x[nPosCC]==aCols[n,nPosCC].and.x[nPosTpMarc]==aCols[n,nPosTpMarc].and.x[nPosFun]==aCols[n,nPosFun],1,0)})
			IF nRepet > 1
				Help(' ', 1, 'P040DTCONI')
				lRet := .F.
				Break
			EndIF
		EndIF
		
		//-- Impede Datas em Branco
		If nPosData > 0 
			IF Empty(aCols[n,nPosData])
				Help(" ",1,"P040DTNIL")
				lRet := .F.
		   		Break
		   	EndIF
		   	//-- Verifica se a Data Entra Dentro do Periodo de Apontamento
		   	IF !( lRet := ValidPonData(aCols[n,nPosData],"G",dPerIni,dPerFim,lPona190,.T.) )
		   		Break
		   	EndIF
		EndIf
        
	    //-- Impede Cod.Evento e Informado Simultaneamente em Branco 
	    If nPosPD > 0   .AND. nPosPDI > 0
			If Empty( aCols[n, nPosPD] ) .And. Empty( aCols[n, nPosPDI] )
			   cHelp := STR0030	//"J  Existe Marca‡„o Cadastrada Para o Dia"
			   Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 )
			   lRet := .F.
			   Break
			Endif   
		EndIf        
		
			//-- Impede a existencia de Quantidades = 0 na linha
		If nPosQuantC > 0 .and. nPosQuantI > 0 .AND. nPosPDI > 0
		   	//-- Nao Permite que as horas Calculadas sejam negativas   
			If aCols[n,nPosQuantC] < 0
			 	Help(' ', 1, 'THORMENOR0')
				lRet := .F.
			    Break
			Endif                                   
			
			//-- Nao Permite que as horas Informadas sejam negativas   			
			If aCols[n,nPosQuantI] < 0
			 	Help(' ', 1, 'THORMENOR0')
				lRet := .F.
			    Break
			Endif  
		    	//-- Nao Permite que as horas sejam vazias simultaneamente
			If Empty(aCols[n,nPosQuantC] + aCols[n,nPosQuantI])
			    //-- Verifica Quantidade Calculada
	            If Empty(aCols[n,nPosQuantC]) .AND. Empty( aCols[n, nPosPDI] )
				   cHelp:=aHeader[nPosQuantC][1]
		    	   Help( ' ' , 1 , 'NVAZIO' , , OemToAnsi( cHelp ) , 5 , 0 )
		    	   lRet:= .F. 
		    	   Break
				Endif   
				
				//-- Verifica Quantidade Informada 
				If Empty(aCols[n,nPosQuantI])
				   cHelp:=aHeader[nPosQuantI][1]
		    	   Help( ' ' , 1 , 'NVAZIO' , , OemToAnsi( cHelp ) , 5 , 0 )
		    	   lRet:= .F. 
		    	   Break
				Endif                             
            Endif
		EndIf	

		If nPosQtAbono > 0 .and. nPosQuantI > 0 .and. nPosQuantC > 0
			
			//-- Impede a digita‡„o de Minutos Inv lidos
			If aCols[n, nPosQtAbono ] > 0 .And. (aCols[n, nPosQtAbono ] - Int(aCols[n, nPosQtAbono ])) * 100 >= 60 .Or. ;
				aCols[n, nPosQuantI] > 0 .And. (aCols[n, nPosQuantI] - Int(aCols[n, nPosQuantI])) * 100 >= 60 .Or. ;
				aCols[n, nPosQuantC] > 0 .And. (aCols[n, nPosQuantC] - Int(aCols[n, nPosQuantC])) * 100 >= 60
				Help(' ', 1, 'THORMAIO59')
				lRet := .F.
				Break
			EndIf
			
			//-- Impede que se Abone horas Informadas
			If aCols[n, nPosQtAbono]	> 0 .And. aCols[n, nPosQuantI] > 0
				Help(' ', 1, 'A130INFABO')
				lRet := .F.
				Break
			EndIf
				
			//-- Impede o Abono maior que o Calculado
			If aCols[n, nPosQtAbono] > aCols[n, nPosQuantC]						
				If ( lPnaAboM )
					If !( ValType( lRet := ExecBlock("PNA130ABOM",.F.,.F. ) ) == "L" )
						lRet := .F.
					EndIf
				Else
					Help(' ',1,'A040ABOMAI') //Somente Adverte para permitir a alteracao do abono informado.								
					lRet := .F.
					Break
				EndIf					
								
			EndIf
			
		EndIf
	End Sequence	
		
EndIf

   

Return lRet

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³pn130TudOk³ Autor ³ J. Ricardo            ³ Data ³ 15.02/95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function pn130TudOk(o)
Local lRetorna  := .T.

lRetorna:=Apont130Ok(o)

Continua := .F.
Return lRetorna


/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130Valid³ Autor ³ Mauro                 ³ Data ³ 06.08.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Critica a data da linha digitada                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130ValDt()

Local lRet 	  := .T.
Local dDataAp := Ctod("")
Local nPos1   := GDFieldPos(cPrefix+"DATA"   )
Local nProc	  := GDFieldPos(cPrefix+"PROCES" )
Local nRot	  := GDFieldPos(cPrefix+"ROTEIR" )
Local nPer	  := GDFieldPos(cPrefix+"PERIODO")
Local nNrPag  := GDFieldPos(cPrefix+"NUMPAG" )
Local nFunc	  := GDFieldPos(cPrefix+"CODFUNC")
Local nPosTab := 0

//-- Verifica se Existe uma lista como Calendario (Ver. Prog Pona280)
If Type("oLBox") == "O"                                                
   //-- Obtem a Data Corrente do Calendario
   dDataAp:=CalendRetCpo( cPrefix+"DATA"  )
   //-- Nao Permite Apontamentos em Datas Diferentes da do Calendario
   If aCols[n,nPos1] <> dDataAp
      lRet:=.F.
   Endif
Else 
	dDataAp := GetMemVar( cPrefix+"DATA" )
Endif

If lRet
	If n <= Len(aColsRec)
		If aCols[n,nPos1] # GetMemVar( cPrefix+"DATA" ) .And. !Empty(aCols[n,nPos1])
		   lRet := .F.
		Endif	
	Else
	    //Nao permite Informar Data Fora do Periodo
		IF nPos1 > 0
			lRet := ValidPonData(GetMemVar( cPrefix+"DATA" ),"G",dPerIni,dPerFim,lPona190,.T.)
		EndIF	
	Endif
	If ( nPosTab := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataAp .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0 .and. lRet
		aCols[n,nProc ] := aTabCalend[nPosTab,CALEND_POS_PROCESSO ]
		aCols[n,nRot  ] := aTabCalend[nPosTab,CALEND_POS_ROTEIRO  ]
		aCols[n,nPer  ] := aTabCalend[nPosTab,CALEND_POS_PERIODO  ]
		aCols[n,nNrPag] := aTabCalend[nPosTab,CALEND_POS_NUM_PAGTO]
		aCols[n,nFunc ] := aTabCalend[nPosTab,CALEND_POS_CODFUNC  ]
	EndIf
Endif

Return lRet   


/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130WPdI  ³ Autor ³ Mauricio MR           ³ Data ³ 09.10.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Verifica When do  Codigo Informado                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Pona130                                                     ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130WPdI()

Local lRet 	:= .T.
Local nPos1 := 0

//-- Nao Permite acesso ao Codigo Informado se o apontamento esta abonado
If ( nPos1 := GDFieldPos(cPrefix+"ABONO") ) > 0
    If !Empty(aCols[n,nPos1])
	   lRet:=.F.	
   Endif 
Endif    

Return lRet  

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130VPdI  ³ Autor ³ Mauricio MR           ³ Data ³ 09.10.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Verifica Valid do Codigo Informado                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130VPdI()

Local lRet 		:= .T.

Local cVar		:= ReadVar()

Local cAlias	:= IF( lPona190 , "SPH" , "SPC" ) 
Local cPrefix	:= ( PrefixoCpo( cAlias ) + "_" )

//-- Numericos -- Posicionamento dos campos em aHeader
Local nPosHrCalc:= GdFieldPos( cPrefix + "QUANTC"	)
Local nPosHrInf := GdFieldPos( cPrefix + "QUANTI"	)
Local nPosDesc	:= GdFieldPos( cPrefix + "DESC" 	) 
Local nPosPD	:= GdFieldPos( cPrefix + "PD" 		)
Local nPosPDI	:= GdFieldPos( cPrefix + "PDI" 		)
Local nPosFlag	:= GdFieldPos( cPrefix + "FLAG" 	)  

If !VAZIO() 
   If !ExistCpo("SP9")
	  //-- Codigo Informado nao Existe
      lRet:=.F.
   Endif 
Endif     

//-- Se nao houveram inconsistencias 
If lRet  .AND. !Empty(nPosHrCalc) .AND. !Empty(nPosPD)  .AND. !Empty(nPosDesc);
        .AND. !Empty(nPosHrInf)  .AND. !Empty(nPosPDI)  .AND. !Empty(nPosFlag)             

   //-- Verifica a Variavel Ativa no momento da saida da linha
   //-- e atualiza conteudo do aCols correspondente
   If cVar==("M->"+cPrefix+"PDI") .AND. !Empty(nPosPDI)
      aCols[n, nPosPDI]:= GetMemVar( cPrefix+"PDI" )
   Endif

   //-- Verifica se Codigo foi Informado                               
   If ( aCols[n, nPosFlag] == "I" )                                                           
   		If !Empty( aCols[n, nPosPDI]) 
      		aCols[n, nPosPD]    := aCols[n, nPosPDI]           
   	  		aCols[n, nPosDESC]  := DescPdPon( aCols[n, nPosPD] )
   	  	Else                                          
   	  	 	aCols[n, nPosPD]    := aCols[n, nPosPDI]  //-- Codigo informado esta em "branco"
   	  		aCols[n, nPosHrCalc]:= 0 
      		aCols[n, nPosHrInf] := 0	
 	  		aCols[n, nPosDESC]  := DescPdPon( aCols[n, nPosPD] )
   	  	Endif
   Else 
        If !Empty( aCols[n, nPosPDI]) 
	        //-- Alimenta as Horas informadas pelas calculadas sem ainda nao foram fornecidas
	        aCols[n, nPosHrInf]:= If( !Empty(  aCols[n, nPosHrInf] ) 	,  aCols[n, nPosHrInf] ,  aCols[n, nPosHrCalc] )  
        Else 
			//-- Zera as Horas informadas
	        aCols[n, nPosHrInf]:= 0
        Endif
   Endif        
           
Endif

Return lRet           

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130WQtdeI³ Autor ³ Mauricio MR           ³ Data ³ 09.10.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Verifica When da Quantidade Informada                        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130WQtdeI()
Local lRet 	:= .T.
Local nPos1 := 0

//-- Nao Permite acesso a Quantidade Informada sem o Codigo Informado
If ( nPos1 := GDFieldPos(cPrefix+"PDI") ) > 0
    If Empty(aCols[n,nPos1])
	   lRet:=.F.	
    Endif 
Endif

If lRet
	//-- Nao Permite acesso a Quantidade Informada se o apontamento esta abonado
	If ( nPos1 := GDFieldPos(cPrefix+"ABONO") ) > 0
	    If !Empty(aCols[n,nPos1])
		   lRet:=.F.	
	    Endif 
	Endif    
Endif

Return lRet 
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130VQtdeI³ Autor ³ Mauricio MR           ³ Data ³ 09.10.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Verifica Valid da Quantidade Informada                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130VQtdeI()

Local lRet 	:= .T.

Local cVar		:= ReadVar()

Local cAlias	:= IF( lPona190 , "SPH" , "SPC" ) 
Local cPrefix	:= ( PrefixoCpo( cAlias ) + "_" )


//-- Numericos -- Posicionamento dos campos em aHeader
Local nPosHrCalc:= GdFieldPos( cPrefix + "QUANTC"	)
Local nPosHrInf := GdFieldPos( cPrefix + "QUANTI"	)
Local nPosDesc	:= GdFieldPos( cPrefix + "DESC" 	) 
Local nPosPD	:= GdFieldPos( cPrefix + "PD" 		)
Local nPosPDI	:= GdFieldPos( cPrefix + "PDI" 		)
Local nPosFlag	:= GdFieldPos( cPrefix + "FLAG" 	)


//-- Se nao houveram inconsistencias 
If lRet  .AND. !Empty(nPosHrCalc) .AND. !Empty(nPosPD)  .AND. !Empty(nPosDesc);
        .AND. !Empty(nPosHrInf)  .AND. !Empty(nPosPDI)  .AND. !Empty(nPosFlag)
   
   //-- Verifica a Variavel Ativa no momento da saida da linha
   //-- e atualiza conteudo do aCols correspondente
   If cVar==("M->"+cPrefix+"QUANTI") .AND. !Empty(nPosHrInf)
      aCols[n, nPosHrInf]:= GetMemVar( cPrefix+"QUANTI" )
   Endif 
   
   
   //-- Limpa Cod.Evento, Descricao e Quantidade para Apontamento Informado se o usuario
   //-- nao informar a quantidade
   If  ( aCols[n, nPosFlag] == "I" )  
	   If !Empty(aCols[n, nPosHrInf]) 
	   	  aCols[n, nPosHrCalc]:= aCols[n, nPosHrInf]
	   Else
	   	  aCols[n, nPosHrCalc]:= 0
	   Endif	
   Endif   
Endif

Return lRet           



/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130WAbono³ Autor ³ Mauricio MR           ³ Data ³ 05.09.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Verifica When do Abono                                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130WAbono()

Local lRet 	:= .T.
Local nPos1 := 0

//-- Verifica o Uso da Funcao pelo Programa Pona280
If Type("LPONA280")<>"U"
   //-- Nao Permite Edicao de Abono para Apontamentos Informados
   If ( nPos1 := GDFieldPos(cPrefix+"FLAG") ) > 0
      If aCols[n,nPos1] == "I"
         lRet:=.F.
      Endif
   Endif 
Endif

//-- Verifica a Digitacao do Codigo Informado
If lRet                                      
   //-- Nao Permite Edicao de Abono para Apontamentos com Codigo Informado
   If ( nPos1 := GDFieldPos(cPrefix+"PDI") ) > 0
      If !Empty(aCols[n,nPos1])
         lRet:=.F.
      Endif
   Endif
Endif
           
If lRet                                      
   //-- Nao Permite Abonar se Nao existir qtde de horas a serem abonadas (Pode ocorrer em acumulados
   //-- ao digitar primeiro o abono e depois a quantidade)
   If ( nPos1 := GDFieldPos(cPrefix+"QUANTC") ) > 0
      If Empty(aCols[n,nPos1])
         lRet:=.F.
      Endif
   Endif
Endif
   
Return lRet   



/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130Data ³ Autor ³ Mauricio MR           ³ Data ³ 29.07.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Valor Padrao da data do apontamento                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Pona130/280                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130Data()

Local dRet 	:= Ctod('')

//-- Verifica se Existe uma lista como Calendario (Ver. Prog Pona280)
If Type("oLBox") == "O"                                                
   //-- Obtem a Data Corrente do Calendario
   dRet:=CalendRetCpo( cPrefix+"DATA",,,cPrefix  )
Endif

REturn dRet
           
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130PosCursor³ Autor ³ Mauricio MR           ³ Data ³ 09.10.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Posiciona o cursor na coluna de codigos informados              ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Pona130/280                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130PosCursor(o)

Local lRet 	  	:= .T.
Local nPosPD 	:= GDFieldPos(cPrefix+"PD")
Local nPosPDI 	:= GDFieldPos(cPrefix+"PDI")
Local nPosABONO	:= GDFieldPos(cPrefix+"ABONO")

If !EMPTY(nPosPD) .AND. !EMPTY(nPosPDI) .AND.!EMPTY(nPosABONO)
    //-- Verifica a Existencia de Abonos
	If  !Empty(aCols[o:nAt,nPosABONO]) 
	    //-- Posiciona no Codigo do Abono
	    o:nColPos:= nPosABONO
	Else
	   //-- Verifica a Existencia de Codigo do Evento
		If  !Empty(aCols[o:nAt,nPosPD])
		    //-- Posiciona no Codigo Informado
	   		o:nColPos:= nPosPDI   
		Endif
	Endif	
Endif


REturn lRet

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130ValPd³ Autor ³ Mauro                 ³ Data ³ 06.08.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Critica o Codigo da linha digitada                          ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130ValPd()

Local lRet := .T.
Local nPos1 := 0
Local nPos2 := 0

nPos1 := GDFieldPos(cPrefix+"PD")
nPos2 := GDFieldPos(cPrefix+"DESC")

If n <= Len(aColsAnt)
	If aCols[n,nPos1] # GetMemVar( cPrefix+"PD" ) .And. !Empty(aCols[n,nPos1])
	   lRet := .F.
	Endif	
Endif

//-- Inclus„o da Descri‡„o
If lRet
	aCols[n,nPos2]	:= DescPDPon( GetMemVar( cPrefix+"PD" ) )
EndIf
Return lRet


/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³Pn130ChoiBar  ³ Autor ³ Mauro             ³ Data ³ 06.08.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Enchoice Bar												  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³Pona130                                                     ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function Pn130ChoiBar(oDlg,nOpcx)
     
Local oBar
Local bSet15
Local bSet24
Local bAbono:={||}
Local bInforma:={||}
Local oBtRec
Local oBtCop
Local oBtCol
Local oBtCal
Local oBtAge
Local oBtSpo
Local oBtHlp
Local oBtOk
Local oBtCan
Local oBtAb
Local oBtInf
Local oBtAbVis
Local lOk     	:= .F.
Local lVolta  	:= .F.
Local dData   	:= Ctod('  /  /  ')
Local nHoras  	:= 0
Local nPosPDI 	:= GDFieldPos(cPrefix+"PDI")
Local nPosQuantI:= GDFieldPos(cPrefix+"QUANTI")
Local cEvento 	:= Space(03) 
Local aButtons	:= {}
Local bPesq		:= {|| }

// Caso seja inclusao, exclusao ou atualizacao, executa inicializador padrao, do contrario nao executa.
Local lIniPad	:= If (nOpcx == 3 .or. nOpcx == 4 .or. nOpcx == 5 , .T. , .F. )
Local cCusto  	:= (cAliasApont)->(CriaVar((cPrefix+"CC"),lIniPad))
Local cCodFunc 	:= (cAliasApont)->(CriaVar((cPrefix+"CODFUNC"),lIniPad))
Local cDepto	:= (cAliasApont)->(CriaVar((cPrefix+"DEPTO"),lIniPad))
Local cPosto	:= (cAliasApont)->(CriaVar((cPrefix+"POSTO"),lIniPad))
Local cProces	:= (cAliasApont)->(CriaVar((cPrefix+"PROCES"),lIniPad))
Local cPeriodo	:= (cAliasApont)->(CriaVar((cPrefix+"PERIODO"),lIniPad))
Local cRoteiro	:= (cAliasApont)->(CriaVar((cPrefix+"ROTEIR"),lIniPad))
Local cNumPag	:= (cAliasApont)->(CriaVar((cPrefix+"NUMPAG"),lIniPad))
Local cTpMarca	:= (cAliasApont)->(CriaVar((cPrefix+"TPMARCA"),lIniPad))	

//-- Somente permite a chamada da tela de abonos se o evento nao foi informado
bAbono:={||	If( Empty(aCols[n,nPosPDI]),;
		                (   SetKey(VK_F4,{||Nil}),;
							RetDataHor(@dData, @nHoras, @cEvento, @cCusto, @cCodFunc, @cTpMarca, @cDepto, @cPosto, @cProces, @cRoteiro, @cPeriodo, @cNumPag),;
							fAcessAbono('PONA130',nOpcx,nPosSRA,dData,nHoras,cEvento,aHeader,@aCols,n,cCusto,cTpMarca,cPrefix,cAliasApont,cDepto,cPosto,cCodFunc,cProces,cRoteiro,cPeriodo,cNumPag),;
							SetKEY(VK_F4,bAbono),;							 
							oDlg:Refresh();
						)   ,;
							(If ( Empty( aCols[n,nPosQuantI]) .OR. aCols[n,nPosQuantI]< 0 ,; 
							    (  cHelp := STR0031,;	 //'N„o se pode Abonar Apontamento com Codigo de Evento Informado.'		 
			                       Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 );
			                    ),; 
			                    Help(' ', 1, 'A130INFABO')), Nil);
			  );
		 }				

If lTemRFK
	//-- Somente permite a chamada da tela de abonos se o evento nao foi informado
	bInforma:={||	If( Empty(aCols[n,nPosPDI]),;
			                (   SetKey(VK_F6,{||Nil}),;
								RetDataHor(@dData, @nHoras, @cEvento, @cCusto, @cCodFunc, @cTpMarca, @cDepto, @cPosto, @cProces, @cRoteiro, @cPeriodo, @cNumPag),;
								fInforma(nOpcx,dData,nHoras,cEvento,aHeader,@aCols,n,cCusto,cPrefix,cAliasApont,cDepto,cPosto,cCodFunc,cProces,cRoteiro,cPeriodo,cNumPag),;
								SetKEY(VK_F6,bInforma),;
								oDlg:Refresh();
							)   ,;
							(	cHelp := STR0203,;	 //'N„o é possível dividir apontamento com Codigo de Evento Informado.'		 
				                Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 );
				   			);
				       );
			 }
EndIf
IF nOpcx == 3 .OR. nOpcx == 4
	aAdd(aButtons, {'ALT_CAD', {|| Eval(bAbono)},OemToAnsi(STR0028)})// 'Abonar/Justificar - <F4>'
	SetKey(VK_F4,bAbono)
	If lTemRFK
		aAdd(aButtons, {'BMPINCLUIR', {|| Eval(bInforma)},OemToAnsi(STR0204)})// 'Informar Apontamento - <F6>'
		SetKey(VK_F6,bInforma)	
	EndIf

Endif

bPesq := {|| 	SetKey(VK_F5,{||NIL}),;
				PONA210(),;
				SetKey(VK_F5,bPesq),;																
				oDlg:Refresh();
		  }
aAdd(aButtons, {'pesquisa', {|| Eval(bPesq)},OeMToAnsi(STR0029)})
SetKey(VK_F5,bPesq)

Return( aButtons )

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³RetDataHor    ³ Autor ³ Mauro             ³ Data ³ 06.08.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Retorna Data e Hora										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³Pona130                                                     ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Static Function RetDataHor(  dData, nHoras,cEvento,cCusto,cCodFun,cTpMarca, cDepto, cPosto, cProcesso, cRoteiro,;
							 cPeriodo, cNumPag)
Local nPos:=0

nPosCodFunc	:= GdFieldPos(cPrefix+"CODFUNC")	
nPosDepto	:= GdFieldPos(cPrefix+"DEPTO")	
nPosPosto	:= GdFieldPos(cPrefix+"POSTO")	
nPosProces  := GdFieldPos(cPrefix+"PROCES")	
nPosRoteir	:= GdFieldPos(cPrefix+"ROTEIR")		
nPosPeriodo	:= GdFieldPos(cPrefix+"PERIODO")			
nPosNumPag	:= GdFieldPos(cPrefix+"NUMPAG")				
nPosDesc    := GdFieldPos(cPrefix+"DESC")

IF ( nPos := GDFieldPos(cPrefix+'DATA')) > 0
	dData := aCols[n, nPos]
EndIF

IF ( nPos := GDFieldPos(cPrefix+'QUANTC')) > 0
	nHoras:= aCols[n, nPos]
EndIF
                                               
IF (nPos := GDFieldPos(cPrefix+'PD')) > 0
	cEvento := aCols[n, nPos]
EndIF
//-- Obtem o Centro de custo do Apontamento
//-- Se estiver gravado pega do arquivo, senao, vale o que estiver no array
If n <= Len(aColsRec)
    cCusto	:=	aColsRec[n ,5] //CCusto
	If nPosCodFunc > 0
		cCodFun	:=  aColsRec[n, 6] //Funcao
	EndIf
	If nPosDepto > 0
		cDepto	:=  aColsRec[n, 7] //Depto
	EndIf
	If nPosPosto > 0
		cPosto	:=  aColsRec[n, 8] //Posto
	EndIf
	If nPosProces > 0
		cProces	:=  aColsRec[n, 9] //Processo
	EndIf
	If nPosRoteir > 0
		cRoteir :=  aColsRec[n, 10]//Roteiro 
	EndIf
	If nPosPeriodo > 0
		cPeriodo:=  aColsRec[n, 11]//Periodo 
	EndIf
	If nPosNumPag > 0
		cNumPag	:=  aColsRec[n, 12]//Num.pagto 
	EndIf		 
Else 
	IF (nPos := GDFieldPos(cPrefix+'CC')) > 0
	   cCusto:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'CODFUNC')) > 0
	   cCodFun:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'DEPTO')) > 0
	   cDepto:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'POSTO')) > 0
	   cPosto:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'PROCES')) > 0
	   cProcesso:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'PERIODO')) > 0
	   cPeriodo:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'ROTEIR')) > 0
	   cRoteiro:= aCols[n, nPos]
	ElseIF (nPos := GDFieldPos(cPrefix+'NUMPAG')) > 0
	   cNumPag:= aCols[n, nPos]
    Endif   
Endif 
   
IF (nPos := GDFieldPos(cPrefix+'TPMARCA')) > 0
	cTpMarca := aCols[n, nPos]
EndIF   
Return( NIL )
   
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³Pn130ValAb³ Autor ³ Fernando joly Siquini ³ Data ³ 22/12/97 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Valida o campo "Abono" e altera campos no aCols            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PonA130                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Function Pn130ValAb()

Local lRet  		:= .T.
Local nPosAbono 	:= GDFieldPos(cPrefix+'ABONO')     
Local nPosData		:= GDFieldPos(cPrefix+'DATA')
Local nPosPD    	:= GDFieldPos(cPrefix+'PD')
Local nPosQtI   	:= GdFieldPos(cPrefix+'QUANTI' )   
Local nPosQtAb 		:= GdFieldPos(cPrefix+'QTABONO' )  
Local nPosQuantC	:= GdFieldPos(cPrefix+'QUANTC' ) 
Local nPosTpMarca	:= GdFieldPos(cPrefix+'TPMARCA' ) 
Local nPosCC	    := GdFieldPos(cPrefix+"CC")
Local nPosFun		:= GdFieldPos(cPrefix+"CODFUNC")
Local nPosDepto	    := GDFieldPos(cPrefix+'DEPTO')
Local nPosPosto	    := GDFieldPos(cPrefix+'POSTO')
Local nPosProces    := GDFieldPos(cPrefix+'PROCES')
Local nPosPer	    := GDFieldPos(cPrefix+'PERIODO')
Local nPosRot	    := GDFieldPos(cPrefix+'ROTEIR')
Local nPosNrPag	    := GDFieldPos(cPrefix+'NUMPAG')

Private aAbonos		:=	{} 

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Verfica se Abono e Valido                                    ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If !DescAbono( GetMemVar( cPrefix+"ABONO" ) , "L" , cPrefix+"DESCABO" )
   Return .f.
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Verfica se Existem Abonos no SPK Para aquele apontamento     ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

fAbonos(aCols[n,nPosData],aCols[n,nPosPD],,@aAbonos,aCols[n,nPosTpMarca],aCols[n,nPosCC],,Iif(nPosFun > 0, aCols[n,nPosFun],),Iif(nPosDepto > 0, aCols[n,nPosDepto],),Iif(nPosPosto > 0, aCols[n,nPosPosto],),Iif(nPosProces > 0, aCols[n,nPosProces],),Iif(nPosPer > 0, aCols[n,nPosPer],),Iif(nPosRot > 0, aCols[n,nPosRot],),Iif(nPosNrPag > 0, aCols[n,nPosNrPag],))
If !Empty(Len(aAbonos))
   Return .f.
Endif    

If Empty( GetMemVar( cPrefix+"ABONO" ) ) .And. !Empty(aCols[n, nPosAbono])
	Help(' ',1,'EXCLABO')
	lRet := .F.
Else
	lRet := .T.
EndIf

If lRet                
	//-- Calcula Qtde Abonada para Apontamento sem Abonos (somente abono rapido)
	//-- Se a Qtde Horas Abonadas nao existir e nao foi fornecida a qtde Informada
	//-- assume a qtde calculada, senao permanece a qtde abonada 
	aCols[n,nPosQtAB]:=iif(Empty(aCols[n,nPosQtAB]).AND. Empty(aCols[n,nPosQtI]),;
                       aCols[n,nPosQuantC],;
                       aCols[n,nPosQtAB])
Endif
Return lRet
  

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³Pn310Horas³ Autor ³ Maurico MR            ³ Data ³ 27/06/01 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Devolve Conteudo para cCampo se houve alteracao nos dados  ³±±
±±³          ³                                                            ³±±
±±³          ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PonA310                                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Retorno   ³cRet                                                        ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Function Pn310Horas(cCampo,aColsAtual,aColsCopia,nElem,cRetorno)

Local cRet := cRetorno         
//Como colocamos alguns Campos Pre-preenchidos, pode ocorrer que a informacao no Array 
//aCols nao esteja gravada fisicamente. Temos que verificar se o campo contem a informacao. 
//Se nao havia registro anteriormente, o campo sera setado para cRetorno informado  
If  Empty(cCampo)
    cRet:=cRetorno
Else    
	//Se nao foram adicionados novos registros compara conteudo atual com anterior 
	If  nElem  <=LEN(aColsCopia)    
	                     
        //fCompArray retorna .T. se nao houve alteracao nas informacoes do registro
        //Para informacao alterada seta flag para retorno informado 
        //Para informacao NAO alterada permanece o conteudo 
        cRet:=If(fCompArray(aColsAtual[nElem],aColsCopia[nElem]),cCampo,cRetorno )
    Else
        //Se foram adicionados outros elementos no array  
        cRet:=cRetorno
    Endif
Endif                           

Return( cRet ) 


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³fAcessAbono ³ Autor ³ Mauricio MR           ³ Data ³ 25/04/03 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Valida o acesso a dialog de abonos                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PonA130                                                      ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/

Function fAcessAbono(fChamadora,nOpcx,nPosSRA,dData,nHoras,cEvento,aHeader,aCols,n,cCusto,cTpMarca,cPrefix,cAliasApont,cDeptoSPC,cPostoSPC,cCodFuncSPC,cProces,cRoteiro,cPeriodo,cNrPag)
Local nPQuantI		:=  GDFieldPos(cPrefix+ 'QUANTI' ) 	
Local lRet			:= .T.	
Local nPosHrAbono 	:= GDFieldPos(cPrefix+'QTABONO')
Local nPosHrCalc 	:= GDFieldPos(cPrefix+'QUANTC')

//-- Caso n„o seja Deletado
If !aCols[n,nUsado+1]
	//-- Se a Linha for Valida
	lRet:= Apont130Ok()          
	If lRet .OR. (!lRet .AND.  aCols[n, nPosHrAbono] > aCols[n, nPosHrCalc])

	    //-- Se localizado o campo de quatidade informada
	   	If !Empty(nPQuantI)  
			//-- Impede que se Abone horas Informadas
			If aCols[n, nPQuantI] > 0
				Help(' ', 1, 'A130INFABO')
				lRet := .F.
			Else
	 		   PONA210(fChamadora,nOpcx ,nPosSRA,dData,nHoras,cEvento,aHeader   ,@aCols  ,n      ,cCusto,cTpMarca,cPrefix,cAliasApont,cDeptoSPC,cPostoSPC,cCodFuncSPC,cProces,cRoteiro,cPeriodo,cNrPag)
	 		   lRet := .F.
	        Endif
	    Endif
	Endif
Else                         
   //-- Nao permite acesso a abono se o evento esta deletado
   Help(' ',1,'P280ACESAB')                                                                                        
   lRet:=.F.
Endif
Return lRet 

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³Pona130Locks    ³Autor³Mauricio MR         ³ Data ³14/04/2004³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Bloqueia Lancamentos de Marcacoes /Apont/Abonos		         ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³<Vide parametros formais>									 ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide parametros formais>									 ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Retorno   ³NIL		                                               	     ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Observa‡„o³                                                      	     ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso       ³PONA130                                                      ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Static Function Pona130Locks( nOpc , cAlias, aRecnos )

Local lLocks	:= .T.
Local aRecAux	:= {}

Begin Sequence

	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³Se nao For Visualizacao 				 					   ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	IF ( nOpc == 2 ) 
		Break
	EndIF

	aEval(aRecnos, {|x| If( !Empty(x),aADD(aRecAux,x), Nil) } )

	IF !( lLocks := WhileNoLock( cAlias , aRecAux , {xFilial(cAlias)+SRA->RA_MAT} , 1 , 1 , .T. , NIL ) )
		Break
	EndIF

End Sequence

Return( lLocks )  


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³pn130MontaGetDados ³ Autor ³ Leandro Drumond       ³ Data ³01/11/2007							   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Montar a GetDados 																				   |
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³
³Sintaxe   ³pn130MontaGetDados(nOpcX,aGdAltera,lMarcacao,lApontamento,lAbono,lEntrada)                         |
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso       ³PONA130                                                            							       ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Static Function pn130MontaGetDados(nOpcX,aGdAltera,lMarcacao,lApontamento,lAbono,oGet,lPriVez)

Local aArea 		:= GetArea()
Local aRecnos		:= {}
Local aQueryCond	:= {}
Local aGdNoFields	:= {cPrefix+"FILIAL",cPrefix+"MAT"}
Local aGdNaoAltera	:= {cPrefix+"FILIAL",cPrefix+"MAT",cPrefix+"FLAG"}
Local aVisual		:= {}
Local bSkip			:= { || .F. }
Local cFil			:= SRA->RA_FILIAL
Local cMat      	:= SRA->RA_MAT
Local cNome     	:= SRA->RA_NOME

//-- Variaveis para Verificacao de Bloqueios
Local lRet			:= .T.
Local nCnt			:= 0   
Local nLenRecnos    := 0
Local nPosDt		:= 0
Local nPosPd		:= 0
Local nPosTp		:= 0
Local nPosCC		:= 0
Local nPosDesc		:= 0

aColsRec   := {}
aTabCalend := {}
aTabPadrao := {}
aVirtual   := {}

Default lPriVez 	:= .F. 

cAlias := cAliasApont

Begin Sequence
	/*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Obtem Periodo de Apontamento conforme o Processo do  ³
	³ funcionario										   ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/ 
	cProcesso	:= SRA->RA_PROCES
	oPeriodo:cProcesso := cProcesso
	
    If !(fGetPeriodo( oPeriodo , lPriVez))
    	lRet := .F.
    	Break
    EndIf
    
  	cRot	 		:= "PON"
	cPeriodo  		:= oPeriodo:cPeriodo
	cNumPagto 		:= oPeriodo:cNumPagto
	
	If lPeriodo
		dPerIni    		:= oPeriodo:dDataIni
		dPerFim    		:= oPeriodo:dDataFim
		cDatas			:= ( DTOC(dPerIni) + " - "  + DTOC(dPerFim))
	Else
		dPerIni           := aDatas[1]
		dPerFim			  := aDatas[2]
		dDataIni		  := dPerIni
		dDataFim		  := dPerFim
		dAntIni 		  := oPeriodo:dDataIni
		dAntFim			  := oPeriodo:dDataFim
		oPeriodo:dDataIni := dPerIni
		oPeriodo:dDataFim := dPerFim
	EndIf

	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³Bloqueia Chaves Logicas de Marcacoes do Funcionario           ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	If !(lApontamento:= Pona130Locks( nOpcX , cAliasApont, {} )) .or.;
	   !(lMarcacao   := Pona130Locks( nOpcX , IF( cAliasApont=='SPC', "SP8" , "SPG" ), {} ))  .or.;
	   !(lAbono		 := Pona130Locks( nOpcX , "SPK" , {} ))
    	lRet := .F.
    	Break
    Endif

	//-- Cria calendario do funcionario para utilizacao nas consistencias
	IF nOpcx == 3 .or. nOpcx == 4 .or. nOpcx = 5 //Inclusao, Alteracao ou Exclusao
		IF !CriaCalend(dPerIni,dPerFim,SRA->RA_TNOTRAB,SRA->RA_SEQTURN,@aTabPadrao,@aTabCalend,SRA->RA_FILIAL,SRA->RA_MAT,SRA->RA_CC)
			oCalendError:ShowErrors() 
       		lRet := .F.
       		Break
		EndIF
	EndIF	

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Monta o cabecalho e Detalhe                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	dbSelectArea( cAlias )
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Posiciona no Funcionario                                     ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	(cAliasApont)->( dbSeek( cFil + cMat , .F. ) )
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Monta Bloco com condicao para desprezar apontamentos fora  do³
	//³ periodo														 ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	bSkip		:= { || ( &(cPrefix+"DATA") < dPerIni ) .or. ( &(cPrefix+"DATA") > dPerFim ) }
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Monta Query para a Selecao das Informacoes                   ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	#IFDEF TOP
		aQueryCond := Array( 09 )
		aQueryCond[01] := cPrefix + "FILIAL='"+cFil+"'"
		aQueryCond[02] := " AND "
		aQueryCond[03] := cPrefix + "MAT='"+cMat+"'"
		aQueryCond[04] := " AND "
		aQueryCond[05] := cPrefix + "DATA>='"+Dtos( dPerIni ) +"'"
		aQueryCond[06] := " AND "
		aQueryCond[07] := cPrefix + "DATA<='"+Dtos( dPerFim ) +"'"
		aQueryCond[08] := " AND "
		aQueryCond[09] := "D_E_L_E_T_=' ' "
	#ENDIF
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Monta Cabecalho e detalhe                                    ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                                    
	aCols:=  GdMontaCols(	@aHeader	,; //01 -> Array com os Campos do Cabecalho da GetDados
							@nUsado		,; //02 -> Numero de Campos em Uso
							@aVirtual	,; //03 -> [@]Array com os Campos Virtuais
							@aVisual	,; //04 -> [@]Array com os Campos Visuais
							cAliasApont	,; //05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
							aGdNoFields	,; //06 -> Opcional, Campos que nao Deverao constar no aHeader
							@aRecnos	,; //07 -> [@]Array unidimensional contendo os Recnos
							cAliasApont	,; //08 -> Alias do Arquivo Pai
							(cFil+cMat)	,; //09 -> Chave para o Posicionamento no Alias Filho
							NIL			,; //10 -> Bloco para condicao de Loop While
							bSkip		,; //11 -> Bloco para Skip no Loop While
							NIL			,; //12 -> Se Havera o Elemento de Delecao no aCols  
							NIL			,; //13 -> Se cria variaveis Publicas
							NIL			,; //14 -> Se Sera considerado o Inicializador Padrao
							NIL			,; //15 -> Lado para o inicializador padrao	
							NIL			,; //16 -> Opcional, Carregar Todos os Campos
							NIL			,; //17 -> Opcional, Nao Carregar os Campos Virtuais  
							aQueryCond	,; //18 -> Opcional, Utilizacao de Query para Selecao de Dados
							.F.			,; //19 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
							.F.      	,; //20 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
							.T.			;  //21 -> Carregar Coluna Fantasma e/ou BitMap ( Logico ou Array )
						 )

	nPosDt		:= GdFieldPos(cPrefix+"DATA")
	nPosPd		:= GdFieldPos(cPrefix+"PD")
	nPosTp		:= GdFieldPos(cPrefix+"TPMARCA")
	nPosCC		:= GdFieldPos(cPrefix+"CC")
	nPosCodFunc	:= GdFieldPos(cPrefix+"CODFUNC")	
	nPosDepto	:= GdFieldPos(cPrefix+"DEPTO")	
	nPosPosto	:= GdFieldPos(cPrefix+"POSTO")	
	nPosProces  := GdFieldPos(cPrefix+"PROCES")	
	nPosRoteir	:= GdFieldPos(cPrefix+"ROTEIR")		
	nPosPeriodo	:= GdFieldPos(cPrefix+"PERIODO")			
	nPosNumPag	:= GdFieldPos(cPrefix+"NUMPAG")				
	nPosDesc    := GdFieldPos(cPrefix+"DESC")

    nLenRecnos	:= Len( aRecnos )

	For nCnt := 1 To nLenRecnos
		aAdd(aColsRec,{})
		aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosDt]) //Data
		aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosPd]) //Evento
		aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosTp]) //Tipo de Marcacao		
		aAdd(aColsRec[Len(aColsRec)], aRecnos[ nCnt ] )
		aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosCC]) 		//C.Custo 
		If nPosCodFunc > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosCodFunc]) 	//CodFunc 
		EndIf
		If nPosDepto > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosDepto]) 	//Depto 
		EndIf
		If nPosPosto > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosPosto]) 	//Posto 		
		EndIf
		If nPosProces > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosProces]) 	//Processo 
		EndIf
		If nPosRoteir > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosRoteir]) 	//Roteiro 		
		EndIf
		If nPosPeriodo > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosPeriodo]) 	//Periodo								
		EndIf	
		If nPosNumPag > 0
			aAdd(aColsRec[Len(aColsRec)], aCols[nCnt,nPosNumPag]) 	//NumPag 		
		EndIf
		If nPosDesc
			aCols[ nCnt , nPosDesc ] := DescPdPon( aCols[ nCnt , nPosPd ] )
		EndIf
	Next nCnt               

	IF Len( aRecnos ) > 0
		aSort(aCols,,,{ |x,y| DtoS(x[nPosDt])+x[nPosPd]+x[nPosTp] < DtoS(y[nPosDt])+y[nPosPd]+y[nPosTp] })	
		aSort(aColsRec,,,{ |x,y| DtoS(x[1])+x[2]+x[3] < DtoS(y[1])+y[2]+y[3] } )
	EndIF	

    If ( ( nCnt :=  nLenRecnos ) > 0 ) .and. nOpcx = 3    //--Quando Inclusao e existir Registro
			Help(" ",1,"a130CAPO")
	       lExit := .T.
       		lRet := .F.
       		Break
    Elseif cPaisLoc != "MEX" .and. nCnt = 0 .And. nOpcx # 3  //--Quando Nao for Inclusao e nao existir Registro
        Help(" ",1,"a130SAPO")
	    lExit := .T.
    	lRet := .F.
     	Break     
	Endif

	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Carrega, apenas, os Campos Editaveis            			   ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	For nCnt := 1 To nUsado
		IF (;
				( aScan( aVirtual 		, aHeader[ nCnt , 02 ] ) == 0 ) .and. ;
		   		( aScan( aVisual  		, aHeader[ nCnt , 02 ] ) == 0 ) .and. ;
		   		( aScan( aGdNaoAltera	, aHeader[ nCnt , 02 ] ) == 0 ) 	     ;
		  	)
			aAdd( aGdAltera , aHeader[ nCnt , 02 ] )
		EndIF			   
	Next nX

	aColsAnt	:= aClone(aCols)
	nOpca		:= 0

	// atualiza a getdados
	If !(oGet == nil)
		oGet:Refresh()
	EndIf	

	
	If !Empty(RCH->RCH_ROTEIR)
		cRoteiro := RCH->RCH_ROTEIR
	EndIf
	
End Sequence

RestArea( aArea )

Return ( lRet )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFuncao  Pn130VerGrava  ºAutor  ³Leandro Drumond     º Data ³  01/11/07   º±±
±±ÌÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.   ³ Caso exista alteracao nas marcacoes pergunta se deseja gravar. º±±
±±ÌÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso     ³ PONA130                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/

Static Function Pn130VerGrava(nOpcX, lApaga)

Local aArea := GetArea()

If !fCompArray(aCols,aColsAnt)
	If !MsgYesNo( OemToAnsi( STR0196 ) )   //"Abandona Alteracoes Realizadas?"
		Pn130Grava(cAliasApont,nOpcX)
	EndIf
EndIF

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Libera Registros Locados		                             ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
FreeLocks( IF( lPona190 , "SPH" , "SPC" ) , NIL , .T. )
FreeLocks( "SPK" , NIL , .T. )
FreeLocks( IF( lPona190 , "SPG" , "SP8" ) , NIL , .T. )

If lApaga
	cPeriodo  := ""
	cNumPagto := ""
	oPeriodo:cPeriodo := cPeriodo
	oPeriodo:cNumPagto := cNumPagto
EndIf

RestArea(aArea)

Return ( NIL )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PonChangePer	³Autor³Equipe Advanced RH ³ Data ³16/11/2007³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Controla a alteracao da chave de busca de Periodos 		    ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³< Vide Parametros Formais >									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³PONA040                                                     ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³NIL															³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >									³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/

Static Function PonChangePer()

Local lDaRefresh := .F.

DEFAULT cRot := "PON"

If ( ( cProcesso + cPeriodo + cNumPagto + cRot ) <> ( cAntProcesso + cAntPeriodo + cAntNumPagto + cAntRoteiro ) )
	
	If cPeriodo <> cAntPeriodo .and. cNumPagto == cAntNumPagto
		cAntNumPagto := cNumPagto
		cNumPagto    := ""
	EndIf
    
	oPeriodo:cPeriodo  := cPeriodo
	oPeriodo:cProcesso := cProcesso
	oPeriodo:cNumPagto := cNumPagto
	oPeriodo:cRoteiro  := cRot
   	lDaRefresh	 	   := .T.
Else 
	If !lPeriodo
		If ( ( dDataIni <> dPerIni ) .or. ( dDataFim <> dPerFim ) )
			oPeriodo:cPeriodo  := cPeriodo
			oPeriodo:cProcesso := cProcesso
			oPeriodo:cNumPagto := cNumPagto
			oPeriodo:cRoteiro := cRot
		   	lDaRefresh	 := .T.
		   	dPerIni := dDataIni
		   	dPerFim := dDataFim
		   	aDatas := { dPerIni , dPerFim }
		 EndIf
	EndIf
Endif

Return (lDaRefresh)  


/*/   
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³fGetPeriodo   ³ Autor ³ Equipe Advanced RH³ Data ³26/11/2007³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Obtem o periodo de apontamento							    ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Exemplo   ³oPeriodo:=RHPERIODO:New()       //Criacao do Obj            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³fGetPeriodo( oPeriodo )											    ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso       ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Static Function fGetPeriodo( oPeriodo, lPriVez)

Local aArea 		:= GetArea()
Local lRet 			:= .T.

DEFAULT lPriVez := .F.

Begin Sequence      
    /*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³Obtem Informacoes do Periodo Solicitado					  ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	//Se não for acumulado, irá sempre verificar períodos vazios
	If !lPona190
		oPeriodo:PerSel()
		/*/
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³Mostra Advertencia de Periodo Fechado p/ Manutencao de Perio ³
		³dos Abertos.												  ³
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/	
		//Se lpona190 for .f., somente podera ser visualizado periodos que estejam abertos (rch_dtfecha vazio) 		
		If oPeriodo:lFechado 
			MsgInfo( OemToAnsi( oPeriodo:cMsgClosedPer ) )    //"Período de Apontamento Fechado. Selecione ou informe um Período Aberto."
			lRet		:= .F.
			Break
		EndIf	 
	Else
		If lPriVez
			oPeriodo:PerUltFech()
		Else		
			oPeriodo:GetPer("!EMPTY(RCH_DTFECH)")
		EndIf

		/*/
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³Mostra Advertencia de Periodo Aberto para Manutencao de Perio³
		³dos Fechados.												  ³
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/	
	 	If oPeriodo:lAberto
			MsgInfo( OemToAnsi( oPeriodo:cMsgOpenedPer ) )    //"Período de Apontamento Aberto. Selecione ou informe um Período Fechado."
	 		lRet		:= .F.
	 		Break
	 	EndIf
	EndIf

    /*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³Mostra Advertencia para Periodo Nao Encontrado				  ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	If !oPeriodo:lFound
 		lRet		:= .F. 
		MsgInfo( OemToAnsi( oPeriodo:cMsgNotFoundPer ) )	//"Período de Apontamento Não Encontrado."
 		Break
	Endif	
	
End Sequence

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Recupera Valores do Periodo antes da Troca de Periodo 		  ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/	
If !lRet
	oPeriodo:RollBack()
Endif

RestArea( aArea )

Return( lRet )

// Funcoes genericas do inicializador padrao
/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCPostoInit  ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_POSTO					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCPostoInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cPosto													  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCPostoInit()

Local cPosto   := Space(GetSx3Cache( "PC_POSTO" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cPosto := aTabCalend[nPos , CALEND_POS_POSTO]
	EndIf
Else
	cPosto := aTabCalend[n , CALEND_POS_POSTO]
EndIf

Return( cPosto )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCDeptoInit  ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_DEPTO					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCDeptoInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cDepto													  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCDeptoInit()

Local cDepto   := Space(GetSx3Cache( "PC_DEPTO" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cDepto := aTabCalend[nPos , CALEND_POS_DEPTO]
	EndIf
Else
	cDepto := aTabCalend[n , CALEND_POS_DEPTO]
EndIf

Return( cDepto )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCProcesInit ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_PROCES					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCProcesInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cProcess												  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCProcesInit()

Local cProcesso := Space(GetSx3Cache( "PC_PROCES" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cProcesso := aTabCalend[nPos , CALEND_POS_PROCESSO]
	EndIf
Else
	cProcesso := aTabCalend[n , CALEND_POS_PROCESSO]
EndIf

Return( cProcesso )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCFuncInit	  ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_CODFUNC				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCFuncInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cFunc													  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCFuncInit()

Local cFunc := Space(GetSx3Cache( "PC_CODFUNC" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cFunc := aTabCalend[nPos , CALEND_POS_CODFUNC]
	EndIf
Else
	cFunc := aTabCalend[n , CALEND_POS_CODFUNC]
EndIf

Return( cFunc )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCRoteirInit ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_ROTEIR 				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCRoteirInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cRoteiro												  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCRoteirInit()

Local cRoteiro := Space(GetSx3Cache( "PC_ROTEIR" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cRoteiro := aTabCalend[nPos , CALEND_POS_ROTEIRO]
	EndIf
Else
	cRoteiro := aTabCalend[n , CALEND_POS_ROTEIRO]
EndIf

Return( cRoteiro )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCPeriodoInit³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_PERIODO				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCPeriodoInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cPer												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCPeriodoInit()

Local cPeriodo := Space(GetSx3Cache( "PC_PERIODO" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cPeriodo := aTabCalend[nPos , CALEND_POS_PERIODO]
	EndIf
Else
	cPeriodo := aTabCalend[n , CALEND_POS_PERIODO]
EndIf

Return( cPeriodo )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCNumPagInit ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PC_NUMPAG					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCNumPagInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cNumPag												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCNumPagInit()

Local cNumPag := Space(GetSx3Cache( "PC_NUMPAG" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PC_DATA",,,"PC_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cNumPag := aTabCalend[nPos , CALEND_POS_NUM_PAGTO]
	EndIf
Else
	cNumPag := aTabCalend[n , CALEND_POS_NUM_PAGTO]
EndIf

Return( cNumPag )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHPostoInit  ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_POSTO					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHPostoInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cPosto													  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHPostoInit()

Local cPosto   := Space(GetSx3Cache( "PH_POSTO" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cPosto := aTabCalend[nPos , CALEND_POS_POSTO]
	EndIf
Else
	cPosto := aTabCalend[n , CALEND_POS_POSTO]
EndIf

Return( cPosto )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHDeptoInit  ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_DEPTO					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHDeptoInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cDepto													  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHDeptoInit()

Local cDepto   := Space(GetSx3Cache( "PH_DEPTO" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cDepto := aTabCalend[nPos , CALEND_POS_DEPTO]
	EndIf
Else
	cDepto := aTabCalend[n , CALEND_POS_DEPTO]
EndIf

Return( cDepto )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHProcesInit ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_PROCES					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHProcesInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cProcess												  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHProcesInit()

Local cProcesso := Space(GetSx3Cache( "PH_PROCES" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cProcesso := aTabCalend[nPos , CALEND_POS_PROCESSO]
	EndIf
Else
	cProcesso := aTabCalend[n , CALEND_POS_PROCESSO]
EndIf

Return( cProcesso )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHFuncInit   ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_CODFUNC				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHFuncInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cFunc													  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHFuncInit()

Local cFunc    := Space(GetSx3Cache( "PH_CODFUNC" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cFunc := aTabCalend[nPos , CALEND_POS_CODFUNC]
	EndIf
Else
	cFunc := aTabCalend[n , CALEND_POS_CODFUNC]
EndIf

Return( cFunc )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHRoteirInit ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_ROTEIR					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHRoteirInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³cRoteiro												  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHRoteirInit()

Local cRoteiro := Space(GetSx3Cache( "PH_ROTEIR" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cRoteiro := aTabCalend[nPos , CALEND_POS_ROTEIRO]
	EndIf
Else
	cRoteiro := aTabCalend[n , CALEND_POS_ROTEIRO]
EndIf

Return( cRoteiro )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHPeriodoInit³Autor³Equipe Advanced RH ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_PERIODO				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHPeriodoInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cPer												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHPeriodoInit()

Local cPeriodo := Space(GetSx3Cache( "PH_PERIODO" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cPeriodo := aTabCalend[nPos , CALEND_POS_PERIODO]
	EndIf
Else
	cPeriodo := aTabCalend[n , CALEND_POS_PERIODO]
EndIf

Return( cPeriodo )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHNumPagInit ³Autor³Leandro Drumond    ³ Data ³19/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo PH_NUMPAG					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHNumPagInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cNumPag												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHNumPagInit()

Local cNumPag  := Space(GetSx3Cache( "PH_NUMPAG" , "X3_TAMANHO" ))
Local dDataCal := CtoD("")
Local nPos     := 0

If Empty(n)
	dDataCal := CalendRetCpo( "PH_DATA",,,"PH_" )
	If ( nPos := aScan(aTabCalend, {|x| x[CALEND_POS_DATA] == dDataCal .and. x[CALEND_POS_TIPO_MARC] == "1E" } ) ) > 0
		cNumPag := aTabCalend[nPos , CALEND_POS_NUM_PAGTO]
	EndIf
Else
	cNumPag := aTabCalend[n , CALEND_POS_NUM_PAGTO]
EndIf

Return( cNumPag )


//Funcoes de validacao
/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCProcesVld  ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PC_PROCES							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCProcesVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCProcesVld()

Local lRet := EXISTCPO("RCJ")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCRoteirVld  ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PC_ROTEIR							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCRoteirVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCRoteirVld()

Local lRet := EXISTCPO("SRY")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCPeriodoVld ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PC_PERIODO 							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCPeriodoVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCPeriodoVld()

Local lRet := EXISTCPO("RCH")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCDeptoVld   ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PC_DEPTO								  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCDeptoVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCDeptoVld()

Local lRet := EXISTCPO("SQB")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCPostoVld   ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PC_POSTO								  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCPostoVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCPostoVld()

Local lRet := .T.

If Select("RCL") < 1
	dbSelectArea("RCL")
EndIf

RCL->( dbSetOrder(02) )
lRet := EXISTCPO("RCL")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PCFuncVld    ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PC_CODFUNC							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PCFuncVld()			   									  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PCFuncVld()

Local lRet := EXISTCPO("SRJ")

Return( lRet )



/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHProcesVld  ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PH_PROCES							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHProcesVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHProcesVld()

Local lRet := EXISTCPO("RCJ")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHRoteirVld  ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PH_ROTEIR							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHRoteirVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHRoteirVld()

Local lRet := EXISTCPO("SRY")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHPeriodoVld ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PH_PERIODO 							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHPeriodoVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHPeriodoVld()

Local lRet := EXISTCPO("RCH")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHDeptoVld   ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PH_DEPTO								  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHDeptoVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHDeptoVld()

Local lRet := EXISTCPO("SQB")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHPostoVld   ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PH_POSTO								  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHPostoVld()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHPostoVld()

Local lRet := EXISTCPO("RCL")

Return( lRet )


/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ PHFuncVld    ³Autor³Leandro Drumond    ³ Data ³20/02/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Validacao do campo PH_CODFUNC							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³PHFuncVld()			 									  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Logico												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function PHFuncVld()

Local lRet := EXISTCPO("SRJ")

Return( lRet )
/*/   
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    |Pn130MntGd    ³ Autor ³ Leandro Drumond   ³ Data ³17/12/2007³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³monta a get e caso exista problema, monta novamente com 	|
|		   |com dados anteriores										|
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³Pn130MntGd( nOpcX , aGdAltera , lMarcacao , lApontamento ,  |
|          |lAbono , oGet )												³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso       ³PONA130                                                     ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Static Function Pn130MntGd( nOpcX , aGdAltera , lMarcacao , lApontamento , lAbono , oGet , lPriVez )
                                                                                                                               
If !pn130MontaGetDados( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet , lPriVez)
	SRA->(DbGoto(nRegAnt)) 
	cPeriodo  := ""
	cNumPagto := ""
	pn130MontaGetDados( nOpcX , @aGdAltera , @lMarcacao , @lApontamento , @lAbono , @oGet , .T.)
Else
	cAntProcesso	:= cProcesso
	cAntPeriodo		:= cPeriodo
	cAntNumPagto	:= cNumPagto
	cAntRoteiro     := cRot
	aColsRFK		:= {}
EndIf

Return(NIL)

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³fInforma    ³ Autor ³ Leandro Drumond       ³ Data ³ 08/08/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Valida dialog para informacao de eventos                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PONA130                                                      ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/

Function fInforma(nOpcx,dData,nHoras,cEvento,aHeader,aCols,n,cCusto,cPrefix,cAliasApont,cDeptoSPC,cPostoSPC,cCodFuncSPC,cProces,cRoteiro,cPeriodo,cNrPag)
Local cHelp			:= ''
Local lRet			:= .T.	

//-- Caso n„o seja Deletado
If !aCols[n,nUsado+1]
   fTelaInf(nOpcx,dData,nHoras,cEvento,aHeader,aCols,n,cCusto,cPrefix,cAliasApont,cDeptoSPC,cPostoSPC,cCodFuncSPC,cProces,cRoteiro,cPeriodo,cNrPag)
Else                         
   	//-- Nao permite acesso se o evento esta deletado
	cHelp := STR0203	 //'N„o é possível dividir apontamento com Codigo de Evento Informado.'		 
	Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 )
	lRet:=.F.
EndIf

Return lRet

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³fTelaInf    ³ Autor ³ Leandro Drumond       ³ Data ³ 08/08/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Cria dialog para informacao de eventos                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PONA130                                                      ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/

Function fTelaInf(nOpcx,dData,nHoras,cEvento,aHeader,aCols,n,cCusto,cPrefix,cAliasApont,cDeptoSPC,cPostoSPC,cCodFuncSPC,cProces,cRoteiro,cPeriodo,cNrPag)
//-- Variaveis para tratamento de tela 
Local aArea			:= GetArea()
Local aAdvSize		:= MsAdvSize(.T.,.T. )
Local aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3], aAdvSize[4] , 0 , 0 }
Local aObjCoords    := {}
Local aObjSize     	:= {}
Local aAltera      	:= {}
Local aSvCols		:= {}
Local aNotFields	:= {}
Local bSeekWhile	:= {|| .T.}
Local cSeekKey		:= ''
Local nPosPDI   	:= 0
Local nPosDesc		:= 0
Local nPosHrIni		:= 0
Local nPosHrFim		:= 0
Local nPosHrsInf	:= 0
Local nY			:= 0
Local nX			:= 0
Local nPos			:= 0
Local nTam			:= 0
Local nOpc			:= 0

Private aHeaderSPC	:= aClone(aHeader)
Private aColsSPC	:= aClone(aCols)
Private oGet1
Private oDlg1
Private nPosCols	:= n
Private nTotQtC   	:= nHoras

aAdd( aObjCoords , { 100 , 100 , .T. , .T. } )
aObjSize		:= MsObjSize( aInfoAdvSize , aObjCoords, .T., .T. )

aAltera := {"RFK_PDI", "RFK_HRINI" , "RFK_HRFIM" , "RFK_CC" , "RFK_POSTO" , "RFK_DEPTO" , "RFK_CODFUN"} 

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Campos que nao serao Mostrados							   ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd( aNotFields , "RFK_FILIAL"	)
aAdd( aNotFields , "RFK_MAT"	)
aAdd( aNotFields , "RFK_PROCES"	)
aAdd( aNotFields , "RFK_PERIOD"	)
aAdd( aNotFields , "RFK_ROTEIR"	)
aAdd( aNotFields , "RFK_NUMPAG"	)

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Utiliza funcao fillgetdados apenas para montar aheader com   |
| campos do walk true, acols sera montado manualmente.		   ³
| Condicao cseekkey nunca sera verdadeira para atender este    |
| este proposito											   |
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/

cSeekKey 	:= xFilial('RFK')+SRA->RA_MAT+DtoS(dData)+cEvento+cProces+cPeriodo+cRoteiro+cNrPag
bSeekWhile 	:= {|| RFK_FILIAL+RFK_MAT+DtoS(RFK_DATA)+RFK_PD+RFK_PROCES+RFK_PERIOD+RFK_ROTEIR+RFK_NUMPAG }

aHeader := {}
aCols   := {}
 
FillGetDados(nOpcx					 ,; //1-nOpcx - número correspondente à operação a ser executada, exemplo: 3 - inclusão, 4 alteração e etc;
			 "RFK"				 	 ,; //2-cAlias - area a ser utilizada;
			 1	    				 ,; //3-nOrder - ordem correspondente a chave de indice para preencher o  acols;
			 cSeekKey                ,; //4-cSeekKey - chave utilizada no posicionamento da area para preencher o acols;
			 bSeekWhile	    		 ,; //5-bSeekWhile - bloco contendo a expressão a ser comparada com cSeekKey na condição  do While.
			 NIL    		 		 ,; //6-uSeekFor - pode ser utilizados de duas maneiras:1- bloco-de-código, condição a ser utilizado para executar o Loop no While;2º - array bi-dimensional contendo N.. condições, em que o 1º elemento é o bloco condicional, o 2º é bloco a ser executado se verdadeiro e o 3º é bloco a ser executado se falso, exemplo {{bCondicao1, bTrue1, bFalse1}, {bCondicao2, bTrue2, bFalse2}.. bCondicaoN, bTrueN, bFalseN};
			 aNotFields		   	     ,; //7-aNoFields - array contendo os campos que não estarão no aHeader;
			 NIL					 ,; //8-aYesFields - array contendo somente os campos que estarão no aHeader;
			 NIL					 ,; //9-lOnlyYes - se verdadeiro, exibe apenas os campos de usuário;
			 NIL					 ,; //10-cQuery - query a ser executada para preencher o acols(Obs. Nao pode haver MEMO);
			 NIL			      	 ,; //11-bMontCols - bloco contendo função especifica para preencher o aCols; Exmplo:{|| MontaAcols(cAlias)}
			 .F.				  	 ,; //12-lEmpty
			 @aHeader	      	     ,; //13-aHeaderAux
			 @aCols			      	 ,; //14-aColsAux
			 NIL			     	 ;  //15-bAfterCols
			)

If !Empty(aColsRFK)
	If ( nY := aScan(aColsRFK, {|x| x[1] == cSeekKey } ) ) > 0
		aCols := {}
		For nY := nY to Len(aColsRFK)
			If aColsRFK[nY,1] <> cSeekKey
				Exit
			EndIf
			//Carrega Itens do aColsRFK no aCols
			LoadRFKCols(aColsRFK[nY],@aCols)
		Next nY
	EndIf	
EndIf
			
aSvCols 	:= aClone( aCols )

If Empty(aHeaderRFK)
	aHeaderRFK 	:= aClone( aHeader)
EndIf

//-- Cria Dialogo de Apontamentos 
DEFINE MSDIALOG oDlg1 TITLE OemToAnsi( STR0206 ) From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF oMainWnd PIXEL //"Manutenção de Apontamentos Informados"
oDlg1:lShowHint := .T.
oDlg1:lCentered := .F.

oGet1 := MsNewGetDados():New( aObjSize[1,1]+12,aObjSize[1,2],aObjSize[1,3],aObjSize[1,4],IF(nOpcX==2.Or.nOpcX==5,0,GD_INSERT+GD_UPDATE+GD_DELETE	),"pnInfLinOk()","pnInfTudOk","",aAltera,0,,,,,@oDlg1,aClone(aHeader),aClone(aCols))

//-- Blocos de Codigos para Confirmar e Abandonar o Dialogo	  
//-- Se Nao Houver Incosnistencias, Descarrega informacoes de apontamentos informados
oDlg1:bSet15 := { || IF( oGet1:TudoOk() , ( nOpc := 1 , oDlg1:End() ) , nOpc := 0 ) }
bSvSet15 := SetKey( 15 , oDlg1:bSet15 )
oDlg1:bSet24 := { || nOpc := 0 , oDlg1:End() }
bSvSet24 := SetKey( 24 , oDlg1:bSet24 )

ACTIVATE MSDIALOG oDlg1 ON INIT EnchoiceBar( oDlg1 ,{ || IF( oGet1:TudoOk() , ( nOpc := 1 , oDlg1:End() ) , nOpc := 0 ) } , { || nOpc := 0 , oDlg1:End() } ) CENTERED

If nOpc == 1 .and. !fCompArray( oGet1:aCols , aSvCols )
	nPosPDI   	:= GDFieldPos('RFK_PDI')
	nPosDesc	:= GDFieldPos('RFK_DESC')
	nPosHrIni	:= GDFieldPos('RFK_HRINI')
	nPosHrFim	:= GDFieldPos('RFK_HRFIM')
	nPosHrsInf	:= GDFieldPos('RFK_HRSINF')

	nTam := Len(aColsRFK)
	nY   := 1
	
	While nY <= nTam
		//Limpa o array
		If aColsRFK[nY,1] == cSeekKey
			aDel(aColsRFK,nY)
			nTam--
			aSize(aColsRFK,nTam)
		Else
			nY++
		EndIf
	EndDo
	
	For nY := 1 to Len(oGet1:aCols)
		aAdd(aColsRFK,{ cSeekKey , Array(Len(oGet1:aCols[nY])) } )
		nPos := Len(aColsRFK)

	 	For nX := 1 to Len(oGet1:aCols[nY])
	 		aColsRFK[nPos,2,nX] := oGet1:aCols[nY,nX]
	 	Next nX

	Next nY

EndIf

aCols 	:= aClone(aColsSPC)
aHeader := aClone(aHeaderSPC)

RestArea(aArea)

Return Nil
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³pnInfLinOk³ Autor ³ Leandro Drumond       ³ Data ³ 08/08/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function pnInfLinOk(o)
Local cHelp		 := ""
Local lRet  	 := .T.
Local nLenCols   := Len(aCols)
Local nX		 := 0
Local nPosHrIni  := GdFieldPos("RFK_HRINI")
Local nPosHrFim	 := GdFieldPos("RFK_HRFIM")
Local nPosPDI	 := GdFieldPos("RFK_PDI")

If nLenCols > 1
	For nX := 1 to nLenCols
		//-- Caso n„o seja Deletado
		If !aCols[nX,Len(aCols[nX])] .and. nX <> n
			If ( ( aCols[n,nPosHrIni] > aCols[nX,nPosHrIni] .and.  aCols[n,nPosHrIni] < aCols[nX,nPosHrFim] ) .or. ;
				 ( aCols[n,nPosHrIni] < aCols[nX,nPosHrIni] .and.  aCols[n,nPosHrFim] > aCols[nX,nPosHrIni] ) .or.;
				 ( aCols[n,nPosHrIni] = aCols[nX,nPosHrIni] .and.  aCols[n,nPosHrFim] <= aCols[nX,nPosHrFim] ) .or.;
				 ( aCols[n,nPosHrFim] = aCols[nX,nPosHrFim] .and.  aCols[n,nPosHrIni] >= aCols[nX,nPosHrIni] ) )
				cHelp := STR0208	 //"Não é permitido a inclusão de dois eventos no mesmo horário"
				Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 )
				Return .F.
			EndIf
		EndIf
	Next nX
EndIf

If !aCols[nLenCols,Len(aCols[nLenCols])]
	If aCols[nLenCols,nPosHrIni] >= aCols[nLenCols,nPosHrFim]
		cHelp := STR0209	 //"Horário inicial não pode ser maior que o horário final."
		Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 )
		Return .F.
	EndIf
	
	If Empty(aCols[nLenCols,nPosPDI])
		cHelp := STR0210	 //"Evento informado deve ser preenchido."
		Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 )
		Return .F.
	EndIf
EndIf

Return lRet

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³pnInfTudOk³ Autor ³ Leandro Drumond       ³ Data ³ 08/08/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function pnInfTudOk(o)
Local cHelp		:= ''
Local lRet  	:= .T.
Local lOk		:= .F.
Local nLenCols  := Len(aCols)
Local nX		:= 0
Local nTotHors	:= 0
Local nPosHrs   := GdFieldPos("RFK_HRSINF")
  

For nX := 1 to nLenCols
	//-- Caso n„o seja Deletado
	If !aCols[nX,Len(aCols[nX])]
		nTotHors := SomaHoras(nTotHors , aCols[nX,nPosHrs])
		lOk := .T. //Indica que existe dado não deletado no aCols para fazer a validacao abaixo. Se não existir nenhuma linha nao fara validacao.
	EndIf
Next nX

If lOk .and. nTotHors <> nTotQtc
	cHelp := STR0207	 //"Quantidade de horas informadas é diferente da quantidade de horas calculadas"
	Help( ' ' , 1 , 'PN230INCON' , , OemToAnsi( cHelp ) , 5 , 0 )
	lRet := .F.
EndIf

Return lRet

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fGrvRFK   ³ Autor ³ Leandro Drumond       ³ Data ³ 08/08/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Static Function fGrvRFK()
Local aArea 	:= GetArea()
Local nLenRFK  	:= Len(aColsRFK)
Local nPos  	:= 0
Local nPosRec	:= Len(aColsRFK[1,2]) - 1
Local nPosDel	:= Len(aColsRFK[1,2])
Local nPosData	:= GdFieldPos('RFK_DATA',aHeaderRFK)
Local nPosPD	:= GdFieldPos('RFK_PD',aHeaderRFK)
Local nPosPosto := GdFieldPos('RFK_POSTO',aHeaderRFK)
Local nPosDepto := GdFieldPos('RFK_DEPTO',aHeaderRFK)
Local nPosCC	:= GdFieldPos('RFK_CC',aHeaderRFK)
Local nPosCodFun:= GdFieldPos('RFK_CODFUN',aHeaderRFK)
Local nPosPDI	:= GdFieldPos('RFK_PDI',aHeaderRFK)
Local nPosHrIni	:= GdFieldPos('RFK_HRINI',aHeaderRFK)
Local nPosHrFim := GdFieldPos('RFK_HRFIM',aHeaderRFK)
Local nPosHrsInf:= GdFieldPos('RFK_HRSINF',aHeaderRFK)

dbSelectArea("RFK")

For nPos := 1 to nLenRFK

	If !Empty(aColsRFK[nPos,2,nPosRec])
		dbGoTo(aColsRFK[nPos,2,nPosRec])
		RecLock('RFK',.F.)
		If aColsRFK[nPos,2,nPosDel]
			dbDelete()
			MsUnLock()
			Loop
		EndIf
	ElseIf aColsRFK[nPos,2,nPosDel]
		Loop
	Else
		RecLock("RFK",.T.)
	EndIf
		
	RFK->RFK_FILIAL := xFilial('RFK')
	RFK->RFK_MAT	:= SRA->RA_MAT
	RFK->RFK_DATA	:= aColsRFK[nPos,2,nPosData]
	RFK->RFK_PD		:= aColsRFK[nPos,2,nPosPD]
	RFK->RFK_PROCES	:= cProcesso
	RFK->RFK_PERIOD	:= cPeriodo
	RFK->RFK_ROTEIR	:= cRot
	RFK->RFK_NUMPAG	:= cNumPagto
	RFK->RFK_POSTO	:= aColsRFK[nPos,2,nPosPosto]
	RFK->RFK_DEPTO	:= aColsRFK[nPos,2,nPosDepto]
	RFK->RFK_CC		:= aColsRFK[nPos,2,nPosCC]
	RFK->RFK_CODFUN	:= aColsRFK[nPos,2,nPosCodFun]
	RFK->RFK_PDI	:= aColsRFK[nPos,2,nPosPDI]
	RFK->RFK_HRINI	:= aColsRFK[nPos,2,nPosHrIni]
	RFK->RFK_HRFIM	:= aColsRFK[nPos,2,nPosHrFim]
	RFK->RFK_HRSINF	:= aColsRFK[nPos,2,nPosHrsInf]	

	RFK->( MsUnLock() )
	
Next nPos

aColsRFK := {}
		
RestArea(aArea)

Return Nil

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fDelRFK   ³ Autor ³ Leandro Drumond       ³ Data ³ 11/08/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function fDelRFK(cAlias,cPrefixo)
Local aArea 	:= GetArea()
Local cSeekKey 	:= xFilial('RFK') +	(cAlias)->( &(cPrefixo+"MAT") )+DtoS((cAlias)->( &(cPrefixo+"DATA") ))+(cAlias)->( &(cPrefixo+"PD") )+(cAlias)->( &(cPrefixo+"PROCES") )+(cAlias)->( &(cPrefixo+"PERIODO") )+(cAlias)->( &(cPrefixo+"ROTEIR") )+(cAlias)->( &(cPrefixo+"NUMPAG") )

If RFK->(dbSeek(cSeekKey))

	While RFK->(!Eof() .and. RFK_FILIAL+RFK_MAT+DtoS(RFK_DATA)+RFK_PD+RFK_PROCES+RFK_PERIOD+RFK_ROTEIR+RFK_NUMPAG == cSeekKey )
	
		RecLock('RFK',.F.)
		RFK->(dbDelete())
		RFK->(MsUnLock())	
		RFK->(dbSkip())
	
	EndDo
EndIf

RestArea(aArea)

Return Nil

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKDataInit  ³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_DATA					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKDataInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |dDataSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKDataInit()

Local nPosData := GDFieldPos(cPrefix+'DATA',aHeaderSPC)
Local dDataSPC := aColsSPC[nPosCols,nPosData]

Return( dDataSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKDescPDInit³Autor³Leandro Drumond    ³ Data ³10/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_DESC					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKDescPDInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cDesc												  	  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKDescPDInit()

Local nPosPDI 	:= GDFieldPos('RFK_PDI')
Local nPos		:= Len(aCols)
Local cDesc		:= ''

If !Empty(aCols[nPos,nPosPDI])
	cDesc := DescPDPon( aCols[nPos,nPosPDI] )
EndIf

Return( cDesc )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKPDInit    ³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_PD  					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKPDInit() 											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cPDSPC												  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKPDInit()

Local nPosPD      := GDFieldPos(cPrefix+'PD',aHeaderSPC)
Local cPDSPC 	  := aColsSPC[nPosCols,nPosPD]

Return( cPDSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKDeptoInit ³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_DEPTO					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKDeptoInit() 											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cDeptoSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKDeptoInit()

Local nPosDepto	  := GDFieldPos(cPrefix+'DEPTO',aHeaderSPC)
Local cDeptoSPC	  := aColsSPC[nPosCols,nPosDepto]

Return( cDeptoSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKPostoInit ³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_POSTO					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKPostoInit() 											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cPostoSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKPostoInit()

Local nPosPosto	  := GDFieldPos(cPrefix+'POSTO',aHeaderSPC)
Local cPostoSPC	  := aColsSPC[nPosCols,nPosPosto]

Return( cPostoSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKCCInit    ³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_CC					  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKCCInit() 											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cCCSPC		   										  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKCCInit()

Local nPosCC      := GDFieldPos(cPrefix+'CC',aHeaderSPC)
Local cCCSPC	  := aColsSPC[nPosCols,nPosCC]

Return( cCCSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKProcesInit³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_PROCES				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKProcesInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cProcesSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKProcesInit()

Local nPosProces  := GDFieldPos(cPrefix+'PROCES',aHeaderSPC)
Local cProcesSPC  := aColsSPC[nPosCols,nPosProces]

Return( cProcesSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKPeriodInit³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_PERIOD				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKPeriodInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cPeriodSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKPeriodInit()

Local nPosPer	  := GDFieldPos(cPrefix+'PERIODO',aHeaderSPC)
Local cPeriodSPC  := aColsSPC[nPosCols,nPosPer]

Return( cPeriodSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKROTEIRInit³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_ROTEIR				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKRoteirInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cRoteirSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKRoteirInit()

Local nPosRot	  := GDFieldPos(cPrefix+'ROTEIR',aHeaderSPC)
Local cRoteirSPC  := aColsSPC[nPosCols,nPosRot]

Return( cRoteirSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKNumPagInit³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_NUMPAG				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKNumPagInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cNumPagSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKNumPagInit()

Local nPosNrPag	  := GDFieldPos(cPrefix+'NUMPAG',aHeaderSPC)
Local cNumPagSPC  := aColsSPC[nPosCols,nPosNrPag]

Return( cNumPagSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKCodFunInit³Autor³Leandro Drumond    ³ Data ³09/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Inicializador padrao do campo RFK_CODFUN				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKCodFunInit()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |cCodFunSPC											  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKCodFunInit()

Local nPosFun	  := GDFieldPos(cPrefix+'CODFUNC',aHeaderSPC)
Local cCodFunSPC  := aColsSPC[nPosCols,nPosFun]

Return( cCodFunSPC )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKPDIWhen	  ³Autor³Leandro Drumond    ³ Data ³10/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³When do campo RFK_PDI									  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKPDIWhen()											  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |.T.													  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKPDIWhen()

Local nPosDesc	  := GDFieldPos('RFK_DESC')

aCols[n,nPosDesc]  := DescPDPon( GetMemVar( "RFK_PDI" ) )

Return( .T. )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ RFKHrWhen	  ³Autor³Leandro Drumond    ³ Data ³10/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³When dos campos RFK_HRINI e RFK_HRFIM	  				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³RFKHrWhen()					 							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |.T.													  	  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >								  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Function RFKHrWhen()

Local nPosHrIni	  := GDFieldPos("RFK_HRINI")
Local nPosHrFim	  := GDFieldPos("RFK_HRFIM")
Local nPosHrInf	  := GDFieldPos("RFK_HRSINF")
Local nHorVar	  := GetMemVar(ReadVar())

If ReadVar() == 'M->RFK_HRINI'
	If aCols[n,nPosHrFim] > nHorVar
		aCols[n,nPosHrInf] := SubHoras(aCols[n,nPosHrFim] , nHorVar)
	ElseIf aCols[n,nPosHrFim] == 0 .and. nHorVar > 0
		aCols[n,nPosHrInf] := SubHoras(24 , nHorVar)
	EndIf
Else
	If nHorVar > aCols[n,nPosHrIni]
		aCols[n,nPosHrInf] := SubHoras(nHorVar , aCols[n,nPosHrIni])
	ElseIf nHorVar == 0 .and. aCols[n,nPosHrIni] > 0
		aCols[n,nPosHrInf] := SubHoras(24 , aCols[n,nPosHrIni])
	EndIf
EndIf

Return( .T. )
/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ LoadRFKCols  ³Autor³Leandro Drumond    ³ Data ³10/08/2011³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Carrega campos do aColsRFK para aCols	  				  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³LoadRFKCols()				 							  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                  ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  |Nil													  	  ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Static Function LoadRFKCols(aColsAux,aCols)
Local nPos := 0
Local nTam := Len(aColsAux[2])
Local nX   := 0

aAdd(aCols,Array(Len(aHeader)+1))

nPos := Len(aCols)

For nX := 1 to nTam
	aCols[nPos,nX] := aColsAux[2,nX]
Next nX

Return Nil
/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡„o    ³ MenuDef		³Autor³  Luiz Almeida     ³ Data ³22/11/2006³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡„o ³Isola opcoes de menu para que as opcoes da rotina possam    ³
³          ³ser lidas pelas blibliotecas Framework da Versao 9.12 .     ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³< Vide Parametros Formais >									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³PONA130                                                     ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Retorno  ³aRotina														³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³< Vide Parametros Formais >									³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/

Static Function MenuDef()

	Local aRotina		:= {}	
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Define array contendo as Rotinas a executar do programa      ³
	³ ----------- Elementos contidos por dimensao ------------     ³
	³ 1. Nome a aparecer no cabecalho                              ³
	³ 2. Nome da Rotina associada                                  ³
	³ 3. Usado pela rotina                                         ³
	³ 4. Tipo de Transa‡„o a ser efetuada                          ³
	³    1 - Pesquisa e Posiciona em um Banco de Dados             ³
	³    2 - Simplesmente Mostra os Campos                         ³
	³    3 - Inclui registros no Bancos de Dados                   ³
	³    4 - Altera o registro corrente                            ³
	³    5 - Remove o registro corrente do Banco de Dados          ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	aRotina	:= {	{ STR0004 , "PesqBrw"		, 0 , 1, ,.F. },;		// "Pesquisar"
	                { STR0005 , "pn130Atu"		, 0 , 2 },;				// "Visualizar"
	                { STR0007 , "pn130Atu"		, 0 , 3,,,.T. },;		// "Incluir"
					{ STR0009 , "pn130Atu" 		, 0 , 4 },;				// "Alterar"
					{ STR0010 , "pn130Atu" 		, 0 , 5 },;				// "Excluir"
					{ STR0002 , "gpLegend" 		, 0 , 6 , , .F.};		// "Legenda"
				}
	
Return aRotina
