#INCLUDE "PROTHEUS.CH"   
#INCLUDE "HEADERGD.CH"  
#INCLUDE "RHLIBGEN.CH"
#include "FILEIO.CH"
#INCLUDE "AP5MAIL.CH"

Static __aASMFunc		:= {}	//Array que contera as Funcoes em Assembler nao Localizadas pela FindFunction()
Static __aReservedWords	:= {}	//Array que contera as Palavras Reservadas do Sistema

/*/
зддддддддддбддддддддддддддбддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁInRhLibGenExecЁAutor ЁMarinaldo de Jesus   Ё Data Ё14/05/2003Ё
цддддддддддеддддддддддддддаддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁExecutar Funcoes Dentro de RHLIBGEN                          Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁInRhLibGenExec( cExecIn , aFormParam )						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁuRet                                                 	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico 													 Ё
цддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё 		ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL.			   	 Ё
цддддддддддддбддддддддбддддддбддддддддддддддддддддддддддддддддддддддддддд╢
ЁProgramador Ё Data	  Ё BOPS Ё  Motivo da Alteracao			  		  	 Ё
цддддддддддддеддддддддеддддддеддддддддддддддддддддддддддддддддддддддддддд╢
ЁMauricio T. Ё        Ё------ЁTratamento para o Tipo R - Reservado.	     Ё
ЁMarcos Kato Ё        Ё------Ё Alterado o tratamento da linha que contem Ё
Ё            Ё        Ё------Ёa funcao fT_fUse. Verificar se o valor re- Ё
Ё            Ё        Ё------Ёtorna numerico, antes nao verificava.      Ё
ЁEmerson CampЁ04/09/14ЁTQLRU0ЁFuncao que avalia se um determinado arquivoЁ
Ё            Ё        Ё------Ё И um arquivo Executavel                   Ё
ЁRenan Borges|29/06/15|TSNBAF|Ajuste para autenticar o usuАrio utilizado Ё
Ё            |        |      |no parametro MV_RELAUSR quando ele estiver Ё
Ё            |        |      |preenchido e o MV_RELAUTH for .T..         Ё
ЁFlavio Corr |08/07/15|      |Ajuste rotina GPEMAIL para mostrar erro    Ё
ЁLuis Artuso |28/08/15|TSTZE8|Implementados os metodos TMailManager      Ё
Ё            |        |      |e TMailMessage para gerenciamento de auten-Ё
Ё            |        |      |ticacao e envio de e-mail.                 Ё
ЁMarcos Perei|03/09/15|PCREQ-|Produtizacao projeto GestЦo PЗblica na 12. Ё
Ё            |        |5342  |                                           Ё
ЁJoao Balbino|15/09/15|TTGBRO|Ajuste em RH_Email() p/ limpar os          Ё
Ё            |        |      |espaГos no email                           Ё
ЁRenan BorgesЁ03/12/15ЁTTTLGIЁAjuste para enviar recibo de pagamento no  Ё
Ё			 Ё        Ё      Ёformato pdf por e-mail.                    Ё
ЁRaquel HagerЁ10/02/16ЁTUJQLJЁAjuste na funcao GPEParSQL para expressoes Ё
Ё			 Ё        Ё       ЁNao contem/Nao esta contido.              Ё
юддддддддддддаддддддддаддддддаддддддддддддддддддддддддддддддддддддддддддды/*/

/*
Usar essa documentaГЦo quando inclui o fonte em alguma pasta de inovaГЦo, por exemplo
12.1.6, a cada merge com o fonte da sustentaГЦo atualizar as informaГУes abaixo para 
que no merge final fique facil a atualizaГЦo do fonte
╠╠иммммммммммяммммммммммямммммммяммммЁ╠╠
╠╠ЁData Fonte SustentaГЦoЁ ChangeSet Ё╠╠
╠╠ЁддддддддддддаддддддддаддддддддддддЁ╠╠  
╠╠Ё    29/06/2015        Ё  312116   Ё╠╠ 
╠╠Ё    24/09/2015        Ё  331593   Ё╠╠ 
╠╠иммммммммммяммммммммммямммммммяммммм╠╠
*/
Function InRhLibGenExec( cExecIn , aFormParam )
         
Local uRet

DEFAULT cExecIn		:= ""
DEFAULT aFormParam	:= {}

IF !Empty( cExecIn )
	cExecIn	:= BldcExecInFun( cExecIn , aFormParam )
	uRet	:= __ExecMacro( cExecIn )
EndIF

Return( uRet )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁGetfxy       ЁAutorЁ Marinaldo de Jesus   Ё Data Ё31/10/2001Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna a Posicao do Eixo y de Acordo com o Eixo x			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁGetfxy( n , p )												Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁRetorna a Posicao do Eixo y de Acordo com o Eixo x			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ n = Numero de Progressoes do Eixo y						Ё
Ё          Ё p = Posicao Relativa do Eixo x								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Getfxy( n , p )
Return( ( ( n * ( p - 1 ) ) + 1 ) )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁGetValType		ЁAutorЁMarinaldo de Jesus Ё Data Ё27/02/2002Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna Valor Default de Acordo com o Tipo Passado		   	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁGetValType( cType , nSize )									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁcType -> Tipo de Retorno  									Ё
Ё          ЁnSize -> Tamanho do Campo 									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function GetValType( cType , nSize )

Local uRet
Local uType

DEFAULT cType := "U"
DEFAULT nSize := 0

IF ( uType := ValType( cType ) ) != "C"
	nSize	:= IF( uType == "C" , Len( cType ) , nSize )
	uRet	:= GetValType( uType , nSize  )
EndIF

cType := Upper( AllTrim( cType ) )

Do Case
	Case cType == "N"  ; uRet := 0
	Case cType $ "CM"  ; uRet := Space( nSize )
	Case cType == "D"  ; uRet := Ctod("//")
	Case cType == "L"  ; uRet := .F.
	Case cType == "B"  ; uRet := { || NIL }
	Case cType == "A"  ; uRet := {}
	Case cType $ "U/O" ; uRet := NIL
	Case cType == "R"  ; uRet := 0
End Case

Return( uRet )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁRetBytes  		ЁAutorЁMarinaldo de Jesus Ё Data Ё19/04/2002Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna Numero de Bytes de um arquivo             		   	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRetBytes( cFile , nHandle , nLine , [ < lRelativePos > ] )	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁnBytes														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RetBytes( cFile , nHandle , nLine , lRelativePos )

Local aInfoFile	:= {}
Local cLine		:= ""
Local cEnd		:= ""
Local nBytes	:= 0
Local nSize		:= 0
Local nPosFimLinha := 0

DEFAULT lRelativePos := .F.

//-- Extrai uma linha "FISICA" de texto (pode conter varias linhas logicas)
cLine	:= fReadStr( nHandle , 256 )

//-- Verifica a Existencia de CHR(13)+CHR(10) //Carriage Return e Line Feed na linha extraida do texto
//-- Se ambos existirem, estamos trabalhando em ambiente Windows
//-- Caso contrario, estamos em ambiente Linux e somente teremos o CHR(10) para indicar o final da linha 
If (nPosFimLinha	:=At( CRLF , cLine ) ) == 0
	nPosFimLinha	:=At( Chr(10) , cLine ) 
    cFimLinha	:= CHR(10)
Else
    cFimLinha	:= CRLF
Endif

//-- Calcula a qtde de caracteres que forma a linha "LOGICA" (ao encontrar a primeira marca de final de linha)
nBytes	:= ( nPosFimLinha + 1 )
fSeek(	nHandle , ((-1)*(Len(cFimLinha)+1)) , 2 )
cEnd	:= Space( Len(cFimLinha) )
fRead( nHandle , @cEnd , 1 )

aInfoFile	:= Directory( cFile )
nSize		:= aInfoFile[ 1 , 2 ]

IF !( cEnd == cFimLinha )
	nSize+=1
EndIF

nLine := Int( nSize / nBytes )
fSeek( nHandle , 0 , IF( lRelativePos , 1 , 0 ) )

Return( nBytes )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁGetAllTxtFile	ЁAutorЁMarinaldo de Jesus Ё Data Ё22/04/2002Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna String Contendo Todo o Conteudo do Arquivo .TXT  	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁGetAllTxtFile( < nHandle > , [ < @nBytesRead > ] )			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁaAllTxt														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function GetAllTxtFile( nHandle , nBytesRead )

Local aAllTxt		:= {}
Local cBuffer		:= ""
Local nSizeBytes	:= 0
Local nReads		:= 0

#DEFINE __nBytesTxtRead__ 16384	//( ( 64 x 64 ) x 4 )

nSizeBytes	:= IF( !Empty( nBytesRead ) , nBytesRead , __nBytesTxtRead__ )

While ( nReads := fRead( nHandle , @cBuffer , nSizeBytes ) == nSizeBytes )
	aAdd( aAllTxt , cBuffer )
	cBuffer := ""
End While
IF !Empty( cBuffer )
	aAdd( aAllTxt , cBuffer )
EndIF	

nBytesRead := nSizeBytes

cBuffer := ""

Return( aAllTxt )

/*/
зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁBldcExecInFunЁ Autor ЁMarinaldo de Jesus   Ё Data Ё14/05/2003Ё
цддддддддддедддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁMonta Expressao para Executar em funcoesn In?				 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁBldcExecInFun( cExecIn , aFormParam )						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁcExec                                                 	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico 													 Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function BldcExecInFun( cExecIn , aFormParam )
         
Local nAt
Local nParam
Local nParams

DEFAULT cExecIn		:= ""

IF !Empty( cExecIn )
	DEFAULT aFormParam	:= {}
	_SetOwnerPrvt( "__aFormais__" , aFormParam )
	cExecIn := StrTran( cExecIn , " " , "" )
	nParams := Len( __aFormais__ )
	IF ( ( nAt := At( "(" , cExecIn ) ) > 0 )
		cExecIn := SubStr( cExecIn , 1 , nAt )
	Else
		cExecIn += "("
	EndIF	
	IF ( nParams > 0 )
		For nParam := 1 To nParams
			cExecIn += "@__aFormais__["+AllTrim(Str(nParam))+"],"
		Next nParam
		cExecIn := SubStr( cExecIn , 1 , Len( cExecIn ) - 1 ) + ")"
	Else
		cExecIn += ")"
	EndIF
EndIF

Return( cExecIn )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o	   ЁExeWhile		ЁAutorЁMarinaldo de Jesus Ё Data Ё22/08/2003Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁFuncao Similar a Instrucao While                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁlExecOk														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso	   ЁGenerica      										    	Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function ExeWhile(	uVarRet			,;	//Variavel de Retorno que sera incrementada pelo bloco
					bRetWhile		,;	//Bloco com a Expressao de Retorno
					uWhileCond		,;	//Expressao ou Bloco para Condicao While
					uSkipCond		,;	//Expressao ou Bloco para a Condicao Skip/Loop
					uExitWhile		,;	//Expressao ou Bloco para Exit no While
					lShowErr		,;	//Se deve Mostrar o Erro nos Testes das Expressoes
					lChkErr		 	 ;	//Se devera Verificar Erro nas Expressoes passadas
				  )

Local bWhileCond	:= { || .T. }
Local bSkipCond		:= { || .F. }
Local bExitWhile	:= { || .F. }
Local cRetWhile		:= ValType( bRetWhile		)
Local cWhileCond	:= ValType( uWhileCond		)
Local cSkipCond		:= ValType( uSkipCond		)
Local cExitWhile	:= ValType( uExitWhile		)
Local cShowErr		:= ValType( lShowErr		)
Local cChkErr		:= ValType( lChkErr			)
Local uExec			:= NIL
Local lExecOk		:= .T.
Local uSvVarRet		:= uVarRet

bRetWhile			:=	IF( ( cRetWhile == "B" ) , bRetWhile , { | uRetWhile | 0 } )

Begin Sequence

	IF ( cWhileCond == "C" )
		IF !Empty( uWhileCond )
			bWhileCond	:= __ExecMacro( "{ || " + uWhileCond + " } " )
		EndIF
	ElseIF ( cWhileCond == "B" )
		bWhileCond := uWhileCond
	EndIF

	IF ( cSkipCond == "C" )
		bSkipCond := __ExecMacro( "{ || " + uSkipCond + " } " )
	ElseIF  ( cSkipCond == "B" )
		bSkipCond := uSkipCond
	EndIF	
	
	IF ( cExitWhile == "C"  )
		bExitWhile	:= __ExecMacro( "{ || " + uExitWhile + " } " )
	ElseIF ( cExitWhile == "B"  )
		bExitWhile	:= uExitWhile
	EndIF	

	IF ( cShowErr <> "L" )
		lShowErr := .F.
	EndIF

	IF ( cChkErr <> "L" )
		lShowErr := .T.
	EndIF

	IF ( lChkErr )

		uExec		:= { || Eval( bWhileCond ) }
		IF !( lExecOk := CheckExecForm( @uExec , lShowErr ) )
			Break
		EndIF
	
		uExec		:= { || Eval( bSkipCond ) }
		IF !( lExecOk := CheckExecForm( @uExec , lShowErr ) )
			Break
		EndIF
	
		uExec		:= { || Eval( bExitWhile ) }
		IF !( lExecOk := CheckExecForm( @uExec , lShowErr ) )
			Break
		EndIF
	
		uSvVarRet	:= uVarRet
		uExec		:= { || Eval( bRetWhile , @uVarRet ) }
		IF !( lExecOk := CheckExecForm( @uExec , lShowErr ) )
			uVarRet := uSvVarRet
			Break
		EndIF
		uVarRet := uSvVarRet

	EndIF

	While ( Eval( bWhileCond ) )
		IF ( Eval( bSkipCond ) )
			IF ( Eval( bExitWhile ) )
				Exit
			EndIF
			Loop
		EndIF
		IF ( Eval( bExitWhile ) )
			Exit
		EndIF
		Eval( bRetWhile , @uVarRet )
	End While
	
End Sequence

Return( lExecOk )

/*/
зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁSetInclui	   Ё Autor ЁMarinaldo de Jesus   Ё Data Ё12/11/2003Ё
цддддддддддедддддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁSeta o Conteudo da Variavel Inclui                             Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁlLastInclui													   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													   Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function SetInclui( lNewInclui )

Local lLastInclui	:= .F.

DEFAULT lNewInclui	:= .T.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Inclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Inclui") == "U" )
	_SetOwnerPrvt( "Inclui"	, .T. )
EndIF
/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Seta Inclusao      										   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
lLastInclui := Inclui
Inclui		:= lNewInclui

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Altera, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Altera") == "U" )
	_SetOwnerPrvt( "Altera" , .F. )
EndIF
Altera	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Exclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Exclui") == "U" )
	_SetOwnerPrvt( "Exclui" , .F. )
EndIF
Exclui	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Visual, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Visual") == "U" )
	_SetOwnerPrvt( "Visual" , .F. )
EndIF
Visual	:= .F.

Return( lLastInclui )

/*/
зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁSetAltera 	   Ё Autor ЁMarinaldo de Jesus   Ё Data Ё12/11/2003Ё
цддддддддддедддддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁSeta o Conteudo da Variavel Altera                             Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁlLastAltra 													   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													   Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function SetAltera( lNewAltera )

Local lLastAltera	:= .F.

DEFAULT lNewAltera	:= .T.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Altera, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Altera") == "U" )
	_SetOwnerPrvt( "Altera"	, .T. )
EndIF
/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Seta Alteracao     										   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
lLastAltera := Altera
Altera		:= lNewAltera

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Inclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Inclui") == "U" )
	_SetOwnerPrvt( "Inclui" , .F. )
EndIF
Inclui	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Exclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Exclui") == "U" )
	_SetOwnerPrvt( "Exclui" , .F. )
EndIF
Exclui	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Visual, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Visual") == "U" )
	_SetOwnerPrvt( "Visual" , .F. )
EndIF
Visual	:= .F.

Return( lLastAltera )

/*/
зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁSetExclui 	   Ё Autor ЁMarinaldo de Jesus   Ё Data Ё12/11/2003Ё
цддддддддддедддддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁSeta o Conteudo da Variavel Exclui                             Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁlLastExclui													   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													   Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function SetExclui( lNewExclui )

Local lLastExclui	:= .F.

DEFAULT lNewExclui	:= .T.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Exclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Exclui") == "U" )
	_SetOwnerPrvt( "Exclui"	, .T. )
EndIF
/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Seta Exclusao      										   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
lLastExclui := Exclui
Exclui		:= lNewExclui

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Inclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Inclui") == "U" )
	_SetOwnerPrvt( "Inclui" , .F. )
EndIF
Inclui	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Altera, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Altera") == "U" )
	_SetOwnerPrvt( "Altera" , .F. )
EndIF
Altera	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Visual, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Visual") == "U" )
	_SetOwnerPrvt( "Visual" , .F. )
EndIF
Visual	:= .F.

Return( lLastExclui )

/*/
зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁSetVisual 	   Ё Autor ЁMarinaldo de Jesus   Ё Data Ё12/11/2003Ё
цддддддддддедддддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁSeta o Conteudo da Variavel Visual                             Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁlLastVisual													   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													   Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function SetVisual( lNewVisual )

Local lLastVisual	:= .F.

DEFAULT lNewVisual	:= .T.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Visual, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Visual") == "U" )
	_SetOwnerPrvt( "Visual"	, .T. )
EndIF
/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Seta Visualizacao  										   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
lLastVisual := Visual
Visual		:= lNewVisual

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Inclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Inclui") == "U" )
	_SetOwnerPrvt( "Inclui" , .F. )
EndIF
Inclui	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Altera, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Altera") == "U" )
	_SetOwnerPrvt( "Altera" , .F. )
EndIF
Altera	:= .F.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Exclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Exclui") == "U" )
	_SetOwnerPrvt( "Exclui" , .F. )
EndIF
Exclui	:= .F.

Return( lLastVisual )

/*/
зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁaRotSetOpc 	   Ё Autor ЁMarinaldo de Jesus   Ё Data Ё12/11/2003Ё
цддддддддддедддддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁSeta Visual, Inclui, Altera ou Exclui conforme nOpc            Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL          											   	   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													   Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function aRotSetOpc( cAlias , nReg , nOpc , lPutInEof )

Local aSvRotSetOpc := Array( 4 )

DEFAULT lPutInEof := .T.

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Visual, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Visual") == "U" )
	_SetOwnerPrvt( "Visual"	, .T. )
EndIF
aSvRotSetOpc[1] := { "Visual" , Visual }

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Inclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Inclui") == "U" )
	_SetOwnerPrvt( "Inclui" , .F. )
EndIF
aSvRotSetOpc[2] := { "Inclui" , Inclui }

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Altera, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Altera") == "U" )
	_SetOwnerPrvt( "Altera" , .F. )
EndIF
aSvRotSetOpc[3] := { "Altera" , Altera }

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁVerifica a Existencia da Variavel Exclui, Caso contrario, criaЁ
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( Type("Exclui") == "U" )
	_SetOwnerPrvt( "Exclui" , .F. )
EndIF
aSvRotSetOpc[4] := { "Exclui" , Exclui }

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCheca a Opcao Selecionada									   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
IF ( nOpc == 2 )		//Visualizacao
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Seta Visualizacao  										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	SetVisual()
ElseIF ( nOpc == 3  )	//Inclusao
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁQuando For Inclusao Garante que o Ponteiro do Alias Estara  emЁ
	ЁEof()														   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF (;
			( lPutInEof );
			.and.;
			!Empty( cAlias );
		)	
		PutFileInEof( cAlias , @nReg )
	EndIF
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Seta Inclusao      										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
   	SetInclui()
ElseIF ( nOpc == 4  )	//Alteracao
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Seta Alteracao     										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	SetAltera()
ElseIF ( nOpc == 5 )	//Exclusao
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Seta Exclusao      										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	SetExclui()
EndIF

Return( aSvRotSetOpc )

/*/
зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁaRotReSetOpc   Ё Autor ЁMarinaldo de Jesus   Ё Data Ё27/12/2004Ё
цддддддддддедддддддддддддддадддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁReSeta Visual, Inclui, Salvas pela aRotSetOpc				   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<vide parametros formais>   								   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL          											   	   Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													   Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function aRotReSetOpc( aSvRotSetOpc )

Local nOpc
Local nOpcs

nOpcs  := Len( aSvRotSetOpc )
For nOpc := 1 To nOpcs 
	IF ( Type( aSvRotSetOpc[ nOpc , 1 ] ) == "L" )
		&( aSvRotSetOpc[ nOpc , 1 ] ) := aSvRotSetOpc[ nOpc , 2 ]
	EndIF 
Next nOpc

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁIsInCallStack	 ЁAutorЁMarinaldo de JesusЁ Data Ё31/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁVerifica se Esta executando a partir de Determinada Rotina  Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                     								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function IsInCallStack( cIsInCallStack , cStackExit )

Local IsInCallStack := .F.

Local cCallStack	:= ""
Local nCallStack	:= 0

DEFAULT cIsInCallStack	:= ""
DEFAULT cStackExit		:= ""

If Empty(cStackExit)
	Return FWIsInCallStack( cIsInCallStack )
EndIf

cIsInCallStack	:= Upper( AllTrim( cIsInCallStack ) )
cStackExit		:= Upper( AllTrim( cStackExit ) )
While (;
			!( ( cCallStack := ProcName( ++nCallStack ) ) $ cStackExit );
	  		.and.;
	  		!Empty( cCallStack );
	  )
	IF ( IsInCallStack := ( cCallStack == cIsInCallStack ) )
		Exit
	EndIF
End While

Return( IsInCallStack )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁFileCreate		 ЁAutorЁMarinaldo de JesusЁ Data Ё29/11/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁCria Arquivo e Retorna nHandle e nErr por Referencia 		Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                     								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function FileCreate( cFile 	,;		// nome do arquivo a ser criado
					 nHandle,;		// retorno da criacao: se -1 nao foi criado
					 nErr	,;		// codigo do erro
					 nSrvRem ;		// 1-Forcar a criacao no servidor, mesmo estando com C:\ criara nesta unidade do servidor
					) // 

Local lCreateOk := .T.
Local nCreateOk

lCreateOk := ( ( nHandle := fCreate( cFile,,nSrvRem ) ) <> -1 )
nCreateOk := 0
IF !( lCreateOk )
	While (;
				!( lCreateOk := ( ( nErr := fError() ) == 0 ) );
				.and.;
				( ++nCreateOk <= 50 );
			)
		Sleep( 1000 )
		IF ( lCreateOk := ( ( nHandle := fCreate( cFile,,nSrvRem ) ) <> -1 ) )
			Exit
		EndIF
	End While
EndIF

Return( lCreateOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁFileErase		 ЁAutorЁMarinaldo de JesusЁ Data Ё29/11/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁExclui Arquivo e Retorna nErr por Referencia				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                     								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function FileErase( cFile , nErr )

Local lEraseOk 	:= .F.
Local lContinua := .F.
Local nFile    	:= 0

Local nEraseOk

lContinua := File(cFile)

nFile := If(lContinua, nFile, 1)

If(!lContinua, lContinua := File(cFile,nFile), Nil)

If lContinua
	nEraseOk := 0
	While (;
				( ++nEraseOk <= 50 );
				.and. !lEraseOk ;
			)

				If(nEraseOk>1,Sleep( 1000 ),Nil)

				lEraseOk := fErase( cFile, nFile ) == 0
	End While
EndIF

Return( lEraseOk )

/*/
зддддддддддбддддддддддддддбддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁlIsSRVDir	  ЁAutor ЁMauricio T. Takakura Ё Data Ё02/09/2005Ё
цддддддддддеддддддддддддддаддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁVerifica se determinado diretorio esta criado no SERVER		 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё.T. se diretorio existir e .F. se nao existir        	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico 													 Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function lIsSRVDir(cCaminho)

cCaminho := AllTrim(cCaminho)
If Right(cCaminho,1) == "\"
	cCaminho := SubStr(cCaminho,1,Len(cCaminho)-1)
EndIf

Return (Ascan( Directory(cCaminho,"D",1),{|_Vet | "D" $ _Vet[5] } ) > 0)

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁIsFunction		Ё Autor ЁMarinaldo de JesusЁ Data Ё26/11/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁVerificar se a Funcao Existe								 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL                                                  	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function IsFunction( cFunction )

Local lFunction	:= FindFunction( cFunction ) 

IF !( lFunction )
	lFunction := IsAsmFunc( cFunction )
EndIF	

Return( lFunction )

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁIsAsmFunc		Ё Autor ЁMarinaldo de JesusЁ Data Ё26/11/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁVerifica se eh uma Funcao em Assembler nao Localizada    pelaЁ
Ё          ЁFindFunction()											 	 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL                                                  	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function IsAsmFunc( cFunction )

Local aAsmFun := GetAsmFunc()

Local lAsmFun

DEFAULT cFunction	:= ""
cFunction			:= Upper( AllTrim( cFunction ) )
lAsmFun				:= ( aScan( aAsmFun , { |x| ( x == cFunction ) } ) > 0 )

Return( lAsmFun )

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁGetAsmFunc		Ё Autor ЁMarinaldo de JesusЁ Data Ё26/11/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna Array com as Funcoes em Assembler nao Localizadas  peЁ
Ё          Ёla FindFunction()											 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL                                                  	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function GetAsmFunc()

IF Empty( __aASMFunc )
	__aASMFunc := {}
	aAdd( __aASMFunc ,  "ALLTRIM"	)
	aAdd( __aASMFunc ,  "AT"		)
	aAdd( __aASMFunc ,  "CHR"		)
	aAdd( __aASMFunc ,  "CTOD"		)
	aAdd( __aASMFunc ,  "DATE"		)
	aAdd( __aASMFunc ,  "DAY"		)
	aAdd( __aASMFunc ,  "DELETED"	)
	aAdd( __aASMFunc ,  "DESCEND"	)
	aAdd( __aASMFunc ,  "DTOC"		)
	aAdd( __aASMFunc ,  "DTOS"		)
	aAdd( __aASMFunc ,  "EMPTY"		)
	aAdd( __aASMFunc ,  "IF"		)
	aAdd( __aASMFunc ,  "IIF"		)
	aAdd( __aASMFunc ,  "LEFT"		)
	aAdd( __aASMFunc ,  "LEN"		)
	aAdd( __aASMFunc ,  "LOWER"		)
	aAdd( __aASMFunc ,  "LTRIM"		)
	aAdd( __aASMFunc ,  "MONTH"		)
	aAdd( __aASMFunc ,  "PAD"		)
	aAdd( __aASMFunc ,  "PADC"		)
	aAdd( __aASMFunc ,  "PADL"		)
	aAdd( __aASMFunc ,  "PADR"		)
	aAdd( __aASMFunc ,  "RAT"		)
	aAdd( __aASMFunc ,  "RIGHT"		)
	aAdd( __aASMFunc ,  "ROUND"		)
	aAdd( __aASMFunc ,  "RTRIM"		)
	aAdd( __aASMFunc ,  "SPACE"		)
	aAdd( __aASMFunc ,  "STR"		)
	aAdd( __aASMFunc ,  "STRZERO"	)
	aAdd( __aASMFunc ,  "SUBSTR"	)	
	aAdd( __aASMFunc ,  "TIME"		)
	aAdd( __aASMFunc ,  "TODAY"		)
	aAdd( __aASMFunc ,  "TRANSFORM"	)
	aAdd( __aASMFunc ,  "TRIM"		)
	aAdd( __aASMFunc ,  "UPPER"		)
	aAdd( __aASMFunc ,  "VAL"		)
	aAdd( __aASMFunc ,  "YEAR"		)
EndIF

Return( __aASMFunc )

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁReservedWords	Ё Autor ЁMarinaldo de JesusЁ Data Ё01/12/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁVerifica se eh uma paravra Reservada						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё.T. Se for Palavra Reservada, Caso Contrario .F.			 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function ReservedWords( cUpperText )

Local aReservedWords := GetReservedWords()

Local lReservedWords

DEFAULT cUpperText	:= ""
cUpperText			:= Upper( AllTrim( cUpperText ) )
lReservedWords		:= ( aScan( aReservedWords , { |x| ( x == cUpperText ) } ) > 0 )

Return( lReservedWords )

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁGetReservedWordsЁ Autor ЁMarinaldo de JesusЁ Data Ё01/12/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁObtem as Palavras Reservadas        						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё__aReservedWords											 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function GetReservedWords()

IF Empty( __aReservedWords )
	__aReservedWords := {}
	aAdd( __aReservedWords , "IF"			)
	aAdd( __aReservedWords , "AADD"			)
	aAdd( __aReservedWords , "CTOD"			)
	aAdd( __aReservedWords , "EXP"			)
	aAdd( __aReservedWords , "INT"			)
	aAdd( __aReservedWords , "MONTH"		)
	aAdd( __aReservedWords , "ROW"			)
	aAdd( __aReservedWords , "TIME"			)
	aAdd( __aReservedWords , "ELSE"			)
	aAdd( __aReservedWords , "ABS"			)
	aAdd( __aReservedWords , "DATE"			)
	aAdd( __aReservedWords , "FCOUNT"		)
	aAdd( __aReservedWords , "LASTREC"		)
	aAdd( __aReservedWords , "PCOL"			)
	aAdd( __aReservedWords , "RTRIM"		)
	aAdd( __aReservedWords , "TRANSFORM"	)
	aAdd( __aReservedWords , "ELSEIF"		)
	aAdd( __aReservedWords , "ASC"			)
	aAdd( __aReservedWords , "DAY"			)
	aAdd( __aReservedWords , "FIELDNAME"	)
	aAdd( __aReservedWords , "LEN"			)
	aAdd( __aReservedWords , "PCOUNT"		)
	aAdd( __aReservedWords , "SECONDS"		)
	aAdd( __aReservedWords , "TRIM"			)
	aAdd( __aReservedWords , "ENDIF"		)
	aAdd( __aReservedWords , "AT"			)
	aAdd( __aReservedWords , "DELETED"		)
	aAdd( __aReservedWords , "FILE"			)
	aAdd( __aReservedWords , "LOCK"			)
	aAdd( __aReservedWords , "PROW"			)
	aAdd( __aReservedWords , "SELECT"		)
	aAdd( __aReservedWords , "TYPE"			)
	aAdd( __aReservedWords , "WHILE"		)
	aAdd( __aReservedWords , "BREAK"		)
	aAdd( __aReservedWords , "DEVPOS"		)
	aAdd( __aReservedWords , "FLOCK"		)
	aAdd( __aReservedWords , "LOG"			)
	aAdd( __aReservedWords , "RECCOUNT"		)
	aAdd( __aReservedWords , "SETPOS"		)
	aAdd( __aReservedWords , "UPPER"		)
	aAdd( __aReservedWords , "ENDCASE"		)
	aAdd( __aReservedWords , "BOF"			)
	aAdd( __aReservedWords , "DOW"			)
	aAdd( __aReservedWords , "FOUND"		)
	aAdd( __aReservedWords , "LOWER"		)
	aAdd( __aReservedWords , "RECNO"		)
	aAdd( __aReservedWords , "SPACE"		)
	aAdd( __aReservedWords , "VAL"			)
	aAdd( __aReservedWords , "ENDDO"		)
	aAdd( __aReservedWords , "CDOW"			)
	aAdd( __aReservedWords , "DTOC"			)
	aAdd( __aReservedWords , "IF"			)
	aAdd( __aReservedWords , "LTRIM"		)
	aAdd( __aReservedWords , "REPLICATE"	)
	aAdd( __aReservedWords , "SQRT"			)
	aAdd( __aReservedWords , "VALTYPE"		)
	aAdd( __aReservedWords , "FUNCTION"		)
	aAdd( __aReservedWords , "CHR"			)
	aAdd( __aReservedWords , "DTOS"			)
	aAdd( __aReservedWords , "IIF"			)
	aAdd( __aReservedWords , "MAX"			)
	aAdd( __aReservedWords , "RLOCK"		)
	aAdd( __aReservedWords , "STR"			)
	aAdd( __aReservedWords , "WORD"			)
	aAdd( __aReservedWords , "PROCEDURE"	)
	aAdd( __aReservedWords , "CMONTH"		)
	aAdd( __aReservedWords , "EMPTY"		)
	aAdd( __aReservedWords , "INKEY"		)
	aAdd( __aReservedWords , "MIN"			)
	aAdd( __aReservedWords , "ROUND"		)
	aAdd( __aReservedWords , "SUBSTR"		)
	aAdd( __aReservedWords , "YEAR"			)
	aAdd( __aReservedWords , "COL"			)
	aAdd( __aReservedWords , "EOF"			)
	aAdd( __aReservedWords , "NIL"			)
EndIF

Return( __aReservedWords )

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁFileToArr		Ё Autor ЁMarinaldo de JesusЁ Data Ё01/12/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna Array com as informacoes de um arquivo Texto         Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL                                                  	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function FileToArr( cFile  )
         
Local aFile := {}

Local cLine

Begin Sequence

	IF !( File( cFile ) )
		Break
	EndIF

	IF ( fT_fUse( cFile ) == -1 )
		Break
	EndIF

	fT_fGotop()
	While !( fT_fEof() )
		cLine := fT_fReadLn()
		aAdd( aFile , cLine )
		fT_fSkip()
	End While
	fT_fUse()

End Sequence

Return( aFile )

/*/
зддддддддддбддддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁFileSrvToArr	Ё Autor ЁMarinaldo de JesusЁ Data Ё01/12/2004Ё
цддддддддддеддддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁRetorna Array com as informacoes de um arquivo Texto - ForcanЁ
Ё          Ёdo a abertura no Server. Sem utilizar as funcoes fFT_*       Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNIL                                                  	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                     Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function FileSrvToArr( cFile, nOpenSrv,lCase )		// 1-Abre direto no Server, NIL - Local

Local aInfoFile
Local aFile 		:= {}

Local cLine
Local cImpLine
Local cAuxLine

Local nSize
Local nTamChr
Local nHandle
Local nPosFimLinha

DEFAULT nOpenSrv := NIL
DEFAULT lCase 	 := .T.
Begin Sequence
   
	IF !( File( cFile, nOpenSrv ,lCase) )
		Break
	EndIF

	nHandle 	:= fOpen( cFile,, nOpenSrv ,lCase)
	If nHandle <= 0
		Break
	EndIf
	aInfoFile	:= Directory( cFile,, nOpenSrv,lCase )
	nSize		:= aInfoFile[ 1 , 2 ]

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Extrai uma linha "FISICA" de texto (pode conter varias linhasЁ
	Ё logicas)											           Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	cLine	:= fReadStr( nHandle , nSize )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Gerar o Array para a GetDados       						   Ё
	Ё Verifica a Existencia de CHR(13)+CHR(10) //Carriage Return e Ё
	Ё Line Feed na linha extraida do texto Se ambos existirem, estaЁ
	Ё mos trabalhando em ambiente Windows. Caso contrario, estamos Ё
	Ё em ambiente Linux e somente teremos o CHR(10) para indicar o Ё
	Ё final da linha 											   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	If (nPosFimLinha	:=	At( CRLF , cLine ) ) == 0
		nPosFimLinha	:=	At( Chr(10) , cLine )
		nTamChr := 1
	Else
		nTamChr := 2
	EndIf

	cImpLine := Substr( cLine, 1, nPosFimLinha )
	cAuxLine := Substr( cLine, nPosFimLinha+nTamChr, nSize )
	aAdd( aFile, cImpLine )
	While nPosFimLinha <> 0
		If nTamChr == 1
			nPosFimLinha	:=	At( Chr(10) , cAuxLine )
		Else
			nPosFimLinha	:=	At( CRLF , cAuxLine )
		EndIf
		If nPosFimLinha <> 0
			cImpLine := Substr( cAuxLine, 1, nPosFimLinha )
			cAuxLine := Substr( cAuxLine, nPosFimLinha+nTamChr, nSize )
			aAdd( aFile, cImpLine )			
		EndIf
	EndDo
	
	fClose( nHandle )

End Sequence

Return( aFile )


/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    |CriaVarRH	  ЁAutorЁRogerio Ribeiro	  Ё Data Ё05/01/2007Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao utilizada no lugar da CriaVar, para tratar os campos	Ё
Ё		   ЁGHOSTCOL e COLBMP 								        	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁConteudo do inicializador padrao, ou valor default do tipo. Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function CriaVarRH(cField, lInitPad, aHeader)
	Local xRetorno
	Local bInitPad
	Local nPos:= aScan(aHeader , { |aColumns| aColumns[__AHEADER_FIELD__] ==  cField} )
		
	Local cInitPad:= aHeader[nPos, __AHEADER_INITPAD__]
	Local cTipo:= aHeader[nPos, __AHEADER_TYPE__]
	Local cTamanho:= aHeader[nPos, __AHEADER_WIDTH__]
	
		IF lInitPad .AND. !Empty(cInitPad)
			bInitPad:= __ExecMacro( " { || xRetorno := " + cInitPad + " } " )
	
			If !CheckExecForm(bInitPad , .F. )
				xRetorno := GetValType(cTipo, cTamanho)
			EndIf
		Else
			xRetorno := GetValType(cTipo, cTamanho)
		EndIf	

Return xRetorno

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | excArquivo   ЁAutorЁ Emerson Campos	  Ё Data Ё02/08/2012Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao utilizada para excluir arquivo transferido entre     Ё
ЁDescricao Ёservidores                                               	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T.)                                             Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function exclArquivo(cEnv, cServ, nPort, cFileTo, cArquivo)
	Local oRpcSrv 		:= TRpc():New( cEnv )
	Local lRet 			:= .T.
	
	If ( oRpcSrv:Connect( cServ, nPort ) )
		oRpcSrv:CallProcEX( 'uFileDel', cFileTo+"\"+cArquivo )
    EndIf
    
    oRpcSrv:Disconnect()
Return lRet

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | tranfArquivo ЁAutorЁ Emerson Campos	  Ё Data Ё05/05/2012Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao utilizada para transferir arquivos entre servidores	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T. ou .F.)                                      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function tranfArquivo(cEnv, cServ, nPort, cFileFrom, cFileTo, cArquivo)   
	Local oRpcSrv 		:= TRpc():New( cEnv ) 
	Local nHandle  		:= 0
	Local cDados 		:= ''
	Local lRet 			:= .T.

	If ( oRpcSrv:Connect( cServ, nPort ) )  
		nHandle := FOpen( cFileFrom , FO_READWRITE + FO_SHARED )
	
		If !( nHandle == -1 ) 
			If oRpcSrv:CallProcEX( 'lDirCreate', cFileTo ) 
				If oRpcSrv:CallProcEX( 'lFileCreate', cFileTo+"\"+cArquivo )  
			 		While( FRead( nHandle, @cDados, 1005576 ) > 0 )
						oRpcSrv:CallProcEX('uFileWrite', @cDados, cFileTo+"\"+cArquivo ) 
					End
				Else
					Alert(STR0001) //"NЦo foi possМvel salvar o arquivo no endereГo de destino. Contate o administrador do sistema." 
					lRet := .F.
				EndIf
			Else
				Alert(STR0002) //"NЦo foi possМvel criar a pasta no endereГo de destino. Contate o administrador do sistema."
				lRet := .F. 
			EndIf
			FClose(nHandle)
		Else
			Alert(STR0003) //"NЦo foi possМvel ler o arquivo de origem. Contate o administrador do sistema."
			lRet := .F.	
	    EndIf
	    oRpcSrv:Disconnect()
  	Endif
Return lRet

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | lDirCreate   ЁAutorЁ Emerson Campos	  Ё Data Ё05/05/2012Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao auxiliar da tranfArquivo(), serve para validar se 	Ё
Ё          Ёexiste o diretorio, se nЦo houver tenta cria-lo             Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T. ou .F.)                                      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function lDirCreate( acArquivo )
	Local lCreated  := .T.
	
	If ! existDir(acArquivo)
		If makeDir(acArquivo) > 0
			lCreated := .F.
		EndIf
	EndIf 

Return lCreated

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | lFileCreate  ЁAutorЁ Emerson Campos	  Ё Data Ё05/05/2012Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao auxiliar da tranfArquivo(), serve para criar o arq 	Ё
Ё          Ёno diretorio especificado                                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T. ou .F.)                                      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function lFileCreate( acArquivo ) 
	Local nHandle 	:= 0
	Local lCreated  := .F.    
                  
    FErase( acArquivo )        
    nHandle := FCreate( acArquivo )
            
	If !( nHandle == -1 )
		FClose(nHandle) 
		lCreated := .T.
   	EndIf

Return lCreated

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | uFileWrite   ЁAutorЁ Emerson Campos	  Ё Data Ё05/05/2012Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao auxiliar da tranfArquivo(), serve para abrir o arq 	Ё
Ё          Ёno diretorio especificado e escrever no mesmo               Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T. ou .F.)                                      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function uFileWrite( acDados, acArquivo ) 
	Local nHandle := FOpen( acArquivo , FO_READWRITE + FO_SHARED )
                    
	If !( nHandle == -1 )
	   	FSeek(nHandle, 0, FS_END) 
	   	FWrite(nHandle, acDados) 
	   	FClose(nHandle)  
   	EndIf
Return


/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | uFileDel     ЁAutorЁ Emerson Campos	  Ё Data Ё02/08/2012Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao auxiliar da exclArquivo(), serve para excluior o arq	Ё
Ё          Ёno diretorio especificado                                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T. ou .F.)                                      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
/*/
Function uFileDel( acArquivo ) 
	FErase(acArquivo)
Return .T.

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | RHGeraLinhas ЁAutorЁ Marcelo Faria       Ё Data Ё07/02/2013Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao para gerar linhas de arquivo texto para integrar     Ё
Ё          Ёcom empresas de beneficios, baseada em funcao do Ernani.    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ                                                            Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
/*/
Function RHGeraLinhas( aTipo, cIdSeq, nTamMaxLin )

Local cLinha     := ''
Local nI         := 0
Local cTipo      := ""
Local nDecimal   := 0
Local nTamanho   := 0

Default aTipo		:= {}
Default cIdSeq		:= ""
Default nTamMaxLin	:= 0	//-600

For nI := 1 To Len( aTipo )
	
	If Empty(cIdSeq) .OR. aTipo[nI][1] == cIdSeq
		
		bAux      := &( '{ || ' + aTipo[nI][6] + ' } ' )
		
		cTipo     := aTipo[nI][3]
		nTamanho  := aTipo[nI][4]
		nDecimal  := aTipo[nI][5]
		
		uConteudo := EVal( bAux )
		//-uConteudo := IIf( ValType( uConteudo ) == 'U' , '', EverChar( uConteudo ) )
		uConteudo := IIf( ValType( uConteudo ) == 'U' , '', RHAllChar( uConteudo ) )
		
		If     cTipo == 'C'
			uConteudo := SubStr( AllTrim( UPPER(uConteudo) ) + Space(nTamanho), 1, nTamanho )
			
		ElseIf cTipo == 'N'
			uConteudo := StrZero( Val( uConteudo ) * (10^nDecimal) , nTamanho )
			
		EndIf
		
		cLinha += uConteudo
	EndIf
Next

cLinha += Replicate( ' ', nTamMaxLin - Len( cLinha ) ) + CRLF

Return(cLinha)


/*
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | RHProcessaIniЁAutorЁ Marcelo Faria       Ё Data Ё07/02/2013Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao para avaliar e preparar arquivo INI de integracao    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ                                                            Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
*/
Function RHProcessaIni(nomeArq)

Local cBuffer   := ""
Local aHead     := {}
Local aDet      := {}
Local aTrail    := {}
Local aResult   := {}

If !File(nomeArq)
    Return
EndIf

//Abrir Arquivo INI
FT_FUSE(nomeArq)

FT_FGOTOP()

cBuffer := FT_FREADLN()
    
If Subst(cBuffer,1,1) == "["
    FT_FSKIP()
Endif

While !FT_FEOF()
    
    cBuffer := FT_FREADLN()
    
    If Subst(cBuffer,1,1) == "["
        FT_FSKIP()
        Loop
    Endif
    
    If Subst(cBuffer,1,1) == "H"
        aAdd( aHead,	{Subst(cBuffer,2,2),;		//-01-Sequencial do Tipo de Registro
        				Subst(cBuffer,4,25),;		//-02-Campo de indentificacao
        				Subst(cBuffer,29,1),;		//-03-Tipo de campo
        				Val(Subst(cBuffer,30,4)),;	//-04-Tamanho do Campo
        				Val(Subst(cBuffer,34,1)),;	//-05-Decimais
        				Subst(cBuffer,35)} )		//-06-Conteudo do campo
        
    ElseIf Subst(cBuffer,1,1) == "D"
        aAdd( aDet,		{Subst(cBuffer,2,2),;		//-01-Sequencial do Tipo de Registro
        				Subst(cBuffer,4,25),;		//-02-Campo de indentificacao
        				Subst(cBuffer,29,1),;		//-03-Tipo de campo
        				Val(Subst(cBuffer,30,4)),;	//-04-Tamanho do Campo
        				Val(Subst(cBuffer,34,1)),;	//-05-Decimais
        				Subst(cBuffer,35)} )		//-06-Conteudo do campo
        
    ElseIf Subst(cBuffer,1,1) == "T"
        aAdd( aTrail,	{Subst(cBuffer,2,2),;		//-01-Sequencial do Tipo de Registro
        				Subst(cBuffer,4,25),;		//-02-Campo de indentificacao
        				Subst(cBuffer,29,1),;		//-03-Tipo de campo
        				Val(Subst(cBuffer,30,4)),;	//-04-Tamanho do Campo
        				Val(Subst(cBuffer,34,1)),;	//-05-Decimais
        				Subst(cBuffer,35)} )		//-06-Conteudo do campo
    Endif
        
    FT_FSKIP()

Enddo

//Fecha Arquivo
FT_FUSE()

aResult := {aHead, aDet, aTrail}

Return(aResult)

/*
дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
GRAVADATA(ExpD1,ExpL1,ExpN1)
ExpD1 := Data a ser convertida
ExpL1 := Tipo - Se .T. com Barra - Se .F. sem Barra
ExpN1 := Formato (1,2,3,4,5,6,7,8)
Formato 1 := ddmmaa
		2 := mmddaa
		3 := aaddmm
		4 := aammdd
		5 := ddmmaaaa
		6 := mmddaaaa
		7 := aaaaddmm
		8 := aaaammdd
дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
*/

/*/
зддддддддддбддддддддддддддбдддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFuncao    | uFileExecut  ЁAutorЁ Emerson Campos	  Ё Data Ё08/01/2014Ё
цддддддддддеддддддддддддддадддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescricao ЁFuncao que avalia se um determinado arquivo И um arquivo 	Ё
Ё          Ёexecutavel, exemplo .exe          							Ё
Ё          ЁEsta funГЦo valida arquivos do tipo:          				Ё
Ё          Ё"DOS Executable": EncarnaГЦo mais simples dos ficheiros EXE.Ё 
Ё          Ё                  Esta И a Зnica versЦo usada no DOS sem    Ё
Ё          Ё                  extensУes de 32 bits.          			Ё
Ё          Ё"16-bit New Executable": Executado pelo OS/2 e todas as     Ё 
Ё          Ё                         versУes de Windows.          		Ё
Ё          Ё"Mixed 16/32-bit Linear Executable": Usado para drivers do  Ё
Ё          Ё                                     tipo VxD no Windows 3.xЁ 
Ё          Ё                                     e Windows 9x.          Ё
Ё          Ё"32-bit Linear Executable":  Formato exclusivo do OS/2 nas  Ё
Ё          Ё							 versУes 2.0 ou mais recentes   Ё
Ё          Ё"32-bit Portable Executable":Este И o formato mais complexo Ё
Ё          Ё          					 de ficheiros EXE e podem ser   Ё
Ё          Ё          					 executados por todas as versУesЁ
Ё          Ё          					 do Windows NT e pelos Windows  Ё
Ё          Ё          					 95 e mais recentes.          	Ё
Ё          Ё"64-bit": Similares aos ficheiros EXE "32-bit Portable      Ё
Ё          Ё          Executable" porИm usam as extensУes de 64-bits    Ё
Ё          Ё          das CPUs. Estes sС podem ser executados nas       Ё
Ё          Ё          ediГУes dos Windows 64-bits.          			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ cPacthFile - O caminho completo mais o arquivo, exemplo:   Ё
Ё          Ё			  \dir\setup.exe ou C:\setup.exe				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   Ё Boleano. (.T. ou .F.)                                      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
/*/
Function uFileExecut(cPacthFile)
Local lRet		:= .F.
Local nHdl		:= 0
Local nBytes	:= 0
Local nBloco	:= 2
Local cBuffer	:= ""

nHdl := FOpen(cPacthFile, FO_READ)
FSeek(nHdl, 0, FS_SET) 
If nHdl <> -1
	nBytes := FRead(nHdl, @cBuffer, nBloco)      // LЙ os bytes
	If nBytes <> nBloco
		MsgAlert( STR0004 + str(FError())) //"Erro de leitura n╨:"
	Else
		If cBuffer $ ("MZ*NE*LE*LX*PE")     
        	lRet	:= .T.
		EndIf
	EndIf
EndIf

If !FClose(nHdl)
	MsgAlert( STR0005 + str(FError())) //"Erro ao fechar arquivo. Erro nЗmero: "
EndIf

Return lRet

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    ЁfCondExec Ё Autor Ё Emerson Rosa          Ё Data Ё29/08/03  Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Avalia a condicao e executa								  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё fCondExec(cCond,cExec)									  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ                                                            Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё Generico                                                   Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function fCondExec(cCond,cExec1,cExec2)
Local bCond  := &( "{ || " + cCond  + "}" )
Local bExec1 := &( "{ || " + cExec1 + "}" )
Local bExec2 := &( "{ || " + cExec2 + "}" )

Return If( Eval( bCond ), Eval( bExec1 ), Eval( bExec2 ) )

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё fRetDec  Ё Autor Ё Equipe RH             Ё Data Ё27/11/00  Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Retorna o valor com 4 cadas decimais                       Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё fRetDec(nValRet)                                           Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ                                                            ╢╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё Generico                                                   Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function fRetDec(nValRet)
Local cValRet := AllTrim(Str(nValRet,12,2))
Local cValRetInt,cValRetDec,cNovoDec,cNovoDig

If Right(cValRet,1) # "0"
    cValRetInt := Left(cValRet, Len(cValRet)-2)
    cValRetDec := Right(cValRet,2)
    If Left(cValRetDec,1) == Right(cValRetDec,1)
        cNovoDec := cValRetDec + Replic(Left(cValRetDec,1), 2)
    Else
        cNovoDig := Str(Val(Right(cValRetDec,1))-1,1)
        cNovoDig := If(cNovoDig == "5", StrZero(Val(cNovoDig)+1,1), cNovoDig)
        cNovoDec := Left(cValRetDec,1) + Replic(cNovoDig,3)
    EndIf
	nValRet := Val(cValRetInt + cNovoDec)
EndIf

Return nValRet

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 Ё fTacento Ё Autor Ё Equipe Advanded RH	Ё Data Ё 30.03.93 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё tirar o acento para impressao.							  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe	 Ё fTacento(cTexto)											  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Generico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ/*/
Function fTAcento( cTexto )

Local cAcentos	:= "─ г ┤ Г ▌ д ю а б ц е ┘ ├ ═ └ ╕ Ю А Ц Д Е и х й к ┬ ┌ Х И Й К л м н о ║ М р с т у ж С У ⌠ ■ ∙ ╒ ╖ П Ж ы з ш э ё Ы З Ш Э я Я"
Local cAcSubst	:= "C C c c A A A A A A A A a a a a a a a a a E E E E E e e e e e I I I I i i O O O O O o o o o o o o o U U U U u u u u u u N n"
Local cImpCar	:= ""
Local cImpLin	:= ""
Local nChar   	:= 0.00
Local nChars	:= 0.00
Local nAt		:= 0.00	

cTexto := If( Empty( cTexto ) .or. ValType( cTexto ) != "C", "" , cTexto )

nChars := Len( cTexto )
For nChar := 1 To nChars
	cImpCar := SubStr( cTexto , nChar , 1 )
	If ( nAt := At( cImpCar , cAcentos ) ) > 0
		cImpCar := SubStr( cAcSubst , nAt , 1 )
	EndIf
	cImpLin += cImpCar
Next nChar

Return( cImpLin )


/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 Ё FDESC_MESЁ Autor Ё R.H. - Marcos StiefanoЁ Data Ё 04.01.96 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Descricao do Mes														  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe	 Ё FDESC_MES(nMes , nLetras)											  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ nMes	  - Numero do Mes 											  Ё╠╠
╠╠Ё			 Ё nLetras - Numero de Caracteres que Deve Retornar			  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Generico 																  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ/*/
Function FDESC_MES(nMes,nLetras)

Local cMes[12]
nMes := If(nMes <= 0, Month(dDataBase), nMes)
If nLetras = NIL
	nLetras := 9
EndIf

cMes := {STR0006,STR0007,STR0008,STR0009,STR0010,STR0011,;  	//"Janeiro  "###"Fevereiro"###"Marco    "###"Abril    "###"Maio     "###"Junho    "
			STR0012,STR0013,STR0014,STR0015,STR0016,STR0017}   	//"Julho    "###"Agosto   "###"Setembro "###"Outubro  "###"Novembro "###"Dezembro "

Return Subs(cMes[nMes]+Space(nLetras),1,nLetras)

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁGPEA090   ╨Autor  ЁMicrosiga           ╨ Data Ё  07/26/07   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё TRADUZ UMA REGRA CADASTRADA NO CONTROLE DE ACESSO DE USUA- ╨╠╠
╠╠╨          Ё RIO DE SRA->RA_MAT PARA SRA.RA_MAT POR EXEMPLO     		  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё AP                                                         ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function fConvExpPSql(cExpress)

Default cExpress := ""
Private cRetorno 

//TRANSFORMA O BLOCO DE CODIGO EM STRING
cExpress := GetCBSource(cExpress)
cRetorno := Upper(cExpress)

//LIMPA BLOCOS VAZIOS
cRetorno := StrTran(cRetorno, " ","") //E NECESSARIO LIMPAR OS ESPACOS PARA POSSIVELMENTE LIMPAR O BLOCO
cRetorno := StrTran(cRetorno, "{||.T.}","")   
cRetorno := StrTran(cRetorno, "{||.F.}","")   

//LIMPA OS COMANDOS INVALIDOS
cRetorno := StrTran(cRetorno, "DTOS","")   

cRetorno := StrTran(cRetorno, "{","")  
cRetorno := StrTran(cRetorno, "}","")  
cRetorno := StrTran(cRetorno, "|","")  
cRetorno := StrTran(cRetorno, "==","=")  
cRetorno := StrTran(cRetorno, '"',"'")  
cRetorno := StrTran(cRetorno, "->",".")  
cRetorno := StrTran(cRetorno, ".AND."," AND ")  
cRetorno := StrTran(cRetorno, ".OR."," OR ")  
cRetorno := AllTrim(cRetorno)

If (cRetorno != "")
	/* 
	   SE A EXPRESSAO FOR DIFERENTE DE VAZIO
	   ENTAO ADIOCIONA-SE O AND PARA QUE A EXPRESAO
	   SEJA COMPLETA EM SEU RETORNO 
	*/
	cRetorno := " AND " + cRetorno 
EndIf

Return (cRetorno)


/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁGPEA090   ╨Autor  ЁMicrosiga           ╨ Data Ё  07/26/07   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё FILTRA UMA TABELA COM BASE NA REGRA CADASTRADA NO CONTROLE ╨╠╠
╠╠╨          Ё DE ACESSOS DE USUARIOS, NAO FUNCIONA PARA TABELAS ABERTAS  ╨╠╠
╠╠╨          Ё DIRETAMENTE COM COMANDOS SQL								  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё AP                                                         ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function fFiltro(cProcesso,aAlias,cTipo, nInicio, nFim, lForceRFT)

Local bFiltraBrws	    := {|| NIL }					//Variavel para Filtro
Local cFiltro			:= ""
Local cVarAIndex		:= ""
Local nI 				:= 0                   
Default nInicio			:= 1
Default nFim			:= Len(aAlias) 
Default	lForceRFT		:= .F.

Do Case
	Case (cTipo == 0)
		/*
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁLimpa os FilBrowse											   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/		
	    For nI := nInicio to nFim
	    	cVarAIndex := 'aIdx'+aAlias[nI]
	        If Type(cVarAIndex) != "U" 
				EndFilBrw(@aAlias[nI],@&cVaraIndex) 
			EndIf
		Next
		
	Case (cTipo == 1)
		/*Verifica se a variavel esta criada para recriar caso necessario*/	
		For nI := nInicio to nFim                        
			cVarAIndex := 'aIdx'+aAlias[nI]
			
			If Type(cVarAIndex) == "U" 
				_SetOwnerPrvt(cVaraIndex, {} )
			EndIf
			If lForceRFT	
				//Limpa o Filtro
				&cVarAIndex := {}
			EndIf
            
			//Executa o Filtro
	   		cFiltro	    := CHKRH(cProcesso,aAlias[nI],"1")   
	   		If (!Empty(cFiltro), cFiltro:= "("+ cFiltro + ")", )
			bFiltraBrws := {|| FilBrowse(aAlias[nI],@&cVarAIndex,cFiltro) }
			Eval(bFiltraBrws)		
		Next
		
	Case (cTipo == 2)
		/*Cria variaveis para disponibilizar para o uso*/
   		For nI := nInicio to nFim					   
			cVarAIndex := 'aIdx'+aAlias[nI]
 			If Type(cVarAIndex) == "U" 
				_SetOwnerPrvt(cVaraIndex, {} )
			EndIf
   		Next
EndCase  

Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁGPEParSQL ╨Autor  ЁMicrosiga -Natie    ╨ Data Ё  02/22/05   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё Executa parse para converter expressoes adv para SQL       ╨╠╠
╠╠╨          Ё quando filtro vem  da SetPrint                             ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё AP                                                         ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
*/
Function GPEParSQL(cFilADV) 
	cFilADV := StrTran(Upper(cFilADV)	,".AND."  ," AND ")
	cFilADV := StrTran(Upper(cFilADV)	,".OR."   ," OR ")
	cFilADV := StrTran(cFilADV       	,"=="     ," = ")
	cFilADV := StrTran(cFilADV       	,"!="     ,"<>")
	cFilADV := StrTran(cFilADV       	,'"'      ,"'")
	cFilADV := StrTran(Upper(cFilADV)	,"ALLTRIM"," ")
	cFilADV := StrTran(Upper(cFilADV)	,'!$'   ,"NOT IN")
	cFilADV := StrTran(cFilADV       	,'$'      ," IN ")
	cFilADV := StrTran(Upper(cFilADV)	,"DTOS"   ,"")
	cFilADV := StrTran(cFilADV			,"->"   ,".")
	cFilADV := StrTran(Upper(cFilADV)	,"TRIM"   ," ")
Return(cFilADV) 

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 ЁAMaiorZeroЁ Autor Ё Marcos A. Stiefano    Ё Data Ё 29.06.95 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Verifica Valor Zerado e Negativo 						  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Generico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ/*/
Function aMaiorZero(nValor)
	Local cAlias := Alias()
	
	If nValor == 0 .OR. nValor < 0
		Help(" ",1, "VALZERADO")
		Return (.F.)
	EndIf
	
	dbSelectArea( cAlias )	
Return .T.

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 ЁChkCPF 	Ё Autor Ё Marcos A. Stiefano	Ё Data Ё 29.06.95 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Verifica CPF												  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Generico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ/*/
Function ChkCPF(cCPF, lMeurh)
Local nCic01	:= nCic02	:= nCic03 := nCic04 := nCic05 := 0
Local nCic06	:= nCic07	:= nCic08 := nCic09 := nCic10 := nCic11 := 0
Local nXcic 	:= nYcic 	:= nWcic  := nKcic  := 0
Local nDig1Cic := nDig2Cic := 0
Local nAux		:= 0

Default lMeurh := .F.

If Replicate(Left(cCPF,1),11) = cCPF
	If !lMeurh 
		Help(" ",1, "CPFINVALID")
		Return (.F.)
	Else
		Return (.F.)
	EndIf		
EndIf

For nAux := 1 to 11
	If !(SubStr(cCpf,nAux,1) $ "1234567890")
		If !lMeurh 
			Help(" ",1,"CPFINVALID")
			Return(.F.)
		Else	
			Return(.F.)
		EndIf	
	EndIf
Next nAux

nCic01  := Val(SubStr(cCPF,01,01))
nCic02  := Val(SubStr(cCPF,02,01))
nCic03  := Val(SubStr(cCPF,03,01))
nCic04  := Val(SubStr(cCPF,04,01))
nCic05  := Val(SubStr(cCPF,05,01))
nCic06  := Val(SubStr(cCPF,06,01))
nCic07  := Val(SubStr(cCPF,07,01))
nCic08  := Val(SubStr(cCPF,08,01))
nCic09  := Val(SubStr(cCPF,09,01))
nCic10  := Val(SubStr(cCPF,10,01))
nCic11  := Val(SubStr(cCPF,11,01))

// Consistencia do 1╖ Numero do Digito
nXcic := (nCic01 * 10) + (nCic02 * 9) + (nCic03 * 8) + (nCic04 * 7) + (nCic05 * 6)
nXcic += (nCic06 *  5) + (nCic07 * 4) + (nCic08 * 3) + (nCic09 * 2)
nYcic := Int( nXcic / 11 )
nWcic := nYcic * 11
nKcic := nXcic - nWcic

If nKcic = 0 .OR. nKcic = 1
	nDig1Cic := 0
Else
	nDig1Cic := 11 - nKcic
EndIf

If nDig1Cic != nCic10
	If !lMeuRh
		Help(" ",1, "CPFINVALID")
		Return (.F.)
	Else	
		Return(.F.)
	EndIf		
EndIf

// Consistencia do 2╖ Numero do Digito
nXcic := (nCic01 * 11) + (nCic02 * 10) + (nCic03 * 9) + (nCic04 * 8) + (nCic05 * 7)
nXcic += (nCic06 *  6) + (nCic07 *	5) + (nCic08 * 4) + (nCic09 * 3) + (nCic10 * 2)
nYcic = Int( nXcic / 11 )
nWcic = nYcic * 11
nKcic = nXcic - nWcic

If nKcic = 0 .OR. nKcic = 1
	nDig2Cic = 0
Else
	nDig2Cic = 11 - nKcic
EndIf

If nDig2Cic != nCic11
	If !lMeurh
		Help(" ",1, "CPFINVALID")
		Return (.F.)
	Else	
		Return(.F.)
	EndIf		
EndIf

Return (.T.)

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 ЁChkPIS 	Ё Autor Ё Marcos A. Stiefano	Ё Data Ё 29.06.95 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Verifica PIS												  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Generico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ/*/
Function CHKPIS(cPIS)
Local nPis01 := nPis02 := nPis03 := nPis04 := nPis05 := 0
Local nPis06 := nPis07 := nPis08 := nPis09 := nPis10 := nPis11 := 0
Local nXpis  := nYpis  := nKpis	:= 0
Local nPis	 := 0

nPis01 := Val(SubStr(cPIS,01,01))
nPis02 := Val(SubStr(cPIS,02,01))
nPis03 := Val(SubStr(cPIS,03,01))
nPis04 := Val(SubStr(cPIS,04,01))
nPis05 := Val(SubStr(cPIS,05,01))
nPis06 := Val(SubStr(cPIS,06,01))
nPis07 := Val(SubStr(cPIS,07,01))
nPis08 := Val(SubStr(cPIS,08,01))
nPis09 := Val(SubStr(cPIS,09,01))
nPis10 := Val(SubStr(cPIS,10,01))
nPis11 := Val(SubStr(cPIS,11,01))

nXpis := (nPis01 * 3) + (nPis02 * 2) + (nPis03 * 9) + (nPis04 * 8) + (nPis05 * 7)
nXpis += (nPis06 * 6) + (nPis07 * 5) + (nPis08 * 4) + (nPis09 * 3) + (nPis10 * 2)
nYpis := (nXpis * 10)
nKpis := Mod(nYpis,11)

nPis	:= nPis01+nPis02+nPis03+nPis04+nPis05+nPis06+nPis07+nPis08+nPis09+nPis10+nPis11

If nKpis >= 10
	nKpis := 0
EndIf

IF nKpis != nPis11 .OR. Len(Alltrim(cPis)) < 11
	Help(" ",1, "PISINVALID")
	Return (.F.)
EndIf

IF nPis = 0
	Help(" ",1, "PISINVALID")
	Return (.F.)
EndIf

Return ( .T. )

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤└o	 Ё SepExt	Ё Autor Ё Mauro Sergio Testoni  Ё Data Ё		  Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Separa corretamente o extenso de um valor 				  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe	 Ё SepExt( cExt,nTam1,nTam2,cRet1,cRet2						  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ cExt	- String que cont┌m o extenso de um valor 			  Ё╠╠
╠╠Ё			 Ё nTam1 - Tamanho m═ximo da primeira linha do extenso		  Ё╠╠
╠╠Ё			 Ё nTam2 - Tamanho m═ximo da segunda  linha do extenso		  Ё╠╠
╠╠Ё			 Ё cRet1 - String de retorno com a primeira linha do extenso  Ё╠╠
╠╠Ё			 Ё cRet2 - String de retorno com a segunda  linha do extenso  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Gen┌rico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ */
Function SepExt(cExt,nTam1,nTam2,cRet1,cRet2)
If Len(cExt) > nTam1
	nPos := Rat(" ",Subs(cExt,1,nTam1))
	If nPos >= nTam1
		cRet1 := Subs(cExt,1,nTam1)
		cRet2 := Subs(cExt,nTam1,nTam2)
	Else
		cRet1 := Repl('*',nTam1-nPos)+Subs(cExt,1,nPos)
		cRet2 := Subs(cExt,nPos+1,nTam2)
	EndIf
Else
	cRet1 := cExt
EndIf
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤└o	 Ё fRetPer	Ё Autor Ё Wiliam			    Ё Data Ё		  Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna o extenso do periodo de uma semana.				  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe	 Ё fRetPer( cSemana,dDataPer )								  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ cSemana	- Numero da semana								  Ё╠╠
╠╠Ё			 Ё dDataPer - Data base referente a semana					  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Gen┌rico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ */
Function fRetPer( cSemana,dDataPer ) 
Local cSaveAlias 	:= Alias() 
Local cRetorno   	:= Space(28) 
Local cTurno 		:= SPACE(3)

dDataPer := If( dDataPer==Nil,dDataBase,dDataPer)

cChaveSem := StrZero(Year(dDataPer),4)+StrZero(Month(dDataPer),2) 

dbSelectArea( "RCF" )

If dbSeek( xFilial("RCF")+ cChaveSem  + cTurno + cSemana , .T. ) 
	cRetorno 	:= "Periodo : " + DtoC(RCF->RCF_DTINI,'DDMMYY') + " A " + DtoC(RCF->RCF_DTFIM,'DDMMYY') 
EndIf

dbSelectArea( cSaveAlias )
Return( cRetorno )

/*
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё GpeMail      Ё Autor Ё R.H. Natie       Ё Data Ё 12/08/01 Ё╠╠
╠╠цддддддддддеддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Envia emails                                              |╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё gpeMail(cSubject,cMensagem,cEMail)                        Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametro Ё cSubject  - Assunto                                       Ё╠╠
╠╠Ё          Ё cMensagem - Corpo do E-mail                               Ё╠╠
╠╠Ё          Ё cEMail     - Conta que recebera o eMail                   Ё╠╠
╠╠Ё          Ё aFiles     - 											 Ё╠╠
╠╠Ё          Ё lMensagem  - Define se exibe aviso de erro de AutenticaГЦoЁ╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё Generico                                                  Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function gpeMail(cSubject,cMensagem,cEMail,aFiles,lMensagem, cError)

Local lEnvioOK 		:= .F.	// Variavel que verifica se foi conectado OK
Local lMailAuth		:= SuperGetMv("MV_RELAUTH",,.F.)
Local cMailServer	:= SuperGetMv("MV_RELSERV",, "")
Local cMailConta	:= SuperGetMV("MV_RELACNT",, "")
Local cMailSenha	:= SuperGetMV("MV_RELPSW" ,, "")
Local lUseSSL		:= SuperGetMV("MV_RELSSL" ,,.F.)
Local lUseTLS		:= SuperGetMV("MV_RELTLS" ,,.F.)
Local oMail			:= NIL
Local nErro			:= 0
Local nArqErro		:= 0
Local cMsgErro		:= ""
Local cUsuario		:= SubStr(cMailConta,1,At("@",cMailConta)-1)
Local cFrom         := SuperGetMV("MV_RELFROM",,"" )
Local oMessage		:= NIL
Local nPort			:= 0
Local nAt			:= 0
Local cServer		:= ""
Local nX			:= 0
Local lErroFile	    := .F.

DEFAULT aFiles 		:= {}
DEFAULT lMensagem 	:= .T.
DEFAULT cError		:= ""

//Em servidores linux, И necessАrio que os arquivos estejam em caracteres minusculos
If GetSrvInfo()[2] == "Linux"
    For nX := 1 to len(aFiles)
        aFiles[nx] := Lower(aFiles[nX]) 
	Next nX
EndIf 

If Empty(cFrom)
	If At("@",cMailConta) > 0
		cFrom := cMailConta
	Else
		MsgAlert( OemToAnsi( STR0024 ) )
		Return Nil
	EndIf
EndIf

If (!Empty(cMailServer)) .AND. (!Empty(cMailConta)) .AND. (!Empty(cMailSenha))
	
	oMail	:= TMailManager():New()
	oMail:SetUseSSL(lUseSSL)
	oMail:SetUseTLS(lUseTLS)
	nAt	:=  At(':' , cMailServer)
	
	// Para autenticacao, a porta deve ser enviada como parametro[nSmtpPort] na chamada do mИtodo oMail:Init().
	// A documentacao de TMailManager pode ser consultada por aqui : http://tdn.totvs.com/x/moJXBQ
	If ( nAt > 0 )
		cServer		:= SubStr(cMailServer , 1 , (nAt - 1) )
		nPort		:= Val(AllTrim(SubStr(cMailServer , (nAt + 1) , Len(cMailServer) )) )
	Else
		cServer		:= cMailServer
	EndIf
	
	oMail:Init("", cServer, cMailConta, cMailSenha , 0 , nPort)	
	//Init( < cMailServer >, < cSmtpServer >, < cAccount >, < cPassword >, [ nMailPort ], [ nSmtpPort ] )
	
	nErro := oMail:SMTPConnect()
		
	If ( nErro == 0 )

		If lMailAuth

			// try with account and pass
			nErro := oMail:SMTPAuth(cMailConta, cMailSenha)
			If nErro != 0
				// try with user and pass
				nErro := oMail:SMTPAuth(cUsuario, cMailSenha)
				If nErro != 0
				    If lMensagem 
						If cError <> "S"
							Aviso(OemToAnsi(STR0022),OemToAnsi(STR0023) + CHR(13) + oMail:GetErrorString(nErro) ,{"Ok"})	//"Atencao"###"Falha na conexЦo com servidor de e-mail"	
						Else
							// "Falha na AutenticaГЦo no Envio do E-mail - Verifique o conteЗdo dos parБmetros MV_RELACNT / MV_RELPSW."   
							cError	:= OemToAnsi(STR0027)
						EndIf
					EndIf
					Return Nil
				EndIf
			EndIf
		Endif
		
		oMessage := TMailMessage():New()
		
		//Limpa o objeto
		oMessage:Clear()
		
		//Popula com os dados de envio
		oMessage:cFrom 		:= cFrom
		oMessage:cTo 		:= cEmail
		oMessage:cCc 		:= ""
		oMessage:cBcc 		:= ""
		oMessage:cSubject 	:= cSubject
		oMessage:cBody 		:= cMensagem
		
		For nX :=1 to Len(aFiles)
			nArqErro := oMessage:AttachFile( aFiles[nX] )
			
			If (nArqErro < 0)
				If cError <> "S"
					Aviso(OemToAnsi(STR0022) + OemToAnsi(STR0023),"Falha no envio do e-mail. Erro retornado: " + CHR(13) + cMsgErro,{"OK"})
				Else
					// "Falha de Anexo de Arquivo - Verifique as configuraГУes de permissЦo do caminho indicado no parБmetro MV_RELT." 
					cError := OemToAnsi(STR0026)
				EndIf
				lErroFile	:= .T.
				Exit
			EndIf
		Next		
		
		If !lErroFile
			//Envia o e-mail
			nErro := oMessage:Send( oMail )
			
			If !(nErro == 0)
				cMsgErro := oMail:GetErrorString(nErro)
				If cError <> "S"					
					Aviso(OemToAnsi(STR0022) + OemToAnsi(STR0023),"Falha no envio do e-mail. Erro retornado: " + CHR(13) + cMsgErro,{"OK"})
				Else
					// "Falha no Envio do E-mail - Verifique o email (RA_EMAIL) do funcionАrio." 
					cError	:= OemToAnsi(STR0025)
				EndIf
			Else
				lEnvioOk	:= .T.
			EndIf
		EndIf

		//Desconecta do servidor
		oMail:SmtpDisconnect()
		
	Else
		If cError <> "S"
			cMsgErro := oMail:GetErrorString(nErro)
			Aviso(OemToAnsi(STR0022),OemToAnsi(STR0023) + CHR(13) + cMsgErro ,{"Ok"})	//"Atencao"###"Falha na conexЦo com servidor de e-mail"
		Else
			// "Falha na ConexЦo com Servidor de E-mail -Verifique a configuraГЦo de Servidor de Email no mСdulo SIGACFG e parБmetros"   
			cError := OemToAnsi(STR0028)
		EndIf
	EndIf
	
Else

	If ( Empty(cMailServer) )
		Help(" ",1,"SEMSMTP")//"O Servidor de SMTP nao foi configurado !!!" ,"Atencao"
	EndIf

	If ( Empty(cMailConta) )
		Help(" ",1,"SEMCONTA")//"A Conta do email nao foi configurado !!!" ,"Atencao"
	EndIf
	
	If Empty(cMailSenha)
		Help(" ",1,"SEMSENHA")	//"A Senha do email nao foi configurado !!!" ,"Atencao"
	EndIf
	
EndIf

Return( lEnvioOK )

/*
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё RH_Email     Ё Autor Ё Emerson Grassi   Ё Data Ё 28/03/02 Ё╠╠
╠╠цддддддддддеддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Funcao que envia email para Funcionarios.		   		 Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё RH_Email()	                                             Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ cEmailTo:	Email do Destinatario.                       Ё╠╠
╠╠Ё		     Ё cEmailCC:	Outras Contas para mandar Copia do email.    Ё╠╠
╠╠Ё		     Ё cAssunto:	Assunto do Email.							 Ё╠╠
╠╠Ё		     Ё cMensagem:	Mensagem do Corpo do email.                  Ё╠╠
╠╠Ё		     Ё cAttach:		Arquivos a serem attachados no email.    	 Ё╠╠
╠╠Ё			 Ё cChave:		Filial + Matricula do funcionario.  		 Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁObservacaoЁ Utilizar a Funcao RH_ErroMail() para verificar erros 	 Ё╠╠
╠╠Ё			 Ё retornado por esta funcao.								 Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё Generica                                                  Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function RH_Email(cEmailTo,cEmailCC,cAssunto,cMensagem,cAttach,cChave)
	Local aSaveArea		:= GetArea()
	Local lOk			:= .F.		// Variavel que verifica se foi conectado OK
	Local lSendOk		:= .F.		// Variavel que verifica se foi enviado OK
	Local cNome			:= ""
	Local cMailConta	:=SUPERGETMV("MV_EMCONTA")
	Local cMailServer	:=SUPERGETMV("MV_RELSERV")
	Local cMailSenha	:=SUPERGETMV("MV_EMSENHA")
	Local lMailAuth		:=GETMV("MV_RELAUTH")
	Local nErro			:= 0
	Local cUsuario		:= "" 
		
	Default cEmailTo:= ""
	Default cEmailCC:= ""
	Default cAssunto:= ""
	Default cMensagem:= ""
	Default cAttach:= ""
	Default cChave:= ""
	
	//Verifica se existe o SMTP Server
	If 	Empty(cMailServer)
		nErro := 1
		RestArea(aSaveArea)
		Return(nErro)
	EndIf
	
	//Verifica se existe a CONTA 
	If 	Empty(cMailConta)
		nErro := 2
		RestArea(aSaveArea)
		Return(nErro)
	EndIf
	
	//Verifica se existe a Senha
	If 	Empty(cMailSenha) 
		nErro := 3
		RestArea(aSaveArea)
		Return(nErro)
	EndIf                                              
	         
	cUsuario		:=  SubStr(cMailConta,1,At("@",cMailConta)-1)
	If cChave != "" .And. Empty(cEmailTo)	//Busca email no Cadastro de Funcionario.
	
		dbSelectArea("SRA")
		dbSetOrder(1)
		If dbSeek(cChave)
			cEmailTo := ALLTRIM(SRA->RA_EMAIL)
			cNome	 := SRA->RA_NOME
		EndIf
	EndIf	
	
	//Verifica se existe email do Destinatario
	If 	Empty(cEmailTo)
		nErro := 4
		RestArea(aSaveArea)
		Return(nErro)
	EndIf      
	
	// Envia e-mail com os dados necessarios
	If !Empty(cMailServer) .AND. !Empty(cMailConta) .AND. !Empty(cMailSenha)
		CONNECT SMTP SERVER cMailServer ACCOUNT cMailConta PASSWORD cMailSenha RESULT lOk
		If 	lOk     
			If lMailAuth
				If !MailAuth(cMailConta,cMailSenha)
					MailAuth(cUsuario, cMailSenha)
				EndIf
			EndIf                                                                     
				SEND MAIL 	FROM cMailConta;
						TO cEmailTo;
	 					BCC cEmailcc;					
						SUBJECT cAssunto;
						BODY cMensagem;  
						ATTACHMENT cAttach;					
						RESULT lSendOk 
			If !lSendOk
				//Erro no Envio do e-mail
				nErro := 5
			EndIf
			DISCONNECT SMTP SERVER
		Else
			//Erro na conexao com o SMTP Server
			nErro := 5
		EndIf
	EndIf                   
	
	RestArea(aSaveArea)
Return nErro

/*
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддддбдддддддбддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё RH_ErroMail  Ё Autor Ё Emerson Grassi   Ё Data Ё 28/03/02 Ё╠╠
╠╠цддддддддддеддддддддддддддадддддддаддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Funcao que Retorna erros ocorridos no envio de emails.	 Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё RH_ErroMail(nErro)                                        Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ nErro: Numero do Erro retornado pela funcao RH_Email().   Ё╠╠
╠╠Ё			 Ё cNome: Nome do Destinatario(Funcionario). 				 Ё╠╠
╠╠цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё Generica                                                  Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function RH_ErroMail(nErro,cNome)
	Local lRet	:= .T.
	
	cNome := IIf(cNome == Nil, "", cNome)  
	
	If nErro != 0                                                                     
		Do Case
			Case nErro == 1
				Help(" ",1, "SEMSMTP")//"O Servidor de SMTP nao foi configurado !!!" , "Atencao"
			
			Case nErro == 2
				Help(" ",1, "SEMCONTA")//"A Conta do email nao foi configurado !!!" , "Atencao"		
				
			Case nErro == 3
				Help(" ",1, "SEMSENHA")	//"A Senha do email nao foi configurado !!!" , "Atencao"		
				
			Case nErro == 4
				Aviso(OemToAnsi(STR0018),OemToAnsi(STR0019+cNome),{"Ok"})	//"Atencao"###"Nao foi informado o email do destinatario "		
			               
			Case nErro == 5
				Aviso(OemToAnsi(STR0018),OemToAnsi(STR0020),{"Ok"}) //"Erro no envio de Email" 

			Case nErro == 6 //Erro implementado na funcao VDFEmail (VDFXFUN.PRW)
				Aviso(OemToAnsi(STR0018),OemToAnsi(STR0021),{"Ok"}) //"Erro na conexЦo com o SMTP Server."
		
		EndCase
		lRet := .F.
	EndIf	
Return lRet

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁValAsc    ╨Autor  ЁSilvia Taguti       ╨ Data Ё  28/12/04   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё Retorna o Valor correspondente as letras do Nome           ╨╠╠
╠╠╨          Ё                                                            ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё AP                                                        ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
*/
                                                             
Function ValAsc(cLetNome)   
          
Local nValAsc := 0

If cLetNome >= "A" .AND. cLetNome <= "I"
	nValAsc := Asc(cLetNome) - 54
ElseIf cLetNome >= "J" .AND. cLetNome <= "R"
	nValAsc := Asc(cLetNome) - 53	
ElseIf cLetNome >= "S" .AND. cLetNome <= "Z"
	nValAsc := Asc(cLetNome) - 51
ElseIf cLetNome >= "0" .AND. cLetNome <= "9"
	nValAsc := Asc(cLetNome) - 48
ElseIf cLetNome = " " 
   nValAsc := 0
Else
   If cLetNome = "&" .OR. cLetNome = Chr(209) .OR. cLetNome = Chr(241)
      nValAsc :=10
   Else
      nValAsc = 0
   EndIf   
EndIf			

Return nValAsc	

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁValAscI   ╨Autor  ЁSilvia Taguti       ╨ Data Ё  29/12/04   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁRetorna valor das letras do nome                            ╨╠╠
╠╠╨          Ё                                                            ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё AP                                                        ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
*/

Function ValAscI(cLetNom)

Local nValAsc := 0

If cLetNom >= "A" .AND. cLetNom <= "N" 
	nvalasc := Asc(cLetNom) - 55
ElseIf cLetNom >= "O" .AND. cLetNom <= "Z" 
	nValAsc := Asc(cLetNom) - 54
ElseIf cLetNom >= "0" .AND. cLetNom <= "9" 
	nValAsc := Asc(cLetNom) - 48
ElseIf cLetNom == "&" 
	nValAsc := 24
ElseIf cLetNom == " " 
	nValAsc := 37
Else
	If cLetNom == "&" .OR. cLetNom == Chr(209) .OR. cLetNom == Chr(241)
		nValAsc := 10
	Else
		nValAsc := 0
	End If
EndIf

Return nValAsc

/*                                	
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    Ё fRHLoadImg		ЁAutorЁAlceu Pereira/IgorFЁ Data Ё13/01/2010Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁCarrega imagens para impressao								Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё< Vide Parametros Formais >									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Uso      ЁGenИrico													Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Retorno  ЁaRotina														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ< Vide Parametros Formais >									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/   
Function fRHLoadImg(cNomeArq)

Local  cStartPath:= GetSrvProfString("Startpath", "")

If Substr(cStartPath, len(cStartPath), 1) == "\"
	cImagem := cStartPath + cNomeArq
Else
	cImagem := cStartPath + "\" + cNomeArq
EndIf

Return cImagem


/*/{Protheus.doc} GetEAIVers
	Obtem a versЦo do Adapter EAI de <cMessage>
@author PHILIPE.POMPEU
@since 22/07/2015
@version P12
@param cMessage, caractere, Nome da Mensagem ( ex: MONTHLYPAYROLL )
@param cAlterna, caractere, valor de retorno alternativo caso nЦo encontrado
@param lHasFound, lСgico, valor deve ser passado por referЙncia para
 ser utilizado, coloca a variАvel como .F. caso nЦo encontre
@return cResult,caractere, versЦo do Adapter
@sample GetEAIVers('MONTHLYPAYROLL','1.000',@lValue)
/*/
Function GetEAIVers(cMessage,cAlterna,lHasFound)
	Local aArea	:= XX4->(GetArea())
	Local cResult := ''
	Default cMessage	:= 'WHOIS'
	Default cAlterna	:= ''
	Default lHasFound	:= .T.
	
	cResult := FwXX4Version(cMessage)
	
	if(Empty(cResult))
		lHasFound	:= .F.
		cResult	:= cAlterna
	endIf
	
	RestArea(aArea)
Return (AllTrim(cResult))
