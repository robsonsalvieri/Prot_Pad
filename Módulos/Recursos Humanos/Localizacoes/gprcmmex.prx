#INCLUDE "PROTHEUS.CH"

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun??o    ³GPRCMMEX      ³Autor³ Gerado pelo sistema ³ Data ³21/06/2024³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri??o ³Verbas padroes                                              ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GPRCMMEX( aAusent, aRCMHeader )
Local nPosAusent 	:= 0
Local lRet	  		:= .T.

DEFAULT aAusent 		:= {}
DEFAULT aRCMHeader	:= {}

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Cabecalho de RCM                                           ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd(aRCMHeader, { 'Sucursal','RCM_FILIAL','','8','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRCMHeader, { 'Cod.Ausencia','RCM_TIPO','@!','3','0','EXISTCHAV("RCM")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','                                                                                                                                ','GETSX8NUM("RCM","RCM_TIPO")','','A','','','.T.' })
aAdd(aRCMHeader, { 'Desc.Ausenc.','RCM_DESCRI','@!','75','0','NAOVAZIO()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.T.' })
aAdd(aRCMHeader, { 'Cod.Concepto','RCM_PD','','3','0','VAZIO() .OR. ( EXISTCPO("SRV" ) .And. IsLeeAus(.T., M->RCM_PD,.T.))','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','SRVAUS','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Ausenc.Prog.','RCM_PROG','@!','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Si;2=No                                                                                                                       ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Tp Aus. IMSS','RCM_TPIMSS','9','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','1=Faltas;2=Incapacidad;3=Ninguno                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Tipo Dia','RCM_TIPODI','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','1=Habiles;2=Corridos                                                                                                            ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Tp.Ausencia','RCM_TIPOAF','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','1=Ausencia sin Pago;2=Ausencia con Pago;3=Informativo;4=Programacion de Periodos                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Dias Pg Empr','RCM_DIASEM','999','3','0','gp430DEmpValid()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','N','      ','R','                                                                                                                                ','0','','A','','','.F.' })
aAdd(aRCMHeader, { 'Superposic.','RCM_SOBREP','9','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','1=Si;2=No                                                                                                                       ','','','A','','','.T.' })
aAdd(aRCMHeader, { 'Dias no Pag.','RCM_DNPIMS','999','3','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','N','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Aplica 7mo','RCM_7MODIA','@!','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','1=Si;2=No                                                                                                                       ','"2"','','A','','','.F.' })
aAdd(aRCMHeader, { 'Tip.Aus.Vac.','RCM_FERIAS','@!','1','0','PERTENCE(" 123")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Descuenta;2=No Descuenta                                                                                                      ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Desc.Avos Ag','RCM_DECIMO','@!','1','0','PERTENCE(" 12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Si;2=No                                                                                                                       ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Prov. Vacac.','RCM_PROVFE','@!','1','0','PERTENCE(" 123")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Congela;2=No Congela;3=Congela después de 6 meses                                                                             ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Prov. Aguin.','RCM_PROV13','@!','1','0','PERTENCE(" 12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Congela;2=No Congela                                                                                                          ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Días Lic.13.','RCM_DIAS13','999','3','0','Positivo()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','N','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Días Lic.PLR','RCM_DIASPL','999','3','0','Positivo()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','N','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Días Lic.Vac','RCM_DIASFE','999','3','0','Positivo()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','N','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'D.Estab.','RCM_DIAEST','999','3','0','Positivo()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','N','      ','R','                                                                                                                                ','0','','A','','','.F.' })
aAdd(aRCMHeader, { 'Letra Kardex','RCM_LETRAK','@!','2','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Col. Kardex','RCM_CORK','@!','30','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'N.Mes.C.Med.','RCM_MESMED','99','2','0','Gp430MesMed()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','N','      ','R','                                                                                                                                ','0','','A','','','.F.' })
aAdd(aRCMHeader, { 'Cat.Cálc.Pro','RCM_CATMED','@!','15','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','GPESIT','R','                                                                                                                                ','','GP430CatMed()','A','','','.F.' })
aAdd(aRCMHeader, { 'Sust. Puesto','RCM_SUBPOS','9','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','1=No;2=Sí                                                                                                                       ','"1"','','A','','','.F.' })
aAdd(aRCMHeader, { 'Tipo SAT','RCM_TIPSAT','@!','2','0','ValidRCC("S032",M->RCM_TIPSAT,1,2)','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','S32MEX','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRCMHeader, { 'Cont.Exp.RH','RCM_RHEXP','@!','6','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRCMHeader, { 'Desc.Aviso','RCM_ABATAV','9','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','1=Sí;2=No                                                                                                                       ','"2"','','A','','','.T.' })

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Validar a Estrutura das Tabela RCM                           ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
lRet := fNewOldSx3(aRCMHeader, NIL, "RCM", NIL, .F.)

If lRet
		ItensAusent (aAusent)

EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Fun??o    ³ItensAusent (aAusent)³Autor³ Gerado pelo sistema ³ Data ³21/06/2024³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Descri??o ³Tipos Ausent padroes da tabela RCM                                      ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                          ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                           ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Static Function ItensAusent (aAusent)

DEFAULT aAusent := {}

aAdd(aAusent, { '','102','Incapacidad AT','102','','2','2','1',999,'1',0,'2','','','','',0,0,0,0,'','',0,'','','01','','2'} )
aAdd(aAusent, { '','103','Incapacidad EG','103','','2','2','1',999,'1',0,'2','','','','',0,0,0,0,'','',0,'','','02','','2'} )
aAdd(aAusent, { '','104','Incapacidad MT','104','','2','2','1',999,'1',0,'2','','','','',0,0,0,0,'','',0,'','','03','','2'} )
aAdd(aAusent, { '','105','Faltas Injustificadas','105','','1','1','1',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','106','Castigo','106','','3','1','1',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','107','Permiso con Goce de Sueldo','107','','3','1','2',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','108','Permiso sin Goce de Sueldo','108','','3','1','1',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','109','Prestación Empresa','109','','3','1','2',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','110','Incapacidad Empresa','110','','3','1','2',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','111','Comisión Sindical','111','','3','1','2',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','112','Dias Económicos','112','','3','1','2',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','113','Vacaciones','113','','3','1','4',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )
aAdd(aAusent, { '','119','Permiso Paternidad','119','','3','1','2',999,'2',0,'2','','','','',0,0,0,0,'','',0,'','','','','2'} )

Return( NIL )