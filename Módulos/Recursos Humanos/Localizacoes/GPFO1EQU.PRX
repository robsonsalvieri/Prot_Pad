/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpFo1EQU      ³Autor³ Gerado pelo sistema ³ Data ³27/02/2013³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Programa de Continuacao das formulas                        ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0111    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0111( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOB','SALARIO BASE MES DOS FUNCIONAR','SALARIO','001065','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOB','SALMES     .END.','000001','000000','.EXE.','2','SALMES','','1','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0112    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0112( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOD','SALARIO DIA DOS FUNCIONARIOS','SALDIA','001066','003','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','sra->ra_salario / 30   .END.','000003','000002','.EXE.','1','sra->ra_salario','/','5','30','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_TIPOPGT = "S" .AND.','000004','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC = "S" .END.','000005','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO / 7   .END.','000006','000005','.EXE.','1','SRA->RA_SALARIO','/','5','7','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC $ "H*T*G" .END.','000007','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO * SRA->RA_HRSMES / 30 .END.','000008','000007','.EXE.','1','SRA->RA_SALARIO','*','1','SRA->RA_HRSMES','/','5','30','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC = "D" .END.','000009','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO     .END.','000010','000009','.EXE.','1','SRA->RA_SALARIO','','5','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0113    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0113( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOH','SALARIO HORA DOS FUNCIONARIOS','SALHORA','001067','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','sra->ra_salario / SRA->RA_HRSMES   .END.','000003','000002','.EXE.','1','sra->ra_salario','/','1','SRA->RA_HRSMES','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_TIPOPGT = "S" .AND.','000004','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC = "S" .END.','000005','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SALHORA := SRA->RA_SALARIO / 7 .CNT.','000006','000005','.EXE.','2','SALHORA',':=','1','SRA->RA_SALARIO','/','5','7','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SALHORA *= 30 / SRA->RA_HRSMES .END.','000007','000005','.EXE.','2','SALHORA','*=','5','30','/','1','SRA->RA_HRSMES','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC $ "H*T*G" .END.','000008','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_SALARIO     .END.','000009','000008','.EXE.','1','SRA->RA_SALARIO','','5','','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC = "D" .END.','000010','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_SALARIO * 30 / SRA->RA_HRSMES .END.','000011','000010','.EXE.','1','SRA->RA_SALARIO','*','5','30','/','1','SRA->RA_HRSMES','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0114    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0114( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOM','SALARIO MENSAL DOS FUNCIONARIO','','001068','008','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := sra->ra_salario   .CNT.','000003','000002','.EXE.','5','SALMES',':=','5','sra->ra_salario','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000004','000002','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000005','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_TIPOPGT = "S" .AND.','000006','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC = "S" .END.','000007','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO / 7 * 30 .CNT.','000008','000007','.EXE.','5','SALMES := SRA->RA_SALARIO','/','5','7','*','5','30','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000009','000007','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000010','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "H*T*G" .AND.','000011','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTipoRot == "1" .END.','000012','000000','.CON.','2','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','NCOMPHRS := nHorasTrab + nHorasDSR .CNT.','000013','000012','.EXE.','2','NCOMPHRS',':=','5','nHorasTrab','+','5','nHorasDSR','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * NCOMPHRS   .CNT.','000014','000012','.EXE.','5','SALMES := SRA->RA_SALARIO','*','2','NCOMPHRS','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000015','000012','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000016','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC == "H" .AND.','000017','000000','.CON.','2','','','1','SRA->RA_CATFUNC','==','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTipoRot == "2I" .AND.','000018','000000','.CON.','2','','','5','cTipoRot','==','5','"2I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cCompMes == "S" .AND.','000019','000000','.CON.','2','','','2','cCompMes','==','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTip == "B" .END.','000020','000000','.CON.','2','','','2','cTip','==','5','"B"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','NCOMPHRS := nHorasTrab + nHorasDSR .CNT.','000021','000020','.EXE.','2','NCOMPHRS',':=','5','nHorasTrab','+','5','nHorasDSR','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * NCOMPHRS   .CNT.','000022','000020','.EXE.','5','SALMES := SRA->RA_SALARIO','*','2','NCOMPHRS','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000023','000020','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000024','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "H*T*G" .END.','000025','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * SRA->RA_HRSMES   .CNT.','000026','000025','.EXE.','5','SALMES := SRA->RA_SALARIO','*','1','SRA->RA_HRSMES','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000027','000025','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000028','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC = "D" .END.','000029','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * 30   .END.','000030','000029','.EXE.','5','SALMES := SRA->RA_SALARIO','*','5','30','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0115    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0115( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALINC','SALARIO INCORPORADO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRC()     .CNT.','000001','000000','.EXE.','5','S_CARGASRC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRK()     .CNT.','000002','000000','.EXE.','5','S_CARGASRK()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARGB()     .CNT.','000003','000000','.EXE.','5','S_CARGARGB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCH()     .CNT.','000004','000000','.EXE.','5','S_CARGARCH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGATAB()     .CNT.','000005','000000','.EXE.','5','S_CARGATAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCF()     .CNT.','000006','000000','.EXE.','5','S_CARGARCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCM()     .CNT.','000007','000000','.EXE.','5','S_CARGARCM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRF()     .CNT.','000008','000000','.EXE.','5','S_CARGASRF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASR8()     .CNT.','000009','000000','.EXE.','5','S_CARGASR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRB()     .CNT.','000010','000000','.EXE.','5','S_CARGASRB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARG1()     .CNT.','000011','000000','.EXE.','5','S_CARGARG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCRGB()     .CNT.','000012','000000','.EXE.','5','S_PROCRGB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSR8()     .CNT.','000013','000000','.EXE.','5','S_PROCSR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_DIASTRAB()     .CNT.','000014','000000','.EXE.','5','S_DIASTRAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOM()     .CNT.','000015','000000','.EXE.','5','S_SALARIOM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOD()     .CNT.','000016','000000','.EXE.','5','S_SALARIOD()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOH()     .CNT.','000017','000000','.EXE.','5','S_SALARIOH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOB()     .CNT.','000018','000000','.EXE.','5','S_SALARIOB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CALCDSR()     .CNT.','000019','000000','.EXE.','5','S_CALCDSR()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_GRAVASAL()     .CNT.','000020','000000','.EXE.','5','S_GRAVASAL()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCRG1()     .CNT.','000021','000000','.EXE.','5','S_PROCRG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSRC()     .END.','000022','000000','.EXE.','5','S_PROCSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0116    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0116( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALMIN','SALARIO MINIMO','VAL_SALMIN','000268','011','2','1',} )

aAdd(aRc3Cols, { '','S_','SALMIN','VAL_SALMIN := FTABELA("S014",1,4, dDataRef)     .CNT.','000001','000000','.EXE.','5','VAL_SALMIN := FTABELA("S014",1,4, dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALMIN','Type("VAL_SALMIN") = "U" .END.','000002','000000','.CON.','5','','','5','Type("VAL_SALMIN")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALMIN','VAL_SALMIN := 0   .END.','000003','000002','.EXE.','5','VAL_SALMIN',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0117    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0117( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SDOSALA','CALCULA SALDO DE SALARIO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SDOSALA','CVERBA := FGETCODFOL("0048")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("0048")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','EMPTY(CVERBA)   .END.','000002','000000','.CON.','5','','','5','EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','CMSGLOG := FMSGFORM({19}) + "0048 - " + FDESC("RCN", "0048",','000003','000002','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0048 - " + FDESC("RCN", "0048", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','S_MSGLOG()     .CNT.','000004','000002','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','FINALFUN()     .END.','000005','000002','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','nPos := fPosTab("S018", cTipRes, "==", 04)     .CNT.','000006','000000','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','nPos > 0 .And. fTabela("S018", nPos, 6) == "S"   .END.','000007','000000','.CON.','5','','','5','nPos > 0 .And. fTabela("S018", nPos, 6) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','NVALOR := ROUND( (SALMES / 30) * DIASTRAB,MSDECIMAIS(1))','000008','000007','.EXE.','5','NVALOR := ROUND( (SALMES / 30) * DIASTRAB,MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVERBA,ROUND(','000009','000007','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVERBA,ROUND(NVALOR,2),DIASTRAB})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0118    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0118( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','VACPEND','CALCULA VACACIONES PENDENTES','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','VACPEND','fTabela("S018", 01, 04) = Nil   .END.','000001','000000','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACPEND','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000002','000001','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','S_MSGLOG()     .CNT.','000003','000001','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','FINALFUN()     .END.','000004','000001','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nPos := fPosTab("S018", cTipRes, "==", 04)     .CNT.','000005','000000','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nPos > 0 .And. fTabela("S018", nPos, 07) == "S"   .END.','000006','000000','.CON.','5','','','5','nPos > 0 .And. fTabela("S018", nPos, 07) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACPEND','aPerFerias:= {}     .CNT.','000007','000006','.EXE.','5','aPerFerias:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDFerAve:= 0     .CNT.','000008','000006','.EXE.','5','nDFerAve:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nSubSal := 0     .CNT.','000009','000006','.EXE.','5','nSubSal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nValFer := 0     .CNT.','000010','000006','.EXE.','5','nValFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDifSub := 0     .CNT.','000011','000006','.EXE.','5','nDifSub := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDferven:= 0     .CNT.','000012','000006','.EXE.','5','nDferven:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','Calc_Fer(@aPerFerias , dDataDem , @nDferven, @nDferave,,,,.F','000013','000006','.EXE.','5','Calc_Fer(@aPerFerias , dDataDem , @nDferven, @nDferave,,,,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','len(aPerFerias) > 0   .END.','000014','000006','.CON.','5','','','5','len(aPerFerias) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nAux:= 1     .CNT.','000015','000014','.EXE.','5','nAux:= 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nAux <= len(aPerFerias)   .END.','000016','000014','.ENQ.','5','','','5','nAux <= len(aPerFerias)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','VACPEND','(aPerFerias[nAux, 1] <= dDataDem) .And. (aPerFerias[nAux,','000017','000016','.CON.','5','','','5','(aPerFerias[nAux, 1] <= dDataDem) .And. (aPerFerias[nAux, 2] > dDataDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDFerProv:= aPerFerias[nAux, 4] - aPerFerias[nAux, 14]     .','000018','000017','.EXE.','5','nDFerProv:= aPerFerias[nAux, 4] - aPerFerias[nAux, 14]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDFerProv:= Max(nDFerProv, 0)     .CNT.','000019','000017','.EXE.','5','nDFerProv:= Max(nDFerProv, 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDiasDir := aPerFerias[nAux, 19]     .CNT.','000020','000017','.EXE.','5','nDiasDir := aPerFerias[nAux, 19]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','DtIniFer := aPerFerias[nAux, 1]     .CNT.','000021','000017','.EXE.','5','DtIniFer := aPerFerias[nAux, 1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','DtFimFer := aPerFerias[nAux, 2]     .END.','000022','000017','.EXE.','5','DtFimFer := aPerFerias[nAux, 2]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nAux++     .END.','000023','000016','.EXE.','5','nAux++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','lAcumPer:= .T.     .CNT.','000024','000014','.EXE.','5','lAcumPer:= .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','S_GETACUFE()     .CNT.','000025','000014','.EXE.','5','S_GETACUFE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nDFerProv > 0 .And. nBaseFer > 0   .END.','000026','000014','.CON.','5','','','5','nDFerProv > 0 .And. nBaseFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nValFer:= nBaseFer / 24     .CNT.','000027','000026','.EXE.','5','nValFer:= nBaseFer / 24','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','nValfer := nValFer + nDifSub     .END.','000028','000029','.EXE.','5','nValfer := nValFer + nDifSub','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000029','000026','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("1230"), NDFERPROV, NBASEFER })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACPEND','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000030','000026','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("0087"), NDFERPROV, nValFer})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0119    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0119( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','VACVENC','VACACIONES VENCIDAS','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','VACVENC','fTabela("S018", 01, 04) = Nil   .END.','000001','000000','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000002','000001','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','S_MSGLOG()     .CNT.','000003','000001','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','FINALFUN()     .END.','000004','000001','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nVlVacVenc:= 0     .CNT.','000005','000000','.EXE.','5','nVlVacVenc:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nSubSal := 0     .CNT.','000006','000000','.EXE.','5','nSubSal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nValFer := 0     .CNT.','000007','000000','.EXE.','5','nValFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDifSub := 0     .CNT.','000008','000000','.EXE.','5','nDifSub := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasFTot:= 0     .CNT.','000009','000000','.EXE.','5','nDiasFTot:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nPos := fPosTab("S018", cTipRes, "==", 04)     .CNT.','000010','000000','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nPos > 0 .And. fTabela("S018", nPos, 07) == "S"   .END.','000011','000000','.CON.','5','','','5','nPos > 0 .And. fTabela("S018", nPos, 07) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','fo_GoTop(@oSRF)     .CNT.','000012','000011','.EXE.','5','fo_GoTop(@oSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','!fo_Eof(@oSRF)   .END.','000013','000011','.ENQ.','5','','','5','!fo_Eof(@oSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','VACVENC','( fo_GetVal(@oSRF,"RF_PD") == fGetCodFol("0072") ) .And. (','000014','000013','.CON.','5','','','5','( fo_GetVal(@oSRF,"RF_PD") == fGetCodFol("0072") ) .And. ( fo_GetVal(@oSRF,"RF_DATABAS") <= dDataDem )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','fo_GetVal(@oSRF,"RF_STATUS") $ " *1"   .END.','000015','000014','.CON.','5','','','5','fo_GetVal(@oSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','DtIniFer := fo_GetVal(@oSRF,"RF_DATABAS")     .CNT.','000016','000015','.EXE.','5','DtIniFer := fo_GetVal(@oSRF,"RF_DATABAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','DtFimFer := fo_GetVal(@oSRF,"RF_DATAFIM")     .CNT.','000017','000015','.EXE.','5','DtFimFer := fo_GetVal(@oSRF,"RF_DATAFIM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasDir:= fo_GetVal(@oSRF,"RF_DIASDIR")     .CNT.','000018','000015','.EXE.','5','nDiasDir:= fo_GetVal(@oSRF,"RF_DIASDIR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasFVe:= fo_GetVal(@oSRF,"RF_DFERVAT") + fo_GetVal(@oSRF,"','000019','000015','.EXE.','5','nDiasFVe:= fo_GetVal(@oSRF,"RF_DFERVAT") + fo_GetVal(@oSRF,"RF_DBONVAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasDes:= fo_GetVal(@oSRF,"RF_DFERANT") + fo_GetVal(@oSRF,"','000020','000015','.EXE.','5','nDiasDes:= fo_GetVal(@oSRF,"RF_DFERANT") + fo_GetVal(@oSRF,"RF_DBONGOZ") + fo_GetVal(@oSRF,"RF_DBONANT") + fo_GetVal(@oSRF,"RF_DIASANT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasFVe-= nDiasDes     .CNT.','000021','000015','.EXE.','5','nDiasFVe-= nDiasDes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasGoz:= 0     .CNT.','000022','000015','.EXE.','5','nDiasGoz:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','Procura em SRH se nao houve ferias calculadas referentes a e','000023','000015','.MSG.','5','Procura em SRH se nao houve ferias calculadas referentes a este periodo aquisitivo','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','VACVENC','fPosReg("SRH", 1 , SRA->RA_FILIAL + SRA->RA_MAT + DtoS(DtIni','000024','000015','.EXE.','5','fPosReg("SRH", 1 , SRA->RA_FILIAL + SRA->RA_MAT + DtoS(DtIniFer) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','!SRH->(Eof()) .AND. SRH->RH_FILIAL+SRH->RH_MAT+DtoS(SRH->R','000025','000015','.ENQ.','5','','','5','!SRH->(Eof()) .AND. SRH->RH_FILIAL+SRH->RH_MAT+DtoS(SRH->RH_DATABAS) == SRA->RA_FILIAL+SRA->RA_MAT+DtoS(DtIniFer)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','VACVENC','SRH->RH_PERIODO = cPeriodo   .END.','000026','000025','.CON.','5','','','5','SRH->RH_PERIODO = cPeriodo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasGoz += SRH->RH_DFERIAS     .CNT.','000027','000026','.EXE.','5','nDiasGoz += SRH->RH_DFERIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasGoz += SRH->RH_DBONIFI     .END.','000028','000026','.EXE.','5','nDiasGoz += SRH->RH_DBONIFI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','SRH->(dbSkip())     .END.','000029','000025','.EXE.','5','SRH->(dbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasFVe-= nDiasGoz     .CNT.','000030','000015','.EXE.','5','nDiasFVe-= nDiasGoz','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasFVe > 0   .END.','000031','000015','.CON.','5','','','5','nDiasFVe > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','S_GETACUFE()     .CNT.','000032','000031','.EXE.','5','S_GETACUFE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nBaseFer > 0   .END.','000033','000031','.CON.','5','','','5','nBaseFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nValFer := nBaseFer / 24     .CNT.','000034','000033','.EXE.','5','nValFer := nBaseFer / 24','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nSubSal := ( SRA->RA_SALARIO * P_PercProv ) / 100     .CNT.','000035','000033','.EXE.','5','nSubSal := ( SRA->RA_SALARIO * P_PercProv ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nValfer < nSubsal   .END.','000036','000033','.CON.','5','','','5','nValfer < nSubsal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDifSub := NSubSal - nValFer     .CNT.','000037','000036','.EXE.','5','nDifSub := NSubSal - nValFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nValFer := NvalFer + nDifSub     .END.','000038','000036','.EXE.','5','nValFer := NvalFer + nDifSub','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nDiasFTot+= nDiasFVe     .CNT.','000039','000033','.EXE.','5','nDiasFTot+= nDiasFVe','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','nVlVacVenc+= (nValfer / nDiasDir) * nDiasFVe     .END.','000040','000033','.EXE.','5','nVlVacVenc+= (nValfer / nDiasDir) * nDiasFVe','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','fo_Skip(@oSRF)     .END.','000041','000013','.EXE.','5','fo_Skip(@oSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','NBASEFER > 0 .AND.   NVLVACVENC > 0   .END.','000042','000011','.CON.','5','','','5','NBASEFER > 0 .AND.   NVLVACVENC > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VACVENC','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000043','000042','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("1229"), NDIASFTOT, NBASEFER})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VACVENC','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000044','000042','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("0086"), NDIASFTOT, NVLVACVENC})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0120    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0120( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','VALRES','VALORIZA VERBAS NA RESCISAO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','VALRES','FO_GOTOP(@&COBJETO)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','!FO_EOF(@&COBJETO)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO := FO_GETVAL( @&COBJETO , CCPOTIPO1)     .CNT.','000003','000002','.EXE.','5','CTIPO := FO_GETVAL( @&COBJETO , CCPOTIPO1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NDECIMAIS := GETSX3CACHE( CCPOVALOR , "X3_DECIMAL" )     .CN','000004','000002','.EXE.','5','NDECIMAIS := GETSX3CACHE( CCPOVALOR , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','CVERBA := FO_GETVAL( @&COBJETO , CCPOPD)     .CNT.','000005','000002','.EXE.','5','CVERBA := FO_GETVAL( @&COBJETO , CCPOPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO2 := FO_GETVAL( @&COBJETO , CCPOTIPO2)     .CNT.','000006','000002','.EXE.','5','CTIPO2 := FO_GETVAL( @&COBJETO , CCPOTIPO2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR := FO_GETVAL( @&COBJETO , CCPOVALOR)     .CNT.','000007','000002','.EXE.','5','NVALOR := FO_GETVAL( @&COBJETO , CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)     .CNT.','000008','000002','.EXE.','5','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NPERCENT := IF (( NPERCENT := POSSRV(CVERBA, SRA->RA_FILIAL,','000009','000002','.EXE.','5','NPERCENT := IF (( NPERCENT := POSSRV(CVERBA, SRA->RA_FILIAL, "RV_PERC") ) = 0,1,NPERCENT / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR = 0 .AND. CTIPO2 $ " *I*F*G"   .END.','000010','000002','.CON.','5','','','5','NVALOR = 0 .AND. CTIPO2 $ " *I*F*G"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO=="H"   .END.','000011','000010','.CON.','5','','','5','CTIPO=="H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR:=ROUND(NQTD*SALHORA*NPERCENT,NDECIMAIS)     .CNT.','000012','000011','.EXE.','5','NVALOR:=ROUND(NQTD*SALHORA*NPERCENT,NDECIMAIS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)     .END.','000013','000011','.EXE.','5','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO=="D"   .END.','000014','000010','.CON.','5','','','5','CTIPO=="D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR:=ROUND(NQTD*SALDIA * NPERCENT, NDECIMAIS)     .CNT.','000015','000014','.EXE.','5','NVALOR:=ROUND(NQTD*SALDIA * NPERCENT, NDECIMAIS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)     .END.','000016','000014','.EXE.','5','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','FO_SKIP(@&COBJETO)     .END.','000017','000002','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0121    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0121( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','VERBASAC','CARREGA VERBAS PARA PESQUISA P/ HISTORIC','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC := ""     .CNT.','000001','000000','.EXE.','5','CVERBASAC := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0015") ), FGETCODFOL("0','000002','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0015") ), FGETCODFOL("0015")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0066") ), FGETCODFOL("0','000003','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0066") ), FGETCODFOL("0066")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0016") ), FGETCODFOL("0','000004','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0016") ), FGETCODFOL("0016")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0067") ), FGETCODFOL("0','000005','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0067") ), FGETCODFOL("0067")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0064") ), FGETCODFOL("0','000006','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0064") ), FGETCODFOL("0064")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0065") ), FGETCODFOL("0','000007','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0065") ), FGETCODFOL("0065")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("1118") ), FGETCODFOL("1','000008','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("1118") ), FGETCODFOL("1118")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0289") ), FGETCODFOL("0','000009','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("0289") ), FGETCODFOL("0289")+"/","")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VERBASAC','CVERBASAC += IIF(!EMPTY( FGETCODFOL("1187") ), FGETCODFOL("1','000010','000000','.EXE.','5','CVERBASAC += IIF(!EMPTY( FGETCODFOL("1187") ), FGETCODFOL("1187")+"/","")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )