/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpFo1BOL      ³Autor³ Gerado pelo sistema ³ Data ³26/05/2025³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Programa de Continuacao das formulas                        ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0111    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0111( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRGB','PROCESSA INFORMACOES DE RGB PA','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRGB','FO_GOTOP(@ORGB)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@ORGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','!FO_EOF(@ORGB)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@ORGB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")     .CNT.','000003','000002','.EXE.','5','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")     .CNT.','000004','000002','.EXE.','5','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")     .CNT.','000005','000002','.EXE.','5','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")     .CNT.','000006','000002','.EXE.','5','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','NVLRGB := ROUND( NVLRGB, MSDECIMAIS(1) )','000007','000002','.EXE.','5','NVLRGB := Round( nVlRGB, MsDecimais(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")     .CNT.','000008','000002','.EXE.','5','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")     .CNT.','000009','000002','.EXE.','5','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")     .CNT.','000010','000002','.EXE.','5','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")     .CNT.','000011','000002','.EXE.','5','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")     .CNT.','000012','000002','.EXE.','5','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")     .CNT.','000013','000002','.EXE.','5','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")     .CNT.','000014','000002','.EXE.','5','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SEEK(@&COBJETO,{CCPOPD,CCPOSEQ,CCPODTREF},{CPDRGB,CSEQRGB','000015','000002','.CON.','5','','','5','FO_SEEK(@&COBJETO,{CCPOPD,CCPOSEQ,CCPODTREF},{cPDRGB,CSEQRGB,CDTRGB})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SETVAL(@&COBJETO,cCpoTipo1,cTp1RGB)     .CNT.','000016','000015','.EXE.','5','FO_SETVAL(@&COBJETO,cCpoTipo1,cTp1RGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SETVAL(@&COBJETO,CCPOHORAS,cHrRGB)     .CNT.','000017','000015','.EXE.','5','FO_SETVAL(@&COBJETO,cCpoHoras,cHrRGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SETVAL(@&COBJETO,CCPOHORINF,CHRRGB)','000018','000015','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOHORINF,CHRRGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SETVAL(@&COBJETO,CCPOVALINF,NVLRGB)','000019','000015','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOVALINF,NVLRGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SETVAL(@&COBJETO,CCPOVALOR,ROUND(NVLRGB,MSDECIMAIS(1)))','000020','000015','.EXE.','5','FO_SETVAL(@&COBJETO,cCpoValor,ROUND(nVlRGB,MSDECIMAIS(1)))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','CPAISLOC == "BOL" .AND. CTIPOROT == "4"','000021','000015','.CON.','5','','','5','cPaisLoc == "BOL" .And. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SETVAL(@&COBJETO,CCPONPAGTO,CNPAGRGB)','000022','000021','.EXE.','5','FO_SETVAL(@&COBJETO,CCPONPAGTO,CNPAGRGB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','!FO_SEEK(@&COBJETO,{CCPOPD,CCPOSEQ,CCPODTREF},{CPDRGB,CSEQRG','000023','000002','.CON.','5','','','5','!FO_SEEK(@&COBJETO,{CCPOPD,CCPOSEQ,CCPODTREF},{cPDRGB,CSEQRGB,CDTRGB})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','CPAISLOC == "BOL" .AND. CTIPOROT == "4"','000024','000023','.CON.','5','','','5','cPaisLoc == "BOL" .And. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_ADD(@&COBJETO,{CCPOMAT,CCPOHORAS,CCPOVALOR,CCPOCC, CCPOPD','000025','000024','.EXE.','5','fo_ADD(@&cObjeto,{cCpoMat,cCpoHoras,cCpoValor,cCpoCC, cCpoPd,cCpoTipo1,cCpoTipo2,cCpoDtRef,cCpoParcel, cCpoSeq,CCPOHORINF,CCPOVALINF,CCPONPAGTO},{cMatRGB,cHrRGB,nVlRGB,cCCRGB,cPDRGB,cTp1RGB, cTp2RGB,cDtRGB,cParRGB,cSeqRGB,cHrRGB,nVlRGB, CNPAGRGB})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','!(CPAISLOC == "BOL" .AND. CTIPOROT == "4")','000026','000023','.CON.','5','','','5','!(cPaisLoc == "BOL" .And. cTipoRot == "4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCp','000027','000026','.EXE.','5','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCpoPd, cCpoTipo1, cCpoTipo2,cCpoDtRef, cCpoParcel, cCpoSeq,CCPOHORINF,CCPOVALINF},{cMatRGB, cHrRGB, nVlRGB, cCCRGB, cPDRGB, cTp1RGB, cTp2RGB, cDtRGB, cParRGB, cSeqRGB,cHrRGB, nVlRGB} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SKIP(@oRGB)     .END.','000028','000002','.EXE.','5','FO_SKIP(@oRGB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0112    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0112( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSR8','Geracao Ausencias','','000260','113','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof(@oSR8)   .END.','000001','000000','.CON.','5','','','5','!fo_Eof(@oSR8)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dFimPer := dDataAte   .CNT.','000002','000001','.EXE.','5','dFimPer',':=','5','dDataAte','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIniFer := dDtFimFer := CTOD("")     .CNT.','000003','000001','.EXE.','5','dDtIniFer := dDtFimFer := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas := 0     .CNT.','000004','000001','.EXE.','5','nDiasAfas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasFGTS := 0   .CNT.','000005','000001','.EXE.','5','nDiasFGTS',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nValFer := 0   .CNT.','000006','000001','.EXE.','5','nValFer',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha := 0     .CNT.','000007','000001','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','AINCAPTEMP := {}     .CNT.','000008','000001','.EXE.','5','AINCAPTEMP := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIASPAGO := 0     .CNT.','000009','000001','.EXE.','5','NDIASPAGO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LHABILES := .F.     .CNT.','000010','000001','.EXE.','5','LHABILES := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LFIRST := .T.     .CNT.','000011','000001','.EXE.','5','LFIRST := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LMESINT := .F.     .CNT.','000012','000001','.EXE.','5','LMESINT := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nHorasVac := 0     .CNT.','000013','000001','.EXE.','5','nHorasVac := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nValVac := 0     .CNT.','000014','000001','.EXE.','5','nValVac := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVbMesFer := fGetCodFol("0075")     .CNT.','000015','000001','.EXE.','5','cVbMesFer := fGetCodFol("0075")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof( @oSR8)   .END.','000016','000001','.ENQ.','5','','','5','!fo_Eof( @oSR8)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha ++     .CNT.','000017','000016','.EXE.','5','nLinha ++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )     .CNT.','000018','000016','.EXE.','5','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','CNUMID := FO_GETVAL( @OSR8 , "R8_NUMID" , NLINHA )     .CNT.','000019','000016','.EXE.','5','CNUMID := FO_GETVAL( @OSR8 , "R8_NUMID" , NLINHA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )     .','000020','000016','.EXE.','5','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NSDOPAGAR := FO_GETVAL ( @OSR8 , "R8_SDPAGAR" , NLINHA )','000021','000016','.EXE.','5','NSDOPAGAR := FO_GETVAL ( @OSR8 , "R8_SDPAGAR" , NLINHA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )     .CNT.','000022','000016','.EXE.','5','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000023','000016','.EXE.','5','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPOAF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoAfa == "2"   .END.','000024','000016','.CON.','5','','','5','cTipoAfa == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPagto := "S"     .CNT.','000025','000024','.EXE.','5','cAfaPagto := "S"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVrbPagto += cVerbaAfas + ";"     .END.','000026','000024','.EXE.','5','cVrbPagto += cVerbaAfas + ";"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )     .CNT','000027','000016','.EXE.','5','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )     .CN','000028','000016','.EXE.','5','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DXDTINI := DDTINI','000029','000016','.EXE.','5','DXDTINI := DDTINI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DXDTFIM := DDTFIM','000030','000016','.EXE.','5','DXDTFIM := DDTFIM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIASPAGO := FO_GETVAL(@OSR8, "R8_DPAGOS", NLINHA)     .CNT.','000031','000016','.EXE.','5','NDIASPAGO := FO_GETVAL(@OSR8, "R8_DPAGOS", NLINHA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lInformativo:= (cTipoAfa == "3")     .CNT.','000032','000016','.EXE.','5','lInformativo:= (cTipoAfa == "3")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LFERIAS := (CTIPOAFA == "4")     .CNT.','000033','000016','.EXE.','5','LFERIAS := (CTIPOAFA == "4")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LHABILES := .F.     .CNT.','000034','000016','.EXE.','5','LHABILES := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','CTIPODIA := ""     .CNT.','000035','000016','.EXE.','5','CTIPODIA := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','CTIPODIA := POSALIAS("RCE", SRA->RA_SINDICA, SRA->RA_FILIAL,','000036','000016','.EXE.','5','CTIPODIA := POSALIAS("RCE", SRA->RA_SINDICA, SRA->RA_FILIAL, "RCE_HABCOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LOK := EMPTY(CTIPODIA)   .END.','000037','000016','.CON.','5','','','5','LOK := EMPTY(CTIPODIA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LHABILES := POSALIAS("RCM", FO_GETVAL(@OSR8, "R8_TIPOAFA", N','000038','000037','.EXE.','5','LHABILES := POSALIAS("RCM", FO_GETVAL(@OSR8, "R8_TIPOAFA", NLINHA), SRA->RA_FILIAL, "RCM_TIPODI") == "1"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LOK   .END.','000039','000016','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LHABILES := (CTIPODIA  =="'+"'"+'1")     .END.','000040','000039','.EXE.','5','LHABILES := (CTIPODIA  =="'+"'"+'1")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )     .CNT.','000041','000016','.EXE.','5','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','POSSRV(CVERBA,SRA->RA_FILIAL)     .CNT.','000042','000016','.EXE.','5','POSSRV(CVERBA,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LTEMFALTA := IF ( SRV->RV_CODFOL = "0054", .T., .F. )     .C','000043','000016','.EXE.','5','LTEMFALTA := IF ( SRV->RV_CODFOL = "0054", .T., .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lFaltaLic := IF ( SRV->RV_CODFOL $ "0040|0041|0042", .T., .F','000044','000016','.EXE.','5','lFaltaLic := IF ( SRV->RV_CODFOL $ "0040|0041|0042", .T., .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','( nSdoPagar > 0 .OR. CVERBA == FGETCODFOL("0072") )   .AND','000045','000016','.CON.','5','','','5','( nSdoPagar > 0 .OR. CVERBA == FGETCODFOL("0072") )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer <= cPeriodo .And. cAfaNPag <= cNumPag   .AND.','000046','000016','.CON.','5','','','5','cAfaPer <= cPeriodo .And. cAfaNPag <= cNumPag','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIni <= dDataAte   .END.','000047','000016','.CON.','5','','','5','dDtIni <= dDataAte','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LFIRST == .T.   .END.','000048','000047','.CON.','5','','','5','LFIRST == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTINIM := DDTINI     .CNT.','000049','000048','.EXE.','5','DDTINIM := DDTINI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTFIMM := DDTFIM     .CNT.','000050','000048','.EXE.','5','DDTFIMM := DDTFIM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LFIRST := .F.     .END.','000051','000048','.EXE.','5','LFIRST := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTFIMM < ( DDTINI -1)   .END.','000052','000047','.CON.','5','','','5','DDTFIMM < ( DDTINI -1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTINIM := DDTINI     .END.','000053','000052','.EXE.','5','DDTINIM := DDTINI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTFIMM := DDTFIM     .CNT.','000054','000047','.EXE.','5','DDTFIMM := DDTFIM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTINIM <= DDATADE  .AND. DDTFIMM >= DDATAATE   .END.','000055','000047','.CON.','5','','','5','DDTINIM <= DDATADE  .AND. DDTFIMM >= DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LMESINT := .T.     .END.','000056','000055','.EXE.','5','LMESINT := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTINI < DDATADE   .END.','000057','000047','.CON.','5','','','5','DDTINI < DDATADE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTINI := DDATADE     .END.','000058','000057','.EXE.','5','DDTINI := DDATADE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTFIM > DDATAATE   .END.','000059','000047','.CON.','5','','','5','DDTFIM > DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTFIM := DDATAATE     .END.','000060','000059','.EXE.','5','DDTFIM := DDATAATE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','Empty(dDtFim)   .END.','000061','000047','.CON.','5','','','5','Empty(dDtFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := dFimPer     .END.','000062','000061','.EXE.','5','dDtFim := dFimPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni:= 0     .CNT.','000063','000047','.EXE.','5','nDiaIni:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtIni ) .END.','000064','000047','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtIni )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := Day( dDtIni )     .END.','000065','000064','.EXE.','5','nDiaIni := Day( dDtIni )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes > MesAno(dDtIni) .END.','000066','000047','.CON.','5','','','5','cAnoMes','>','5','MesAno(dDtIni)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := 1     .END.','000067','000066','.EXE.','5','nDiaIni := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim:= 0     .CNT.','000068','000047','.EXE.','5','nDiaFim:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtFim ) .END.','000069','000047','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtFim )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day( dDtFim )     .END.','000070','000069','.EXE.','5','nDiaFim := Day( dDtFim )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes < MesAno(dDtFim) .END.','000071','000047','.CON.','5','','','5','cAnoMes','<','5','MesAno(dDtFim)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day(dFimPer)     .END.','000072','000071','.EXE.','5','nDiaFim := Day(dFimPer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000073','000047','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .and. P_DIASMES <> "S" )) .and. (nDiaFim > 30) .and. cVerbaAfas # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := 30     .END.','000074','000073','.EXE.','5','nDiaFim := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIn','000075','000047','.EXE.','5','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIni + 1), 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LHABILES   .END.','000076','000047','.CON.','5','','','5','LHABILES','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS :=  0','000077','000076','.EXE.','5','NDIAS :=  0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','MESANO(DXDTINI) == CPERIODO .OR. MESANO(DXDTFIM) == CPERIODO','000078','000076','.CON.','5','','','5','MESANO(DXDTINI) == CPERIODO .OR. MESANO(DXDTFIM) == CPERIODO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS :=  FO_GETVAL(@OSR8, "R8_DURACAO", NLINHA)','000079','000078','.EXE.','5','NDIAS :=  FO_GETVAL(@OSR8, "R8_DURACAO", NLINHA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DXDTFIM > DDATAATE','000080','000078','.CON.','5','','','5','DXDTFIM > DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS :=  FDIASHBFER(DDTINI, DDTFIM, CPERIODO, CNUMPAG)','000081','000080','.EXE.','5','NDIAS :=  FDIASHBFER(DDTINI, DDTFIM, CPERIODO, CNUMPAG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DXDTINI < DDATADE .AND. MESANO(DXDTFIM) == CPERIODO','000082','000078','.CON.','5','','','5','DXDTINI < DDATADE .AND. MESANO(DXDTFIM) == CPERIODO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS :=  FDIASHBFER(DDTINI, DDTFIM, CPERIODO, CNUMPAG)','000083','000082','.EXE.','5','NDIAS :=  FDIASHBFER(DDTINI, DDTFIM, CPERIODO, CNUMPAG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','CVERBA == FGETCODFOL("0072")   .END.','000084','000047','.CON.','5','','','5','CVERBA == FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DDTFIMC := FO_GETVAL ( @OSR8 , "R8_DATAFIM", NLINHA )     .C','000085','000084','.EXE.','5','DDTFIMC := FO_GETVAL ( @OSR8 , "R8_DATAFIM", NLINHA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LFAT := (NDIAS > 0 .AND. SRA->RA_TIPOPGT = "S" .AND. IIF(T','000086','000084','.CON.','5','','','5','LFAT := (NDIAS > 0 .AND. SRA->RA_TIPOPGT = "S" .AND. IIF(TYPE("P_FERPRIME")=="U", .T., P_FERPRIME = "S"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','L2FAT := ( DDTINIM < DDTINI )   .END.','000087','000086','.CON.','5','','','5','L2FAT := ( DDTINIM < DDTINI )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS := 0     .END.','000088','000087','.EXE.','5','NDIAS := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!L2FAT   .END.','000089','000086','.CON.','5','','','5','!L2FAT','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS := DDTFIMC - DDTINI + 1     .END.','000090','000089','.EXE.','5','NDIAS := DDTFIMC - DDTINI + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas += IIF(LTEMFALTA .OR. LFALTALIC, 0, NDIAS)     .CN','000091','000047','.EXE.','5','nDiasAfas += IIF(LTEMFALTA .OR. LFALTALIC, 0, NDIAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','000092','000047','.EXE.','5','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0   .END.','000093','000047','.CON.','5','','','5','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)     .CN','000094','000093','.EXE.','5','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','MesAno(dDtFimAnt) > MesAno(dDtIni)   .END.','000095','000093','.CON.','5','','','5','MesAno(dDtFimAnt) > MesAno(dDtIni)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (Month(dDtIni) = 2)   .END.','000096','000095','.CON.','5','','','5','LIf:= (Month(dDtIni) = 2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2     .END.','000097','000096','.EXE.','5','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000098','000095','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni','000099','000098','.EXE.','5','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIn','000100','000093','.EXE.','5','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIni+1,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas-= nDiasNaoAplic     .CNT.','000101','000093','.EXE.','5','nDiasAfas-= nDiasNaoAplic','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (cAnoMes==MesAno(DDTINI))   .END.','000102','000093','.CON.','5','','','5','LIf:= (cAnoMes==MesAno(DDTINI))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nL','000103','000102','.EXE.','5','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nLinha-1),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000104','000093','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= nDiasAfas     .END.','000105','000104','.EXE.','5','nPagarMes:= nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','000106','000093','.EXE.','5','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDias <= nSdoPagar .END.','000107','000047','.CON.','5','','','5','nDias','<=','5','nSdoPagar','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDPagarPer := nDias     .END.','000108','000107','.EXE.','5','nDPagarPer := nDias','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDias > nSdoPagar .END.','000109','000047','.CON.','5','','','5','nDias','>','5','nSdoPagar','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDPagarPer := nSdoPagar     .END.','000110','000109','.EXE.','5','nDPagarPer := nSdoPagar','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','AUSENCIA POR FERIAS     .CNT.','000111','000047','.MSG.','5','AUSENCIA POR FERIAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lFerias .And. cVerba == fGetCodFol("0072") .And. nDPagarPe','000112','000047','.CON.','5','','','5','lFerias .And. cVerba == fGetCodFol("0072") .And. nDPagarPer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nBasePRVAC:=0     .CNT.','000113','000112','.EXE.','5','nBasePRVAC:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','S_BSVALPRV()     .CNT.','000114','000112','.EXE.','5','S_BSVALPRV()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nValFer := ROUND( (NBASEPRVAC / 30 * nDPagarPer), 2 )     .C','000115','000112','.EXE.','5','nValFer := ROUND( (NBASEPRVAC / 30 * nDPagarPer), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVERBA ) + 1     .CNT','000116','000112','.EXE.','5','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVERBA ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!EMPTY(CVBMESFER) .AND. !FO_SEEK(@&COBJETO, CCPOPD, CVBMES','000117','000112','.CON.','5','','','5','!EMPTY(CVBMESFER) .AND. !FO_SEEK(@&COBJETO, CCPOPD, CVBMESFER) .AND. ! FO_DELETED(@&COBJETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_ADD( @&COBJETO , {CCPOPD, CCPOVALOR, CCPOSEQ} , {CVBMESFE','000118','000117','.EXE.','5','FO_ADD( @&COBJETO , {CCPOPD, CCPOVALOR, CCPOSEQ} , {CVBMESFER, NBASEPRVAC, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" )) },{CCPOPD, CCPOSEQ},{CVERBA, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. ! FO_DELETED(@&CO','000119','000112','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. ! FO_DELETED(@&COBJETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NVALVAC:= FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000120','000119','.EXE.','5','NVALVAC:= FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NHORASVAC:=FO_GETVAL(@&COBJETO,CCPOHORAS)     .CNT.','000121','000119','.EXE.','5','NHORASVAC:=FO_GETVAL(@&COBJETO,CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_SETVAL(@&COBJETO,CCPOVALOR,ROUND(NVALFER+NVALVAC,2))','000122','000119','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOVALOR,ROUND(NVALFER+NVALVAC,2))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_SETVAL(@&COBJETO,CCPOHORAS,NDPAGARPER+NHORASVAC)     .END','000123','000119','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOHORAS,NDPAGARPER+NHORASVAC)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. ! FO_DELETED(@&C','000124','000112','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. ! FO_DELETED(@&COBJETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_ADD( @&COBJETO , {CCPOPD, CCPOVALOR, CCPOSEQ} , {CVBMESFE','000125','000124','.EXE.','5','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR, CCPOSEQ} , {CVERBA, "V" , NDPAGARPER, NVALFER, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" )) },{CCPOPD, CCPOSEQ},{CVERBA, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','DEMAIS TIPOS DE AUSENCIAS     .CNT.','000126','000047','.MSG.','5','DEMAIS TIPOS DE AUSENCIAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!lFerias .And. !lFaltaLic .And. nDPagarPer > 0 .And. !cTip','000127','000047','.CON.','5','','','5','!lFerias .And. !lFaltaLic .And. nDPagarPer > 0 .And. !cTipoAfa $ "1/3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. ! FO_DELETED(@&C','000128','000127','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. ! FO_DELETED(@&COBJETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVERBA ) + 1     .CNT','000129','000128','.EXE.','5','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVERBA ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOSEQ}','000130','000128','.EXE.','5','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOSEQ} , {CVERBA, "D" , NDPAGARPER, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" )) },{CCPOPD, CCPOSEQ},{CVERBA, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Skip ( @oSR8 )     .END.','000131','000016','.EXE.','5','fo_Skip ( @oSR8 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0113    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0113( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRC','Valoriza Verbas','','001176','076','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRC','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000001','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lGerRes := If (Type("lGerRes") == "U" .Or. lGerRes == Nil  ,','000002','000000','.EXE.','5','lGerRes',':=','5','If (Type("lGerRes") == "U" .Or. lGerRes == Nil  , .F. , lGerRes)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGe','000003','000000','.EXE.','5','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGetCodFol("003")+"*"+fGetCodFol("004")+"*"+fGetCodFol("005")+"*"+fGetCodFol("036")+"*"+fGetCodFol("037")+"*"+fGetCodFol("038")+"*"+fGetCodFol("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp := IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)   .C','000004','000000','.EXE.','5','nDiasProp',':=','5','IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_GoTop(@&cObjeto)     .CNT.','000005','000000','.EXE.','5','fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!fo_Eof( @&cObjeto )   .END.','000006','000000','.CON.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha := 1     .CNT.','000007','000006','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC := aClone(&cObjeto:aCols)     .CNT.','000008','000006','.EXE.','5','aSRC := aClone(&cObjeto:aCols)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))     .','000009','000006','.EXE.','5','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','000010','000006','.EXE.','5','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))     .','000011','000006','.EXE.','5','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','000012','000006','.EXE.','5','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )     .C','000013','000006','.EXE.','5','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha <= Len(aSRC)   .END.','000014','000006','.ENQ.','5','','','5','nLinha <= Len(aSRC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC[nLinha, nPosDel] == .F.   .END.','000015','000014','.CON.','5','','','5','aSRC[nLinha, nPosDel] == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha','000016','000015','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha,nPosPD], aSRC[nLinha,nPosCC], aSRC[nLinha,nPosSeq]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .F.     .CNT.','000017','000016','.EXE.','5','lValAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .F.     .CNT.','000018','000016','.EXE.','5','lQtdAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)     .CNT.','000019','000016','.EXE.','5','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)   .EN','000020','000016','.CON.','5','','','5','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)     .CNT.','000021','000020','.EXE.','5','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba := fo_GetVal( @&cObjeto , cCpoPD)     .CNT.','000022','000020','.EXE.','5','cVerba := fo_GetVal( @&cObjeto , cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL,','000023','000020','.EXE.','5','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL, "RV_PERC") ) = 0,1,nPercent / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )     .CN','000024','000020','.EXE.','5','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .END.','000025','000020','.CON.','5','','','5','cTipo2','==','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHorInf)     .CNT.','000026','000025','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHorInf)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValInf)     .END.','000027','000025','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValInf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 # "I" .END.','000028','000020','.CON.','5','','','5','cTipo2','#','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000029','000028','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor )     .END.','000030','000028','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba $ CPDACFIXOS   .END.','000031','000020','.CON.','5','','','5','cVerba $ CPDACFIXOS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")     .CNT.','000032','000031','.EXE.','5','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.','000033','000031','.EXE.','5','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)     .CNT.','000034','000031','.EXE.','5','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NVALOR :=  NQTD * NBASEACU / 100     .CNT.','000035','000031','.EXE.','5','NVALOR :=  NQTD * NBASEACU / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','FO_RESTORE(@&COBJETO)     .CNT.','000036','000031','.EXE.','5','FO_RESTORE(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','LVALALTEROU:=.T.     .END.','000037','000031','.EXE.','5','LVALALTEROU:=.T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")     .','000038','000020','.EXE.','5','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)     .C','000039','000020','.EXE.','5','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA-','000040','000020','.CON.','5','','','5','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")  # "S" )) .And. Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValo','000041','000040','.CON.','5','','','5','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValor = 0 .And. cTipo2 $ "I*F*G" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "H" .END.','000042','000041','.CON.','5','','','5','cTipo','==','5','"H"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALHORA*nPercent,nDecimais)   .CNT.','000043','000042','.EXE.','5','nValor',':=','5','round(nQtd*SALHORA*nPercent,nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000044','000042','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000045','000042','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "D" .END.','000046','000041','.CON.','5','','','5','cTipo','==','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALDIA * nPercent, nDecimais)   .CNT.','000047','000046','.EXE.','5','nValor',':=','5','round(nQtd*SALDIA * nPercent, nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000048','000046','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000049','000046','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "V" .AND.','000050','000041','.CON.','5','','','5','cTipo','==','5','"V"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .AND.','000051','000041','.CON.','5','','','5','cTipo2','==','5','"I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor > 0 .END.','000052','000041','.CON.','5','','','5','nValor','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000053','000052','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )   .AND.','000054','000020','.CON.','5','','','5','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S" .END.','000055','000020','.CON.','5','','','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalMes += nValor   .CNT.','000056','000055','.EXE.','5','SalMes','+=','5','nValor','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalHora += (nValor / SRA->RA_HRSMES)   .CNT.','000057','000055','.EXE.','5','SalHora','+=','5','(nValor / SRA->RA_HRSMES)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalDia += (nValor / 30)   .CNT.','000058','000055','.EXE.','5','SalDia','+=','5','(nValor / 30)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)     .CNT.','000059','000055','.EXE.','5','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .AND.','000060','000055','.CON.','5','','','5','nDiasProp','#','5','Nil','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp >= 0 .AND.','000061','000055','.CON.','5','','','5','nDiasProp','>=','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ f','000062','000055','.CON.','5','','','5','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ fGetCodFol("347")))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','Empty(cTarefa)   .END.','000063','000055','.CON.','5','','','5','Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo   .END.','000064','000063','.CON.','5','','','5','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := ( ( nQtd / 30 ) * nDiasProp )     .CNT.','000065','000064','.EXE.','5','nQtd := ( ( nQtd / 30 ) * nDiasProp )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000066','000064','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo   .END.','000067','000063','.CON.','5','','','5','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := nDiasProp     .CNT.','000068','000067','.EXE.','5','nQtd := nDiasProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000069','000067','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','000070','000063','.EXE.','5','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000071','000063','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_IN','000072','000020','.CON.','5','','','5','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo','000073','000020','.CON.','5','','','5','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo2 $ "I*F*G" ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .T.     .CNT.','000074','000073','.EXE.','5','lPropAdic := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # 0 .END.','000075','000073','.CON.','5','','','5','nDiasProp','#','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99)','000076','000075','.CON.','5','','','5','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000077','000076','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.9','000078','000075','.CON.','5','','','5','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','000079','000075','.CON.','5','','','5','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000080','000079','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S','000081','000073','.CON.','5','','','5','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nD','000082','000081','.EXE.','5','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000083','000081','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor <= 0 .END.','000084','000081','.CON.','5','','','5','nValor','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Delete(@&cObjeto)     .END.','000085','000084','.EXE.','5','fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou   .END.','000086','000020','.CON.','5','','','5','lValAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTot','000087','000086','.CON.','5','','','5','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTotAdic > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValAdic := nTotAdic / 30 * nQtd     .CNT.','000088','000087','.EXE.','5','nValAdic := nTotAdic / 30 * nQtd','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor += nValAdic     .END.','000089','000087','.EXE.','5','nValor += nValAdic','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoValor, nValor)     .END.','000090','000086','.EXE.','5','fo_SetVal(@&cObjeto , cCpoValor, nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou   .END.','000091','000020','.CON.','5','','','5','lQtdAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)     .END.','000092','000091','.EXE.','5','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipoRot == "9" .And. cTipo2 == "I"   .END.','000093','000020','.CON.','5','','','5','cTipoRot == "9" .And. cTipo2 == "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)     .CNT.','000094','000093','.EXE.','5','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)     .END.','000095','000093','.EXE.','5','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd := PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")   .CN','000096','000020','.EXE.','5','cCodPd',':=','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd # "   " .END.','000097','000020','.CON.','5','','','5','cCodPd','#','5','"   "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCC := fo_GetVal(@&cObjeto, cCpoCC)     .CNT.','000098','000097','.EXE.','5','cCC := fo_GetVal(@&cObjeto, cCpoCC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCp','000099','000097','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCpoTipo1, cCpoTipo2, cCpoSeq, cCpoData}, {cCodPd, nValor, nQtd, cCC, cTipo, cTipo2, fo_GetVal(@&cObjeto, cCpoSeq), fo_GetVal(@&cObjeto, cCpoData)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha ++     .END.','000100','000014','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0114    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0114( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRK','Geracao Val. Futuros no Mvto','','000265','039','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRK','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)     .CNT.','000001','000000','.EXE.','5','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSitFolh <> "D" .AND.','000002','000000','.CON.','5','','','5','cSitFolh','<>','5','"D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000003','000000','.CON.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSe','000004','000003','.EXE.','5','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GoTop( @OSRK )     .CNT.','000005','000003','.EXE.','5','fo_GoTop( @OSRK )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha := 0     .CNT.','000006','000003','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000007','000003','.ENQ.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha++     .CNT.','000008','000007','.EXE.','5','nLinha++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"   .END.','000009','000007','.CON.','5','','','5','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)     .CNT.','000010','000009','.EXE.','5','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)     .CNT','000011','000009','.EXE.','5','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)     .CN','000012','000009','.EXE.','5','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )   .AND.','000013','000009','.CON.','5','','','5','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg < nParcela   .END.','000014','000009','.CON.','5','','','5','nParcPg < nParcela','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)     .CNT.','000015','000014','.EXE.','5','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)     .CNT.','000016','000014','.EXE.','5','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)     .','000017','000014','.EXE.','5','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)     .CNT.','000018','000014','.EXE.','5','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cTipoRot == "4" .END.','000019','000014','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','000020','000019','.EXE.','5','nValor',':=','5','nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!(cTipoRot == "4")   .END.','000021','000014','.CON.','5','','','5','!(cTipoRot == "4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo >= nVlParcela .END.','000022','000021','.CON.','5','','','5','nSaldo','>=','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nVlParcela     .END.','000023','000022','.EXE.','5','nValor := nVlParcela','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo < nVlParcela .END.','000024','000021','.CON.','5','','','5','nSaldo','<','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor  := nSaldo     .END.','000025','000024','.EXE.','5','nValor  := nSaldo','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','(nParcela - nParcPg) = 1 .END.','000026','000021','.CON.','5','','','5','(nParcela - nParcPg)','=','5','1','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor += fo_GetVal(@oSRK, "RK_VALORAR", nLinha)   .END.','000027','000026','.EXE.','5','nValor','+=','5','fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba )','000028','000014','.EXE.','5','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba ) + 1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}     .CNT.','000029','000014','.EXE.','5','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq},','000030','000014','.EXE.','5','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq}, {cVerba, cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Skip( @OSRK )     .END.','000031','000007','.EXE.','5','fo_Skip( @OSRK )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0115    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0115( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRO','PROCESSAR SRO','','','039','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRO','PROCESSA TAREFA DO SRO','000001','000000','.CON.','5','','','5','!fo_Eof( @OSRO )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','fo_GoTop( @OSRO )     .CNT.','000002','000001','.EXE.','5','fo_GoTop( @OSRO )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','!fo_Eof( @OSRO )   .END.','000003','000001','.ENQ.','5','','','5','!fo_Eof( @OSRO )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','cVerba := FO_GetVal( @OSRO , "RO_VERBA")     .CNT.','000004','000003','.EXE.','5','cVerba := FO_GetVal( @OSRO , "RO_VERBA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','cCCTar  := If(Empty(FO_GETVAL(@oSRO,"RO_CC")), SRA->RA_CC, F','000005','000003','.EXE.','5','cCCTar  := If(Empty(FO_GETVAL(@oSRO,"RO_CC")), SRA->RA_CC, FO_GETVAL(@oSRO,"RO_CC"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nQuant := FO_GETVAL(@oSRO,"RO_QUANT")     .CNT.','000006','000003','.EXE.','5','nQuant := FO_GETVAL(@oSRO,"RO_QUANT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nQtSeman := FO_GETVAL(@oSRO,"RO_QTDSEM")     .CNT.','000007','000003','.EXE.','5','nQtSeman := FO_GETVAL(@oSRO,"RO_QTDSEM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','cTipVerba := PosSrv(cVerba,SRA->RA_FILIAL,"RV_TIPOCOD")','000008','000003','.EXE.','5','cTipVerba := PosSrv(cVerba,SRA->RA_FILIAL,"RV_TIPOCOD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nValor := FO_GETVAL(@oSRO,"RO_VALTOT",nLinha)     .CNT.','000009','000003','.EXE.','5','nValor := FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','( nPosTar := Ascan( aTarefas, { |X| X[1] == cVerba .And. X','000010','000003','.CON.','5','','','5','( nPosTar := Ascan( aTarefas, { |X| X[1] == cVerba .And. X[5] = cCcTar .and. X[8] == "SRO" })) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','Aadd( aTarefas, { cVerba, nValor,nQtSeman,nQuant, cCCTar, FO','000011','000010','.EXE.','5','Aadd( aTarefas, { cVerba, nValor,nQtSeman,nQuant, cCCTar, FO_GETVAL(@oSRO,"RO_DATA"), cTipVerba, "SRO", fo_getval(@oSRO,"RO_TIPO") } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nPostar > 0   .END.','000012','000003','.CON.','5','','','5','nPostar > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','aTarefas[nPostar,2] += nValor     .CNT.','000013','000012','.EXE.','5','aTarefas[nPosTar,2] += nValor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','aTarefas[nPosTar,3] += nQtSeman     .CNT.','000014','000012','.EXE.','5','aTarefas[nPosTar,3] += nQtSeman','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','aTarefas[nPosTar,4] += nQuant     .END.','000015','000012','.EXE.','5','aTarefas[nPosTar,4] += nQuant','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','fo_Skip( @OSRO )     .END.','000016','000003','.EXE.','5','fo_Skip( @OSRO )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0116    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0116( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCTARV','PROCESSAR TAREFAS DO SRC','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCTARV','!fo_Eof( @&cObjeto )   .END.','000001','000000','.CON.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','fo_GoTop( @&cObjeto )     .CNT.','000002','000001','.EXE.','5','fo_GoTop( @&cObjeto )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','!fo_Eof( @&cObjeto )   .END.','000003','000001','.ENQ.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cVerba := fo_GetVal( @&cObjeto ,cCpoPd)     .CNT.','000004','000003','.EXE.','5','cVerba := fo_GetVal( @&cObjeto ,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cTipo := fo_GetVal( @&cObjeto ,cCpoTipo1)     .CNT.','000005','000003','.EXE.','5','cTipo := fo_GetVal( @&cObjeto ,cCpoTipo1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cCodTar := PosSrv(cVerba,SRA->RA_FILIAL,"RV_TAREFA")   .CNT.','000006','000003','.EXE.','5','cCodTar',':=','5','PosSrv(cVerba,SRA->RA_FILIAL,"RV_TAREFA")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','Len(Alltrim(cCodTar)) == 3 .AND.','000007','000003','.CON.','5','','','5','Len(Alltrim(cCodTar))','==','5','3','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cTipo $ "H*D" .END.','000008','000003','.CON.','5','','','5','cTipo','$','5','"H*D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )     .CN','000009','000008','.EXE.','5','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nQtd := fo_GetVal( @&cObjeto ,cCpoHorInf)     .CNT.','000010','000008','.EXE.','5','nQtd := fo_GetVal( @&cObjeto ,cCpoHorInf)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nValTar := Val( SubStr( Posicione("SRX",1,xFilial("SRX")+"59','000011','000008','.EXE.','5','nValTar',':=','5','Val( SubStr( Posicione("SRX",1,xFilial("SRX")+"590"+cCodTar, "RX_TXT"),31,12 ))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nValor := round(nQtd * nValtar,nDecimais)     .CNT.','000012','000008','.EXE.','5','nValor := round(nQtd * nValtar,nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','fo_SetVal(@&cObjeto , cCpoValor, nValor)     .CNT.','000013','000008','.EXE.','5','fo_SetVal(@&cObjeto , cCpoValor, nValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','Aadd( aTarefas , { cVerba,nValor, FO_GETVAL(@&cObjeto, cCpoQ','000014','000008','.EXE.','5','Aadd( aTarefas , { cVerba,nValor, FO_GETVAL(@&cObjeto, cCpoQtdSem), nQtd,FO_GETVAL(@&cObjeto,cCpoCC), FO_GETVAL(@&cObjeto,cCpoData),"1", "SRC", "2" } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','fo_Skip( @&cObjeto )     .END.','000015','000003','.EXE.','5','fo_Skip( @&cObjeto )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0117    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0117( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROPTARE','PROPORCIONALISA TAREFAS PROFES','','','016','2','1',} )

aAdd(aRc3Cols, { '','S_','PROPTARE','lAdmissao := If( MesAno(SRA->RA_ADMISSA) == cAnoMes,.T.,.F.)','000001','000000','.EXE.','5','lAdmissao := If( MesAno(SRA->RA_ADMISSA) == cAnoMes,.T.,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','(!Empty(cSitFolh) .And. cSitFolh # "D" ) .Or. lAdmissao','000002','000000','.CON.','5','','','5','(!Empty(cSitFolh) .And. cSitFolh # "D" ) .Or. lAdmissao','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nLinha := 1     .CNT.','000003','000002','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nLinha <= Len(aTarefas)   .END.','000004','000002','.ENQ.','5','','','5','nLinha <= Len(aTarefas)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','aTarefas[nLinha,9] == "1"   .END.','000005','000004','.CON.','5','','','5','aTarefas[nLinha,9] == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCc},{aTarefas[nLinha,1],aTar','000006','000005','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCc},{aTarefas[nLinha,1],aTarefas[nLinha,5]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_GETVAL(@&cObjeto,cCpoTipo2) <> "I"   .END.','000007','000006','.CON.','5','','','5','FO_GETVAL(@&cObjeto,cCpoTipo2) <> "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nValor := Round( FO_GETVAL(@&cObjeto,cCpoValor) / 30 * Diast','000008','000007','.EXE.','5','nValor := Round( FO_GETVAL(@&cObjeto,cCpoValor) / 30 * Diastrab, MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','000009','000007','.EXE.','5','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoValor,nValor)     .CNT.','000010','000007','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,nValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)     .END.','000011','000007','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nLinha ++     .END.','000012','000004','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("033"))   .END.','000013','000002','.CON.','5','','','5','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("033"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTR','000014','000013','.EXE.','5','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTRAB,MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','000015','000013','.EXE.','5','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)     .CNT.','000016','000013','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoValor,nValor)     .END.','000017','000013','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("317"))   .END.','000018','000002','.CON.','5','','','5','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("317"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTR','000019','000018','.EXE.','5','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTRAB,MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','000020','000018','.EXE.','5','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)     .CNT.','000021','000018','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nValor)     .END.','000022','000018','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0118    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0118( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVAGUI','PROVISION AGUINALDO','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVAGUI','ATEMPAGUI := {}     .CNT.','000001','000000','.EXE.','5','ATEMPAGUI := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','dPerFim := iif(SRA->RA_SITFOLH <> "D",dDataAte,SRA->RA_DEMIS','000002','000000','.EXE.','5','dPerFim := iif(SRA->RA_SITFOLH <> "D",dDataAte,SRA->RA_DEMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','ATEMPAGUI := DATEDIFFYMD( CTOD( "01/01/"+ STRZERO(YEAR(DPERF','000003','000000','.EXE.','5','ATEMPAGUI := DATEDIFFYMD( CTOD( "01/01/"+ STRZERO(YEAR(DPERFIM), 4 ) ), DPERFIM )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','nval13pro := 0     .END.','000004','000000','.EXE.','5','nval13pro := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','DDATAAC := MONTHSUB( DDATAREF , 1 )     .CNT.','000005','000000','.EXE.','5','DDATAAC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','LEN(ATEMPAGUI) > 0   .END.','000006','000000','.CON.','5','','','5','LEN(ATEMPAGUI) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','NMESESAGUI := ATEMPAGUI[2]     .CNT.','000007','000006','.EXE.','5','NMESESAGUI := ATEMPAGUI[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','NDIASAGUI := IIF( !(SRA->RA_SITFOLH == "D" .AND. ANOMES(SRA-','000008','000006','.EXE.','5','NDIASAGUI := Iif( !(SRA->RA_SITFOLH == "D" .And. AnoMes(SRA->RA_DEMISSA) == AnoMes(dDataRef)), aTEMPAGUI[3], Day(SRA->RA_DEMISSA) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','nval13pro := nBasepro13     .CNT.','000009','000000','.EXE.','5','nval13pro := nBasepro13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','nPrvAgAnt := 0     .CNT.','000010','000000','.EXE.','5','nPrvAgAnt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','NBASEPRO13 := (NBASEPRO13 / 12 * NMESESAGUI)     .CNT.','000011','000000','.EXE.','5','NBASEPRO13 := (Nval13pro / 12 * NMESESAGUI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','NBASEPRO13 += (Nval13pro / 360 * NDIASAGUI)     .CNT.','000012','000000','.EXE.','5','NBASEPRO13 += (Nval13pro / 360 * NDIASAGUI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','nPrvAgAnt += FBUSCAACM(ACODFOL[136,1], ,DDATAAC, DDATAAC, "V','000013','000000','.EXE.','5','nPrvAgAnt += FBUSCAACM(ACODFOL[136,1], ,DDATAAC, DDATAAC, "V" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVAGUI','nPrvAgAnt += FBUSCAACM(ACODFOL[777,1],,DDATAAC,DDATAAC,"V")','000014','000000','.EXE.','5','nPrvAgAnt += FBUSCAACM(ACODFOL[777,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0119    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0119( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVDAGU','PROVISION DOBLE AGUINALDO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVDAGU','!Empty( aCodFol[142, 1 ] )   .END.','000001','000000','.CON.','5','','','5','!Empty( aCodFol[142, 1 ] )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','ATEMPDAGU := {}     .CNT.','000002','000001','.EXE.','5','ATEMPDAGU := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','dPerFim := iif(SRA->RA_SITFOLH <> "D",dDataAte,SRA->RA_DEMIS','000003','000001','.EXE.','5','dPerFim := iif(SRA->RA_SITFOLH <> "D",dDataAte,SRA->RA_DEMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','ATEMPDAGU := DATEDIFFYMD( CTOD( "01/01/"+ STRZERO(YEAR(DPERF','000004','000001','.EXE.','5','ATEMPDAGU := DATEDIFFYMD( CTOD( "01/01/"+ STRZERO(YEAR(DPERFIM), 4 ) ), DPERFIM )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','nval14pro := 0     .CNT.','000005','000001','.EXE.','5','nval14pro := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','DDATAAC := MONTHSUB( DDATAREF , 1 )     .CNT.','000006','000001','.EXE.','5','DDATAAC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','LEN(ATEMPDAGU) > 0   .END.','000007','000001','.CON.','5','','','5','LEN(ATEMPDAGU) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','NMESESDAGU := ATEMPDAGU[2]     .CNT.','000008','000007','.EXE.','5','NMESESDAGU := ATEMPDAGU[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','NDIASDAGU := Iif( !(SRA->RA_SITFOLH == "D" .And. AnoMes(SRA-','000009','000007','.EXE.','5','NDIASDAGU := Iif( !(SRA->RA_SITFOLH == "D" .And. AnoMes(SRA->RA_DEMISSA) == AnoMes(dDataRef)), ATEMPDAGU[3], Day(SRA->RA_DEMISSA) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','nval14pro := nBasepro14     .CNT.','000010','000001','.EXE.','5','nval14pro := nBasepro14','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','nPrvDAAnt := 0     .CNT.','000011','000001','.EXE.','5','nPrvDAAnt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','NBASEPRO14 := (Nval14pro / 12 * NMESESDAGU)     .CNT.','000012','000001','.EXE.','5','NBASEPRO14 := (Nval14pro / 12 * NMESESDAGU)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','NBASEPRO14 += (Nval14pro / 360 * NDIASDAGU)     .CNT.','000013','000001','.EXE.','5','NBASEPRO14 += (Nval14pro / 360 * NDIASDAGU)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','nPrvDAAnt += FBUSCAACM(ACODFOL[142,1], ,DDATAAC, DDATAAC, "V','000014','000001','.EXE.','5','nPrvDAAnt += FBUSCAACM(ACODFOL[142,1], ,DDATAAC, DDATAAC, "V" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVDAGU','nPrvDAAnt += FBUSCAACM(ACODFOL[1895,1],,DDATAAC,DDATAAC,"V")','000015','000001','.EXE.','5','nPrvDAAnt += FBUSCAACM(ACODFOL[1895,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0120    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0120( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVINDE','PROVISION INDEMNIZACION','','','021','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVINDE','ATEMPSERV := {}     .CNT.','000001','000000','.EXE.','5','ATEMPSERV := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nProvInd := 0     .CNT.','000002','000000','.EXE.','5','nProvInd := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','DDATAAC := MONTHSUB( DDATAREF , 1 )     .CNT.','000003','000000','.EXE.','5','DDATAAC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','DDATAANT := MONTHSUB( DDATAREF , 2 )     .CNT.','000004','000000','.EXE.','5','DDATAANT := MONTHSUB( DDATAREF , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nId1886 := Abs(FBUSCAACM(ACODFOL[1886,1],,DDATAAC,DDATAAC,"V','000005','000000','.EXE.','5','nId1886 := Abs(FBUSCAACM(ACODFOL[1886,1],,DDATAAC,DDATAAC,"V"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nId1886_2 := Abs(FBUSCAACM(ACODFOL[1886,1],,SRA->RA_ADMISSA,','000006','000000','.EXE.','5','nId1886_2 := Abs(FBUSCAACM(ACODFOL[1886,1],,SRA->RA_ADMISSA,DDATAANT,"V"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt := 0     .CNT.','000007','000000','.EXE.','5','nPrvIndAnt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt  += FBUSCAACM(ACODFOL[774,1] , , DDATAAC, DDATAAC','000008','000000','.EXE.','5','nPrvIndAnt  += FBUSCAACM(ACODFOL[774,1] , , DDATAAC, DDATAAC, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt  += FBUSCAACM(ACODFOL[778,1],,DDATAAC,DDATAAC,"V"','000009','000000','.EXE.','5','nPrvIndAnt  += FBUSCAACM(ACODFOL[778,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt  -= nId1886     .CNT.','000010','000000','.EXE.','5','nPrvIndAnt  -= nId1886','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','DDATAATE > SRA->RA_ADMISSA','000011','000000','.CON.','5','','','5','dDataAte > SRA->RA_ADMISSA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nProvInd := nBaseProv     .CNT.','000012','000011','.EXE.','5','nProvInd := nBaseProv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','SRA->RA_SITFOLH <> "D"   .END.','000013','000011','.CON.','5','','','5','SRA->RA_SITFOLH <> "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','ATEMPSERV := DATEDIFFYMD(SRA->RA_ADMISSA, dDataAte )     .EN','000014','000013','.EXE.','5','ATEMPSERV := DATEDIFFYMD(SRA->RA_ADMISSA, dDataAte )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','SRA->RA_SITFOLH == "D"   .END.','000015','000011','.CON.','5','','','5','SRA->RA_SITFOLH == "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','ATEMPSERV := DATEDIFFYMD(SRA->RA_ADMISSA, SRA->RA_DEMISSA )','000016','000015','.EXE.','5','ATEMPSERV := DATEDIFFYMD(SRA->RA_ADMISSA, SRA->RA_DEMISSA )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','LEN(ATEMPSERV ) > 0   .END.','000017','000011','.CON.','5','','','5','LEN(ATEMPSERV ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','NANOS := ATEMPSERV[1]     .CNT.','000018','000017','.EXE.','5','NANOS := ATEMPSERV[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','NMESES := ATEMPSERV[2]     .CNT.','000019','000017','.EXE.','5','NMESES := ATEMPSERV[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','NDIAS := IIF( !(SRA->RA_SITFOLH == "D" .AND. ANOMES(SRA->RA_','000020','000017','.EXE.','5','NDIAS := Iif( !(SRA->RA_SITFOLH == "D" .And. AnoMes(SRA->RA_DEMISSA) == AnoMes(dDataRef)), ATEMPSERV[3], Day(SRA->RA_DEMISSA) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nBaseProv > 0   .END.','000021','000011','.CON.','5','','','5','nBaseProv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nBaseProv :=  nProvInd * nAnos     .CNT.','000022','000021','.EXE.','5','nBaseProv :=  nProvInd * nAnos','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nBaseProv +=  round( nProvInd / 12 * nMeses , 2 )     .CNT.','000023','000021','.EXE.','5','nBaseProv +=  round( nProvInd / 12 * nMeses , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nBaseProv +=  round ( nProvInd / 360 * nDias , 2 )     .CNT.','000024','000021','.EXE.','5','nBaseProv +=  round ( nProvInd / 360 * nDias , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nBaseProv -= nId1886     .CNT.','000025','000021','.EXE.','5','nBaseProv -= nId1886','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nBaseProv -= nId1886_2     .CNT.','000026','000021','.EXE.','5','nBaseProv -= nId1886_2','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt > 0   .END.','000027','000021','.CON.','5','','','5','nPrvIndAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt <  nBaseProv   .END.','000028','000027','.CON.','5','','','5','nPrvIndAnt <  nBaseProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),','000029','000028','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),  ( nPrvIndAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),','000030','000028','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),  ( nBaseProv - nPrvIndAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt > nBaseProv   .END.','000031','000027','.CON.','5','','','5','nPrvIndAnt > nBaseProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),','000032','000031','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),  (  nBaseProv - nPrvIndAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),','000033','000031','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),  (nPrvIndAnt) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','nPrvIndAnt = 0   .END.','000034','000021','.CON.','5','','','5','nPrvIndAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVINDE','FO_ADD(@OSRC, {"RC_PD",  "RC_VALOR"}, { FGETCODFOL("0774"),','000035','000034','.EXE.','5','FO_ADD(@OSRC, {"RC_PD",  "RC_VALOR"}, { FGETCODFOL("0774"), nBaseProv } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0121    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0121( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PRVVAC','PROVISION VACACIONES','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','PRVVAC','dDataInic := ctod("")     .CNT.','000001','000000','.EXE.','5','dDataInic := ctod("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataIniP := ctod("")     .CNT.','000002','000000','.EXE.','5','dDataIniP := ctod("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataFimP := ctod("")     .CNT.','000003','000000','.EXE.','5','dDataFimP := ctod("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasVen := 0     .CNT.','000004','000000','.EXE.','5','nDiasVen := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataF := ctod("")     .CNT.','000005','000000','.EXE.','5','dDataF := ctod("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasProp := 0     .CNT.','000006','000000','.EXE.','5','nDiasProp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasVen := 0     .CNT.','000007','000000','.EXE.','5','nDiasVen := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','!EMPTY(SRA->RA_DTREC)   .END.','000008','000000','.CON.','5','','','5','!EMPTY(SRA->RA_DTREC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataInic := SRA->RA_DTREC     .END.','000009','000008','.EXE.','5','dDataInic := SRA->RA_DTREC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','Empty(dDataInic)   .END.','000010','000000','.CON.','5','','','5','Empty(dDataInic)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataInic:=SRA->RA_ADMISSA     .END.','000011','000010','.EXE.','5','dDataInic:=SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataIniP:=ctod( StrZero( Day( dDataInic ), 2 ) + "/" + StrZ','000012','000000','.EXE.','5','dDataIniP:=ctod( StrZero( Day( dDataInic ), 2 ) + "/" + StrZero( Month( dDataInic ),2 ) + "/" + StrZero(Year(dDataDe),4 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataIniP <= dDataDe .Or. MesAno(DDATAINIC) == MesAno(DDAT','000013','000000','.CON.','5','','','5','dDataIniP <= dDataDe .Or. MesAno(DDATAINIC) == MesAno(DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataFimP := ctod( Strzero( Day( dDataInic ),2 ) + "/" + Str','000014','000013','.EXE.','5','dDataFimP := ctod( Strzero( Day( dDataInic ),2 ) + "/" + StrZero( Month( dDataInic ) ,2 ) + "/" + StrZero( Year( dDataDe) + 1, 4) ) -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataIniP  > dDataDe .And. !MesAno(DDATAINIC) == MesAno(DD','000015','000000','.CON.','5','','','5','dDataIniP  > dDataDe .And. !MesAno(DDATAINIC) == MesAno(DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataIniP:= ctod( StrZero( Day( dDataInic) , 2 )  + "/" + St','000016','000015','.EXE.','5','dDataIniP:= ctod( StrZero( Day( dDataInic) , 2 )  + "/" + StrZero( Month( dDataInic ) ,  2 ) + "/" + StrZero( Year(dDataDe ) - 1,  4 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','dDataFimP := ctod( StrZero( Day( dDataInic ), 2 ) + "/" + St','000017','000015','.EXE.','5','dDataFimP := ctod( StrZero( Day( dDataInic ), 2 ) + "/" + Strzero( Month( dDataInic ),2  ) + "/" + StrZero(Year(dDataDe) , 4) ) -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','(dDataInic < dDataAte )   .END.','000018','000000','.CON.','5','','','5','(dDataInic < dDataAte )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','DDATAF := IIF(CTIPOROT == '+"'"+'4'+"'"+' , DDATADEM, IIF( !(SRA->RA_SIT','000019','000018','.EXE.','5','dDataF := Iif(cTipoRot == '+"'"+'4'+"'"+' , dDataDem, Iif( !(SRA->RA_SITFOLH == "D" .And. AnoMes(SRA->RA_DEMISSA) == AnoMes(dDataRef)), dDataAte, SRA->RA_DEMISSA ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nAnosTrab := (( dDataF - dDataInic) + 1) / 365     .CNT.','000020','000018','.EXE.','5','nAnosTrab := (( dDataF - dDataInic) + 1) / 365','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nX := FPOSTAB("S010", SRA->RA_PROCES, "=", 4 , nAnosTrab , "','000021','000018','.EXE.','5','nX := FPOSTAB("S010", SRA->RA_PROCES, "=", 4 , nAnosTrab , "<=" , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasVac := IF(nX > 0,  FTABELA("S010" , nX , 7 ) ,  0 )','000022','000018','.EXE.','5','nDiasVac := IF(nX > 0,  FTABELA("S010" , nX , 7 ) ,  0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasProp := nDiasVac / 365  * ( dDataF - dDataIniP + 1 )','000023','000018','.EXE.','5','nDiasProp := nDiasVac / 365  * ( dDataF - dDataIniP + 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasProp > nDiasVac   .END.','000024','000018','.CON.','5','','','5','nDiasProp > nDiasVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasVen :=  nDiasVac     .CNT.','000025','000024','.EXE.','5','nDiasVen :=  nDiasVac','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasProp := 0     .END.','000026','000024','.EXE.','5','nDiasProp := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','cKey := xFilial("SRF") + SRA->RA_MAT + FGETCODFOL("0072") +','000027','000018','.EXE.','5','cKey := xFilial("SRF") + SRA->RA_MAT + FGETCODFOL("0072") + dtos(dDataIniP)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','lExiste := FPOSREG("SRF", 2 ,cKey , .F. )     .CNT.','000028','000018','.EXE.','5','lExiste := FPOSREG("SRF", 2 ,cKey , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','lExiste   .END.','000029','000018','.CON.','5','','','5','lExiste','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','FGRAVAFOR( "SRF" , 2, cKey, {"RF_DATABAS", "RF_DATAFIM", "RF','000030','000029','.EXE.','5','FGRAVAFOR( "SRF" , 2, cKey, {"RF_DATABAS", "RF_DATAFIM", "RF_DIASDIR",  "RF_DFERVAT", "RF_DFERAAT" , "RF_STATUS" } ,  {dDataIniP , dDataFimP ,  nDiasVac, nDiasVen, nDiasProp, "1"} , , .F. , .F. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','!lExiste   .END.','000031','000018','.CON.','5','','','5','!lExiste','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','cKey02 := { "RF_FILIAL", "RF_MAT", "RF_PD", "RF_DATABAS", "R','000032','000031','.EXE.','5','cKey02 := { "RF_FILIAL", "RF_MAT", "RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DIASDIR", "RF_DIASANT", "RF_DFERVAT", "RF_DFERAAT", "RF_DFERANT", "RF_STATUS"}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','FGRAVAFOR("SRF" , 2 , cKey, cKey02 , { SRA->RA_FILIAL, SRA->','000033','000031','.EXE.','5','FGRAVAFOR("SRF" , 2 , cKey, cKey02 , { SRA->RA_FILIAL, SRA->RA_MAT,  FGETCODFOL("0072"), dDataIniP,  dDataFimP, nDiasVac ,  0 , nDiasVen , nDiasProp , 0, "1"},, .T.,.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','C__ROTEIRO == "PRV"   .END.','000034','000000','.CON.','5','','','5','C__ROTEIRO == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','!(SRA->RA_SITFOLH == "D" .AND. ANOMES(SRA->RA_DEMISSA) == AN','000035','000034','.CON.','5','','','5','!(SRA->RA_SITFOLH == "D" .And. AnoMes(SRA->RA_DEMISSA) == AnoMes(dDataRef))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasProp := 0     .CNT.','000036','000035','.EXE.','5','nDiasProp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasVen := 0     .CNT.','000037','000035','.EXE.','5','nDiasVen := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','FPOSREG("SRF", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000038','000035','.EXE.','5','FPOSREG("SRF", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','!SRF->(EOF()) .AND. SRF->RF_FILIAL+SRF->RF_MAT == SRA->RA_','000039','000035','.ENQ.','5','','','5','!SRF->(EOF()) .AND. SRF->RF_FILIAL+SRF->RF_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','SRF->RF_STATUS $ '+"'"+'1 '+"'"+'   .END.','000040','000039','.CON.','5','','','5','SRF->RF_STATUS $ '+"'"+'1 '+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasVen += SRF->RF_DFERVAT - SRF->RF_DFERANT     .CNT.','000041','000040','.EXE.','5','nDiasVen += SRF->RF_DFERVAT - SRF->RF_DFERANT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','nDiasProp += SRF->RF_DFERAAT - SRF->RF_DIASANT     .END.','000042','000040','.EXE.','5','nDiasProp += SRF->RF_DFERAAT - SRF->RF_DIASANT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','SRF->(DBSKIP())     .END.','000043','000039','.EXE.','5','SRF->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','SRA->RA_SITFOLH == "D"    .AND. MESANO(SRA->RA_DEMISSA)  =','000044','000034','.CON.','5','','','5','SRA->RA_SITFOLH == "D"    .AND. MESANO(SRA->RA_DEMISSA)  == MESANO(DDATAREF)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','DDATAAC := MONTHSUB( DDATAREF , 1 )     .CNT.','000045','000044','.EXE.','5','DDATAAC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT := 0     .CNT.','000046','000044','.EXE.','5','NPRVVACANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT += FBUSCAACM(ACODFOL[776,1],,DDATAAC,DDATAAC,"V")','000047','000044','.EXE.','5','NPRVVACANT += FBUSCAACM(ACODFOL[776,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT += FBUSCAACM(ACODFOL[130,1],,DDATAAC,DDATAAC,"V")','000048','000044','.EXE.','5','NPRVVACANT += FBUSCAACM(ACODFOL[130,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT += ( FBUSCAACM(ACODFOL[233,1],,DDATAAC,DDATAAC,"V','000049','000044','.EXE.','5','NPRVVACANT += ( FBUSCAACM(ACODFOL[233,1],,DDATAAC,DDATAAC,"V") ) * -1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NBASEPRVAC := ROUND(NBASEPROV / 30 * (NDIASPROP), 2 )     .C','000050','000044','.EXE.','5','NBASEPRVAC := ROUND(NBASEPROV / 30 * (NDIASPROP), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NBASEPRVAC += ROUND(NBASEPROV / 30 * ( NDIASVEN), 2 )     .E','000051','000044','.EXE.','5','NBASEPRVAC += ROUND(NBASEPROV / 30 * ( NDIASVEN), 2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','MESANO(SRA->RA_DEMISSA) = SPACE(6)  .OR. MESANO(SRA->RA_DE','000052','000034','.CON.','5','','','5','MESANO(SRA->RA_DEMISSA) = SPACE(6)  .OR. MESANO(SRA->RA_DEMISSA) > MESANO(DDATAREF)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','DDATAAC := MONTHSUB( DDATAREF , 1 )     .CNT.','000053','000052','.EXE.','5','DDATAAC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT := 0     .CNT.','000054','000052','.EXE.','5','NPRVVACANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NBSFER := NBASEPRVAC     .CNT.','000055','000052','.EXE.','5','NBSFER := NBASEPRVAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NBASEPRVAC := ROUND(NBSFER  / 30 * (NDIASPROP), 2 )     .CNT','000056','000052','.EXE.','5','NBASEPRVAC := ROUND(NBSFER  / 30 * (NDIASPROP), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NBASEPRVAC += ROUND( NBSFER  / 30 * ( NDIASVEN), 2 )     .CN','000057','000052','.EXE.','5','NBASEPRVAC += ROUND( NBSFER  / 30 * ( NDIASVEN), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT += FBUSCAACM(ACODFOL[130,1],,DDATAAC,DDATAAC,"V','000058','000052','.EXE.','5','NPRVVACANT += FBUSCAACM(ACODFOL[130,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT += FBUSCAACM(ACODFOL[776,1],,DDATAAC,DDATAAC,"V")','000059','000052','.EXE.','5','NPRVVACANT += FBUSCAACM(ACODFOL[776,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT += (FBUSCAACM(ACODFOL[233,1],,DDATAAC,DDATAAC,"V"','000060','000052','.EXE.','5','NPRVVACANT += (FBUSCAACM(ACODFOL[233,1],,DDATAAC,DDATAAC,"V") ) * -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NIND := NDIASVAC / 365','000061','000034','.EXE.','5','NIND := NDIASVAC / 365','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NIND_MES := NIND * DAY(LASTDAY(DDATAREF))','000062','000034','.EXE.','5','NIND_MES := NIND * DAY(LASTDAY(DDATAREF))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NDIARIO := SRA->RA_SALARIO / 30','000063','000034','.EXE.','5','NDIARIO := SRA->RA_SALARIO / 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NBASEPRVAC := NIND_MES * NDIARIO','000064','000034','.EXE.','5','NBASEPRVAC := NIND_MES * NDIARIO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','DDATAAC := MONTHSUB( DDATAREF , 1 )','000065','000034','.EXE.','5','DDATAAC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT := FBUSCAACM(ACODFOL[776,1],,DDATAAC,DDATAAC,"V")','000066','000034','.EXE.','5','NPRVVACANT := FBUSCAACM(ACODFOL[776,1],,DDATAAC,DDATAAC,"V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','MONTH(DDATAREF) == 1','000067','000034','.CON.','5','','','5','MONTH(DDATAREF) == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT := NBASEPRVAC','000068','000067','.EXE.','5','NPRVVACANT := NBASEPRVAC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','MONTH(DDATAREF) <> 1','000069','000034','.CON.','5','','','5','MONTH(DDATAREF) <> 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRVVAC','NPRVVACANT := NPRVVACANT + NBASEPRVAC','000070','000069','.EXE.','5','NPRVVACANT := NPRVVACANT + NBASEPRVAC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0122    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0122( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOB','SALARIO BASE MES DOS FUNCIONAR','SALARIO','001065','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOB','SALMES     .END.','000001','000000','.EXE.','2','SALMES','','1','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0123    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0123( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOD','SALARIO DIA DOS FUNCIONARIOS','SALDIA','001066','007','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','sra->ra_salario / 30   .END.','000003','000002','.EXE.','1','sra->ra_salario','/','5','30','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_TIPOPGT = "S" .AND.','000004','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC = "S" .END.','000005','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO / 7   .END.','000006','000005','.EXE.','1','SRA->RA_SALARIO','/','5','7','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC $ "H*T*G" .END.','000007','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','NHORASDIA := FO_GETVAL(@ORCF, "RCF_HRSDIA")     .CNT.','000008','000007','.EXE.','5','NHORASDIA := FO_GETVAL(@ORCF, "RCF_HRSDIA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO * NHORASDIA   .END.','000009','000007','.EXE.','5','SRA->RA_SALARIO','*','5','NHORASDIA','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC = "D" .END.','000010','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO     .END.','000011','000010','.EXE.','1','SRA->RA_SALARIO','','5','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0124    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0124( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOH','SALARIO HORA DOS FUNCIONARIOS','SALHORA','001067','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','sra->ra_salario / SRA->RA_HRSMES   .END.','000003','000002','.EXE.','1','sra->ra_salario','/','1','SRA->RA_HRSMES','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_TIPOPGT = "S" .AND.','000004','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC = "S" .END.','000005','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SALHORA := SRA->RA_SALARIO / 7 .CNT.','000006','000005','.EXE.','2','SALHORA',':=','1','SRA->RA_SALARIO','/','5','7','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SALHORA *= 30 / SRA->RA_HRSMES .END.','000007','000005','.EXE.','2','SALHORA','*=','5','30','/','1','SRA->RA_HRSMES','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC $ "H*T*G" .END.','000008','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_SALARIO     .END.','000009','000008','.EXE.','1','SRA->RA_SALARIO','','5','','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC = "D" .END.','000010','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_SALARIO * 30 / SRA->RA_HRSMES .END.','000011','000010','.EXE.','1','SRA->RA_SALARIO','*','5','30','/','1','SRA->RA_HRSMES','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0125    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0125( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOM','SALARIO MENSAL DOS FUNCIONARIO','','001068','008','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := sra->ra_salario   .CNT.','000003','000002','.EXE.','5','SALMES',':=','5','sra->ra_salario','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000004','000002','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000005','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_TIPOPGT = "S" .AND.','000006','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC = "S" .END.','000007','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO / 7 * 30 .CNT.','000008','000007','.EXE.','5','SALMES := SRA->RA_SALARIO','/','5','7','*','5','30','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000009','000007','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000010','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "H*T*G" .AND.','000011','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTipoRot == "1" .END.','000012','000000','.CON.','2','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','NCOMPHRS := nHorasTrab + nHorasDSR .CNT.','000013','000012','.EXE.','2','NCOMPHRS',':=','5','nHorasTrab','+','5','nHorasDSR','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * NCOMPHRS   .CNT.','000014','000012','.EXE.','5','SALMES := SRA->RA_SALARIO','*','2','NCOMPHRS','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000015','000012','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000016','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC == "H" .AND.','000017','000000','.CON.','2','','','1','SRA->RA_CATFUNC','==','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTipoRot == "2I" .AND.','000018','000000','.CON.','2','','','5','cTipoRot','==','5','"2I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cCompMes == "S" .AND.','000019','000000','.CON.','2','','','2','cCompMes','==','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTip == "B" .END.','000020','000000','.CON.','2','','','2','cTip','==','5','"B"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','NCOMPHRS := nHorasTrab + nHorasDSR .CNT.','000021','000020','.EXE.','2','NCOMPHRS',':=','5','nHorasTrab','+','5','nHorasDSR','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * NCOMPHRS   .CNT.','000022','000020','.EXE.','5','SALMES := SRA->RA_SALARIO','*','2','NCOMPHRS','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000023','000020','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000024','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "H*T*G" .END.','000025','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * SRA->RA_HRSMES   .CNT.','000026','000025','.EXE.','5','SALMES := SRA->RA_SALARIO','*','1','SRA->RA_HRSMES','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000027','000025','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000028','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC = "D" .END.','000029','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * 30   .END.','000030','000029','.EXE.','5','SALMES := SRA->RA_SALARIO','*','5','30','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0126    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0126( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALDISS','SALARIO DISSIDIO','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','SALDISS','lDissidio   .END.','000001','000000','.CON.','5','','','5','lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDISS','fSalDiss(@Salario,@SalHora,@SalDia,@SalMes)     .CNT.','000002','000001','.EXE.','5','fSalDiss(@Salario,@SalHora,@SalDia,@SalMes)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDISS','aPerAberto:= {}     .CNT.','000003','000001','.EXE.','5','aPerAberto:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDISS','aPerFechado:= {}     .CNT.','000004','000001','.EXE.','5','aPerFechado:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDISS','fRetPerComp( SubStr(cPeriodo,5,2), SubStr(cPeriodo,1,4), Nil','000005','000001','.EXE.','5','fRetPerComp( SubStr(cPeriodo,5,2), SubStr(cPeriodo,1,4), Nil, Nil, Nil, @aPerAberto, @aPerFechado)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDISS','aPDOld:= RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT, NIL,','000006','000001','.EXE.','5','aPDOld:= RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, aPerAberto, aPerFechado)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0127    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0127( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALDOSAL','SALDO DE SALARIO - RESCISAO','','000291','017','2','1',} )

aAdd(aRc3Cols, { '','S_','SALDOSAL','cVrbSaldo := FGETCODFOL("0048")     .CNT.','000001','000000','.EXE.','5','cVrbSaldo := FGETCODFOL("0048")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','cVrbInde := FGETCODFOL("0430")     .CNT.','000002','000000','.EXE.','5','cVrbInde := FGETCODFOL("0430")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','cVrbSaldo # SPACE(3) .And. aIncRes[17] = "S" .And. P_CALCI','000003','000000','.CON.','5','','','5','cVrbSaldo # SPACE(3) .And. aIncRes[17] = "S" .And. P_CALCINF # "S" .AND. !FO_SEEK(@&cObjeto,{cCpoPd},{cVrbSaldo})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSaldoSal := 0.00     .CNT.','000004','000003','.EXE.','5','nSaldoSal := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSldDSRInd:= 0.00     .CNT.','000005','000003','.EXE.','5','nSldDSRInd:= 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nDiasInd := 0     .CNT.','000006','000003','.EXE.','5','nDiasInd := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','!P_MESPARTI .AND. MesAno(dDataDem) = MesAno(SRA->RA_ADMISS','000007','000003','.CON.','5','','','5','!P_MESPARTI .AND. MesAno(dDataDem) = MesAno(SRA->RA_ADMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nDiasSd := (Day(SRA->RA_ADMISSA) - 1)     .END.','000008','000007','.EXE.','5','nDiasSd := (Day(SRA->RA_ADMISSA) - 1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','! lModDataDem .and. cVrbInde <> space(3) .and. P_SABDOM ==','000009','000003','.CON.','5','','','5','! lModDataDem .and. cVrbInde <> space(3) .and. P_SABDOM == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nDiasInd := If( dDataDem <> GETMEMVAR("RG_DATADEM"),1,0 )','000010','000009','.EXE.','5','nDiasInd := If( dDataDem <> GETMEMVAR("RG_DATADEM"),1,0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','cPaisLoc <> "DOM"   .END.','000011','000003','.CON.','5','','','5','cPaisLoc <> "DOM"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','SRA->RA_TIPOPGT = "S"   .END.','000012','000011','.CON.','5','','','5','SRA->RA_TIPOPGT = "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSaldoSal := Round( (Salario / 30) * Diastrab,MsDecimais(1))','000013','000012','.EXE.','5','nSaldoSal := Round( (Salario / 30) * Diastrab,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','SRA->RA_TIPOPGT <> "S"   .END.','000014','000011','.CON.','5','','','5','SRA->RA_TIPOPGT <> "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','DiasTrab -= ( nDiasSd + nDiasInd )     .CNT.','000015','000014','.EXE.','5','DiasTrab -= ( nDiasSd + nDiasInd )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','SRA->RA_CATFUNC=="H"   .END.','000016','000014','.CON.','5','','','5','SRA->RA_CATFUNC=="H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSaldoSal := Round( SALDIA * Diastrab,MsDecimais(1))     .CN','000017','000016','.EXE.','5','nSaldoSal := Round( SALDIA * Diastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSldDSRInd:= Round( SALDIA * nDiasInd,MsDecimais(1))     .EN','000018','000016','.EXE.','5','nSldDSRInd:= Round( SALDIA * nDiasInd,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','SRA->RA_CATFUNC <> "H"   .END.','000019','000014','.CON.','5','','','5','SRA->RA_CATFUNC <> "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSaldoSal := Round( (Salario / 30) * Diastrab,MsDecimais(1))','000020','000019','.EXE.','5','nSaldoSal := Round( (Salario / 30) * Diastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSldDSRInd:= Round( (Salario / 30) * nDiasInd,MsDecimais(1))','000021','000019','.EXE.','5','nSldDSRInd:= Round( (Salario / 30) * nDiasInd,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSaldoSal := IF (nSalDoSal-nSalPgto > 0.00,nSaldoSal-nSalPgt','000022','000011','.EXE.','5','nSaldoSal := IF (nSalDoSal-nSalPgto > 0.00,nSaldoSal-nSalPgto,0.00)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSaldoSal > 0   .END.','000023','000003','.CON.','5','','','5','nSaldoSal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras},{cVrbSaldo,nSa','000024','000023','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras},{cVrbSaldo,nSaldoSal,DiasTrab},cCpoPd,cVrbSaldo)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','nSldDSRInd > 0   .END.','000025','000003','.CON.','5','','','5','nSldDSRInd > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALDOSAL','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras},{cVrbInde,nSld','000026','000025','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras},{cVrbInde,nSldDsrInd,nDiasInd},cCpoPd,cVrbInde)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0128    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0128( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALINC','SALARIO INCORPORADO','','000267','019','2','1',} )

aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRC()     .CNT.','000001','000000','.EXE.','5','S_CARGASRC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCH()     .CNT.','000002','000000','.EXE.','5','S_CARGARCH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGATAB()     .CNT.','000003','000000','.EXE.','5','S_CARGATAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCF()     .CNT.','000004','000000','.EXE.','5','S_CARGARCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRF()     .CNT.','000005','000000','.EXE.','5','S_CARGASRF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRO()     .CNT.','000006','000000','.EXE.','5','S_CARGASRO()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARG1()     .CNT.','000007','000000','.EXE.','5','S_CARGARG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCM()     .CNT.','000008','000000','.EXE.','5','S_CARGARCM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASR8()     .CNT.','000009','000000','.EXE.','5','S_CARGASR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSR8()     .CNT.','000010','000000','.EXE.','5','S_PROCSR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_DIASTRAB()     .CNT.','000011','000000','.EXE.','5','S_DIASTRAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOM()     .CNT.','000012','000000','.EXE.','5','S_SALARIOM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOD()     .CNT.','000013','000000','.EXE.','5','S_SALARIOD()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOH()     .CNT.','000014','000000','.EXE.','5','S_SALARIOH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOB()     .CNT.','000015','000000','.EXE.','5','S_SALARIOB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALMIN()     .CNT.','000016','000000','.EXE.','5','S_SALMIN()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSRO()     .CNT.','000017','000000','.EXE.','5','S_PROCSRO()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_BASEATVF()     .CNT.','000018','000000','.EXE.','5','S_BASEATVF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCRG1()     .CNT.','000019','000000','.EXE.','5','S_PROCRG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSRC()     .END.','000020','000000','.EXE.','5','S_PROCSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0129    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0129( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALMED','SALARIO COMPOSTO PARA MEDIA','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','SALMED','( CTIPOROT $ "1*3" ) .AND. ( P_NINCMED > 0 )   .END.','000001','000000','.CON.','5','','','5','( CTIPOROT $ "1*3" ) .AND. ( P_NINCMED > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALMED','SALHORA := ( SRA->RA_SALARIO + P_NINCMED ) / SRA->RA_HRSMES','000002','000001','.EXE.','5','SALHORA := ( SRA->RA_SALARIO + P_NINCMED ) / SRA->RA_HRSMES','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0130    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0130( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALMIN','SALARIO MINIMO','VAL_SALMIN','000268','011','2','1',} )

aAdd(aRc3Cols, { '','S_','SALMIN','VAL_SALMIN := FTABELA("S005",1,4, dDataRef)     .CNT.','000001','000000','.EXE.','5','VAL_SALMIN := FTABELA("S005",1,4, dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALMIN','Type("VAL_SALMIN") = "U" .END.','000002','000000','.CON.','5','','','5','Type("VAL_SALMIN")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALMIN','VAL_SALMIN := 0   .END.','000003','000002','.EXE.','5','VAL_SALMIN',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0131    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0131( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SINDICAL','CALCULO CONTRIBUICAO SINDICAL','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','SINDICAL','nContri_b := 0   .CNT.','000001','000000','.EXE.','5','nContri_b',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','dDtIniA := ctod("//")   .CNT.','000002','000000','.EXE.','5','dDtIniA',':=','5','ctod("//")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','dDtFimA := ctod("//")   .CNT.','000003','000000','.EXE.','5','dDtFimA',':=','5','ctod("//")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','cTipAfA := " "   .CNT.','000004','000000','.EXE.','5','cTipAfA',':=','5','" "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lDescSin := .F.   .CNT.','000005','000000','.EXE.','5','lDescSin',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000006','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','cFilSind == NIL .OR.','000007','000000','.CON.','5','','','5','cFilSind','==','5','NIL','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_FILIAL <> cFilSind .END.','000008','000000','.CON.','5','','','5','SRA->RA_FILIAL','<>','5','cFilSind','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','cFilSind := SRA->RA_FILIAL   .CNT.','000009','000008','.EXE.','5','cFilSind',':=','5','SRA->RA_FILIAL','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nDTrSind := P_DTRSIND   .END.','000010','000008','.EXE.','5','nDTrSind',':=','5','P_DTRSIND','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lSalBase := If (cTipoRot == "1", .T. ,.F. )   .CNT.','000011','000000','.EXE.','5','lSalBase',':=','5','If (cTipoRot == "1", .T. ,.F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_TIPOPGT <> "S" .OR.','000012','000000','.CON.','5','','','5','SRA->RA_TIPOPGT','<>','5','"S"','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lUltSemana == .F. .END.','000013','000000','.CON.','5','','','5','lUltSemana','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','MONTH(dDatabase) >= 3 .OR.','000014','000013','.CON.','5','','','5','MONTH(dDatabase)','>=','5','3','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_PGCTSIND $ "D*T" .END.','000015','000013','.CON.','5','','','5','SRA->RA_PGCTSIND','$','5','"D*T"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','FGETCODFOL("0068") <> SPACE(3) .END.','000016','000015','.CON.','5','','','5','FGETCODFOL("0068")','<>','5','SPACE(3)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','( If( Type( "lDissidio" ) # "U" .And. lDissidio , .T. , SR','000017','000016','.CON.','5','','','5','( If( Type( "lDissidio" ) # "U" .And. lDissidio , .T. , SRA->RA_PGCTSIND == "S") .And. ( Mesano( SRA->RA_ADMISSAO ) == Mesano( dDatabase ) .Or. Month( dDatabase ) >= 3 ) )','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','( SRA->RA_PGCTSIND $ "D*T" .And. Mesano(dDatabase) > Mesan','000018','000016','.CON.','5','','','5','( SRA->RA_PGCTSIND $ "D*T" .And. Mesano(dDatabase) > Mesano(SRA->RA_ADMISSAO) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nBaseSind == NIL .OR.','000019','000018','.CON.','5','','','5','nBaseSind','==','5','NIL','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nBaseSind <= 0 .END.','000020','000018','.CON.','5','','','5','nBaseSind','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nContri_b := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_SINDICA','000021','000020','.EXE.','5','nContri_b',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_SINDICA", "S" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lSalBase == .T. .END.','000022','000020','.CON.','5','','','5','lSalBase','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nContri_b += IF(SRA->RA_CATFUNC $ "H" .And. cDiasMes = "N" ,','000023','000022','.EXE.','5','nContri_b','+=','5','IF(SRA->RA_CATFUNC $ "H" .And. cDiasMes = "N" , (SRA->RA_SALARIO * SRA->RA_HRSMES ), Salario )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lSalBase == .F. .END.','000024','000020','.CON.','5','','','5','lSalBase','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nContri_b := nContri_b + SALMES .END.','000025','000024','.EXE.','5','nContri_b',':=','5','nContri_b','+','5','SALMES','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nBaseSind > 0 .END.','000026','000018','.CON.','5','','','5','nBaseSind','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','NContri_B := nBaseSind + Salario   .END.','000027','000026','.EXE.','5','NContri_B',':=','5','nBaseSind + Salario','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','NContri_B > 0 .END.','000028','000018','.CON.','5','','','5','NContri_B','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','! FO_SEEK(@&cObjeto, cCpoPD, FGETCODFOL("0068") )   .END.','000029','000028','.CON.','5','','','5','! FO_SEEK(@&cObjeto, cCpoPD, FGETCODFOL("0068") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_CATFUNC $ "M*C*H*T" .AND.','000030','000029','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*H*T"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_TIPOPGT == "M" .END.','000031','000029','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nContri := IF( SRA->RA_CATFUNC $ "H" .And. cDiasMes = "S" ,','000032','000031','.EXE.','5','nContri',':=','5','IF( SRA->RA_CATFUNC $ "H" .And. cDiasMes = "S" , (nCONTRI_B / nULT_DIA ) , (nCONTRI_B / 30 ) )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_CATFUNC == "D" .END.','000033','000029','.CON.','5','','','5','SRA->RA_CATFUNC','==','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nContri := nCONTRI_B / 30   .END.','000034','000033','.EXE.','5','nContri',':=','5','nCONTRI_B / 30','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','!(SRA->RA_CATFUNC $ "M*C*H*T" .And. SRA->RA_TIPOPGT = "M"','000035','000029','.CON.','5','','','5','!(SRA->RA_CATFUNC $ "M*C*H*T" .And. SRA->RA_TIPOPGT = "M" )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','SRA->RA_CATFUNC <> "D" .END.','000036','000029','.CON.','5','','','5','SRA->RA_CATFUNC','<>','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','nContri := (nCONTRI_B / 30)   .END.','000037','000036','.EXE.','5','nContri',':=','5','(nCONTRI_B / 30)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lDescSin := .T.   .CNT.','000038','000029','.EXE.','5','lDescSin',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','cSitFolh == "A" .END.','000039','000029','.CON.','5','','','5','cSitFolh','==','5','"A"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','fChkAfas(SRA->RA_FILIAL,SRA->RA_MAT,dDataBase,@dDtIniA,@dDtF','000040','000039','.EXE.','5','fChkAfas(SRA->RA_FILIAL,SRA->RA_MAT,dDataBase,@dDtIniA,@dDtFimA,@cTipAfa)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','MesAno(dDtIniA) == MesAno(dDataBase) .AND.','000041','000039','.CON.','5','','','5','MesAno(dDtIniA)','==','5','MesAno(dDataBase)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','DIASTRAB < nDTrSind .END.','000042','000039','.CON.','5','','','5','DIASTRAB','<','5','nDTrSind','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lDescSin := .F.   .END.','000043','000042','.EXE.','5','lDescSin',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','MesAno(dDtIniA) # MesAno(dDataBase)   .AND.','000044','000039','.CON.','5','','','5','MesAno(dDtIniA) # MesAno(dDataBase)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','(Empty(dDtFimA) .Or. MesAno(dDtFimA) >= MesAno(dDataBase))','000045','000039','.CON.','5','','','5','(Empty(dDtFimA) .Or. MesAno(dDtFimA) >= MesAno(dDataBase))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SINDICAL','lDescSin := .F.   .END.','000046','000045','.EXE.','5','lDescSin',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0132    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0132( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','TESTE','TESTE','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','TESTE','','000001','','','2','','','1','','','1','','.END.','','',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .And. Empty(xFilial('RC2')) .And. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

