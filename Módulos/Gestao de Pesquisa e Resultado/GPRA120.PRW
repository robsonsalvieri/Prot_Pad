#INCLUDE "GPRDEF.CH"
#INCLUDE "PROTHEUS.CH"
#INCLUDE "SHELL.CH"
#INCLUDE "GPRA120.CH"

/*/


Ŀ
Funo    GPRA120    Autora  Henry Fila            Data  07/02/05 
Ĵ
Descrio  Tabulacao de resultados                                    
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
                                                                    
                                                                    
                                                                    
ٱ


/*/

Function GPRA120(aRotAuto,nOpc)

Local aCores := {	{"KC_STATUS == '1'"									, "BR_VERMELHO" },;
					{"KC_STATUS == '2'"									, "BR_VERDE"	},;
					{"KC_STATUS == '2' .AND. KC_DTATE <= dDataBase" 	, "BR_PRETO"	}}
						

Private cCadastro := STR0012

Private aRotina   := MenuDef()
						
mBrowse(6,1,22,75,"SKC",,,,,,aCores)


Return(.T.)

/*/

Ŀ
Funo     MenuDef   Autor  Conrado Q. Gomes       Data  12.12.06 
Ĵ
Descrio  Definio do aRotina (Menu funcional)                      
Ĵ
Sintaxe    MenuDef()                                                  
Ĵ
Parametros                                                            
Ĵ
 Uso       SIGAGPR                                                    
ٱ


/*/
Static Function MenuDef()
	Local aRotina := {	{ STR0001	,"AxPesqui"		,0	,1	,0	,.F.	}	,;	//Pesquisar
						{ STR0002	,"Gpr010Man"	,0	,2	,0	,.T.	}	,;	//Visualizar
						{ STR0003	,"Gpr120Anl"	,0	,4	,0	,.T.	}	}	//"A
Return(aRotina)

/*


Ŀ
Funo    Gpr120Anl  Autora  Henry Fila            Data  20/10/03 
Ĵ
Descrio  Traz os respondentes da pesquisa                           
Ĵ
Sintaxe    Gpr010Anl()                                                
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.09/08/04710   -Revisao do fonte:Sintaxe, documentacao     
                                                                    
                                                                    
ٱ


*/
Function Gpr120Anl()

Local aCheck   := {}

Local cListBox := ""

Local oListBox
Local oDlgCons
	
aCheck := GprTabAnalyser( 1,  SKC->KC_CODPQ )

If Len( aCheck ) > 0

	DEFINE MSDIALOG oDlgCons TITLE STR0004 FROM 10,0 To 33,60 OF oMainWnd // Entidade

		@ 10,05 Say STR0005 + SKC->KC_CODPQ Of oDlgCons PIXEL
		@ 20,05 Say STR0006 + StrZero( Len( aCheck ), 6 ) Of oDlgCons PIXEL
    
		@ 35,5 LISTBOX oListBox VAR cListBox Fields HEADER ;
			STR0007,;
			STR0008,;
			STR0009,;
			STR0010,;
			STR0011,;
		 SIZE 230,120 PIXEL
		 

		oListBox:SetArray( aCheck )
		
		oListBox:bLine      := { || { 	aCheck[oListBox:nAt,1],;
										aCheck[oListBox:nAt,2],;
										aCheck[oListBox:nAt,3],;
										aCheck[oListBox:nAt,4],;										
										aCheck[oListBox:nAt,5] } }										

	DEFINE SBUTTON FROM 160,205 TYPE 1 ACTION (oDlgCons:End()) ENABLE OF oDlgCons
		
	ACTIVATE MSDIALOG oDlgCons CENTERED		

Else

	Help(" ",1, "GPR120RSP" )
	
Endif	

Return( .T. )


/*


Ŀ
Funo    Gpr120Leg  Autora  Henry Fila            Data  20/10/03 
Ĵ
Descrio  Monta a Legenda das Pesquisas                              
Ĵ
Sintaxe    Gpr010Leg()                                                
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.09/08/04710   -Revisao do fonte:Sintaxe, documentacao     
                                                                    
                                                                    
ٱ


*/
Function Gpr120Leg()

/*
  Ŀ
  VERMELHO  - Ativa                                 
  VERDE     - Inativa                               
  PRETO     - Vencida                               
  
*/

Local aLegenda := {	{"BR_VERMELHO",	STR0005},; 	// "Ativa"
					{"BR_VERDE",	STR0006}}

BrwLegenda(STR0007,STR0008,aLegenda) 			//"Pesquisas","Legenda"

Return( .T. )




