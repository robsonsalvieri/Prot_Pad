#INCLUDE "PROTHEUS.CH"
#INCLUDE "FWLIBVERSION.CH"
#include "totvs.ch"
#include "msobject.ch"
#include "totvs.framework.treports.integratedprovider.th"
#include "tlpp-rest.th"
#include "tlpp-core.th"

namespace totvs.protheus.backoffice.sv.fat.listofsalesorders.treportsintegratedprovider
using namespace totvs.framework.treports.integratedprovider

@totvsFrameworkTReportsIntegratedProvider(active=.F., team="SIGAFAT", tables="SC5,SC6,SC9,SF4", name="Relação de Pedidos de Venda", country="BRA")

//-----------------------------------------------------------------------------------
/*/{Protheus.doc} listofsalesordersSmartViewBusinessObjectBRA
Classe para criação do Objeto de Negócio para Relacao de Pedidos de Vendas Brasil.

@author FAT/CRM
@since 06/07/2023
@version 1.0
*/
//-----------------------------------------------------------------------------------  
class listofsalesordersSmartViewBusinessObjectBRA from totvs.protheus.backoffice.sv.fat.listofsalesorders.treportsintegratedprovider.listofsalesordersSmartViewBusinessObject
    
    public method new() as object
    public method preData() as object
    public method processData() as object
    public method preSchema() as object

endclass
 
//-------------------------------------------------------------------
/*{Protheus.doc} new
Método de instância da classe
 
@return object: self
 
@author FAT/CRM
@since 06/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method new() class listofsalesordersSmartViewBusinessObjectBRA 
	
    _Super:new()

return self

//-------------------------------------------------------------------
/*{Protheus.doc} preData
Método chamado antes do getData do objeto principal
 
@return object: self:oData
 
@author FAT/CRM
@since 06/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method preData() as object class listofsalesordersSmartViewBusinessObjectBRA 
	
    //Aqui é adicionada uma condição no where que será utilizado na query do objeto padrão

Return self:oData

//-------------------------------------------------------------------
/*{Protheus.doc} processData
Deverá ser chamado no momento do processamento da query
 
@return object: self:oData
 
@author FAT/CRM
@since 06/07/2023
@version 1.0
*/
//-------------------------------------------------------------------    
method processData(nOperLoc as numeric) as object class listofsalesordersSmartViewBusinessObjectBRA
    
    Do Case

        //---------------------------------------------------
        //Operação 1 será utilizado somente para commit dos 
        //campos antes do appendData 
        //Case (nOperLoc == 1)
        //---------------------------------------------------
        Case nOperLoc == 1 //Commit - AppendData

        //---------------------------------------------------
        //Utilizar para países que o calculo de impostos 
        //depende da serie
        //Case (nOperLoc == 2) 
        //---------------------------------------------------
        Case nOperLoc == 2
        
        //---------------------------------------------------
        //Busca o Valor de IPI (Brasil)
        //---------------------------------------------------
        Case nOperLoc == 3
            self:nValIPILoc := MaFisRet(self:nItemLoc,"IT_VALIPI")

        //---------------------------------------------------
        //Soma Composicao IPI+ICMS+ISS (Brasil)
        //---------------------------------------------------
        Case nOperLoc == 4
            self:nValIPILoc := MaFisRet(self:nItemLoc,"IT_VALICM") + MaFisRet(self:nItemLoc,"IT_VALISS")

    EndCase
        
return

//-------------------------------------------------------------------
/*{Protheus.doc} preSchema
Método chamada antes do getSchema do objeto principal
 
@return object: self:oSchema
 
@author FAT/CRM
@since 06/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method preSchema() as object class listofsalesordersSmartViewBusinessObjectBRA

    //Adição de novos campos personalizados (não existem na tabela)

return self:oSchema
