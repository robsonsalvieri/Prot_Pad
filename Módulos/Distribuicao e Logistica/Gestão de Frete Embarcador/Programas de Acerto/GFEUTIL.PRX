#INCLUDE "PROTHEUS.CH"

//------------------------------------------------
/*/{Protheus.doc} GFEFUNGE
Programa de chamada de funções genéricas

@version 1.0
/*/
//------------------------------------------------

Function GFEFUNGE()
cFuncao := Space(50)
cParame := Space(200)
nOpca   := 1

	If !FWIsAdmin( __cUserID )
		gfehelp('Atenção! Por questão de segurança esta rotina poderá ser executada somente pelo Administrador do Sistema.','Executar o login com o usuário Administrador.','Permissão de Execução.')
		Return
	EndIf

	DEFINE MSDIALOG oDlg TITLE "Chamada de Função Genérica - Administrador" From 15,15 To 30,85 OF oMainWnd
	@ 4,2 SAY "Nome da Função"
	@ 4,8 MSGET cFuncao Picture "@!" SIZE 50,12 VALID NaoVazio() .And. GFEFUNCRPO()
	@ 5,2 SAY "Parâmetros" 
	@ 5,8 MSGET cParame Picture "@!" SIZE 200,12
	ACTIVATE MSDIALOG oDlg ON INIT EnchoiceBar(oDlg,{||nOpca:=2,oDlg:End()},{||nOpca:=1,oDlg:End()})

	If nOpca == 2 .And. AllTrim(cFuncao) $ "U_GFES001;U_GFES002;U_GFES003;U_GFES004;U_GFES005;ALERT;CHKFILE"
		&(AllTrim(cFuncao)+'('+AllTrim(cParame)+')')
	ElseIf nOpca != 1
		gfehelp('Atenção! Por questão de segurança esta rotina não poderá ser executada.',' ','Permissão de Execução.')
	EndIf

Return

//------------------------------------------------
/*/{Protheus.doc} GFEFUNGE
Verifica se a função existe no RPO

@version 1.0
/*/
//------------------------------------------------
Static Function GFEFUNCRPO()

	If !FindFunction(cFuncao)
		MsgInfo("Função não encontrada no RPO em uso.")
		Return .F.
	EndIf

Return .T.
