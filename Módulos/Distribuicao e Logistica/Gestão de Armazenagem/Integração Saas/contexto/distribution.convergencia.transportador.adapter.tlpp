#include 'totvs.ch'
#include 'parmtype.ch'
#include 'TopConn.ch'
#include "tlpp-core.th"

#define A4_NOME 1
#define A4_CGC 2
#define A4_INSEST 3
#define A4_EST 4

//-------------------------------------------------------------------
/*/{Protheus.doc} WMSSaasTransportadorAdapter
Classe Adapter para montar transportador
@author  Filipe Mendes
@since 23/04/2024  
/*/
//-------------------------------------------------------------------
Class WMSSaasTransportadorAdapter FROM FWAdapterBaseV2
	Static Method montaPayload() as json
EndClass

//-------------------------------------------------------------------
/*/{Protheus.doc} MontaPayload
Metodo est√°tico para retornar payload de Transportador para cadastro no Saas.
@author  Filipe Mendes
@since 23/04/2024  
/*/
//-------------------------------------------------------------------
Method montaPayload(cCodigo) Class WMSSaasTransportadorAdapter as json
Local nTamTransp     := TamSx3("A4_COD")[1]
Local aTransportador := GetAdvFVal("SA4", { "A4_NOME", "A4_CGC", "A4_INSEST", "A4_EST" }, xFilial("SA4")+Padr(cCodigo,nTamTransp), 1, { "", "", "", "" })
Local tipoPessoa     := WMSSaasGetTipoPessoaByDocument(Alltrim(aTransportador[A4_CGC]))

Return {;
      "nome": Alltrim(aTransportador[A4_NOME]),;
      "tipoPessoa": tipoPessoa,;
      "documentoIdentificacao": Alltrim(aTransportador[A4_CGC]),;
      "inscricaoEstadual": Alltrim(aTransportador[A4_INSEST]),;
      "endereco":{;
         "unidadeFederativa": Alltrim(Upper(aTransportador[A4_EST]));
      },;
      "chaveExterna":{;
         "codigo": Alltrim(cCodigo);
      };
   }
