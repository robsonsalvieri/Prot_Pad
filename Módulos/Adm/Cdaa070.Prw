#include "CDAA070.ch"
#Include "protheus.ch"

/*/


Ŀ
Funo     CdaA070   Autor  Wagner Mobile Costa    Data  16/08/01 
Ĵ
Descriao  Programa de atualizacao dos cadastro de produtos x edicoes 
Ĵ
 Uso       SigaCda                                                    
ٱ


/*/

Function CdaA070

PRIVATE aRotina 	:= MenuDef()

//Ŀ
// Define o titulo da manutencao					                 
//
PRIVATE cCadastro := STR0006 //"Produtos x edicoes"

//Ŀ
// Endereca a funcao de BROWSE                                  
//
If AMIIn(44)
	mBrowse( 6, 1,22,75, "AHB")
EndIf

Return .T.

/*/


Ŀ
Funo    Cd070IniLj Autor  Wagner Mobile Costa    Data  20/08/01 
Ĵ
Descrio  Inicializa o numero da loja                                
Ĵ
 Uso       CdaA070                                                    
ٱ


/*/
Function Ca070IniLj()

Local lRet 		:= .T.
Local cCampo	:= &(ReadVar()), cLojaFor := ""

SA2->(DbSeek(xFilial("SA2") + M->AHB_FORNEC))
If Empty(cCampo)
	cLojaFor := "  "		
Else
	cLojaFor := SA2->A2_LOJA
Endif
M->AHB_LOJAFO := cLojaFor

CdaAtEnchoice("AHB_LOJAFO")

lRet := Ca070ChkLj()

Return lRet

/*/


Ŀ
Funo    Ca070ChkLj Autor  Wagner Mobile Costa    Data  20/08/01 
Ĵ
Descrio  Checa se a loja esta' cadastrada para o fornecedor digitado
Ĵ
 Uso       CdaA070                                                    
ٱ


/*/
Function Ca070ChkLj()

Local cFornece 	:= M->AHB_FORNEC
Local cLojaFor 	:= M->AHB_LOJAFO
Local lRet 		:= ExistCpo("SA2", cFornece+cLojaFor)

Return lRet

/*/


Ŀ
Funo     Ca070Qto  Autor  Wagner Mobile Costa    Data  09/09/01 
Ĵ
Descrio  Funcao que calcula as quantidades/percentual de exemplares 
Ĵ
 Uso       CdaA070                                                    
ٱ


/*/
Function Ca070Qto()

Local lRet := Positivo()

Return lRet

/*/


Ŀ
Funo    Ca070Edicao Autor  Wagner Mobile Costa   Data  06/09/01 
Ĵ
Descrio  Funcao de verificacao do produto/edicao digitada 		  
Ĵ
 Uso       CdaA070 - AHB_PRODUT e AHB_EDICAO                          
ٱ


/*/
Function Ca070Edicao()

Local lRet := .T.

If ReadVar() = "M->AHB_PRODUT"
	lRet := ExistCpo("SB1")
Endif

If lRet
	ExistChav("AHB", M->AHB_PRODUT+M->AHB_EDICAO)
Endif

If lRet .And. ReadVar() = "M->AHB_PRODUT"
	If Empty(M->AHB_OBSISB)
		M->AHB_ISBN		:= SB1->B1_ISBN
	Endif
	If Empty(M->AHB_OBSISB)
		M->AHB_OBSISB 	:= SB1->B1_OBSISBN
	Endif
	If Empty(M->AHB_TITORI)
		M->AHB_TITORI 	:= SB1->B1_TITORIG
	Endif
	If Empty(M->AHB_SERIE)
		M->AHB_SERIE  	:= SB1->B1_SERIE 
	Endif
	If Empty(M->AHB_NROPAG)
		M->AHB_NROPAG 	:= SB1->B1_NROPAG
	Endif
	CdaAtEnchoice({ "AHB_ISBN", "AHB_OBSISB", "AHB_TITORI", "AHB_SERIE", "AHB_NROPAG"})
Endif

Return lRet

/*/


Ŀ
Programa  MenuDef    Autor  Marco Bianchi          Data 01/09/2006
Ĵ
Descrio  Utilizacao de menu Funcional                               
                                                                      
                                                                      
Ĵ
Retorno   Nenhum                                                      
Ĵ
ParametrosParametros do array a Rotina:                               
          1. Nome a aparecer no cabecalho                             
          2. Nome da Rotina associada                                 
          3. Reservado                                                
          4. Tipo de Transao a ser efetuada:                        
          		1 - Pesquisa e Posiciona em um Banco de Dados           
              2 - Simplesmente Mostra os Campos                       
              3 - Inclui registros no Bancos de Dados                 
              4 - Altera o registro corrente                          
              5 - Remove o registro corrente do Banco de Dados        
          5. Nivel de acesso                                          
          6. Habilita Menu Funcional                                  
Ĵ
   DATA    Programador   Manutencao efetuada                         
Ĵ
                                                                     
ٱ


/*/

Static Function MenuDef()
     
Private aRotina 	:= {{ STR0001,"AxPesqui",0,1,0,.F.},; //"Pesquisar"
						 	 { STR0002,"AxVisual",0,2,0,NIL},; //"Visualizar"
                      { STR0003,"AxInclui",0,3,0,NIL},; //"Incluir"
                      { STR0004,"AxAltera",0,4,0,NIL},; //"Alterar"
                      { STR0005,"AxDeleta",0,5,0,NIL} } //"Excluir"
								
If ExistBlock("CDA070MNU")
	ExecBlock("CDA070MNU",.F.,.F.)
EndIf

Return(aRotina)