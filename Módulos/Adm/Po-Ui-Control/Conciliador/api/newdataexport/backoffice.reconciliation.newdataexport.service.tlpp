#include "tlpp-core.th"

namespace totvs.protheus.backoffice.reconciliation.newdataexport
using namespace totvs.protheus.backoffice.reconciliation.util

//-------------------------------------------------------------------
/*/{Protheus.doc} NewDataExportService
Classe de serviço, realizada instância e chamada de métodos de serviços

@author Totvs
/*/
//-------------------------------------------------------------------
class NewDataExportService
    public method new()
    public method getInstance()
    public method getAllNewDataExport()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} NewDataExportService
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new() class NewDataExportService
return

//-------------------------------------------------------------------
/*/{Protheus.doc} NewDataExportService
Responsável por instanciar a classe controller

@author Totvs
/*/
//-------------------------------------------------------------------
method getInstance() class NewDataExportService
    static __instance As Object

    If ValType(__instance) == "U"
        __instance := NewDataExportService():new()
    EndIf
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getAllNewDataExport
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method getAllNewDataExport(nPage as Numeric, nPageSize as Numeric) class NewDataExportService
    Local oSettings := Nil as Object
    Local aResponse := {} as Array
    Local cFinType  := tcGetQryParams("type") as Character

    If !Empty(cFinType) .And. FindClass('totvs.protheus.backoffice.reconciliation.newdataexport.NewDataExportProtheusDataFin')
        oSettings := NewDataExportProtheusDataFin():getData()
    Else
        oSettings := NewDataExportProtheusData():getData()
    EndIf

    aResponse := oSettings:getAll()
    FreeObj(oSettings)

return aResponse
