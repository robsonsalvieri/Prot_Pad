#include "tlpp-core.th"

namespace totvs.protheus.backoffice.accountingclosing.accountingcalendar

//-------------------------------------------------------------------
/*/{Protheus.doc} AccountingCalendarService
Classe de serviço, realizada instância e chamada de métodos de serviços

@author Totvs
/*/
//-------------------------------------------------------------------
class AccountingCalendarService
    public method new()
    public method getInstance()
    public method getAllAccountingCalendar()
    public method postBlockCalendar()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} AccountingCalendarService
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new() class AccountingCalendarService
return

//-------------------------------------------------------------------
/*/{Protheus.doc} AccountingCalendarService
Responsável por instanciar a classe controller

@author Totvs
/*/
//-------------------------------------------------------------------
method getInstance() class AccountingCalendarService
    static __instance As Object
    
    If ValType(__instance) == "U"
        __instance := AccountingCalendarService():new()
    EndIf
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getAllAccountingCalendar
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method getAllAccountingCalendar(nPage as Numeric, nPageSize as Numeric, cDatIni as Character, cDatFin as Character, cType as Character) class AccountingCalendarService
    Local oSettings := AccountingCalendarProtheusData():getData() As Object
    Local jResponse := JsonObject():new() As Json

    oSettings:getAll(nPage, nPageSize, cDatIni, cDatFin, cType)

    IIf(oSettings:lOk,; 
            jResponse := oSettings:getJSONResponse(),; 
            jResponse := SetRestFault(oSettings:GetCode(), oSettings:getMessage()))
    
    oSettings:DeActivate()
    FreeObj(oSettings)
return jResponse

//-------------------------------------------------------------------
/*/{Protheus.doc} postBlockCalendar
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method postBlockCalendar(jBody as Json, cResponse as Character) class AccountingCalendarService
    Local oSettings := AccountingCalendarProtheusData():getData() As Object
    Local lReturn   := .F.

    lReturn := oSettings:postBlockCalendar(jBody, @cResponse)
    
    oSettings:DeActivate()
    FreeObj(oSettings)

return lReturn


