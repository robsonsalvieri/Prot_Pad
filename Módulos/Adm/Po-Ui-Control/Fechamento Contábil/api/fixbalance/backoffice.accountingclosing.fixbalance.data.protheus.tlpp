#include "tlpp-core.th"

namespace totvs.protheus.backoffice.accountingclosing.FixBalance

//-------------------------------------------------------------------
/*/{Protheus.doc} FixBalanceProtheusData
Classe responsável pela consulta de dados

@author Totvs
/*/
//-------------------------------------------------------------------
class FixBalanceProtheusData from FWAdapterBaseV2
    Public method new()    
    Static method getData() As object  
    Public method postFixBalance()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} FixBalanceProtheusData
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new(cVerbo as Character, lList as Logical) Class FixBalanceProtheusData
    Default cVerbo := "POST"
    Default lList  := .T.
    _Super:New(cVerbo, lList)
return

//-------------------------------------------------------------------
/*/{Protheus.doc} FixBalanceProtheusData
Método para chamada e validação do tratamento de dados

@author Totvs
/*/
//-------------------------------------------------------------------
method getData() class FixBalanceProtheusData As Object
    static __oActiveData As Object

    If ValType(__oActiveData) == "U"
        __oActiveData := FixBalanceProtheusData():new()
    EndIf
return __oActiveData

//-------------------------------------------------------------------
/*/{Protheus.doc} getAll
Metodo responsável pela busca das configuracoes do conciliador

@author Totvs
/*/
//-------------------------------------------------------------------
method postFixBalance(cCodUUID as Character, cCodCurr as Character) class FixBalanceProtheusData
    Local lMoedaEsp := IIf(cCodCurr == "ALL",.F.,.T.)
    Local lResponse := .F.
    Local cMsg :=''
    Local aReturn		:= {}
    
    QLJ->(dbSetOrder(1))
    If QLJ->(dbSeek(xFilial("QLJ")+cCodUUID))
            //lDireto,dDataIni,  dDataFim,  cFilDe,  cFilAte, cTpSald,lMoedaEsp, cMoeda,   lAtu330, cContaIni, cContaFim, cCodUUID)
        IF (CTBA190(.T.,    dDataBase, dDataBase, cFilAnt, cFilAnt, "1",    lMoedaEsp, cCodCurr, .F.,     " ",        "ZZ",     cCodUUID,@cMsg) )  
            lResponse := .T.
        EndIf
    EndIf
    Aadd( aReturn,lResponse)
    Aadd( aReturn,cMsg)
Return aReturn
