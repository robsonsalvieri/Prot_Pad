#include "tlpp-core.th"

namespace totvs.protheus.backoffice.accountingclosing.checkBalance

//-------------------------------------------------------------------
/*/{Protheus.doc} CheckBalanceService
Classe de serviço, realizada instância e chamada de métodos de serviços

@author Totvs
/*/
//-------------------------------------------------------------------
class CheckBalanceService
    public method new()
    public method getInstance()
    public method getAllCheckBalance()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} CheckBalanceService
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new() class CheckBalanceService
return

//-------------------------------------------------------------------
/*/{Protheus.doc} CheckBalanceService
Responsável por instanciar a classe controller

@author Totvs
/*/
//-------------------------------------------------------------------
method getInstance() class CheckBalanceService
    static __instance As Object
    
    If ValType(__instance) == "U"
        __instance := CheckBalanceService():new()
    EndIf
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getAllCheckBalance
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method getAllCheckBalance(cDatIni as Character, cDatFin as Character, cCurrency as Character,;
                    nPage as Numeric, nPageSize as Numeric, cUUIDBalance as Character) class CheckBalanceService
    Local oSettings := CheckBalanceProtheusData():getData() As Object
    Local jResponse as Json
    
    oSettings:getAll(cDatIni, cDatFin, cCurrency, nPage, nPageSize, cUUIDBalance)
    
    IIf(oSettings:lOk,;
        jResponse := oSettings:getJSONResponse(),;
        jResponse := SetRestFault(oSettings:GetCode(), oSettings:getMessage())) 
    
    oSettings:DeActivate()
    FreeObj(oSettings)
return jResponse
