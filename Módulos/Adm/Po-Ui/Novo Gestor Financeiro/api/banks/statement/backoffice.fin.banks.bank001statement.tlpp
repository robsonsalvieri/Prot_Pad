#INCLUDE 'tlpp-core.th'
#include 'backoffice.fin.banks.Bank001Statement.ch'

NAMESPACE totvs.protheus.backoffice.fin.banks

Static __oInstance As Object
Static __oHshTypes as Object

//-------------------------------------------------------------------
/*/{Protheus.doc} Bank001Statement
	Classe que realiza a comunicação com o Banco do Brasil.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
/*/
//-------------------------------------------------------------------
Class Bank001Statement
	Private  Data cOperation	as Character	// Tipo de transmissão a ser realizada.
	Private  Data cEnvironment	as Character	// Ambiente para transmissão.
	Private  Data jCredentials	as Json			// Credênciais de acesso.
	Private  Data jBody			as Json			// Corpo que será utilizado na transmissao.
	Private  Data jToken		as Json			// Token utilizado para transmissão.
	Public	 Data jMockApiData	as Json			// Mock de API para testes.
	Private  Data lMockData		as Logical		// Utliza dados mockados.
	Private	 Data cError		as Character	// Erros de configuração na comunicação com o banco
	Private	 Data cAppKey		as Character	// Propriedade appkey
	Private	 Data cClientID		as Character	// Propriedade clientId
	Private	 Data cClientSecret	as Character	// Propriedade clientSecret

	// Métodos principais de utilização da classe
	Public  Method new()												// Construtor.
	Static  Method getInstance() as Object								// Retorna a instância statica da classe.
	Public  Method setOperation(cOperation as Character) as Character 	// Configura a operação.
	Public  Method setCredentials(cCredentials as Character) as Logical // Configura as credênciais.
	Public  Method setBody(jBody as Json) as Logical					// Definir o corpo da requisicão.
	Public  Method setToken() as Json									// Gera o token para as requisições.
	Public  Method send() as Json										// Realiza a transmissão com base na operacão.
	Public  Method getError() as Character								// Recupera os erros contido na propriedade ::cError 
	Public  Method testConnection() as json							// Testa a conexão com o banco do Brasil.

	// Métodos da operacão de extrato bancário
	Public   Method getBanksStatement() as Json										// Consulta de extrato bancário.
	Public   Method bankStatementReconciliation() as Json							// Consulta de extrato bancário.
	Public   Method formatBankStatement(jResult as Json) as Logical					// Formata o json de extrato para o padrão esperado.
	Public   Method getStatementType(cCodeTipe as Character) as Character			// Obtem o codigo do processo no protheus de acordo com o banco.
	Private  Method checkBanksStatementCredentials() as Logical						// Valida as credênciais para operacao de extrato.
	Private  Method validBodyBanksStatement(jBody as Json) as Logical				// Valida o body para operacao de extrato.
	Private  Method setBodyBankStatementReconciliation(jBody as Json) as Logical	// Configura o body da requisição para o conciliaçao bancária.

	// Métodos para testes
	Public   Method setMockData(jMockData as Json) 									// Realiza o mock dos dados para testes.

	// Métodos internos da classe
	Private  Method validCredentials(jCredentials as Json) as Logical	// Valida as crêdenciais de acesso.
	Private  Method getURLAuth() as Character							// Obtem URL para o Token.
	Private  Method getURLAPI() as Character							// Obtem URL para transmissão.
	Private  Method formatErrorsAPI(jResult as Json) as Json			// Formata a resposta de erro da requisição.

	// Métodos staticos
EndClass

//-------------------------------------------------------------------
/*/{Protheus.doc} new
	Classe que realiza a comunicação com o Banco do Brasil.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
/*/
//-------------------------------------------------------------------
Method new() Class Bank001Statement
	::jCredentials 	:= JsonObject():New()
	::jBody 		:= JsonObject():New()
	::jToken 		:= JsonObject():New()
	::jMockApiData  := JsonObject():New()
	::cOperation 	:= ''
	::cEnvironment 	:= '2'
	::cError		:= ''
	::lMockData 	:= .F.
	::cAppKey		:= 'extratoAppKey'
	::cClientId		:= 'extratoClientId'
	::cClientSecret	:= 'extratoClientSecret'
Return Self

//-------------------------------------------------------------------
/*/{Protheus.doc} getInstance
	Retorna intancia unica da classe.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return instance: Object - Objeto de instancia da classe
/*/
//-------------------------------------------------------------------
Method getInstance() as Object Class Bank001Statement
	If __oInstance == Nil
		__oInstance := Bank001Statement():new()
	Endif
Return __oInstance

//-------------------------------------------------------------------
/*/{Protheus.doc} setOperation
	Define qual operação será realizada.

	@author Vinicius do Prado
	@since Dez | 2023
	@type method
	@version 1.0
	@param cOperation: Character - Operação a ser executaaa pela API.
	@return lRet: Logical - Informa se a operação foi configurada com exito.
/*/
//-------------------------------------------------------------------
Method setOperation(cOperation as Character) as Character Class Bank001Statement
	Local cScopeAPI := ""	as Character

	::cOperation := cOperation

	Do Case
		Case ::cOperation == "api_extrato_bancario" .Or. ::cOperation == "api_extrato_bancario_conciliacao"
			cScopeAPI := "extrato-info"
	End Case
Return cScopeAPI

//-------------------------------------------------------------------
/*/{Protheus.doc} setCredentials
	Define as credênciais de acesso para a transmissão.
	
	@author Vinicius do Prado
	@since Dez | 2023
	@type method
	@version 1.0
	@param cCredentials: Character - String contendo o json das credenciais.
	@return lRet: Logical - Informa se as credênciais foram configuradas com exito.
/*/
//-------------------------------------------------------------------
Method setCredentials(cCredentials as Character) as Logical Class Bank001Statement
	Local lRet := .F. as Logical
	Local jCredenValid := JsonObject():New() as Json

	jCredenValid:FromJson(cCredentials)

	lRet := ::validCredentials(jCredenValid)

	If lRet
		::jCredentials := jCredenValid
		::cEnvironment := ::jCredentials["environment"]
	EndIf

Return lRet

//-------------------------------------------------------------------
/*/{Protheus.doc} setBody
	Configura o corpo utilizado na transmissao.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@param jBody: Json - Json com as propriedades necessarias para o corpo da requisição.
	@return lRet: Logical - Informa se o corpo da requisição foi configurado com exito.
/*/
//-------------------------------------------------------------------
Method setBody(jBody as Json) as Logical Class Bank001Statement
	Local lRet := .F. as Logical

	Do Case
		Case ::cOperation == 'api_extrato_bancario'
			lRet := ::validBodyBanksStatement(jBody)
		Case ::cOperation == 'api_extrato_bancario_conciliacao'
			lRet := ::setBodyBankStatementReconciliation(@jBody)
	EndCase
	
	If lRet
		::jBody := jBody
	EndIf
Return lRet

//-------------------------------------------------------------------
/*/{Protheus.doc} setToken
	Método de geração de token de acesso para o Banco do Brasil.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return jToken: Json - Json contendo o token configurado.
/*/
//-------------------------------------------------------------------
Method setToken() as Json Class Bank001Statement
	Local aHeaders 	 := {}                   as Array
	Local cPath    	 := "/oauth/token"       as Character
	Local cUrlBase 	 := "" 					 as Character
	Local cBasic   	 := ""                   as Character
	Local cTokenBody := ""                   as Character
	Local jToken   	 := JsonObject():New()   as Json
	Local oRestToken                         as Object

	cUrlBase := ::getURLAuth()
	cBasic := Encode64(::jCredentials[::cClientId] + ":" + ::jCredentials[::cClientSecret])

	cTokenBody := "grant_type=client_credentials&scope="
	cTokenBody += "extrato-info"

	If !Empty(::jCredentials[::cAppKey]) .And. !Empty(cBasic)
		aadd(aHeaders, 'Content-Type: application/x-www-form-urlencoded')
		aadd(aHeaders, 'Authorization: Basic ' + cBasic)
		cPath += "?gw-dev-app-key=" + ::jCredentials[::cAppKey]
		oRestToken := FwRest():New(cUrlBase)
		oRestToken:SetPostParams(cTokenBody)
		oRestToken:SetPath(cPath)
		If ::lMockData .or. oRestToken:Post(aHeaders)
			cResult := oRestToken:GetResult()
			If ::lMockData .And. ::jMockApiData:hasProperty('token')
				cResult := ::jMockApiData['token']:toJson()
			EndIf
			jToken:FromJSON(cResult)
		EndIf
	EndIf

	::jToken := jToken
Return ::jToken

//-------------------------------------------------------------------
/*/{Protheus.doc} send
	Realiza a transmissao com base na operacao.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return jResult: Json - Json contendo o resultado da requisição.
/*/
//-------------------------------------------------------------------
Method send() as Json Class Bank001Statement
	Local jResult := JsonObject():New() as Json

	Do Case
		Case ::cOperation == 'api_extrato_bancario'
			jResult := ::getBanksStatement()
		Case ::cOperation == 'api_extrato_bancario_conciliacao'
			jResult := ::bankStatementReconciliation()
	EndCase
	
Return jResult

/*/{Protheus.doc} getError
	Recupera os erros de configuração com o banco
	@author Vitor Duca
	@since 18/12/2023
	@version 1.0
	@return ::cError, Character, Erros de configuração com o banco
/*/
Method getError() as Character Class Bank001Statement
Return ::cError

//-------------------------------------------------------------------
/*/{Protheus.doc} getBanksStatement
	Consulta de extrato bancario.
	Operação: api_extrato_bancario.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return jResponse: Json - Json contendo a resposta da requisição para operação de extrato bancario.
/*/
//-------------------------------------------------------------------
Method getBanksStatement() as Json Class Bank001Statement
	Local cUrl         := "" as Character
	Local cPath        := "" as Character
	Local cCert        := "" as Character
	Local cKey         := "" as Character
	Local cResponse	   := "" as Character
	Local cHeaderRet   := "" as Character
	Local cToken   	   := "" as Character
	Local cIdAgency    := "" as Character
	Local cIdAccount   := "" as Character
	Local cPropertyMock:= "" as Character
	Local aHeaders     := {} as Array
	Local nStatusCode  := 0  as Numeric
	Local jResult      := JsonObject():New() as Json
	Local jResponse    := JsonObject():New() as Json

	If ::jToken:hasProperty('access_token')
		cToken	:= ::jToken['access_token']
	EndIf

	cCert := ::jCredentials["certificate"]["cert"]
	cKey  := ::jCredentials["certificate"]["key"]

	cIdAgency := cValToChar(::jBody['agencia'])
	cIdAccount   := cValToChar(::jBody['conta'])

	cUrl  := ::getURLAPI()
	cPath := "conta-corrente/agencia/" + cIdAgency + "/conta/" + cIdAccount
	cPath += "?gw-dev-app-key=" + ::jCredentials[::cAppKey]
	cPath += "&dataInicioSolicitacao=" + cValToChar(::jBody['dataInicioSolicitacao'])
	cPath += "&dataFimSolicitacao=" + cValToChar(::jBody['dataFimSolicitacao'])
	cPath += "&numeroPaginaSolicitacao=" + cValToChar(::jBody['numeroPaginaSolicitacao'])
	cPath += "&quantidadeRegistroPaginaSolicitacao=" + cValToChar(::jBody['quantidadeRegistroPaginaSolicitacao'])
	
	aAdd(aHeaders, "Content-Type: application/json")
	aAdd(aHeaders, "Charset: UTF-8")
	aAdd(aHeaders, "Authorization: Bearer " + cToken)

	If ::cEnvironment <> "1"
		cCert := ""
		cKey  := ""
		aAdd(aHeaders, "x-br-com-bb-ipa-mciteste: 178961031")
	EndIf

	cResponse := HTTPSGet(cUrl + cPath, cCert, cKey, "", "", 30, aHeaders, @cHeaderRet)
	nStatusCode := HTTPGetStatus(cHeaderRet)

	// Realiza o mock da resposta para testes
	If ::lMockData
		If ::jMockApiData:hasProperty('api_extrato_bancario')
			cPropertyMock := "api_extrato_bancario"
		EndIf
		If ::jMockApiData:hasProperty('api_extrato_bancario_conciliacao_pag_' + cValToChar(self:jBody['numeroPaginaSolicitacao']))
			cPropertyMock := 'api_extrato_bancario_conciliacao_pag_' + cValToChar(self:jBody['numeroPaginaSolicitacao'])
		EndIf
		If !Empty(cPropertyMock)
			nStatusCode := self:jMockApiData[cPropertyMock]['statusCode']
			cResponse 	:= encodeutf8(self:jMockApiData[cPropertyMock]:toJson())
		EndIf
	EndIf

	If !Empty(cResponse)
		jResult:FromJson(DecodeUTF8(cResponse))
	EndIf

	jResponse['transmitted'] := nStatusCode >= 200 .And. nStatusCode < 300
	jResponse['statusCode']  := nStatusCode

	If jResponse['transmitted'] .And. jResult <> Nil
		jResponse['data'] := JsonObject():New()
		jResponse['data'] := jResult
	Else
		jResponse['errors'] := ::formatErrorsAPI(jResult)
	EndIf

Return jResponse

//-------------------------------------------------------------------
/*/{Protheus.doc} bankStatementReconciliation
	Consulta de extrato bancario para executar a conciliação bancária.
	Operação: api_extrato_bancario_conciliacao.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return jResponse: Json - Json contendo a resposta da requisição
	para operação de conciliação do extrato bancario.
/*/
//-------------------------------------------------------------------
Method bankStatementReconciliation() as Json Class Bank001Statement
	Local jResponse := JsonObject():New() as Json
	Local jRespoAux := JsonObject():New() as Json
	Local aMoviments := {} as Array
	Local nTamMovi	:= 0 as Numeric

	jResponse := ::getBanksStatement()

	If jResponse:hasProperty('data') .And.;
	 jResponse['data']:hasProperty('listaLancamento') .And.;
	 jResponse['data']:hasProperty('numeroPaginaProximo')
	 
		aMoviments := AClone(jResponse['data']['listaLancamento'])

		While jResponse['data']['numeroPaginaProximo'] != 0
			::jBody['numeroPaginaSolicitacao'] := jResponse['data']['numeroPaginaProximo']
			nTamMovi := Len(aMoviments)
			jRespoAux := ::getBanksStatement()

			If jRespoAux:hasProperty('data')
				jResponse := jRespoAux
				aSize(aMoviments, nTamMovi + Len(jResponse['data']['listaLancamento']))
				aCopy(jResponse['data']['listaLancamento'],aMoviments,,,nTamMovi+1)
			Else
				jResponse := jRespoAux
				aMoviments := {}
				FwLogMsg('ERROR',, "Bank001Statement", "api_extrato_bancario_conciliacao", "", "Share",  jRespoAux:toJson())
				Exit
			EndIf

			If jResponse['data']:hasProperty('numeroPaginaProximo') .And. jResponse['data']['numeroPaginaProximo'] == 0
				Exit
			EndIf
		EndDo

		If jResponse:hasProperty('data')
			jResponse['data']['listaLancamento'] := aMoviments
		EndIf
	EndIf
Return jResponse

//-------------------------------------------------------------------
/*/{Protheus.doc} checkBanksStatementCredentials
	Válida as credênciais para operação de extrato bancario.

	@author Vinicius do Prado
	@since Dez | 2023
	@type method
	@version 1.0
	@param jCredentials: Json - Json contendo as credênciais da operação de extrato para validação.
    @return lRet: Logical - Informa se as credênciais são válidas para operação de extrato.
/*/
//-------------------------------------------------------------------
Method checkBanksStatementCredentials(jCredentials as Json) as Logical Class Bank001Statement
	Local lCredentials := .F. as Logical
	Local lCertificate := .F. as Logical

	If jCredentials:hasProperty("environment") .And. jCredentials:hasProperty(::cAppKey) .And. jCredentials:hasProperty(::cClientId) .And. jCredentials:hasProperty(::cClientSecret)
		If !Empty(jCredentials["environment"]) .And. !Empty(jCredentials[::cAppKey]) .And. !Empty(jCredentials[::cClientId]) .And. !Empty(jCredentials[::cClientSecret])
			lCredentials := .T.
		EndIf
	EndIf

	If jCredentials["certificate"]:hasProperty("cert") .And. jCredentials["certificate"]:hasProperty("key")
		If !Empty(jCredentials["certificate"]["cert"]) .And. !Empty(jCredentials["certificate"]["key"])
			lCertificate := .T.
		EndIf
	EndIf

Return lCredentials .And. lCertificate

//-------------------------------------------------------------------
/*/{Protheus.doc} validBodyBanksStatement
	Metodo de validação do body para transmissao da operação de extrato.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@param jBody: Json - Json contendo as corpo da requisição para validação.
	@return lRet: Logical - Informa se o corpo da requisição é válido para operação.
/*/
//-------------------------------------------------------------------
Method validBodyBanksStatement(jBody as Json) as Logical Class Bank001Statement
	Local lRet := .F. as Logical
	
	If jBody:hasProperty("agencia") .And. jBody:hasProperty("conta") .And. jBody:hasProperty("dataInicioSolicitacao") .And.;
	   jBody:hasProperty("dataFimSolicitacao") .And. jBody:hasProperty("numeroPaginaSolicitacao") .And. jBody:hasProperty("quantidadeRegistroPaginaSolicitacao")

		If !Empty(jBody["agencia"]) .And. !Empty(jBody["conta"]) .And. !Empty(jBody["dataInicioSolicitacao"]) .And.; 
		   !Empty(jBody["dataFimSolicitacao"]) .And. !Empty(jBody["numeroPaginaSolicitacao"]) .And. !Empty(jBody["quantidadeRegistroPaginaSolicitacao"])
			
			If ValType(jBody['agencia']) == 'N' .And. ValType(jBody['conta']) == 'N' .And. ValType(jBody['dataInicioSolicitacao']) == 'N' .And.;
			   ValType(jBody['dataFimSolicitacao']) == 'N' .And. ValType(jBody['numeroPaginaSolicitacao']) == 'N' .And. ValType(jBody['quantidadeRegistroPaginaSolicitacao']) == 'N'
				lRet := .T.
			EndIf
		EndIf
	Endif

	If !lRet
		::cError := STR0003
	Endif
Return lRet

//-------------------------------------------------------------------
/*/{Protheus.doc} setBodyBankStatementReconciliation
	Metodo de configuração do body para operação de conciliação bancária.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
    @return lRet: Logical - Informa se o corpo da requisição foi configurado para operação.
/*/
//-------------------------------------------------------------------
Method setBodyBankStatementReconciliation(jBody as Json) as Logical Class Bank001Statement
	Local jBodyAPI 	:= JsonObject():New() as Json
	Local lRet 		:= .F. as Logical
	Local cBody 	:= ""  as Character
	Local cDtUltJob := ""  as Character
	Local cDtHoje	:= ""  as Character
	Local cParametr	:= ""  as Character
	Local nDataIni 	:= 0   as Numeric
	Local nDataFim 	:= 0   as Numeric

	cParametr := SUPERGETMV( 'MV_FNEXTDT', .F., '' )

	If Empty(cParametr)
		cDtUltJob := Dtos(Date()) 
	Else
		cDtUltJob := SubStr(StrTran(cParametr, "-", ""), 1, 8)
	EndIf

	// Data de inicio
	If StoD(cDtUltJob) == Date()
		cDtUltJob := DtoS(DaySub(StoD(cDtUltJob), 1))
	EndIf
	nDataIni := Val(SubStr(cDtUltJob, 7, 2)+SubStr(cDtUltJob, 5, 2)+SubStr(cDtUltJob, 1, 4))

	// Data final
	cDtHoje := Dtos(DaySub(Date(), 1)) // Executa sempre D-1 pois a efetivacao dos dados ocorre no final do dia
	nDataFim := Val(SubStr(cDtHoje, 7, 2)+SubStr(cDtHoje, 5, 2)+SubStr(cDtHoje, 1, 4))

	// Criação do body
	cBody := '{'
	cBody += 	'"dataInicioSolicitacao": '+cValToChar(nDataIni)+','
	cBody += 	'"dataFimSolicitacao": '+cValToChar(nDataFim)+','
	cBody += 	'"numeroPaginaSolicitacao": 1,'
	cBody += 	'"quantidadeRegistroPaginaSolicitacao": 200,'
	cBody += 	'"agencia": '+Alltrim(SEE->EE_AGENCIA)+','
	cBody += 	'"conta": '+Alltrim(SEE->EE_CONTA)
	cBody += '}'

	jBodyAPI:FromJson(cBody)

	If ::validBodyBanksStatement(jBodyAPI)
		lRet := .T.
		jBody := jBodyAPI
	EndIf

Return lRet

//-------------------------------------------------------------------
/*/{Protheus.doc} validCredentials
	Metodo de validação das credencias para transmissao.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@param jCredentials: Json - Json contendo as credênciais para validação.
    @return lRet: Logical - Informa se as credênciais são válidas para operação.
/*/
//-------------------------------------------------------------------
Method validCredentials(jCredentials as Json) as Logical Class Bank001Statement
	Local lRet := .F. as Logical

	Do Case
		Case ::cOperation == 'api_extrato_bancario' .Or. ::cOperation == 'api_extrato_bancario_conciliacao'
			lRet := ::checkBanksStatementCredentials(jCredentials)
	EndCase

Return lRet

//-------------------------------------------------------------------
/*/{Protheus.doc} setMockData
	Mocka os dados para testes.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@param jMockData: Json - Json contendo os objetos para teste.
/*/
//-------------------------------------------------------------------
Method setMockData(jMockData as Json) Class Bank001Statement
	::jMockApiData := jMockData
	::lMockData := .T.
Return

//-------------------------------------------------------------------
/*/{Protheus.doc} getURLAuth
	URL para token do ambiente de produção e homologação.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return cURL: Character - URL para acceso do token.
/*/
//-------------------------------------------------------------------
Method getURLAuth() as Character Class Bank001Statement
	Local cURL := "https://oauth.bb.com.br" as Character

	If ::cEnvironment == "2"
		cURL := "https://oauth.hm.bb.com.br"
	EndIf
Return cURL

//-------------------------------------------------------------------
/*/{Protheus.doc} getURLAPI
	URL para API do ambiente de produção e homologação.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@return cURL: Character - URL para acceso da API.
/*/
//-------------------------------------------------------------------
Method getURLAPI() as Character Class Bank001Statement
	Local cURL := "" as Character
	
	If ::cOperation == 'api_extrato_bancario' .Or. ::cOperation == 'api_extrato_bancario_conciliacao'
		cURL := "https://api-extratos.bb.com.br/extratos/v1/"
		If ::cEnvironment == "2"
			cURL := "https://api.hm.bb.com.br/extratos/v1/"
		EndIf
	EndIf

Return cURL

//-------------------------------------------------------------------
/*/{Protheus.doc} formatBankStatement
	Padroniza as tags de retorno da operacao de extrato.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
	@param jResponse, Json, Resposta da API que será formatada
	@param aMoviments, Array (Por Referência), Array contendo os movimentos do extrato.
    @return lRet: Logical - Informa se foi possivel formatar os movimentos.
/*/
//-------------------------------------------------------------------
Method formatBankStatement(jResponse as Json, aMoviments as Array) as Logical Class Bank001Statement
	Local nCountMov 	:= 1 	as Numeric
	Local nCountTag 	:= 1 	as Numeric
	Local aItem 		:= {} 	as Array
	Local aTags 		:= {} 	as Array
	Local aMovFormatted := {} 	as Array
	Local aMovResponse	:= {}	as Array
	Local cDateLanc 	:= "" 	as Character
	Local lRet 			:= .T. 	as Logical

	aaDD(aTags, 'indicadorTipoLancamento')
	aaDD(aTags, 'indicadorSinalLancamento')
	aaDD(aTags, 'codigoHistorico')
	aaDD(aTags, 'numeroDocumento')
	aaDD(aTags, 'valorLancamento')
	aaDD(aTags, 'textoDescricaoHistorico')

	aMovResponse := jResponse['data']['listaLancamento']

	For nCountMov := 1 to Len(aMovResponse)
		// Verifica se as propriedades esperadas existem no json
		For nCountTag := 1 to Len(aTags)
			If !aMovResponse[nCountMov]:hasProperty(aTags[nCountTag])
				lRet := .F.
			EndIf
		Next nCountTag
		
		//Linhas de Saldo Inicial, Saldo do Extrato e Saldo Final
		If lRet .and. !(PADL(aMovResponse[nCountMov]['codigoHistorico'], 3, "0") $ "000|998|999")

			// Formata as Tags
			cDateLanc := PadL(cValToChar(aMovResponse[nCountMov]['dataLancamento']),8,'0')

			aItem := {;
				'tipoLancamentoExtrato':  	aMovResponse[nCountMov]['indicadorTipoLancamento'],;
				'carteiraExtrato':  		aMovResponse[nCountMov]['indicadorSinalLancamento'],;
				'codTipoExtrato':  			PADL(aMovResponse[nCountMov]['codigoHistorico'], 3, "0"),;
				'documentoExtrato': 		cValToChar(aMovResponse[nCountMov]['numeroDocumento']),;
				'valorExtrato':    			aMovResponse[nCountMov]['valorLancamento'],;
				'historicoExtrato':    		aMovResponse[nCountMov]['textoDescricaoHistorico'],;
				'dataMovExtrato':    		cDateLanc;
			}
			Aadd(aMovFormatted, aItem)
		EndIf
	Next nCountMov

	If lRet .And. Len(aMovFormatted) > 0
		aMoviments := aClone(aMovFormatted)
	EndIf

	lRet := Len(aMoviments) > 0

Return lRet

//-------------------------------------------------------------------
/*/{Protheus.doc} formatErrorsAPI
	Formata a resposta de erro.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
    @param jResult: Json - Json contendo a resposta da requisição.
/*/
//-------------------------------------------------------------------
Method formatErrorsAPI(jResult as Json) as Json Class Bank001Statement
	Local jErros := JsonObject():New() as Json
	Local cTagError := '' as Character

	jErros['erro'] := STR0001 		// Error API Banco do Brasil
	jErros['message'] := STR0002	// A API do banco retornou um erro inesperado

	If jResult:hasProperty('erros')
		cTagError := 'erros'
	ElseIf jResult:hasProperty('errors')
		cTagError := 'errors'
	EndIf

	If !Empty(cTagError) .And. jResult[cTagError][1]:hasProperty('ocorrencia') .And. jResult[cTagError][1]:hasProperty('mensagem')
		jErros['erro'] := jResult[cTagError][1]['ocorrencia']
		jErros['message'] := jResult[cTagError][1]['mensagem']
	ElseIf jResult:hasProperty('statusCode') .And. jResult:hasProperty('error') .And. jResult:hasProperty('message')
		jErros['erro'] := jResult['error']
		jErros['message'] := jResult['message']
	EndIf

Return jErros

//-------------------------------------------------------------------
/*/{Protheus.doc} testConnection
	Testa a conecção com o banco e valida as credênciais.

	@author Renato Ito
	@since Abril | 2024
	@version 1.0
    @param jCredential: json - Credenciais do banco para teste de conexão.
	@return lRet: Logical - Informa se a conexão foi realizada com sucesso.
/*/
//-------------------------------------------------------------------
method testConnection(jCredential as json) as json class Bank001Statement
	local jToken := JsonObject():New() as Json
	local jResp  := JsonObject():New() as Json
	
	if jCredential:hasProperty("environment")
		::cEnvironment := jCredential ["environment"]
	endIf
	if ::checkBanksStatementCredentials(jCredential)
		::jCredentials := jCredential
		jToken := ::setToken() 
	endIf

	if jToken:hasProperty('access_token') .and. jToken:hasProperty('scope') .and. "extrato-info" $ jToken['scope']
		jResp := jToken
	else
		jResp["error"]   := 'invalid_credentials or scope'
		jResp["message"] := jToken:toJson()
	endIf
return jResp


//-------------------------------------------------------------------
/*/{Protheus.doc} getStatementType
	Retorna a ocorrencia do protheus de acordo com o codigo do banco.

	@author Vinicius do Prado
	@since Dez | 2023
	@version 1.0
    @param nCodeTipe: Numeric - Codigo do tipo de extrato
	@see https://publicador.developers.bb.com.br/bucket/codigo_Historico_aed5095b0f.pdf
/*/
//-------------------------------------------------------------------
Method getStatementType(nCodeTipe as Numeric) as Character Class Bank001Statement
	Local cStatementType := "" as Character

	If __oHshTypes == NIL
		__oHshTypes := FwHashMap():New()
		__oHshTypes:put(1,   "COB")  // Caixa Pagamento
		__oHshTypes:put(2,   "CHQ")  // Cheque
		__oHshTypes:put(3,   "COB")  // Saque contra recibo
		__oHshTypes:put(4,   "COB")  // Saque sem cartão
		__oHshTypes:put(5,   "CHQ")  // Emissão de Cheque de Viagem
		__oHshTypes:put(6,   "CHQ")  // Cheque Visado
		__oHshTypes:put(7,   "COB")  // Estorno de Recebimento
		__oHshTypes:put(8,   "COB")  // Emissão de Ordem de Pagamento
		__oHshTypes:put(9,   "ENC")  // Tarifa de emissão de DOC/TED
		__oHshTypes:put(10,  "ENC")  //  Tarifa Adicional DOC R 5mil
		__oHshTypes:put(19,  "COB")  //  Recebimento de Numerário
		__oHshTypes:put(20,  "COB")  //  Saque contra recibo
		__oHshTypes:put(23,  "COB")  //  Custódia
		__oHshTypes:put(24,  "COB")  //  Pagamento de Empenho
		__oHshTypes:put(28,  "COB")  //  Pagamento Fatura Cartão Cred
		__oHshTypes:put(30,  "COB")  //  Saque com Cartão
		__oHshTypes:put(31,  "COB")  //  Saque com Cartão
		__oHshTypes:put(32,  "COB")  //  Emissão Ordem Bancária
		__oHshTypes:put(33,  "CHQ")  //  Cheque TB
		__oHshTypes:put(34,  "COB")  //  Saque com Cartão
		__oHshTypes:put(35,  "COB")  //  Saque com Cartão
		__oHshTypes:put(40,  "COB")  //  Saque
		__oHshTypes:put(41,  "COB")  //  Aplicação Poupança
		__oHshTypes:put(42,  "COB")  //  Prestação Leasing
		__oHshTypes:put(43,  "ENC")  //  Tarifa Telecomunicação
		__oHshTypes:put(44,  "ENC")  //  Tarifa Serviço Câmbio
		__oHshTypes:put(45,  "ENC")  //  Tarifa Serviço Cobrança
		__oHshTypes:put(46,  "ENC")  //  Tarifa de cadastro
		__oHshTypes:put(47,  "ENC")  //  Tarifa Comércio Exterior
		__oHshTypes:put(48,  "COB")  //  Emissão de DOC D
		__oHshTypes:put(49,  "COB")  //  SQFACIL - Cartão Pagto
		__oHshTypes:put(50,  "COB")  //  Saque Caixa - Cartão Pagamento
		__oHshTypes:put(51,  "COB")  //  Aplicação em CDB/RDB
		__oHshTypes:put(52,  "COB")  //  TED
		__oHshTypes:put(53,  "CHQ")  //  Cheque do Bacen
		__oHshTypes:put(54,  "ENC")  //  Tarifa de Sustação de Cheque
		__oHshTypes:put(55,  "COB")  //  Pagtos Diversos Autorizados
		__oHshTypes:put(56,  "ENC")  //  Tarifa Serviços Diversos
		__oHshTypes:put(57,  "COB")  //  Contribuição
		__oHshTypes:put(58,  "COB")  //  Emissão de DOC
		__oHshTypes:put(59,  "COB")  //  Pagamento de Boleto
		__oHshTypes:put(60,  "COB")  //  Despesas Cartoriais
		__oHshTypes:put(61,  "COB")  //  Pagamento Tributos
		__oHshTypes:put(62,  "COB")  //  TED Transf Eletr Disponivel
		__oHshTypes:put(63,  "COB")  //  Compra de Ações via DOC
		__oHshTypes:put(64,  "COB")  //  Despesas Diversas
		__oHshTypes:put(67,  "COB")  //  Saque no Rural Rápido
		__oHshTypes:put(68,  "COB")  //  Débito Tributos Res D1
		__oHshTypes:put(69,  "COB")  //  Pagamento de Boleto
		__oHshTypes:put(72,  "COB")  // Diferença de Caixa
		__oHshTypes:put(77,  "COB")  // Transf Arrecadação
		__oHshTypes:put(80,  "COB")  // Estorno de Recebimento
		__oHshTypes:put(81,  "COB")  // Pagamento Seguro BB
		__oHshTypes:put(88,  "COB")  // Estorna Lanc. HST.505
		__oHshTypes:put(100, "COB") // Movimento de Caixa
		__oHshTypes:put(101, "COB") // Diário
		__oHshTypes:put(102, "CHQ") // Cheque Compensado
		__oHshTypes:put(103, "CHQ") // Cheque Pago em Outra Agência
		__oHshTypes:put(104, "COB") // Cota Previdenciaria
		__oHshTypes:put(105, "COB") // Comunicação Remessa
		__oHshTypes:put(106, "CHQ") // Pagamento Cheque Visado
		__oHshTypes:put(107, "COB") // Despesas de Comissão
		__oHshTypes:put(108, "COB") // Emissão de ORPAG
		__oHshTypes:put(109, "COB") // Pagamento de Boleto
		__oHshTypes:put(110, "COB") // Estorno Acerto-Crédito
		__oHshTypes:put(111, "COB") // Transferência Autorizada
		__oHshTypes:put(112, "COB") // Débito Autorizado
		__oHshTypes:put(113, "CHQ") // Cheque
		__oHshTypes:put(114, "CHQ") // Devolução Cheque Depositado
		__oHshTypes:put(115, "COB") // Aviso de Débito
		__oHshTypes:put(116, "COB") // Dividendos de Ações
		__oHshTypes:put(117, "COB") // Retenção
		__oHshTypes:put(118, "COB") // Cobrança de I.O.F.
		__oHshTypes:put(119, "COB") // A.C. FECOB
		__oHshTypes:put(120, "COB") // Transferido para Poupança
		__oHshTypes:put(121, "COB") // Transporte de Saldo
		__oHshTypes:put(122, "COB") // Débito BACEN
		__oHshTypes:put(123, "COB") // Cobrança de Juros
		__oHshTypes:put(124, "COB") // Débito Serviço Cobrança
		__oHshTypes:put(125, "COB") // Aplicação Open
		__oHshTypes:put(126, "COB") // Mensalidade UNAMIBB
		__oHshTypes:put(127, "ENC") // Tarifa de Fornecimento Cheque
		__oHshTypes:put(128, "COB") // Transf entre Cooperativa
		__oHshTypes:put(129, "ENC") // Tarifa Depósito Identificado
		__oHshTypes:put(130, "COB") // Anotação Provisória Débito
		__oHshTypes:put(131, "COB") // Débito Autorizado
		__oHshTypes:put(132, "COB") // Emissão de Ordem Bancária
		__oHshTypes:put(133, "COB") // Seguro
		__oHshTypes:put(134, "COB") // Regularização Poupança Ouro
		__oHshTypes:put(135, "ENC") // CPMF liminar Cassada
		__oHshTypes:put(136, "COB") // Juros s/Liminar Cassada CPMF
		__oHshTypes:put(137, "COB") // Multa s/Liminar Cassada CPMF
		__oHshTypes:put(138, "COB") // Ac.Rec.Ags
		__oHshTypes:put(139, "ENC") // CPMF Poupança Liminar Cassad
		__oHshTypes:put(140, "COB") // Adiantamento
		__oHshTypes:put(141, "ENC") // Tarifa Saque Banco 24 Horas
		__oHshTypes:put(142, "ENC") // Tarifa de SMS
		__oHshTypes:put(143, "COB") // Aluguel
		__oHshTypes:put(144, "COB") // Transferência enviada
		__oHshTypes:put(145, "COB") // Aplic Fundo Empresarial DI 60
		__oHshTypes:put(146, "COB") // Apropriação
		__oHshTypes:put(147, "COB") // Desp.SECEX
		__oHshTypes:put(148, "COB") // Baixa
		__oHshTypes:put(149, "COB") // Bonificação
		__oHshTypes:put(150, "COB") // Furnas a Crédito RMHO
		__oHshTypes:put(151, "COB") // Furnas-Pagamento de Pessoal
		__oHshTypes:put(152, "COB") // ASBAC
		__oHshTypes:put(153, "CHQ") // Cheque BACEN
		__oHshTypes:put(154, "COB") // Cobrança Externa
		__oHshTypes:put(155, "COB") // Consignação
		__oHshTypes:put(156, "COB") // Câmbio
		__oHshTypes:put(157, "COB") // Contribuição
		__oHshTypes:put(158, "COB") // CASSI
		__oHshTypes:put(159, "COB") // Cooperativa
		__oHshTypes:put(160, "COB") // Borderô
		__oHshTypes:put(161, "COB") // Furnas - MN Eletr.
		__oHshTypes:put(162, "ENC") // Tarifa de Custódi
		__oHshTypes:put(163, "COB") // Acerto Sistema CR
		__oHshTypes:put(164, "COB") // Despesas Diversas
		__oHshTypes:put(165, "COB") // Despesas de Manutenção
		__oHshTypes:put(166, "COB") // Emissão de DOC
		__oHshTypes:put(167, "COB") // Indenização Sinistro
		__oHshTypes:put(168, "COB") // Pagamento de Ourocap
		__oHshTypes:put(169, "COB") // Devolução
		__oHshTypes:put(170, "ENC") // Tarifas Serviços Diversos
		__oHshTypes:put(171, "COB") // Taxa Compra e Venda de Ações
		__oHshTypes:put(172, "COB") // Diferença de Caixa
		__oHshTypes:put(173, "COB") // Aplicação BB Ações Energia
		__oHshTypes:put(174, "COB") // Atualização
		__oHshTypes:put(175, "COB") // Débito de Ações
		__oHshTypes:put(176, "COB") // Donativos
		__oHshTypes:put(177, "COB") // Empréstimo
		__oHshTypes:put(178, "COB") // Leilão/Balcão Eletrônico
		__oHshTypes:put(179, "ENC") // Encargos
		__oHshTypes:put(180, "COB") // Estorno de Crédito
		__oHshTypes:put(181, "ENC") // Tarifa de saque contra recibo
		__oHshTypes:put(182, "COB") // Aplicação em BB CIN
		__oHshTypes:put(183, "COB") // Saque com cartão no exterior
		__oHshTypes:put(184, "COB") // Est. Anotação Crédito
		__oHshTypes:put(185, "CHQ") // Devolução Cheque Leilão
		__oHshTypes:put(186, "COB") // Imóveis
		__oHshTypes:put(187, "ENC") // Tarifa Saque Caixa até R 1mil
		__oHshTypes:put(188, "COB") // Imposto de Renda
		__oHshTypes:put(189, "COB") // Empréstimo CDC
		__oHshTypes:put(190, "COB") // DCO - Pedágio AG.01-9
		__oHshTypes:put(191, "COB") // Convênio AFPESP
		__oHshTypes:put(192, "COB") // Estorno Recebimento
		__oHshTypes:put(193, "COB") // Débito SECEX
		__oHshTypes:put(194, "COB") // Mensalidade Seguro saúde
		__oHshTypes:put(195, "COB") // Débito Favor INSS
		__oHshTypes:put(196, "COB") // INSS Arrecadação
		__oHshTypes:put(197, "COB") // Liberações
		__oHshTypes:put(198, "COB") // ASSEFAZ Pronto-Socorro
		__oHshTypes:put(199, "COB") // Montreal Turismo - DCO
		__oHshTypes:put(200, "COB") // DMR-Débito
		__oHshTypes:put(201, "ENC") // Tarifa sustação de cheque
		__oHshTypes:put(202, "COB") // Taxa do Banco Central
		__oHshTypes:put(203, "COB") // Saque Agencia Exterior
		__oHshTypes:put(204, "COB") // Cielo - Cartoes
		__oHshTypes:put(205, "ENC") // Tarifa Gerenciador Financeiro
		__oHshTypes:put(206, "COB") // Passagens
		__oHshTypes:put(207, "COB") // Pensão
		__oHshTypes:put(208, "COB") // TRS ANTECIP E ESTORNAD
		__oHshTypes:put(209, "COB") // Prestação de Contas
		__oHshTypes:put(210, "COB") // Proventos
		__oHshTypes:put(211, "COB") // Provisão
		__oHshTypes:put(212, "COB") // UN.NAC.ASSIST.SERVIDOR
		__oHshTypes:put(213, "ENC") // ENCARGOS TRANS ANTECIP
		__oHshTypes:put(214, "ENC") // Tarifa sobre Saque
		__oHshTypes:put(215, "COB") // Comissão sobre Saque
		__oHshTypes:put(216, "COB") // DCO 38583-GRENASP-AG.4
		__oHshTypes:put(217, "COB") // Reserva
		__oHshTypes:put(218, "COB") // Registro
		__oHshTypes:put(219, "COB") // Saque c/ Liquidação Antecipada
		__oHshTypes:put(220, "COB") // Desativado
		__oHshTypes:put(221, "COB") // Repasse
		__oHshTypes:put(222, "COB") // Desativado
		__oHshTypes:put(223, "COB") // Emissão de DOC D
		__oHshTypes:put(224, "COB") // Antecipação Crédito ao Lojista
		__oHshTypes:put(225, "ENC") // Tarifa de Auto-Atendimento BB
		__oHshTypes:put(226, "COB") // Saldo Transferido
		__oHshTypes:put(227, "COB") // Subscrição de Ações
		__oHshTypes:put(228, "COB") // OUROCARD-Business Card
		__oHshTypes:put(229, "COB") // Transferência de Saldo
		__oHshTypes:put(230, "COB") // Juros sem Liminar Cassada
		__oHshTypes:put(231, "ENC") // Tarifa de manutenção de conta
		__oHshTypes:put(232, "COB") // Multa sem Liminar Cassada
		__oHshTypes:put(233, "COB") // Saque com Cartão
		__oHshTypes:put(234, "COB") // Compra com Cartão
		__oHshTypes:put(235, "COB") // Custódia Petrobrás
		__oHshTypes:put(236, "COB") // Férias Licença Prêmio
		__oHshTypes:put(237, "COB") // Financiamento POUPEX
		__oHshTypes:put(238, "COB") // Transfer.conta centralizadora
		__oHshTypes:put(239, "ENC") // Tarifa Adiant a Depositante
		__oHshTypes:put(240, "COB") // Débito Autorizado
		__oHshTypes:put(241, "COB") // Débito Centralizado
		__oHshTypes:put(242, "COB") // Débito Prestação Leasing
		__oHshTypes:put(243, "CHQ") // Cheque Avulso entre Agências
		__oHshTypes:put(244, "ENC") // Tarifa remessa talão cheque
		__oHshTypes:put(245, "COB") // Taxa Confecc Cadastro
		__oHshTypes:put(246, "COB") // ANABB
		__oHshTypes:put(247, "COB") // APABB
		__oHshTypes:put(248, "COB") // Estorno Resgate Automático
		__oHshTypes:put(249, "COB") // FAM FHE
		__oHshTypes:put(250, "COB") // Folha de Pagamento
		__oHshTypes:put(251, "COB") // Conversão P/ o Real
		__oHshTypes:put(252, "COB") // DCO - AAFB
		__oHshTypes:put(253, "COB") // Débito CARIM
		__oHshTypes:put(254, "COB") // Proex
		__oHshTypes:put(255, "COB") // Débito Benefício
		__oHshTypes:put(256, "COB") // Tarifa Conv.SICREDI
		__oHshTypes:put(257, "COB") // Débito Serv.Cambio
		__oHshTypes:put(258, "COB") // Prestação de Serviços
		__oHshTypes:put(259, "ENC") // Estorno Devolução CPMF
		__oHshTypes:put(260, "COB") // Pagamento
		__oHshTypes:put(261, "ENC") // Tarifa de cartão magnético
		__oHshTypes:put(262, "ENC") // Tarifa de abertura de crédito
		__oHshTypes:put(263, "ENC") // Tarifa de Extrato
		__oHshTypes:put(264, "COB") // Juros Saldo Devedor
		__oHshTypes:put(265, "ENC") // IOF S/Saldo Devedor
		__oHshTypes:put(266, "COB") // Aplicação em BB CDB TR
		__oHshTypes:put(267, "COB") // ASSEF MEDI
		__oHshTypes:put(268, "COB") // ASSEF PAT
		__oHshTypes:put(269, "COB") // BB-FIF C.PRAZO-APL.AUT
		__oHshTypes:put(270, "COB") // Folha de Pagamento
		__oHshTypes:put(271, "COB") // BB-APLIC C.PRZ-APL.AUT
		__oHshTypes:put(272, "COB") // Compra de Ações
		__oHshTypes:put(273, "COB") // Aplicação em BB CDB DI
		__oHshTypes:put(274, "COB") // Aplicação em CDB/RDB - cheque
		__oHshTypes:put(275, "ENC") // Tarifa de devolução de cheque
		__oHshTypes:put(276, "COB") // COMP.DIVIDA CARTAO CRE
		__oHshTypes:put(277, "COB") // TRANSF. ARRECADACAO
		__oHshTypes:put(278, "COB") // AQUIS GOV FED - CONAB
		__oHshTypes:put(279, "COB") // BB Vendor
		__oHshTypes:put(280, "COB") // ESTORNO DE CREDITO
		__oHshTypes:put(281, "COB") // AMORT/LIQ SECURITIZ BB
		__oHshTypes:put(282, "COB") // PREVI/CARIM-DCO 43726
		__oHshTypes:put(283, "COB") // AMORT/LIQ SECURIT OUTR
		__oHshTypes:put(284, "COB") // DEBITO BLOQ. JUDICIAL
		__oHshTypes:put(285, "COB") // ACERTO ENTRE CTAS ARRE
		__oHshTypes:put(286, "COB") // RATEIO IPVA ENTRE MUNI
		__oHshTypes:put(287, "COB") // PASEP FOPAG
		__oHshTypes:put(288, "COB") // APLICACAO CBI
		__oHshTypes:put(289, "COB") // APLIC. FIF CURTO PRAZO
		__oHshTypes:put(290, "COB") // Aplicação em Fundo de Ações
		__oHshTypes:put(291, "COB") // Aplicação em Fundo
		__oHshTypes:put(292, "COB") // LANCAMENTO BBDTVM
		__oHshTypes:put(293, "COB") // FORNECIM COMBUSTIVEL
		__oHshTypes:put(294, "COB") // CONTRIBUICAO AMATRA
		__oHshTypes:put(295, "COB") // EST. SEGURO INFLACAO
		__oHshTypes:put(296, "COB") // EST. DE JUROS
		__oHshTypes:put(267, "COB") // GEROF - TIT. COMPRA
		__oHshTypes:put(268, "COB") // DEVOLUCAO CONAB
		__oHshTypes:put(299, "COB") // DL COMPRA
		__oHshTypes:put(300, "COB") // CH. COMPE NACIONAL
		__oHshTypes:put(301, "COB") // PAGTO DIVIDA GOVERNO
		__oHshTypes:put(302, "COB") // Compra-WEB
		__oHshTypes:put(303, "COB") // Pagto via Auto-Atendimento BB
		__oHshTypes:put(304, "COB") // Operações BMF
		__oHshTypes:put(305, "COB") // APL BB-PRINC.GARANTIDO
		__oHshTypes:put(306, "COB") // Pagamento BBCPR
		__oHshTypes:put(307, "COB") // Estorno de crédito
		__oHshTypes:put(308, "COB") // ASS J.TARDE ESTADAO
		__oHshTypes:put(309, "COB") // TRF COMPE COM D+1 CMF
		__oHshTypes:put(310, "ENC") // Tarifa de DOC ou TED
		__oHshTypes:put(311, "ENC") // Tarifa renovação limite crédit
		__oHshTypes:put(312, "CHQ") // Cheque Pré-datado
		__oHshTypes:put(313, "COB") // SALDO DEV. TRANSF BEMA
		__oHshTypes:put(314, "COB") // DIFERENCIAL DE SWAP
		__oHshTypes:put(315, "COB") // GOVERNO PE TRANSF ICMS
		__oHshTypes:put(316, "COB") // GOVERNO PE TRANSF IPVA
		__oHshTypes:put(317, "COB") // GOVERNO PE TRANSF GNR
		__oHshTypes:put(318, "COB") // GOVERNO PE TRANSF BTP
		__oHshTypes:put(319, "COB") // Aplicação Fundo Private
		__oHshTypes:put(320, "ENC") // Cpmf
		__oHshTypes:put(321, "COB") // THE CASH
		__oHshTypes:put(322, "COB") // Bompreço
		__oHshTypes:put(323, "COB") // Mercadorama
		__oHshTypes:put(324, "COB") // Banco 24 Horas
		__oHshTypes:put(325, "COB") // Pagamento com cartão
		__oHshTypes:put(326, "CHQ") // CHEQUE ELETR. TECBAN
		__oHshTypes:put(327, "ENC") // Tarifa TEF TECBAN
		__oHshTypes:put(328, "COB") // Pagto cartão crédito
		__oHshTypes:put(329, "COB") // Autocaixa
		__oHshTypes:put(330, "COB") // Saque com cartão
		__oHshTypes:put(331, "COB") // Saque com cartão
		__oHshTypes:put(332, "COB") // HIPERMIDIA-TECBAN
		__oHshTypes:put(333, "COB") // Aluguel de P.O.S. Tecban
		__oHshTypes:put(334, "COB") // Sendas
		__oHshTypes:put(335, "COB") // Aplicação em BB Fiex
		__oHshTypes:put(336, "COB") // Valetik
		__oHshTypes:put(337, "COB") // TAXA DE AVAL BBCPR
		__oHshTypes:put(338, "COB") // DESP. FINAME - SIST.CF
		__oHshTypes:put(339, "COB") // EXPORT NOTES - DEREF
		__oHshTypes:put(340, "COB") // Bolsa auxílio
		__oHshTypes:put(341, "COB") // Auxílio creche
		__oHshTypes:put(342, "COB") // Importação siscomex
		__oHshTypes:put(343, "COB") // DC0 - INTERNET
		__oHshTypes:put(344, "ENC") // Tarifa S/Saque Rede Branca
		__oHshTypes:put(345, "COB") // Aplicação em BB Fix
		__oHshTypes:put(346, "COB") // Aplicação em Renda Fixa DI
		__oHshTypes:put(347, "COB") // Aplicação BB Fdos.Extramercado
		__oHshTypes:put(348, "COB") // Aplicação BB Aplic Curto Prazo
		__oHshTypes:put(349, "COB") // BB Ações Índice
		__oHshTypes:put(350, "COB") // COTA DAF-DEBITO
		__oHshTypes:put(351, "COB") // Aplicação em CDB/RDB
		__oHshTypes:put(352, "COB") // DEB.SISTEMA CDA -BSB
		__oHshTypes:put(353, "ENC") // Tarifa sobre ações
		__oHshTypes:put(354, "COB") // Bompreço
		__oHshTypes:put(355, "COB") // MERCADORAMA
		__oHshTypes:put(356, "COB") // Sendas
		__oHshTypes:put(357, "COB") // Carrefour
		__oHshTypes:put(358, "COB") // HIPERMIDIA-TECBAN
		__oHshTypes:put(359, "ENC") // Tarifa Adicional DOC R 5mil
		__oHshTypes:put(360, "COB") // OC/OP E DR
		__oHshTypes:put(361, "COB") // Pagamento conta água
		__oHshTypes:put(362, "COB") // Pagamento conta luz
		__oHshTypes:put(363, "COB") // Pagamento conta telefone
		__oHshTypes:put(364, "COB") // Pagamento consórcio
		__oHshTypes:put(365, "COB") // Jornal ou revistas
		__oHshTypes:put(366, "COB") // Condomínio
		__oHshTypes:put(367, "COB") // Sindicato
		__oHshTypes:put(368, "COB") // Bancorbrás
		__oHshTypes:put(369, "COB") // BB Turismo
		__oHshTypes:put(370, "COB") // COOPERFORTE
		__oHshTypes:put(371, "COB") // Satélite seguros
		__oHshTypes:put(372, "COB") // Escola
		__oHshTypes:put(373, "COB") // AABB
		__oHshTypes:put(374, "COB") // Mensalidade clube
		__oHshTypes:put(375, "COB") // Impostos
		__oHshTypes:put(376, "COB") // UNIMED
		__oHshTypes:put(377, "COB") // PAGTO PREMIO SEGURO
		__oHshTypes:put(378, "COB") // Pagamento conta gas
		__oHshTypes:put(379, "COB") // UNAFISCO
		__oHshTypes:put(380, "COB") // TV por assinatura
		__oHshTypes:put(381, "COB") // REMUNERACAO SOBRE ACOE
		__oHshTypes:put(382, "COB") // DEBITO DE CARNET
		__oHshTypes:put(383, "COB") // AGENDAMENTO DEBITO DAR
		__oHshTypes:put(384, "COB") // AGENDAMENTO DEBITO GRP
		__oHshTypes:put(385, "COB") // AGENDAMENTO DEBITO GRC
		__oHshTypes:put(386, "COB") // AGENDAM. DEBITO ICMS-S
		__oHshTypes:put(387, "COB") // Concurso
		__oHshTypes:put(388, "COB") // APLICACAO APLIC PLUS
		__oHshTypes:put(389, "COB") // FDO-ESTORNO
		__oHshTypes:put(390, "COB") // Aplicação em BB Multicarteira
		__oHshTypes:put(391, "COB") // APLIC FUNDO MODERADO
		__oHshTypes:put(392, "CHQ") // Tarif.Adicion.Cheque R 5mil
		__oHshTypes:put(393, "COB") // TED Transf.Eletr.Disponivel
		__oHshTypes:put(394, "COB") // Aplicação em BB FAPI
		__oHshTypes:put(395, "COB") // PLUS AUT APLIC AUTOM
		__oHshTypes:put(396, "COB") // PLUS CP APLICACAO
		__oHshTypes:put(397, "COB") // Emissão de DOC
		__oHshTypes:put(398, "COB") // Aplicação em BB CDB Pré
		__oHshTypes:put(399, "COB") // Aplicação em BB Aplic Pós
		__oHshTypes:put(400, "COB") // TRANSFERENCIA BERON
		__oHshTypes:put(401, "COB") // APLICACAO BB APLIC PUB
		__oHshTypes:put(402, "COB") // Aplicação BB APLIC COR
		__oHshTypes:put(403, "COB") // Aplicação BB Fundos Exclusivos
		__oHshTypes:put(404, "COB") // Débito programado Abril S.A.
		__oHshTypes:put(405, "ENC") // Tarifa Centralização de Saldo
		__oHshTypes:put(406, "COB") // Convênio leasing
		__oHshTypes:put(407, "COB") // DEBITO BB PREVIDENCIA
		__oHshTypes:put(408, "CHQ") // Cheque descontado
		__oHshTypes:put(409, "COB") // CONTRIBUICAO AFESP
		__oHshTypes:put(410, "COB") // Desbloqueio de depósito
		__oHshTypes:put(411, "COB") // Estorno depósito 1 dia
		__oHshTypes:put(412, "COB") // ESTORNO DEP. BL. 2 D
		__oHshTypes:put(413, "COB") // ESTORNO DEP. BL. 3 D
		__oHshTypes:put(414, "COB") // ESTORNO DEP. BL. 4 D
		__oHshTypes:put(415, "COB") // ESTORNO DEP. BL. 5 D
		__oHshTypes:put(416, "COB") // ESTORNO DEP. BL. 6 D
		__oHshTypes:put(417, "COB") // ESTORNO DEP. BL. 7 D
		__oHshTypes:put(418, "COB") // ESTORNO DEP. BL. 8 D
		__oHshTypes:put(419, "COB") // ESTORNO DEP. BL. 9 D
		__oHshTypes:put(420, "COB") // ESTORNO DEP. BL. IND
		__oHshTypes:put(421, "COB") // EST. BLOQUEIO LIBERADO
		__oHshTypes:put(422, "COB") // DEBITO GEAP
		__oHshTypes:put(423, "COB") // Aplicação em BB Fix DI 60 CPMF
		__oHshTypes:put(424, "COB") // CLUBE DE COMPRAS 0800
		__oHshTypes:put(425, "COB") // Aplicação BB Fix CPMF Diário
		__oHshTypes:put(426, "ENC") // TARIFA BB GIRO RAPIDO
		__oHshTypes:put(427, "COB") // BB FIX DI 30
		__oHshTypes:put(428, "COB") // Financiamento Veículo
		__oHshTypes:put(429, "ENC") // Tarifa Processamento de Cheque
		__oHshTypes:put(430, "COB") // TAR.CHQ.PROC. ABX.R 10
		__oHshTypes:put(431, "ENC") // Tarifa processamento depósito
		__oHshTypes:put(432, "ENC") // Tarifa saque em TAA terceiros
		__oHshTypes:put(432, "COB") // DEB LIM EXTRA CART CRE
		__oHshTypes:put(434, "COB") // AJUDA ALIMENTACAO
		__oHshTypes:put(435, "ENC") // Tarifa de Pacote de Serviços
		__oHshTypes:put(436, "COB") // TELEFONE PRE-PAGO
		__oHshTypes:put(437, "COB") // CANCEL. CONV. CTA UNIC
		__oHshTypes:put(438, "COB") // TED
		__oHshTypes:put(439, "COB") // SINDFISCO-DF
		__oHshTypes:put(440, "COB") // RSG ACOES TELEBRASIL
		__oHshTypes:put(441, "COB") // Estorno da PLR
		__oHshTypes:put(442, "ENC") // Tarifa Extrato Unificado
		__oHshTypes:put(443, "COB") // CONTR.ASS.TECN.TES.NAC
		__oHshTypes:put(444, "COB") // PARCELAMENTO DIV. INSS
		__oHshTypes:put(445, "COB") // Pix Enviado
		__oHshTypes:put(446, "COB") // Desativado
		__oHshTypes:put(447, "COB") // APLICACAO FDO BB-DOLAR
		__oHshTypes:put(448, "COB") // APLICACAO FDO MILENIO
		__oHshTypes:put(449, "COB") // SQ CART.ELETR TSF
		__oHshTypes:put(450, "COB") // SQ CART.ELETR TCX
		__oHshTypes:put(451, "COB") // ORBAN FLUX
		__oHshTypes:put(452, "CHQ") // Cheque Pago
		__oHshTypes:put(453, "CHQ") // CHEQUE DEVOLVIDO
		__oHshTypes:put(454, "COB") // SEGURO
		__oHshTypes:put(455, "COB") // CH. TB COMPE NACIONAL
		__oHshTypes:put(456, "CHQ") // Cheque TB Compensado
		__oHshTypes:put(457, "CHQ") // Pagamento Cheque TB
		__oHshTypes:put(458, "CHQ") // PAGAMENTO CHEQUE TB NA
		__oHshTypes:put(459, "COB") // CH.COM.REM.CPMF0
		__oHshTypes:put(460, "COB") // DESPESAS CARTORIAIS
		__oHshTypes:put(461, "COB") // Pagamento Eletronico Boleto
		__oHshTypes:put(462, "COB") // APL FUNDO ACOES COELBA
		__oHshTypes:put(463, "COB") // ESTORNO TRANSF.P/COBR
		__oHshTypes:put(464, "COB") // SAQUE NO RURAL RAPIDO
		__oHshTypes:put(465, "COB") // Brasilprev
		__oHshTypes:put(466, "COB") // Aplicação em Fundo Fix DI 60
		__oHshTypes:put(467, "COB") // AMORT/LIQ. RURAL RAPID
		__oHshTypes:put(468, "COB") // DRIVERS CARD
		__oHshTypes:put(469, "COB") // Aplicação BB Fundos Privativos
		__oHshTypes:put(470, "COB") // Transferência enviada
		__oHshTypes:put(471, "COB") // APLICACAO BB-FIX 30
		__oHshTypes:put(472, "COB") // ESTORNO COMMODITIES
		__oHshTypes:put(473, "COB") // RENDA FIXA - ESTORNO
		__oHshTypes:put(474, "COB") // Transferência enviada
		__oHshTypes:put(475, "COB") // Aplicação em Poupança
		__oHshTypes:put(476, "COB") // TRIBUTOS ESTADUAIS
		__oHshTypes:put(477, "COB") // APLICAÇÃO BB EMPRESARIAL
		__oHshTypes:put(478, "COB") // APLICAÇÃO BB EMPRESARIAL
		__oHshTypes:put(479, "COB") // Aplicação em BB Premium
		__oHshTypes:put(480, "COB") // Aplicação em Poupança
		__oHshTypes:put(481, "COB") // PROAGRO COOPERATIVAS
		__oHshTypes:put(482, "COB") // Depósito em BB Reaplic
		__oHshTypes:put(483, "COB") // Aplicação em BB Cambial
		__oHshTypes:put(484, "COB") // BB-ACOES MASTER
		__oHshTypes:put(485, "COB") // REGUL.RECOLHIM INDEVID
		__oHshTypes:put(486, "COB") // DEBITO POR ORDEM NUCLE
		__oHshTypes:put(487, "COB") // APLICACAO FUNDO ACOES EN
		__oHshTypes:put(488, "COB") // ESTORNA HST 605/657
		__oHshTypes:put(489, "COB") // DEB. AUTOMAT. VITALMED
		__oHshTypes:put(490, "COB") // PAGAMENTO FORNECEDOR
		__oHshTypes:put(491, "COB") // APLIC. BB-COMMODITIES
		__oHshTypes:put(492, "COB") // AQUISICAO CTN PESA
		__oHshTypes:put(493, "COB") // COP DBTO AUTOMATICO
		__oHshTypes:put(494, "COB") // DEBITO GRUPO AFINIDADE
		__oHshTypes:put(495, "COB") // Pagamento de Boleto
		__oHshTypes:put(496, "COB") // DESP MANUT ESTOQ CONAB
		__oHshTypes:put(497, "COB") // ASSEFAZ
		__oHshTypes:put(498, "COB") // DEBITO GRUPO CO-BRANDE
		__oHshTypes:put(499, "ENC") // Tarifa Adicional ORPAG
		__oHshTypes:put(500, "COB") // Movimento do Dia
		__oHshTypes:put(501, "COB") // Caixa
		__oHshTypes:put(502, "COB") // Depósito em Dinheiro
		__oHshTypes:put(503, "COB") // Depósito Inicial
		__oHshTypes:put(504, "COB") // Cobrança
		__oHshTypes:put(505, "CHQ") // Depósito em cheque liber
		__oHshTypes:put(506, "CHQ") // Depósito em cheque BB lib
		__oHshTypes:put(507, "COB") // Estorno de Pagamento
		__oHshTypes:put(508, "COB") // Recebimento de Guias
		__oHshTypes:put(509, "COB") // Recomposição de Provento
		__oHshTypes:put(510, "CHQ") // Depósito Cheque BB Liqui
		__oHshTypes:put(511, "COB") // Depósito bloqueado 1 dia
		__oHshTypes:put(512, "COB") // Depósito bloqueado 2dias
		__oHshTypes:put(513, "COB") // Depósito bloqueado 3dias
		__oHshTypes:put(514, "COB") // Depósito bloqueado 4dias
		__oHshTypes:put(515, "COB") // Depósito bloqueado 5dias
		__oHshTypes:put(516, "COB") // Depósito bloqueado 6dias
		__oHshTypes:put(517, "COB") // Depósito bloqueado 7dias
		__oHshTypes:put(518, "COB") // Depósito bloqueado 8dias
		__oHshTypes:put(519, "COB") // Depósito bloqueado 9dias
		__oHshTypes:put(520, "COB") // Depósito bloquead.20dias
		__oHshTypes:put(530, "COB") // Depósito com Cartão
		__oHshTypes:put(532, "COB") // Ordem Bancária
		__oHshTypes:put(533, "COB") // Seguros
		__oHshTypes:put(534, "COB") // Corretagem
		__oHshTypes:put(540, "COB") // Adiantamento
		__oHshTypes:put(541, "COB") // Resgate Poupança
		__oHshTypes:put(545, "COB") // Rem N.Exp.
		__oHshTypes:put(551, "COB") // Resgate CDB/RDB
		__oHshTypes:put(555, "COB") // Recebimentos
		__oHshTypes:put(558, "COB") // Recolhimentos
		__oHshTypes:put(560, "COB") // FINAME
		__oHshTypes:put(562, "COB") // Custódia
		__oHshTypes:put(568, "COB") // Ordem de Pagamento
		__oHshTypes:put(570, "COB") // Despesas de Comissão
		__oHshTypes:put(572, "COB") // Diferença de Caixa
		__oHshTypes:put(575, "COB") // Estorno Lançamento
		__oHshTypes:put(577, "COB") // Saque do PASEP
		__oHshTypes:put(580, "COB") // Estorno Autenticação Pagament
		__oHshTypes:put(581, "COB") // Estorno Autenticação Pagament
		__oHshTypes:put(582, "COB") // Estorno Autenticação Pagament
		__oHshTypes:put(588, "COB") // Imposto de Renda
		__oHshTypes:put(590, "COB") // Est Aut Pgt IPMF
		__oHshTypes:put(598, "CHQ") // Cheque de Viagem
		__oHshTypes:put(600, "COB") // Movimento de Caixa
		__oHshTypes:put(601, "COB") // Diário
		__oHshTypes:put(602, "COB") // Adiantamento de Proventos
		__oHshTypes:put(603, "CHQ") // Cheque Devolvido Sem Fundo
		__oHshTypes:put(604, "COB") // Proventos
		__oHshTypes:put(605, "CHQ") // Depósito em cheque liberado
		__oHshTypes:put(606, "CHQ") // Depósito em cheque BB liberad
		__oHshTypes:put(607, "COB") // Cobrança
		__oHshTypes:put(608, "COB") // Crédito Ordem Pagamento
		__oHshTypes:put(609, "COB") // Desconto
		__oHshTypes:put(610, "COB") // Estorno de Débito
		__oHshTypes:put(611, "COB") // Crédito autorizado
		__oHshTypes:put(612, "COB") // Crédito cfe. instruções
		__oHshTypes:put(613, "COB") // Depósito inicial
		__oHshTypes:put(614, "COB") // Abono
		__oHshTypes:put(615, "COB") // Aviso de Crédito
		__oHshTypes:put(616, "COB") // Dividendos de ações
		__oHshTypes:put(617, "COB") // Recebimento de guias
		__oHshTypes:put(618, "CHQ") // Cheque TB devolvido
		__oHshTypes:put(619, "COB") // Devolução de juros
		__oHshTypes:put(620, "ENC") // Devolução de IOF
		__oHshTypes:put(621, "COB") // Transporte de Saldo
		__oHshTypes:put(622, "COB") // Crédito BACEN
		__oHshTypes:put(623, "COB") // Depósito COMPE
		__oHshTypes:put(624, "COB") // Cobrança
		__oHshTypes:put(625, "COB") // CRED. POR ORDEM RFFSA
		__oHshTypes:put(626, "COB") // SAQUE EM POUPANCA
		__oHshTypes:put(627, "COB") // RACOES GUABI
		__oHshTypes:put(628, "COB") // Cartão de Crédito
		__oHshTypes:put(629, "COB") // TRF. ENTRE COOPERATIVA
		__oHshTypes:put(630, "COB") // Anot. provisória crédito
		__oHshTypes:put(631, "COB") // Desbloqueio de depósito
		__oHshTypes:put(632, "COB") // Ordem Bancária
		__oHshTypes:put(633, "COB") // Seguro
		__oHshTypes:put(634, "COB") // Crédito FAPEX
		__oHshTypes:put(635, "COB") // Remuneração a Cooperado
		__oHshTypes:put(636, "COB") // Recebimento Telefone Pré-Pago
		__oHshTypes:put(637, "COB") // Abono
		__oHshTypes:put(638, "COB") // ITCMD-TRANSM CAUSA MORTIS DOA
		__oHshTypes:put(639, "COB") // IPVA-PROPRIED VEICULOS AUTOMO
		__oHshTypes:put(640, "COB") // Adiantamento
		__oHshTypes:put(641, "COB") // Adiantamento de Borderô
		__oHshTypes:put(642, "COB") // desativado
		__oHshTypes:put(643, "COB") // Cred.IPMC.
		__oHshTypes:put(644, "COB") // Amortização
		__oHshTypes:put(645, "COB") // RSG FNDO EMPRES. DI 60
		__oHshTypes:put(646, "COB") // Apropriação
		__oHshTypes:put(647, "COB") // Auxílio
		__oHshTypes:put(648, "COB") // Grupo Perdigão
		__oHshTypes:put(649, "COB") // CRED. POR ORDEM FIPECQ
		__oHshTypes:put(650, "COB") // DIVIDENDOS TELEBRAS
		__oHshTypes:put(651, "COB") // CRED. POR ORDEM FURNAS
		__oHshTypes:put(652, "COB") // CRED. POR ORDEM FURNAS
		__oHshTypes:put(653, "CHQ") // CHEQUE DO BACEN
		__oHshTypes:put(654, "COB") // Cobrança externa
		__oHshTypes:put(655, "COB") // DEVOLUCAO IAE
		__oHshTypes:put(656, "COB") // CREDITO SERVICO CAMBIO
		__oHshTypes:put(657, "COB") // CAMBIO A LIBERAR D+1
		__oHshTypes:put(658, "COB") // Conversão
		__oHshTypes:put(659, "COB") // CRED. POR ORDEM FORD
		__oHshTypes:put(660, "COB") // Correção Monetária
		__oHshTypes:put(661, "COB") // Crédito Furnas
		__oHshTypes:put(662, "COB") // Custódia
		__oHshTypes:put(663, "COB") // ACERTOS SISTEMA CRM
		__oHshTypes:put(664, "COB") // Recebimentos diversos
		__oHshTypes:put(665, "COB") // HOSP.CLINICAS P.ALEGRE
		__oHshTypes:put(666, "COB") // GRUPO HOSP. CONCEIC.
		__oHshTypes:put(667, "COB") // INDENIZACAO SEGURO
		__oHshTypes:put(668, "COB") // Resgate Autom.Aplic Curto Pra
		__oHshTypes:put(669, "COB") // Devolução
		__oHshTypes:put(670, "ENC") // Estorno de tarifa
		__oHshTypes:put(671, "COB") // Diárias
		__oHshTypes:put(672, "COB") // Diferença de caixa
		__oHshTypes:put(673, "COB") // Resgate ações energia
		__oHshTypes:put(674, "COB") // DEVOLUCAO CHQ MOTIVO 2
		__oHshTypes:put(675, "COB") // Estorno Débito
		__oHshTypes:put(676, "COB") // DEVOLUCAO CHQ MOTIVO 2
		__oHshTypes:put(677, "COB") // Empréstimo
		__oHshTypes:put(678, "COB") // LEILAO/BALCAO ELETRON.
		__oHshTypes:put(679, "COB") // Resgate BB Premium
		__oHshTypes:put(680, "COB") // Estorno de débito
		__oHshTypes:put(681, "COB") // FORNECIMENTO
		__oHshTypes:put(682, "COB") // ESTORNO DE AQUISICAO
		__oHshTypes:put(683, "COB") // ITR-IMPOSTO TERRITORIAL RURAL
		__oHshTypes:put(684, "COB") // EST. ANOTACAO DEBITO
		__oHshTypes:put(685, "COB") // Crédito previ carim
		__oHshTypes:put(686, "COB") // CHQ DEVOLVIDO APRESENT INDEVI
		__oHshTypes:put(687, "COB") // Brasilcap
		__oHshTypes:put(688, "COB") // RESTITUICAO DA RECEITA FEDERA
		__oHshTypes:put(689, "COB") // MENSALIDADE SEG SAUDE
		__oHshTypes:put(690, "COB") // IMPOSTO SINDICAL
		__oHshTypes:put(691, "COB") // VENDA DE ACOES
		__oHshTypes:put(692, "COB") // Resgate BB CIN
		__oHshTypes:put(693, "COB") // CREDITO SECEX
		__oHshTypes:put(694, "COB") // CRD. BLOQUEADO COBRANC
		__oHshTypes:put(695, "COB") // Crédito origem INSS
		__oHshTypes:put(696, "COB") // INSS ARRECADACAO
		__oHshTypes:put(697, "COB") // Liberação
		__oHshTypes:put(698, "COB") // Liquidação
		__oHshTypes:put(699, "COB") // CRD ORIGEM PREFEITURA
		__oHshTypes:put(700, "COB") // DMR CREDITO
		__oHshTypes:put(701, "COB") // CHQ DEV.MOTIVO 25 OU 2
		__oHshTypes:put(702, "COB") // Multa-Taxa
		__oHshTypes:put(703, "COB") // CRED. A LIBERAR NO DIA
		__oHshTypes:put(704, "COB") // Ordem de Crédito
		__oHshTypes:put(705, "COB") // CH DEVOLVIDO COM IRREGULARIDA
		__oHshTypes:put(706, "COB") // CRED A LIBERAR NO DIA
		__oHshTypes:put(707, "COB") // Benefício INSS
		__oHshTypes:put(708, "COB") // Conta Única
		__oHshTypes:put(709, "COB") // Prestação de Contas
		__oHshTypes:put(710, "COB") // Proventos
		__oHshTypes:put(711, "COB") // Provisão
		__oHshTypes:put(712, "COB") // Estorno de Devolução
		__oHshTypes:put(713, "COB") // Desativado
		__oHshTypes:put(714, "COB") // Resgate BB Multicarteira
		__oHshTypes:put(715, "COB") // Resgate BB Moderado 60
		__oHshTypes:put(716, "COB") // Refinanciamento
		__oHshTypes:put(717, "COB") // Desativado
		__oHshTypes:put(718, "COB") // CH DEVOLVIDO IMPEDIM PAGAMENT
		__oHshTypes:put(719, "COB") // FED.COOP.CONS.FUN.BB
		__oHshTypes:put(720, "COB") // Remuneração Agência
		__oHshTypes:put(721, "COB") // Repasse
		__oHshTypes:put(722, "COB") // Crédito FASSINCRA
		__oHshTypes:put(723, "COB") // Crédito SEMUS
		__oHshTypes:put(724, "COB") // Ressarcimento
		__oHshTypes:put(725, "COB") // Crédito CODOMAR
		__oHshTypes:put(726, "COB") // Saldo Transferido
		__oHshTypes:put(727, "COB") // Cancelamento de Subscrição
		__oHshTypes:put(728, "COB") // Seguro Automático Penhor Rura
		__oHshTypes:put(729, "COB") // Transferência recebida
		__oHshTypes:put(730, "COB") // Vendas
		__oHshTypes:put(731, "COB") // CREDITO COM AVISO
		__oHshTypes:put(732, "COB") // CIELO - CARTOES
		__oHshTypes:put(733, "COB") // CUSTODIA/BONIFICACAO
		__oHshTypes:put(734, "COB") // Ajuda alimentação
		__oHshTypes:put(735, "COB") // Resgate BB Fiex
		__oHshTypes:put(736, "COB") // Valetik
		__oHshTypes:put(737, "COB") // Juros
		__oHshTypes:put(738, "COB") // CREDITO AUTORIZADO
		__oHshTypes:put(739, "COB") // Telemar
		__oHshTypes:put(740, "COB") // CREDITO CONVENIO
		__oHshTypes:put(741, "COB") // GOLDEN CROSS
		__oHshTypes:put(742, "COB") // CREDITO LEASING
		__oHshTypes:put(743, "COB") // RESGATE OPEN
		__oHshTypes:put(744, "COB") // CANC TRS-CONTEST OU NA
		__oHshTypes:put(745, "COB") // CREDITO GEAP
		__oHshTypes:put(746, "COB") // CREDITO SINDIFISCO
		__oHshTypes:put(747, "COB") // CREDITO PASEP
		__oHshTypes:put(748, "COB") // RSG BB-APLIC C.PRAZO
		__oHshTypes:put(749, "COB") // Resgate Ourocap
		__oHshTypes:put(750, "COB") // FOPAG BB
		__oHshTypes:put(751, "COB") // conv.Real
		__oHshTypes:put(752, "COB") // Crédito do Sistema CDA
		__oHshTypes:put(753, "COB") // DESATIVADO
		__oHshTypes:put(754, "COB") // DESATIVADO
		__oHshTypes:put(755, "COB") // CASSI CREDITO
		__oHshTypes:put(756, "COB") // FERIAS - LICENCA PREMI
		__oHshTypes:put(757, "COB") // DEVOLUCAO MENS. OUROCA
		__oHshTypes:put(758, "COB") // ORDEM BANC PETROBRAS
		__oHshTypes:put(759, "COB") // OUROCAP PREMIACAO
		__oHshTypes:put(760, "COB") // BDAR-BANCO DO BRASIL
		__oHshTypes:put(761, "COB") // CBR-CIOPE BB-VENDOR
		__oHshTypes:put(762, "COB") // Distribuição Simples Nacional
		__oHshTypes:put(763, "COB") // OBC-CREDITO DIVERSOS
		__oHshTypes:put(764, "COB") // RENDIMENTOS PIS
		__oHshTypes:put(765, "COB") // EMBRATEL
		__oHshTypes:put(766, "COB") // CREDITO CARNET RECEBID
		__oHshTypes:put(767, "COB") // DESATIVADO
		__oHshTypes:put(768, "COB") // DRIVERS CARD
		__oHshTypes:put(769, "COB") // BBTUR
		__oHshTypes:put(770, "COB") // Fopag
		__oHshTypes:put(771, "COB") // SALARIO EDUCACAO
		__oHshTypes:put(772, "COB") // Venda de ações
		__oHshTypes:put(773, "COB") // CREDITO CARIM
		__oHshTypes:put(774, "COB") // Proex
		__oHshTypes:put(775, "COB") // CREDITO ALUGUEL
		__oHshTypes:put(776, "COB") // DOC devolvido
		__oHshTypes:put(777, "COB") // DRC-CREDITO
		__oHshTypes:put(778, "COB") // Pagamento Fornecedor PHILIPS
		__oHshTypes:put(779, "COB") // Pagamento Fornecedor AmBev
		__oHshTypes:put(780, "COB") // Estorno de Débito
		__oHshTypes:put(781, "COB") // CREDITO SESI
		__oHshTypes:put(782, "COB") // CREDITO UNIMED
		__oHshTypes:put(783, "COB") // CREDITO SENAI
		__oHshTypes:put(784, "COB") // BR TELECOM Pagto Fornecedores
		__oHshTypes:put(785, "COB") // GEROF - TIT. VENDA
		__oHshTypes:put(786, "COB") // DL VENDA
		__oHshTypes:put(787, "COB") // CREDITO CONTA SALARIO
		__oHshTypes:put(788, "COB") // DESATIVADO
		__oHshTypes:put(789, "COB") // CREDITO POR ORDEM ECT
		__oHshTypes:put(790, "COB") // Resgate BB Fundo de Ações
		__oHshTypes:put(791, "COB") // Resgate Fundo
		__oHshTypes:put(792, "COB") // LANCAMENTO BBDTVM
		__oHshTypes:put(793, "COB") // Pagamento Fornecedor TAM
		__oHshTypes:put(794, "COB") // Dividendos CRT
		__oHshTypes:put(795, "COB") // Crédito Automático CDC
		__oHshTypes:put(796, "COB") // ESTORNO COMPRA
		__oHshTypes:put(797, "COB") // Resgate BB Extrapoupe
		__oHshTypes:put(798, "COB") // CDB/RDB
		__oHshTypes:put(799, "COB") // RESGATE FDO APLIC-120
		__oHshTypes:put(800, "COB") // CREDITO POR ORDEM CNPQ
		__oHshTypes:put(801, "COB") // Desativado
		__oHshTypes:put(802, "COB") // Desativado
		__oHshTypes:put(803, "COB") // Desativado
		__oHshTypes:put(804, "COB") // RESGATE APLIC-PROG
		__oHshTypes:put(805, "COB") // P/ ORDEM EMPRESA WEG S
		__oHshTypes:put(806, "COB") // RECEBIMENTO BBCPR
		__oHshTypes:put(807, "COB") // Estorno de Débito
		__oHshTypes:put(808, "COB") // ORPAG ORIGEM EXTERIOR
		__oHshTypes:put(809, "COB") // PETROBRAS BLOQ.1 DIA
		__oHshTypes:put(810, "COB") // Bolsa auxílio
		__oHshTypes:put(811, "COB") // Taxa de administração
		__oHshTypes:put(812, "ENC") // Devolução CPMF BB Aplic
		__oHshTypes:put(813, "CHQ") // Cheque descontado
		__oHshTypes:put(814, "COB") // DESATIVADO
		__oHshTypes:put(815, "COB") // ESTORNO AGF-SECURITIZA
		__oHshTypes:put(816, "COB") // Proventos P.M.M.G.
		__oHshTypes:put(817, "COB") // FAELBA-PAGTO FORNECED.
		__oHshTypes:put(818, "COB") // DESATIVADO
		__oHshTypes:put(819, "COB") // CRED POR ORDEM NUCLEM
		__oHshTypes:put(820, "ENC") // Devolução de CPMF
		__oHshTypes:put(821, "COB") // Pix Recebido
		__oHshTypes:put(822, "COB") // Créditos bloquetos
		__oHshTypes:put(823, "COB") // Dívida Transferida p/ Prejuíz
		__oHshTypes:put(824, "COB") // ACL CIELO
		__oHshTypes:put(825, "COB") // Resgate Poupança
		__oHshTypes:put(826, "COB") // CREDITO SISTEMA TEF
		__oHshTypes:put(827, "COB") // RSG BB-PRINC.GARANTIDO
		__oHshTypes:put(828, "COB") // ESTORNO DEB CART CRED
		__oHshTypes:put(829, "COB") // PENSAO ALIM. JUDICIAL
		__oHshTypes:put(830, "COB") // Depósito Online
		__oHshTypes:put(831, "COB") // RECEBIMENTO DE ICMS
		__oHshTypes:put(832, "COB") // Credito Lojista-TECBAN
		__oHshTypes:put(833, "COB") // RECEBIMENTO DE IPVA
		__oHshTypes:put(834, "COB") // DESATIVADO
		__oHshTypes:put(835, "COB") // RSG AUT. BB-COMMODITIE
		__oHshTypes:put(836, "COB") // ASSEF PLUS
		__oHshTypes:put(837, "COB") // ASSEF MEDI
		__oHshTypes:put(838, "COB") // ASSEF PAT
		__oHshTypes:put(839, "COB") // DESATIVADO
		__oHshTypes:put(840, "COB") // AIH-INAMPS
		__oHshTypes:put(841, "COB") // SINPAS-DIV
		__oHshTypes:put(842, "COB") // PERICIA MEDICA
		__oHshTypes:put(843, "COB") // PAGMENTO CTA.AMB
		__oHshTypes:put(844, "COB") // FINANCTO RURAL RAPIDO
		__oHshTypes:put(845, "COB") // Resgate Poupex
		__oHshTypes:put(846, "COB") // Resgate BB Renda Fixa DI
		__oHshTypes:put(847, "COB") // Resgate BB Fundos Extramercad
		__oHshTypes:put(848, "COB") // Resgate Automático
		__oHshTypes:put(849, "COB") // BB Ações Índice
		__oHshTypes:put(850, "COB") // COTA DAF - CREDITO
		__oHshTypes:put(851, "COB") // Resgate CDB/RDB
		__oHshTypes:put(852, "COB") // Resgate Fundo Energia
		__oHshTypes:put(853, "COB") // DESATIVADO
		__oHshTypes:put(854, "COB") // RSG BB-ACOES TELEBRASI
		__oHshTypes:put(855, "COB") // Resgate BB Fix
		__oHshTypes:put(856, "COB") // ESTORNO DE DESPESAS
		__oHshTypes:put(857, "COB") // RSG FUNDO ACOES COELBA
		__oHshTypes:put(858, "COB") // PRESTACAO SERVICOS
		__oHshTypes:put(859, "COB") // CRED ORDEM CARGILL
		__oHshTypes:put(860, "COB") // FINAME
		__oHshTypes:put(861, "COB") // RSG AUT.BB-FIF C.PRAZO
		__oHshTypes:put(862, "COB") // RECEBIMENTO ATRAVES BT
		__oHshTypes:put(863, "COB") // CIA SEGUROS ALIANCA
		__oHshTypes:put(864, "COB") // CIA SEGUROS ALIANCA
		__oHshTypes:put(865, "COB") // BRASILPREV
		__oHshTypes:put(866, "COB") // ACERTO ENTRE CTAS ARRE
		__oHshTypes:put(867, "COB") // GOVERNO PE TRANSF ICMS
		__oHshTypes:put(868, "COB") // EXCEDENTE CHQ GARANTIA
		__oHshTypes:put(869, "COB") // Estorno Aplicação Fundos
		__oHshTypes:put(870, "COB") // Transferência recebida
		__oHshTypes:put(871, "COB") // RESGATE BB-FIX-30
		__oHshTypes:put(872, "COB") // ESTORNO APLIC BB-COMMO
		__oHshTypes:put(873, "COB") // ESTORNO APL BB-RND-FIX
		__oHshTypes:put(874, "COB") // Transferência recebida
		__oHshTypes:put(875, "COB") // Transferido da poupança
		__oHshTypes:put(876, "COB") // TRIBUTOS ESTADUAIS
		__oHshTypes:put(877, "COB") // RSG BB-EMPRESARIAL-30
		__oHshTypes:put(878, "COB") // RSG BB-EMPRESARIAL-60
		__oHshTypes:put(879, "COB") // PROAGRO COOPERATIVAS
		__oHshTypes:put(880, "COB") // GAP-INAMPS
		__oHshTypes:put(881, "COB") // SIA-INAMPS
		__oHshTypes:put(882, "COB") // Resgate BB REAPLIC
		__oHshTypes:put(883, "COB") // Resgate BB Cambial
		__oHshTypes:put(884, "COB") // RSG BB-ACOES-MASTER
		__oHshTypes:put(885, "COB") // DESATIVADO
		__oHshTypes:put(886, "COB") // Remuneração sobre ações
		__oHshTypes:put(887, "ENC") // DEVOLUCAO CPMF PASEP
		__oHshTypes:put(888, "COB") // SUBSCRICAO DE ACOES
		__oHshTypes:put(889, "COB") // RSG BB-FIF-CURTO-PRAZO
		__oHshTypes:put(890, "COB") // VOLKSWAGEN
		__oHshTypes:put(891, "COB") // RSG BB-COMMODITIES
		__oHshTypes:put(892, "COB") // CREDITO SESEF
		__oHshTypes:put(893, "COB") // CAPESESP
		__oHshTypes:put(894, "COB") // CREDITO CVRD
		__oHshTypes:put(895, "COB") // RESG. FUNDO DI-60
		__oHshTypes:put(896, "COB") // CREDITO CONAB
		__oHshTypes:put(897, "COB") // ASSEFAZ
		__oHshTypes:put(898, "COB") // CENTRAIS ELETRICAS-ES
		__oHshTypes:put(899, "COB") // Resgate BB Fundos Privat
		__oHshTypes:put(900, "COB") // Movimento do Dia
		__oHshTypes:put(901, "COB") // Salário ord empregador
		__oHshTypes:put(902, "COB") // Venda-WEB
		__oHshTypes:put(903, "COB") // GOVERNO PE DEVOL FOPAG
		__oHshTypes:put(904, "COB") // Resgate BB FAPI
		__oHshTypes:put(905, "COB") // PLUS AUT (RESG AUTOM)
		__oHshTypes:put(906, "COB") // PLUS CP (RESGATE)
		__oHshTypes:put(907, "COB") // DIFERENCIAL DE SWAP
		__oHshTypes:put(908, "COB") // AUXILIO-CRECHE
		__oHshTypes:put(909, "COB") // COP CRED AUTOMATICO
		__oHshTypes:put(910, "CHQ") // Depósito Cheque BB Liqui
		__oHshTypes:put(911, "COB") // Depósito bloqueado 1 dia
		__oHshTypes:put(912, "COB") // Depósito bloqueado 2dias ú
		__oHshTypes:put(913, "COB") // Depósito bloqueado 3dias
		__oHshTypes:put(914, "COB") // Depósito bloqueado 4dias
		__oHshTypes:put(915, "COB") // Depósito bloqueado 5dias
		__oHshTypes:put(916, "COB") // Depósito bloqueado 6dias
		__oHshTypes:put(917, "COB") // Depósito bloqueado 7dias
		__oHshTypes:put(918, "COB") // Depósito bloqueado 8dias
		__oHshTypes:put(919, "COB") // Depósito bloqueado 9dias
		__oHshTypes:put(920, "COB") // Depósito bloquead.20dias
		__oHshTypes:put(921, "COB") // GOVERNO PE TRANSF GNR
		__oHshTypes:put(922, "COB") // GOVERNO PE TRANSF GNR
		__oHshTypes:put(923, "COB") // GOVERNO PE TRANSF BTP
		__oHshTypes:put(924, "COB") // PISO DE ATENCAO BASICA
		__oHshTypes:put(925, "COB") // PROGRAMA SAUDE FAMILIA
		__oHshTypes:put(926, "COB") // PGM AGENTE COMUN SAUDE
		__oHshTypes:put(927, "COB") // PGM FARMACIAS BASICAS
		__oHshTypes:put(928, "COB") // PGM CARENCIA NUTRICION
		__oHshTypes:put(929, "COB") // PGM VIGILANCIA SANITAR
		__oHshTypes:put(930, "COB") // PGM VIGILANCIA EPIDEMI
		__oHshTypes:put(931, "COB") // PROGRAMA SAUDE BUCAL
		__oHshTypes:put(932, "COB") // GESTAO PLENA SISTEMA
		__oHshTypes:put(933, "COB") // Liquidação BB CDB Pré
		__oHshTypes:put(934, "COB") // Liquidação BB Aplic Pós
		__oHshTypes:put(935, "COB") // TRANSFERENCIA BERON
		__oHshTypes:put(936, "COB") // RESGATE BB APLIC PUB
		__oHshTypes:put(937, "COB") // RESGATE BB APLIC CORP
		__oHshTypes:put(938, "COB") // Resgate BB Fundos Exclus
		__oHshTypes:put(939, "COB") // APOS/PENSAO BBPREV
		__oHshTypes:put(940, "COB") // CREDITO BB PREVIDENCIA
		__oHshTypes:put(941, "COB") // DESATIVADO
		__oHshTypes:put(942, "COB") // CANCEL. CONV. CTA UNIC
		__oHshTypes:put(943, "COB") // Estorno de Saque-cédula
		__oHshTypes:put(944, "COB") // CDB/RDB
		__oHshTypes:put(945, "COB") // Desativado
		__oHshTypes:put(946, "COB") // Desativado
		__oHshTypes:put(947, "COB") // DESATIVADO
		__oHshTypes:put(948, "ENC") // Devolução CPMF BB Aplic
		__oHshTypes:put(949, "COB") // TAXA RENOV CHQ ESECIAL
		__oHshTypes:put(950, "COB") // Cobrança Devolvida
		__oHshTypes:put(951, "COB") // DEVOL. RENOV. CHQ. ESP
		__oHshTypes:put(952, "COB") // FPE/FPM
		__oHshTypes:put(953, "COB") // IPI/EXPORTACAO
		__oHshTypes:put(954, "COB") // ICMS-DESONER.EXPORTACO
		__oHshTypes:put(955, "COB") // COMPLEMENTO UNIAO
		__oHshTypes:put(956, "COB") // INCENTIVO DESCET.FUNAS
		__oHshTypes:put(957, "COB") // CONSORCIO HONDA
		__oHshTypes:put(958, "COB") // RESGATE FUNDO BB DOLAR
		__oHshTypes:put(959, "COB") // RESGATE FUNDO MILENIO
		__oHshTypes:put(960, "COB") // CRED.COBRANCA EF. COMP
		__oHshTypes:put(961, "ENC") // BB FIX DI 60 CPMF RESG
		__oHshTypes:put(962, "COB") // Resgate BB Fix Diário
		__oHshTypes:put(963, "COB") // BB FIX DI 30
		__oHshTypes:put(964, "COB") // EMPR CTA GARANTIDA
		__oHshTypes:put(965, "COB") // SALDO TRANSF PREJUIZO
		__oHshTypes:put(966, "COB") // CREDITOS DO GOV. MS
		__oHshTypes:put(967, "COB") // CRED FUNDO NAC SAUDE
		__oHshTypes:put(968, "COB") // PLANO OAB DE SAUDE
		__oHshTypes:put(969, "COB") // BONUS PERFORMANCE-GFI
		__oHshTypes:put(970, "COB") // TAXA DE RESGATE-GFI
		__oHshTypes:put(971, "COB") // RESSARCIMENTO FUNDOS
		__oHshTypes:put(972, "COB") // ORDEM BANC CANCELADA
		__oHshTypes:put(973, "COB") // CRED DE KS PISTOES LTD
		__oHshTypes:put(974, "COB") // BBCPR Não Cumprida
		__oHshTypes:put(975, "COB") // SADIA
		__oHshTypes:put(976, "COB") // TED Transferência Eletr.
		__oHshTypes:put(977, "COB") // SEARA
		__oHshTypes:put(978, "COB") // BUNGE
		__oHshTypes:put(979, "COB") // FGTS Lei Complementar 11
		__oHshTypes:put(980, "COB") // Crédito COAMO
		__oHshTypes:put(981, "COB") // ESTORNO DE DéBITO
		__oHshTypes:put(982, "COB") // ESTORNO DE DéBITO
		__oHshTypes:put(983, "COB") // TED Devolvida
		__oHshTypes:put(984, "COB") // Crédito por ordem da PNU
		__oHshTypes:put(985, "COB") // Crédito Cooperat Castrol
		__oHshTypes:put(986, "COB") // Resgate Fundo Private
		__oHshTypes:put(987, "COB") // Resgate Fundo Private
		__oHshTypes:put(988, "COB") // RESGATE APLIC PLUS
		__oHshTypes:put(989, "COB") // Resgate BB CDB DI
		__oHshTypes:put(990, "COB") // RSG BLQ - USO EXCL. RD
		__oHshTypes:put(991, "COB") // Pagamento de Prebenda
		__oHshTypes:put(992, "COB") // RECOMPRA CTN PESA
		__oHshTypes:put(993, "COB") // Cia Particip Aliança da
		__oHshTypes:put(994, "COB") // CREDITO GRUPO AFINIDAD
		__oHshTypes:put(996, "COB") // Pagamento da PLR
		__oHshTypes:put(998, "COB") // CONTROLE APLICATIVO DE
		__oHshTypes:put(999, "COB") // CONTROLE APLICATIVO DE
	EndIf

	If nCodeTipe > 0 .and. nCodeTipe < 1000
		cStatementType := __oHshTypes:get(nCodeTipe)
	EndIf

Return cStatementType

