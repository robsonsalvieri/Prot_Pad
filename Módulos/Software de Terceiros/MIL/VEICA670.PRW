// ͻ
//  Versao    3    
// ͼ
#Include "Protheus.ch"
#Include "VEICA670.CH"

/*


Ŀ
Funcao     VEICA670  Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descricao  Lancamento das Metas de Consorcio	                      
ٱ


*/
Function VEICA670()
Private aRotina := MenuDef()
Private cCadastro := STR0001 // Lancamento das Metas de Consorcio
//Ŀ
// Endereca a funcao de BROWSE                                  
//
mBrowse( 6, 1,22,75,"VQA")
Return

/*


Ŀ
Funcao     VEICA670I Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descricao  Incluir VQA                                                
ٱ


*/
Function VEICA670I(cAlias,nReg,nOpc)    
aCampos := FS_CPOSVQA()
AxInclui(cAlias,nReg,nOpc,aCampos)
Return(.t.)

/*


Ŀ
Funcao     VEICA670V Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descricao  Visualizar VQA                                             
ٱ


*/
Function VEICA670V(cAlias,nReg,nOpc)    
aCampos := FS_CPOSVQA()
AxVisual(cAlias,nReg,nOpc,aCampos)
Return(.t.)

/*


Ŀ
Funcao     VEICA670A Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descricao  Alterar VQA                                                
ٱ


*/
Function VEICA670A(cAlias,nReg,nOpc)    
aCampos := FS_CPOSVQA()
AxAltera(cAlias,nReg,nOpc,aCampos)
Return(.t.)

/*


Ŀ
Funcao     VEICA670E Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descricao  Excluir VQA                                                
ٱ


*/
Function VEICA670E(cAlias,nReg,nOpc)    
aCampos := FS_CPOSVQA()
AxDeleta(cAlias,nReg,nOpc)
asReturn(.t.)

/*


Ŀ
Funcao    FS_CPOSVQA Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descriao  Levanta campos VQA                                         
ٱ


*/
Static Function FS_CPOSVQA()
DbSelectArea("SX3")
DbSetOrder(1)
dbseek("VQA")
aCampos := {}
do While !Eof() .and. x3_arquivo == "VQA"
   If X3USO(x3_usado).And.cNivel>=x3_nivel
      aadd(aCampos,x3_campo)
   EndIf   
   DbSkip()
EndDo
DbSelectArea("VQA")
Return(aCampos)
                        
/*


Ŀ
Funcao     MenuDef   Autor  Andre Luis Almeida     Data  09/09/14 
Ĵ
Descricao  MenuDef ( aRotina )                                        
ٱ


*/
Static Function MenuDef()
Local aRotina := { { STR0002 ,"axPesqui", 0 , 1},; // Pesquisar
                   { STR0003 ,"VEICA670V" , 0 , 2},; // Visualizar
                   { STR0004 ,"VEICA670I" , 0 , 3},; // Incluir
                   { STR0005 ,"VEICA670A" , 0 , 4},; // Alterar
                   { STR0006 ,"VEICA670E" , 0 , 5}} // Excluir
Return aRotina