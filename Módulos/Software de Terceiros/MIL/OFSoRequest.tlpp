#include 'totvs.ch'
#include "tlpp-core.th"

/*/{Protheus.doc} OFSoRequest
	Classe que representa uma request do DMS mas com os adicionais do service operations
	
	@type class
	@author Vinicius Gati
	@since 09/08/2021
/*/
Class OFSoRequest from OFDMSRequest
	public data oSoRequestBody
	public data oContainer

	public method New() CONSTRUCTOR
	public method SetBodyName()
	public method SetBody()
	public method GetHeader()
	public method GetBody()
EndClass

/*/{Protheus.doc} New
	Construtor Simples

	@type method
	@author Vinicius Gati
	@since 09/08/2021
/*/
Method New(oCont) Class OFSoRequest
	_Super:New()
	::oContainer       := oCont //mensagem
	::oSoRequestBody   := OFSoRequestBody():New()
	::SetTypeServiceOperations()
	::SetOriginDBS()	
Return SELF

/*/{Protheus.doc} SetBodyName
	Chama funcao do body de setName

	@type method
	@author Vinicius Gati
	@since 09/08/2021
/*/
Method SetBodyName() Class OFSoRequest
Return self:oSoRequestBody:SetName(self:oContainer:cName)

/*/{Protheus.doc} GetHeader
	

	@type method
	@author Vinicius Gati
	@since 25/10/2021
/*/
Method GetHeader() Class OFSoRequest
Return OFSoGatewayHeader():New(self:oContainer:cName, self:oContainer:GetMessageId(), self:GetId())

/*/{Protheus.doc} SetBody
	seta o body

	@type method
	@author Vinicius Gati
	@since 12/08/2021
/*/
Method SetBody(oReqBody as object) Class OFSoRequest
	local cJson
	local cErro := ""
	self:oSoRequestBody := oReqBody
//	self:Set("VK5_REQBOD", oReqBody:toJson():toJson())
	cJson := FGX_JSONform( oReqBody:toJson():toJson(), .T., @cErro )
	self:Set("VK5_REQBOD", iif( empty( cErro ), cJson, oReqBody:toJson():toJson() ) )
Return .t.

/*/{Protheus.doc} GetBody
	retorna o body

	@type method
	@author Vinicius Gati
	@since 25/10/2021
/*/
Method GetBody() Class OFSoRequest
	self:SetBodyName()
Return self:oSoRequestBody
