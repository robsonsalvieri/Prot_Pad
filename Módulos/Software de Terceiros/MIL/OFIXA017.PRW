#include "Protheus.ch"
#include "OFIXA017.ch"
/*
===============================================================================
###############################################################################
##+----------+------------+-------+-----------------------+------+----------+##
##|Funcao    | OFIXA017   | Autor |  Luis Delorme         | Data | 25/09/09 |##
##+----------+------------+-------+-----------------------+------+----------+##
##|Descri‡„o | Politicas de Descontos e Promocoes de Pecas                  |##
##+----------+--------------------------------------------------------------+##
##|Uso       | Oficina / AutoPecas                                          |##
##+----------+--------------------------------------------------------------+##
###############################################################################
===============================================================================
*/
Function OFIXA017
Local oBrowse
Private cCadastro := OemToAnsi(STR0001)                      //###"Formas de Descontos"
Private aRotina := MenuDef()

oBrowse := FWMBrowse():New()
oBrowse:SetAlias("VEM")
oBrowse:SetDescription(cCadastro)
oBrowse:DisableDetails()
oBrowse:Activate()

//
Return
/*
===============================================================================
###############################################################################
##+----------+------------+-------+-----------------------+------+----------+##
##|Fun‡„o    | MenuDef    | Autor |  Luis Delorme         | Data | 20/05/09 |##
##+----------+------------+-------+-----------------------+------+----------+##
##|Descri‡„o | Menudef aRotina                                              |##
##+----------+--------------------------------------------------------------+##
##|Uso       | Oficina / AutoPecas                                          |##
##+----------+--------------------------------------------------------------+##
###############################################################################
===============================================================================
*/
Static Function MenuDef()
Local aRotina := { 	{ STR0002, "axPesqui"  , 0 , 1},;	//Pesquisar
					{ STR0003, "OFIXX005"  , 0 , 2},;	// Visualizar
					{ STR0004, "OFIXX005"  , 0 , 3},;	// Incluir
					{ STR0005, "OFIXX005"  , 0 , 4},;	// Alterar
					{ STR0006, "OFIXX005"  , 0 , 5},;	// Excluir
					{ STR0010, "OFX005DUP" , 0 , 4},;	// Duplicar
					{ STR0011, "OFX0050011_ReplicarCadastro" , 0 , 4}}	// Replicar
Return aRotina

/*
===============================================================================
###############################################################################
##+----------+------------+-------+-----------------------+------+----------+##
##|Fun‡„o    | OXA017ORD  | Autor |  Thiago               | Data | 13/11/12 |##
##+----------+------------+-------+-----------------------+------+----------+##
##|Descri‡„o | VALIDACAO NO CAMPO VEM_ORDPRI.                               |##
##+----------+--------------------------------------------------------------+##
##|Uso       | Oficina / AutoPecas                                          |##
##+----------+--------------------------------------------------------------+##
###############################################################################
===============================================================================
*/
Function OXA017ORD()

Local cNumber, cLeter
Local lRet := .t.
Local i_x := 0

For i_x := 1 to len(alltrim(M->VEM_ORDPRI))
	cNumber := substr(alltrim(M->VEM_ORDPRI),i_x+1)
	cLeter  := substr(alltrim(M->VEM_ORDPRI),i_x,1)
	if cLeter $ "123456" // "123456"
		if cLeter $ cNumber
			MsgInfo(STR0007,STR0008)
			lRet := .f.
			Exit
		Endif
	Else
		if !Empty(M->VEM_ORDPRI)
			MsgInfo(STR0009,STR0008)
			lRet := .f.
			Exit
		Endif
	Endif
Next

Return(lRet)