#INCLUDE "locr013.ch" 
#INCLUDE "PROTHEUS.CH"     
#INCLUDE "TOPCONN.CH"

/*/{PROTHEUS.DOC} LOCR013.PRW
ITUP BUSINESS - TOTVS RENTAL
IMPRESSÃO EXTRATO DA MEDICAO
@TYPE FUNCTION
@AUTHOR FRANK ZWARG FUGA
@SINCE 03/12/2020
@VERSION P12
@HISTORY 03/12/2020, FRANK ZWARG FUGA, FONTE PRODUTIZADO.
/*/

FUNCTION LOCR013()
LOCAL XALIAS 	:= GETAREA()

PRIVATE CCABEC  := ""
PRIVATE NAUX    := 0

	// --> SELECAO DA IMPRESSORA. 
	OOBJPRINT:= TMSPRINTER():NEW(CCABEC)
	OOBJPRINT:SETLANDSCAPE()
	OOBJPRINT:SETSIZE( 210, 297 )
	OOBJPRINT:SETUP()

	LJMSGRUN(STR0001,,{|| IMP_MED() }) //"POR FAVOR AGUARDE, IMPRIMINDO RELATORIO MEDICAO..."

	// --> MOSTRA RELATORIO PARA IMPRIMIR.
	OOBJPRINT:SETSIZE( 210, 297 )
	OOBJPRINT:PREVIEW()

	RESTAREA(XALIAS)

RETURN(NIL)



/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPROGRAMA  ³ IMP_MED   º AUTOR ³ IT UP BUSINESS     º DATA ³ 12/05/2007 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDESCRICAO ³ IMPRESSÃO EXTRATO DA MEDICAO - TELA MEDICAO                º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUSO       ³ ESPECIFICO GPO                                             º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC FUNCTION IMP_MED()

PRIVATE CUSER
PRIVATE NLINHAATUAL := 0
PRIVATE NNUMPAGINA	:= 0
PRIVATE CPERSEGU,CTPISS
PRIVATE OFONT01	:= NIL
PRIVATE OFONT02	:= NIL
PRIVATE OFONT03	:= NIL
PRIVATE OFONT04	:= NIL
PRIVATE OFONT05	:= NIL
PRIVATE OFONT06	:= NIL
PRIVATE OFONT07	:= NIL
PRIVATE OFONT08 := NIL 
PRIVATE OFONT09	:= NIL
PRIVATE OFONT10	:= NIL
PRIVATE OFONT11 := NIL
PRIVATE OFONT12 := NIL
PRIVATE CPROJETO,COBRA,CVIAGEM,CAS,CSERVICO
PRIVATE NTOTTOT:=0,NTOTISS:=0,NTOTHOR:=0

// --> INICIALIZA OBJETOS DA CLASSE TMSPRINTER.
OFONT01     := TFONT():NEW("ARIAL"     ,11,11,,.F.,,,,,.F.)   // NORMAL
OFONT02     := TFONT():NEW("ARIAL"     ,18,18,,.T.,,,,,.F.)   // NEGRITO
OFONT03     := TFONT():NEW("ARIAL"     ,11,11,,.T.,,,,,.T.)   // NEGRITO / SUBLINHADO
OFONT04     := TFONT():NEW("ARIAL"     ,10,10,,.F.,,,,,.F.)   // NORMAL
OFONT05     := TFONT():NEW("ARIAL"     ,10,10,,.T.,,,,,.F.)   // NEGRITO
OFONT06     := TFONT():NEW("ARIAL"     ,10,10,,.T.,,,,,.T.)   // NEGRITO / SUBLINHADO
OFONT07     := TFONT():NEW("VENDANA"   ,07,07,,.F.,,,,,.F.)   // NORMAL
OFONT08     := TFONT():NEW("VENDANA"   ,07,07,,.F.,,,,,.T.)   // SUBLINHADO
OFONT09     := TFONT():NEW("ARIAL"     ,08,08,,.F.,,,,,.F.)   // NORMAL
OFONT10     := TFONT():NEW("ARIAL"     ,08,08,,.F.,,,,,.F.)   // NEGRITO
OFONT11     := TFONT():NEW("ARIAL"     ,07,07,,.F.,,,,,.F.)   // NORMAL
OFONT12     := TFONT():NEW("ARIAL"     ,07,07,,.T.,,,,,.F.)   // NORMAL

	// --> IMPRIME CABECALHO DO RELATORIO.
	LFIRST   := .T.
	IMP_CABEC(@NNUMPAGINA,@NLINHAATUAL,CUSER,1)

	// --> CRIA AS TABELAS TEMPORARIA PARA GERACAO DO RELATORIO.     ³
	//DBSELECTAREA("FQ5")      
	CCODMED	 := FPN->FPN_COD
	CPROJETO := FPN->FPN_PROJET
	COBRA    := FPN->FPN_OBRA  
	CDESOBRA := ALLTRIM(COBRA) + "-"+ POSICIONE("FP1",1,XFILIAL("FP1")+CPROJETO+COBRA,"FP1_NOMORI")
	CVIAGEM  := FPN->FPN_VIAGEM
	CAS      := FPN->FPN_AS
	CSERVICO := FPN->FPN_VIAGEM  
	NTOTMED	 := FPN->FPN_VALSER         
	NTOTMO	 := 0                           
	NTOTTOT	 := FPN->FPN_VALTOT
	NDESCON	 := FPN->FPN_VLDESC
	NACRESC	 := FPN->FPN_VLACRE       
	NARREDON := FPN->FPN_VLARRE

	DBSELECTAREA("FQ5")
	FQ5->(DBSETORDER(9))
	FQ5->(DBSEEK(XFILIAL("FQ5")+CAS+CVIAGEM))
	CTPAS := FQ5->FQ5_TPAS

	DBSELECTAREA("FP0")
	FP0->(DBSETORDER(1))
	FP0->(DBSEEK(XFILIAL('FP0')+CPROJETO ))

	DBSELECTAREA("FP1")                                       
	FP1->(DBSETORDER(1))
	FP1->(DBSEEK(XFILIAL('FP1')+CPROJETO+COBRA ))
					
	DBSELECTAREA("FP4")
	FP4->(DBSETORDER(2))
	FP4->(DBSEEK(XFILIAL('FP4')+CPROJETO+COBRA+CAS+CVIAGEM ))  
	//AJUSTES DENNIS 04/10/23 - CHAMADO CEC 31540 - INICIO
	
	DBSELECTAREA("FPA")
	FPA->(DBSETORDER(2))
	FPA->(DBSEEK(XFILIAL('FPA')+CPROJETO+COBRA+CAS+CVIAGEM ))  
	

	DBSELECTAREA("FPP")
	FPP->(DBSETORDER(1))
	FPP->(DBSEEK(XFILIAL('FPP')+CCODMED ))  	

	CTPISS	  := IF( FPP->FPP_TPISS =="I",STR0002, IF(FPP->FPP_TPISS =="N",STR0003,STR0004 ) )  //"INCLUSO    "###"NÃO INCLUSO"###"N/A        "
	CPERISS	  := FPP->FPP_PERISS
	CTPSEGURO := IF( FPP->FPP_TIPO=="I",STR0002, IF(FPP->FPP_TIPO=="N",STR0003,STR0005 ) )  //"INCLUSO    "###"NÃO INCLUSO"###"CLIENTE    "
	CPERSEGU  := FPP->FPP_PERSEG 
	CPERMO	  := FPP->FPP_PERMAO 
	
	/*
	IF     CTPAS == "G" 
		CTPISS	  := IF( FP4->FP4_TPISS =="I",STR0002, IF(FP4->FP4_TPISS =="N",STR0003,STR0004 ) )  //"INCLUSO    "###"NÃO INCLUSO"###"N/A        "
		CPERISS	  := FP4->FP4_PERISS
		CTPSEGURO := IF( FP4->FP4_TPSEGU=="I",STR0002, IF(FP4->FP4_TPSEGU=="N",STR0003,STR0005 ) )  //"INCLUSO    "###"NÃO INCLUSO"###"CLIENTE    "
		CPERSEGU  := FP4->FP4_PERSEG 
		CPERMO	  := FP4->FP4_PERMAO 
	ELSEIF CTPAS == "U"
		CTPISS	  := IF( FPA->FPA_TPISS =="I",STR0002, IF(FPA->FPA_TPISS =="N",STR0003,STR0004 ) )  //"INCLUSO    "###"NÃO INCLUSO"###"N/A        "
		CPERISS	  := FPA->FPA_PERISS
		CTPSEGURO := IF( FPA->FPA_TPSEGU=="I",STR0002, IF(FPA->FPA_TPSEGU=="N",STR0003,STR0005 ) )  //"INCLUSO    "###"NÃO INCLUSO"###"CLIENTE    "
		CPERSEGU  := FPA->FPA_PERSEG 
		CPERMO	  := FPA->FPA_PERMAO 
	ELSE
		CTPISS	  := ""
		CPERISS	  := 0
		CTPSEGURO := ""
		CPERSEGU  := 0
		CPERMO	  := 0
	ENDIF
	*/
	//AJUSTES DENNIS 04/10/23 - CHAMADO CEC 31540 - FIM
	DBSELECTAREA("FPN")
	FPN->(DBSETORDER(1))
	FPN->(DBSEEK(XFILIAL('FPN')+CCODMED ))

	IMPMED()

RETURN(NIL)



/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPROGRAMA  ³ IMP_CABEC º AUTOR ³ IT UP BUSINESS     º DATA ³ 16/11/2007 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDESCRICAO ³ IMPRESSAO DO CABECALHO DA PAGINA DO RELATORIO              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUSO       ³ ESPECIFICO GPO                                             º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC FUNCTION IMP_CABEC(NNUMPAGINA,NLINHAATUAL,CUSER,NVIAS)

	NNUMPAGINA += 1

	IF !LFIRST
		OOBJPRINT:ENDPAGE()
		OOBJPRINT:STARTPAGE()
	ENDIF                                      

	LFIRST := .F.

RETURN(.T.)



/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPROGRAMA  ³ IMPMED    º AUTOR ³ IT UP BUSINESS     º DATA ³ 01/05/2007 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDESCRICAO ³ IMPRESSAO DOS ITENS APURADOS                               º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUSO       ³ ESPECIFICO GPO                                             º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC FUNCTION IMPMED()

LOCAL CDET1,LVEZ,LVEZCAB,LTEMZC1,NVALTOT,NVALGER
LOCAL NPOS001,NPOS002,NPOS003,NPOS004,NPOS005,NPOS006
LOCAL CCODESTO
LOCAL NX   := 0 
LOCAL NPOS := 0 

	// POSIÇÃO DAS COLUNAS DOS CUSTOS EXTRAS
	NPOS001:=0100  //DESPESA
	NPOS002:=0600  //DOC.ORIGEM
	NPOS003:=1000  //DESC.PRODUTO
	NPOS004:=2050  //QUANTIDADE
	NPOS005:=2350  //VALOR TOTAL
	NPOS006:=2650  //DATA

	PRIVATE NLIN := 200
	PRIVATE NAUXO:= 0
	PRIVATE NTOTKM:=0
	PRIVATE NTOTVLRKM:=0
	PRIVATE NTOTVLRHR:=0 
	PRIVATE _CDESCRI
	PRIVATE CLOGO := "LOGO.BMP"

	IF CEMPANT == "07"
		CLOGO := "LGJSM.BMP"	//ALTERAÇÃO DO LOGO PARA UTILIZAR NA EMPRESA 07 - JSM
	ENDIF

	AAREASA1 := SA1->(GETAREA())
	CCONDPAG := FPN->FPN_CONDPA
	CCONTATO := POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_CONTATO")
	DVENCTO  := POSICIONE("SC5", 1 , XFILIAL("SC5") + FPN->FPN_NUMPV , "C5_DATA1"    )
	CNUMPV   := FPN->FPN_NUMPV

	LVEZCAB:=.T.

	NVALGER:=0

	DBSELECTAREA("FPP")
	FPP->(DBSETORDER(1))
	FPP->(DBSEEK(XFILIAL("FPP")+FPN->FPN_COD))
	_CDESCRI := "" 

	WHILE !EOF() .AND. (FPP->FPP_FILIAL == XFILIAL("FPP") .AND. FPP->FPP_COD == FPN->FPN_COD)

		IF EMPTY(_CDESCRI)
			CCODESTO:=POSICIONE("ST9",1,XFILIAL("ST9")+FPP->FPP_FROTA,"T9_CODESTO")  //POSICIONA NO BEM E RETORNA O CÓDIGO DO ESTOQUE
			_CDESCRI := ALLTRIM(POSICIONE("SB1",1,XFILIAL("SB1")+PADR(ALLTRIM(CCODESTO),LEN(SB1->B1_COD)),"B1_DESC"))  //DESCRIÇÃO DO PRODUTO  //SOLICITADO PELO MÁRIO EM 29/05/2015
			IF EMPTY(_CDESCRI)
				_CDESCRI:=STR0006 //"PRODUTO NAO ENCONTRADO"
			ENDIF
		ENDIF

		IF LVEZCAB
			LVEZCAB:=.F.
			IMPCAB()
		ENDIF

		NTOTMO += FPP->FPP_VLTOTM
		NTOTHOR+= FPP->FPP_QTDHR 
		NTOTISS+= FPP->FPP_VALISS
		NTOTKM += FPP->FPP_QTDKM
		
		DO CASE
		CASE FPP_BASE=="K"
				NTOTVLRKM+=FPP->FPP_VLRTOT - FPP->FPP_VALISS
		OTHERWISE
				NTOTVLRHR+=FPP->FPP_VLRTOT - FPP->FPP_VALISS	   
		ENDCASE
			
		OOBJPRINT:SAY( NLIN  , 0000  , DTOC(FPP->FPP_DTMEDI)                                  ,OFONT10 , 100 )
		OOBJPRINT:SAY( NLIN  , 0140  , FPP->FPP_OS                                            ,OFONT10 , 100 )
		
		IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
			NCOL:=700						
					
			OOBJPRINT:SAY( NLIN  , 0270  , FPP->FPP_ITEMBA                                            	,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0400  , FPP->FPP_LINHA                                               ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0560  , FPP->FPP_OMPJ                                        		,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0700  , FPP->FPP_CCUSTO                                        		,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0860  , FPP->FPP_CODGER                                        		,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0310+NCOL  , FPP->FPP_FROTA                                          ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0570+NCOL  ,    IIF(FPP_BASE=="K",ALLTRIM(TRANSFORM(FPP->FPP_KMINI,"@E 9,999.9999")),FPP->FPP_HORAI)                                         ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0710+NCOL  ,    IIF(FPP_BASE=="K",ALLTRIM(TRANSFORM(FPP->FPP_KMFIM,"@E 9,999.9999")),FPP->FPP_HORAF)                                         ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0910+NCOL-30  , IIF(FPP_BASE=="K",ALLTRIM(TRANSFORM(FPP->FPP_QTDKM,"@E 9,999.9999")),ALLTRIM(TRANSFORM(FPP->FPP_QTDHR ,"@E 999.99")) )   ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0950+NCOL+50  , ALLTRIM(TRANSFORM(FPP->FPP_VALHOR,"@E 999,999.99"))  ,OFONT10 , 100 ) //VERIFICAR CAMPO UNITARIO
			OOBJPRINT:SAY( NLIN  , 1130+NCOL+30  , ALLTRIM(TRANSFORM(FPP->FPP_TRSPES,"@E 999,999.99"))  ,OFONT10 , 100 ) //CONTRA PESO 
			OOBJPRINT:SAY( NLIN  , 1270+NCOL+080 , ALLTRIM(TRANSFORM(FPP->FPP_VLRMOB+FPP->FPP_VLRDES,"@E 9,999,999.99"))             ,OFONT10 , 100 )  
			OOBJPRINT:SAY( NLIN  , 1480+NCOL+090 , ALLTRIM(TRANSFORM(FPP->FPP_ANCORA+FPP->FPP_TELESC,"@E 9,999,999.99"))             ,OFONT10 , 100 )  	
			OOBJPRINT:SAY( NLIN  , 1680+NCOL+120 , ALLTRIM(TRANSFORM(FPP->FPP_MONTAG+FPP->FPP_DESMON,"@E 9,999,999.99"))             ,OFONT10 , 100 )  
			OOBJPRINT:SAY( NLIN  , 1880+NCOL+120 , ALLTRIM(TRANSFORM(FPP->FPP_ACESSO,"@E 999,999.99"))  ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 2070+NCOL+090 , ALLTRIM(TRANSFORM(FPP->FPP_VALSEG,"@E 999,999.99"))  ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 2220+NCOL+110 , ALLTRIM(TRANSFORM(FPP->FPP_VLTOTM,"@E 999,999.99"))  ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 2420+NCOL+050 , ALLTRIM(TRANSFORM(FPP->FPP_VALISS,"@E 999,999.99"))  ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 2610+NCOL     , ALLTRIM(TRANSFORM(FPP->FPP_VLRTOT,"@E 999,999.99"))  ,OFONT10 , 100 )     

			OOBJPRINT:SAY( NLIN  , 2800+NCOL     , ALLTRIM(TRANSFORM(FPA->FPA_HRFRAQ,"@E 999,999.99"))  ,OFONT10 , 100 )     
			OOBJPRINT:SAY( NLIN  , 2990+NCOL     , ALLTRIM(TRANSFORM(FPA->FPA_VLHREX,"@E 999,999.99"))  ,OFONT10 , 100 )     

		ELSE
			OOBJPRINT:SAY( NLIN  , 0270 , FPP->FPP_FROTA                                         		,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0570 , IIF(FPP_BASE=="K",ALLTRIM(TRANSFORM(FPP->FPP_KMINI,"@E 9,999.9999")),FPP->FPP_HORAI),OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0680 , IIF(FPP_BASE=="K",ALLTRIM(TRANSFORM(FPP->FPP_KMFIM,"@E 9,999.9999")),FPP->FPP_HORAF),OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0810 , IIF(FPP_BASE=="K",ALLTRIM(TRANSFORM(FPP->FPP_QTDKM,"@E 9,999.9999")),ALLTRIM(TRANSFORM(FPP->FPP_QTDHR ,"@E 999.99")) ) ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 0920+100 , TRANSFORM(FPP->FPP_VALHOR,"@E 999,999.99"                  ),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1130+100 , TRANSFORM(FPP->FPP_TRSPES,"@E 999,999.99"                  ),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1270+100 , TRANSFORM(FPP->FPP_VLRMOB+FPP->FPP_VLRDES,"@E 9,999,999.99"),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1480+100 , TRANSFORM(FPP->FPP_MONTAG+FPP->FPP_DESMON,"@E 9,999,999.99"),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1680+100 , TRANSFORM(FPP->FPP_VALSEG,"@E 999,999.99"                  ),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1880+100 , TRANSFORM(FPP->FPP_VLTOTM,"@E 999,999.99"                  ),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 2070+100 , TRANSFORM(FPP->FPP_VALISS,"@E 999,999.99"                  ),OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 2220+100 , TRANSFORM(FPP->FPP_VLRTOT,"@E 999,999.99"                  ),OFONT10 , 100 , , , 1 )

			OOBJPRINT:SAY( NLIN  , 2370+100     , ALLTRIM(TRANSFORM(FPA->FPA_HRFRAQ,"@E 999,999.99"))  ,OFONT10 , 100 )     
			OOBJPRINT:SAY( NLIN  , 2520+100     , ALLTRIM(TRANSFORM(FPA->FPA_VLHREX,"@E 999,999.99"))  ,OFONT10 , 100 )     

		ENDIF

		NVALGER+=FPP->FPP_VLRTOT

		NLIN := NLIN + 50
		//DANIEL 
		IF CPERSEGU <> FPP->FPP_PERSEG 
			CPERSEGU := FPP->FPP_PERSEG 
		ENDIF  
		DBSELECTAREA("FPP")
		DBSKIP()
		
		IF NLIN >= 2350
			IMPCAB()
		ENDIF
		
	END

	IF LVEZCAB
		LVEZCAB:=.F.
		IMPCAB()
	ENDIF

	IF NLIN>= 2300
		NLIN := 250
		OOBJPRINT:ENDPAGE()
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:SAYBITMAP( 55, 020,CLOGO   , 690, 0280 ) //553 X 224
		NLIN:=NLIN +80
	ENDIF

	IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
		NAUX:=080
	ENDIF
	OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )

	NLIN+=50

	OOBJPRINT:SAY( NLIN  , 0060   , STR0007        + TRANSFORM(NTOTHOR   , "@E 9,999.99")	    + SPACE(04) +; //"TOTAL HORA"
									STR0008    + TRANSFORM(NTOTVLRHR , "@E 9,999,999.99")	+ SPACE(04) +; //"TOTAL MED HORA"
									STR0009 	+ TRANSFORM(NTOTMED   , "@E 9,999,999.99")	+ SPACE(04) +; //"TOTAL MEDIÇÃO R$"
									STR0010      + CTPISS									+ SPACE(04) +; //"TIPO ISS    "
									STR0011          + TRANSFORM(CPERISS   , "@E 999.99")		+ SPACE(04) +; //"% ISS   "
									STR0012		+ TRANSFORM(NTOTISS   , "@E 9,999,999.99")	+ SPACE(04) +; //"TOTAL ISS R$"
									STR0013		+ TRANSFORM(CPERMO    , "@E 9,999,999.99")	+ SPACE(04) +; //"% MO        "
									STR0014		+ TRANSFORM(NTOTMO    , "@E 99,999,999.99")	+ SPACE(04) ,OFONT10 , 100 ) //"TOTAL MO   R$"
															
	NLIN+=50

	IF NLIN>= 2300
		NLIN := 250
		OOBJPRINT:ENDPAGE()
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:SAYBITMAP( 55, 020,CLOGO   , 690, 0280 ) //553 X 224
		NLIN:=NLIN +80
	ENDIF

	IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
		NAUX:=080
	ENDIF
	OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )

	NLIN+=50

	OOBJPRINT:SAY( NLIN  , 0060   , STR0015       	+ TRANSFORM(NTOTKM    , "@E 9,999.99")	    + SPACE(04) +; //"TOTAL KM  "
									STR0016    + TRANSFORM(NTOTVLRKM , "@E 9,999,999.99")	+ SPACE(04) +;								 //"TOTAL MED KM  "
									STR0017 	+ TRANSFORM(NARREDON  , "@E 9,999,999.99")	+ SPACE(04) +; //"TOTAL ARREDON.R$"
									STR0018      + CTPSEGURO									+ SPACE(04) +; //"TIPO SEGURO "
									STR0019          + TRANSFORM(CPERSEGU  , "@E 999.99")		+ SPACE(04) +; //"% SEGURO"
									STR0020		+ TRANSFORM(NDESCON   , "@E 9,999,999.99")	+ SPACE(04) +; //"DESCONTO  R$"
									STR0021		+ TRANSFORM(NACRESC   , "@E 9,999,999.99")	+ SPACE(04) +; //"ACRESCIMO R$"
									STR0022		+ TRANSFORM(NTOTTOT   , "@E 99,999,999.99") + SPACE(04) +; //"TOTAL REAL R$"
									STR0023 	+  POSICIONE("SE4",1,XFILIAL("SE4")+CCONDPAG,"E4_DESCRI")        ,OFONT10 , 100 ) //"FORMA DE PGTO "

	NLIN+=50
	IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
		NAUX:=080
	ENDIF
	OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )

	NLIN+=50
	CDET1:=STR0024 //"TOTAL MEDICAO CONTRATO/LOCACAO"
	OOBJPRINT:SAY( NLIN  , NPOS003  , CDET1 ,OFONT05 , 100 )
	cDET1:=(TRANSFORM(NVALGER,"@E 999,999,999.99")) // SIGALOC94-504 (CEC 29942 ) - Jose Eulalio - 14/09/2022 - Lui solicitou retirar todas chamadas da FPG
	OOBJPRINT:SAY( NLIN  , NPOS005  , CDET1 ,OFONT05 , 100 , , , 1 )

	NLIN+=50
	IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
		NAUX:=080
	ENDIF
	OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )
	NLIN+=70

	IF NLIN>= 2000
		NLIN := 250
		OOBJPRINT:ENDPAGE()
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:SAYBITMAP( 55, 020,CLOGO   , 690, 0280 ) //553 X 224
		NLIN:=NLIN +50
	ENDIF

	LVEZ := .T.
	LIMP := .F.
	NY   := MLCOUNT(FPN->FPN_OBSDES)
	FOR NX:=1 TO NY
		IF EMPTY(MEMOLINE(FPN->FPN_OBSDES,160,NX))
			LOOP
		ENDIF

		IF LVEZ
			LVEZ:=.F.
			NLIN+=70
			IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
				NAUXO := 0450
			ENDIF
			OOBJPRINT:SAY( NLIN  , 1000+NAUXO  , STR0025     ,OFONT05 , 100 ) //"OBSERVAÇÕES - DESCONTO"
		ENDIF

		LIMP:=.T.
		NLIN:=NLIN+100
		IF NLIN >= 2300
			NLIN := 250
			OOBJPRINT:ENDPAGE()
			OOBJPRINT:STARTPAGE()
			OOBJPRINT:SAYBITMAP( 55, 020,CLOGO   , 690, 0280 ) //553 X 224
			NLIN:=NLIN +0050
			OOBJPRINT:SAY( NLIN  , 1000+NAUXO  , STR0025     ,OFONT05 , 100 )   //"OBSERVAÇÕES - DESCONTO"
			NLIN:=NLIN +0100
		ENDIF                                                                           

		OOBJPRINT:SAY( NLIN  , 0050  , MEMOLINE(FPN->FPN_OBSDES,160,NX) ,OFONT10 , 100 )
		
	NEXT NX 

	LVEZ := .T.
	LIMP := .F.      
	NY   :=  MLCOUNT(FPN->FPN_OBSACR)
	FOR NX:=1 TO NY
		IF EMPTY(MEMOLINE(FPN->FPN_OBSACR,160,NX))
			LOOP
		ENDIF

		IF LVEZ
			LVEZ:=.F.
			NLIN+=50
			IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
				NAUX:=080
			ENDIF
			OOBJPRINT:SAY( NLIN+50  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )
			NLIN+=70
			OOBJPRINT:SAY( NLIN  , 1000+NAUXO  , STR0026     ,OFONT05 , 100 ) //"OBSERVAÇÕES - ACRESCIMO"
		ENDIF

		LIMP:=.T.
		NLIN:=NLIN+100
		IF NLIN >= 2300
			NLIN := 250
			OOBJPRINT:ENDPAGE()
			OOBJPRINT:STARTPAGE()
			OOBJPRINT:SAYBITMAP( 55, 20,CLOGO   , 690, 0280 ) //553 X 224
			NLIN:=NLIN +0050
			OOBJPRINT:SAY( NLIN  , 1000+NAUXO  , STR0026     ,OFONT05 , 100 )   //"OBSERVAÇÕES - ACRESCIMO"
			NLIN:=NLIN +0100
		ENDIF    
		OOBJPRINT:SAY( NLIN  , 0050  , MEMOLINE(FPN->FPN_OBSACR,160,NX) ,OFONT10 , 100 )
		
	NEXT

	LVEZ := .T.
	LIMP := .F.    
	NY   := MLCOUNT(FPN->FPN_OBS) 
	FOR NX:=1 TO NY
		IF EMPTY(MEMOLINE(FPN->FPN_OBS,160,NX))
			LOOP
		ENDIF

		IF LVEZ
			LVEZ:=.F.
			NLIN+=50
			IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
				NAUX:=080
			ENDIF
			OOBJPRINT:SAY( NLIN+50  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )
			NLIN+=70
			OOBJPRINT:SAY( NLIN  , 1000+NAUXO  , STR0027     ,OFONT05 , 100 ) //"OBSERVAÇÕES - FATURAMENTO"
		ENDIF

		LIMP:=.T.
		NLIN:=NLIN+100
		IF NLIN >= 2300
			NLIN := 250
			OOBJPRINT:ENDPAGE()
			OOBJPRINT:STARTPAGE()
			OOBJPRINT:SAYBITMAP( 55, 20,CLOGO   , 690, 0280 ) //553 X 224
			NLIN:=NLIN +0050
			OOBJPRINT:SAY( NLIN  , 1000+NAUXO  , STR0027     ,OFONT05 , 100 )   //"OBSERVAÇÕES - FATURAMENTO"
			NLIN:=NLIN +0100
		ENDIF    
		
		OOBJPRINT:SAY( NLIN  , 0050  , MEMOLINE(FPN->FPN_OBS,160,NX) ,OFONT10 , 100 )
		
	NEXT  

	///////////////////////////////////////////////////////////////////////////////
	// IMPRIME AS RESPONSABILIDADES - INÍCIO
	///////////////////////////////////////////////////////////////////////////////
	LTEMZAA:=.F.
	ATABZAA:={}
	FP6->(DBSETORDER(2))  //FP6_FILIAL+FP6_PROJET+FP6_OBRA+FP6_SEQGUI+FP6_SEQRES
	FP6->(DBSEEK(XFILIAL("FP6")+FPN->FPN_PROJET+FPN->FPN_OBRA))  //POSICIONA NO ZAA
	WHILE FP6->(!EOF() .AND. FP6_FILIAL+FP6_PROJET+FP6_OBRA==XFILIAL("FP6")+FPN->FPN_PROJET+FPN->FPN_OBRA)
		IF FP6->(FP6_RESPON<>"C")  //C=CLIENTE,L=EMPRESA,D=DESPESA
			FP6->(DBSKIP())
			LOOP
		ENDIF

		// LINHA ADICIONADA PRA FUNCIONAR O RELATÓRIO!
		FP6->(AADD(ATABZAA,{FP6_CODIGO,FP6_DESCRI, 1         , FP6_VALCOB             ,ROUND(FP6_VALCOB,2)                        ,""        ,""                                                    }))


		FP6->(DBSKIP())
		LTEMZAA:=.T.
	END
	IF LTEMZAA
		NLIN+=70
		OOBJPRINT:SAY( NLIN  , 1150+NAUXO  , STR0028     ,OFONT05 , 100 ) //"RESPONSABILIDADES"
		NLIN+=50
		OOBJPRINT:SAY( NLIN  , 0100 , STR0029        ,OFONT05 , 100 ) //"CODIGO"
		OOBJPRINT:SAY( NLIN  , 0400 , STR0030     ,OFONT05 , 100 ) //"DESCRIÇÃO"
		OOBJPRINT:SAY( NLIN  , 1000 , STR0031    ,OFONT05 , 100 ) //"QUANTIDADE"
		OOBJPRINT:SAY( NLIN  , 1400 , STR0032,OFONT05 , 100 ) //"VALOR UNITÁRIO"
		OOBJPRINT:SAY( NLIN  , 1800 , STR0033   ,OFONT05 , 100 ) //"VALOR TOTAL"
		NVALTOT:=0
		FOR NPOS:=1 TO LEN(ATABZAA)
			NLIN+=050

			CDET1:=ATABZAA[NPOS,6]//ATABZAA[NPOS,1]  //IMPRIMIR O CÓDIGO DO PRODUTO, NÃO DA RESPONSABILIDADE
			OOBJPRINT:SAY( NLIN  , 0100  , CDET1 ,OFONT10 , 100 )
			CDET1:=ATABZAA[NPOS,7]//ATABZAA[NPOS,2]  //IMPRIMIR A DESCRIÇÃO DO PRODUTO, NÃO DA RESPONSABILIDADE
			OOBJPRINT:SAY( NLIN  , 0400  , CDET1 ,OFONT10 , 100 )
			OOBJPRINT:SAY( NLIN  , 1100  , CDET1 ,OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1500  , CDET1 ,OFONT10 , 100 , , , 1 )
			OOBJPRINT:SAY( NLIN  , 1900  , CDET1 ,OFONT10 , 100 , , , 1 ) 
			NVALTOT+=ATABZAA[NPOS,5]

		NEXT
		NLIN+=50
		IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
			NAUX:=080
		ENDIF
		OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )
		
		NLIN+=50
		CDET1:=STR0034 //"TOTAL RESPONSABILIDADES"
		OOBJPRINT:SAY( NLIN  , 0400  , CDET1 ,OFONT05 , 100 )
		OOBJPRINT:SAY( NLIN  , 1900  , CDET1 ,OFONT05 , 100 , , , 1 )

		NVALGER+=NVALTOT

		NLIN+=050
		IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
			NAUX:=080
		ENDIF
		OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )
	ENDIF
	///////////////////////////////////////////////////////////////////////////////
	// IMPRIME OS RESPONSABILIDADES - FIM
	///////////////////////////////////////////////////////////////////////////////

	///////////////////////////////////////////////////////////////////////////////
	// IMPRIME OS CUSTOS EXTRAS - INÍCIO
	///////////////////////////////////////////////////////////////////////////////
	LTEMZC1:=.F.

	*/
	///////////////////////////////////////////////////////////////////////////////
	// IMPRIME OS CUSTOS EXTRAS - FIM
	///////////////////////////////////////////////////////////////////////////////
		
	NLIN+=50
	CDET1:=STR0042 //"TOTAL GERAL"
	OOBJPRINT:SAY( NLIN  , NPOS003  , CDET1 ,OFONT05 , 100 )
	// CDET1:=FPG->(TRANSFORM(NVALGER,"@E 999,999,999.99"))  // SIGALOC94-504 (CEC 29942 ) - Jose Eulalio - 14/09/2022 - Lui solicitou retirar todas chamadas da FPG
	CDET1:=(TRANSFORM(NVALGER,"@E 999,999,999.99"))  // SIGALOC94-504 (CEC 29942 ) - Jose Eulalio - 14/09/2022 - Lui solicitou retirar todas chamadas da FPG
	OOBJPRINT:SAY( NLIN  , NPOS005  , CDET1 ,OFONT05 , 100 , , , 1 )
	//

	NLIN+=50
	IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
		NAUX:=080
	ENDIF
	OOBJPRINT:SAY( NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )
	NLIN+=70

	SA1->(RESTAREA(AAREASA1))

RETURN


// ======================================================================= \\
STATIC FUNCTION IMPCAB()
// ======================================================================= \\

	NLIN := 150                          
    
    OOBJPRINT:ENDPAGE()
    OOBJPRINT:STARTPAGE()
    OOBJPRINT:SAYBITMAP( 0055, 020,CLOGO   , 690, 0280 ) //553 X 224
        
    //INCLUSAO DO CAMPO DO NUMERO DO PEDIDO DE VENDA  - CANDISANI - 08/08/08
    OOBJPRINT:SAY( 150  , 1240 - 0240  , STR0043        , OFONT02   , 100 )  //"BOLETIM DE MEDICAO "
    OOBJPRINT:SAY( 150  , 1800  , STR0044   , OFONT02   , 100 ) //"PEDIDO VENDA "
    OOBJPRINT:SAY( 220  , 1200  , STR0045+TRANSFORM(FPN->FPN_COD,"@R 999.999")    , OFONT02   , 100 )  //"NR.: "
    OOBJPRINT:SAY( 220  , 1800  , STR0045+FPN->FPN_NUMPV    , OFONT02   , 100 ) //"NR.: "
    
    
    OOBJPRINT:SAY( 220+NLIN  , 0060  , STR0046 +  SUBSTRING(DTOS(FP0->FP0_DATINC),7,2)+"/"+SUBSTRING(DTOS(FP0->FP0_DATINC),5,2)+"/"+SUBSTRING(DTOS(FP0->FP0_DATINC),3,2),OFONT05 , 100 )     //"EMISSAO :  "
    OOBJPRINT:SAY( 220+NLIN  , 0550  , STR0047 +CAS             ,OFONT05 , 100 ) //"A.S.G :  "
	OOBJPRINT:SAY( 220+NLIN  , 1300  , STR0048 +CSERVICO       ,OFONT05 , 100 )     //"SERVIÇO:  "
    OOBJPRINT:SAY( 220+NLIN  , 1800  , STR0049+DTOC(DDATABASE)+STR0050+TIME()  ,OFONT05 , 100 )   //"IMPRESSA EM :  "###" ÀS "
    
    IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
       NAUX:=080
    ENDIF
    OOBJPRINT:SAY(270+NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )   
    
    OOBJPRINT:SAY( 320+NLIN  , 0060  , STR0051 ,OFONT05 , 100 ) //"CLIENTE : "
    OOBJPRINT:SAY( 320+NLIN  , 1000  , STR0052    ,OFONT05 , 100 ) //"CNPJ : "
    OOBJPRINT:SAY( 320+NLIN  , 1500  , STR0053    ,OFONT05 , 100 ) //"I.E :  "
    
    OOBJPRINT:SAY( 330+NLIN  , 0250  , FP0->FP0_CLINOM ,OFONT10 , 100 )
    OOBJPRINT:SAY( 330+NLIN  , 1140  , TRANSFORM(FP0->FP0_CLICGC,"@!R NN.NNN.NNN/NNNN-99")    ,OFONT10 , 100 )
    OOBJPRINT:SAY( 330+NLIN  , 1600  , TRANSFORM(FP0->FP0_CLIINS,"@R 999.999.999-999")       ,OFONT10 , 100 )
    
    
    IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
       NAUX:=080
    ENDIF

    OOBJPRINT:SAY( 370+NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )   
    
    OOBJPRINT:SAY( 420+NLIN  , 0060  , STR0054 ,OFONT05 , 100 ) //"ENDERECO COMERCIAL: "
    OOBJPRINT:SAY( 470+NLIN  , 0060  , STR0055   	      ,OFONT05 , 100 ) //"BAIRRO: "
    OOBJPRINT:SAY( 470+NLIN  , 0700  , STR0056		      ,OFONT05 , 100 ) //"CIDADE: "
    OOBJPRINT:SAY( 470+NLIN  , 1770  , STR0057 		      ,OFONT05 , 100 ) //"ESTADO: "
    OOBJPRINT:SAY( 520+NLIN  , 0060  , STR0058 			  ,OFONT05 , 100 ) //"CEP: "
    OOBJPRINT:SAY( 520+NLIN  , 0700  , STR0059 		      ,OFONT05 , 100 ) //"TELEFONE:"
        
    OOBJPRINT:SAY( 428+NLIN  , 0500  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_END"    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 478+NLIN  , 0180  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_BAIRRO" )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 478+NLIN  , 0900  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_MUN"    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 478+NLIN  , 1885  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_EST"    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 528+NLIN  , 0180  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_CEP"    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 530+NLIN  , 0900  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_TEL"    )	,OFONT10 , 100 )
    
    OOBJPRINT:SAY( 620+NLIN  , 0060  , STR0060,OFONT05 , 100 ) //"ENDERECO DE COBRANCA: "
    OOBJPRINT:SAY( 670+NLIN  , 0060  , STR0055  		       ,OFONT05 , 100 ) //"BAIRRO: "
    OOBJPRINT:SAY( 670+NLIN  , 0700  , STR0056 		       ,OFONT05 , 100 ) //"CIDADE: "
    OOBJPRINT:SAY( 670+NLIN  , 1400  , STR0057 		       ,OFONT05 , 100 ) //"ESTADO: "
    OOBJPRINT:SAY( 720+NLIN  , 0060  , STR0058    		       ,OFONT05 , 100 ) //"CEP: "
    OOBJPRINT:SAY( 720+NLIN  , 0700  , STR0061  	       ,OFONT05 , 100 ) //"TELEFONE: "
    
    OOBJPRINT:SAY( 628+NLIN  , 0500  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_ENDCOB"    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 678+NLIN  , 0180  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_BAIRROC"   )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 678+NLIN  , 0900  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_MUNC" 	    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 678+NLIN  , 1550  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_ESTC"      )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 678+NLIN  , 2000  , POSICIONE("SYA", 1 , XFILIAL("SYA") + POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_PAIS"    ),"YA_DESCR")     ,OFONT10 , 100 )    
    OOBJPRINT:SAY( 728+NLIN  , 0180  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_CEPC"	    )	,OFONT10 , 100 )
    OOBJPRINT:SAY( 728+NLIN  , 0900  , POSICIONE("SA1", 1 , XFILIAL("SA1") + FPN->FPN_CLIENTE + FPN->FPN_LOJA  , "A1_TEL"    	)	,OFONT10 , 100 )
    
    
    IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
    	NAUX:=080
    ENDIF
    OOBJPRINT:SAY( 770+NLIN  , 0000    , REPLICATE("-",330+NAUX),OFONT10 , 100 )   

	OOBJPRINT:SAY( 0820+NLIN ,  0060  , STR0062                ,OFONT05 , 100 ) //"OBRA: "
	OOBJPRINT:SAY( 0820+NLIN ,  1600-200  , STR0063  ,OFONT05 , 100 ) //"PERIODO DE MEDIÇÃO: "
	
	OOBJPRINT:SAY( 0828+NLIN ,  200  , CDESOBRA                ,OFONT10 , 100 )
	OOBJPRINT:SAY( 0828+NLIN ,  2000-200  , DTOC(FPN->FPN_DTINIC)+ ' À '+DTOC(FPN->FPN_DTFIM)    ,OFONT10 , 100 )

	OOBJPRINT:SAY( 0828+NLIN ,  2200  , STR0064 ,OFONT05 , 100 ) //"PRODUTO:"
	OOBJPRINT:SAY( 0828+NLIN ,  2400  , _CDESCRI ,OFONT10 , 100 )
	
	IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
    	NAUX  :=080
    	NAUXO := 0450
    ENDIF
	OOBJPRINT:SAY( 870+NLIN  , 0000    , REPLICATE("-",330+NAUX)         ,OFONT10 , 100 )   	

	OOBJPRINT:SAY( 0920+NLIN  , 1100+NAUXO  , STR0065, OFONT05, 100 ) //"MEDICAO CONTRATO/LOCACAO "
	    
	 IF (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "04") .OR. (SM0->M0_CODIGO == "01" .AND. SM0->M0_CODFIL == "09")
	   
		OOBJPRINT:SAY(0970+NLIN  , 0000  , STR0039                     ,OFONT05 , 100 ) //"DATA"
		OOBJPRINT:SAY(0970+NLIN  , 0140  , STR0066                       ,OFONT05 , 100 ) //"OS"

		OOBJPRINT:SAY(0970+NLIN  , 0270  , STR0067                  ,OFONT05 , 100 )	     //"IT.PBR."
		OOBJPRINT:SAY(0970+NLIN  , 0400  , STR0068                  ,OFONT05 , 100 )	    	     //"LI.PBR."
		OOBJPRINT:SAY(0970+NLIN  , 0560  , STR0069                    ,OFONT05 , 100 )	    	    	     //"OM/PJ"
		OOBJPRINT:SAY(0970+NLIN  , 0700  , STR0070                  ,OFONT05 , 100 )	    	    	     //"C.CUSTO"
		OOBJPRINT:SAY(0970+NLIN  , 0860  , STR0029                   ,OFONT05 , 100 )	    	    	     //"CODIGO"
					    
	    OOBJPRINT:SAY(0970+NLIN  , 1050  , STR0071                    ,OFONT05 , 100 ) //"FROTA"
	    OOBJPRINT:SAY(0970+NLIN  , 1260  , STR0072                   ,OFONT05 , 100 ) //"INICIO"
	    OOBJPRINT:SAY(0970+NLIN  , 1410  , STR0073                    ,OFONT05 , 100 )     //"FINAL"
	    OOBJPRINT:SAY(0970+NLIN  , 1570  , STR0074                     ,OFONT05 , 100 ) //"QTDE"
	    OOBJPRINT:SAY(0970+NLIN  , 1710  , STR0075                    ,OFONT05 , 100 ) //"UNIT."
	    OOBJPRINT:SAY(0970+NLIN  , 1850  , STR0076                  ,OFONT05 , 100 ) //"CT PESO"
	    OOBJPRINT:SAY(0970+NLIN  , 2050  , STR0077                 ,OFONT05 , 100 )  //"MOB/DESM"
		OOBJPRINT:SAY(0970+NLIN  , 2280  , STR0078                 ,OFONT05 , 100 )                        	 //"ANC/TELE"
		OOBJPRINT:SAY(0970+NLIN  , 2480  , STR0079                  ,OFONT05 , 100 )                        		 //"MON/DES"
		OOBJPRINT:SAY(0970+NLIN  , 2670  , STR0080                    ,OFONT05 , 100 ) //"CHUMB"
	    OOBJPRINT:SAY(0970+NLIN  , 2820  , STR0081                  ,OFONT05 , 100 ) //"SEGURO "
	    OOBJPRINT:SAY(0970+NLIN  , 3000  , STR0082                   ,OFONT05 , 100 )             //"VLR MO"
	    OOBJPRINT:SAY(0970+NLIN  , 3170  , STR0083                     ,OFONT05 , 100 ) //"ISS "
	    OOBJPRINT:SAY(0970+NLIN  , 3300  , STR0084                   ,OFONT05 , 100 )    //"TOTAL "
		OOBJPRINT:SAY(0970+NLIN  , 3430  , STR0085                 ,OFONT05 , 100 )    //"FRANQUIA"
		OOBJPRINT:SAY(0970+NLIN  , 3570  , STR0086                   ,OFONT05 , 100 )    //"VLR.H.EXTRA"

     	NAUX:=080
     ELSE		
		OOBJPRINT:SAY(0970+NLIN  , 0000  , STR0039                     ,OFONT05 , 100 ) //"DATA"
		OOBJPRINT:SAY(0970+NLIN  , 0140  , STR0066                       ,OFONT05 , 100 ) //"OS"
	    OOBJPRINT:SAY(0970+NLIN  , 0270  , STR0087                   ,OFONT05 , 100 ) //"FROTA "
	    OOBJPRINT:SAY(0970+NLIN  , 0570  , STR0088                  ,OFONT05 , 100 ) //"INICIO "
	    OOBJPRINT:SAY(0970+NLIN  , 0680  , STR0089                  ,OFONT05 , 100 )     //"FINAL  "
	    OOBJPRINT:SAY(0970+NLIN  , 0780  , STR0090                    ,OFONT05 , 100 ) //"QTDE "
	    OOBJPRINT:SAY(0970+NLIN  , 0890  , STR0091                ,OFONT05 , 100 ) //"UNITARIO "
	    OOBJPRINT:SAY(0970+NLIN  , 1050  , STR0092            ,OFONT05 , 100 ) //"CT.PESO/FRETE"
	    OOBJPRINT:SAY(0970+NLIN  , 1270  , STR0093                ,OFONT05 , 100 )  //"MOB/DESM."
		OOBJPRINT:SAY(0970+NLIN  , 1480/*1680*/  , STR0094                 ,OFONT05 , 100 )                        		 //"MON/DES."
	    OOBJPRINT:SAY(0970+NLIN  , 1680/*2070*/  , STR0081                  ,OFONT05 , 100 ) //"SEGURO "
	    OOBJPRINT:SAY(0970+NLIN  , 1860/*2220*/  , STR0095               ,OFONT05 , 100 )             //"VALOR MO  "
	    OOBJPRINT:SAY(0970+NLIN  , 2070/*2420*/  , STR0083                     ,OFONT05 , 100 ) //"ISS "
	    OOBJPRINT:SAY(0970+NLIN  , 2220/*2620*/  , STR0084                   ,OFONT05 , 100 )    //"TOTAL "
		OOBJPRINT:SAY(0970+NLIN  , 2370  , STR0085                 ,OFONT05 , 100 )    //"FRANQUIA"
		OOBJPRINT:SAY(0970+NLIN  , 2530  , STR0086                   ,OFONT05 , 100 )    //"VLR.H.EXTRA"
	 ENDIF   

	NLIN := 1030+NLIN

RETURN(NIL)

