
#include "PROTHEUS.CH"
#include "PLSMGER.CH"
#include "COLORS.CH"

/*


ͻ
Programa  PLSA166   Autor  Geraldo Felix Junior Data   09/04/04   
͹
Desc.     utilitario de pesquisa de agendas e impressao de atestados  
          retroativos...                                              
͹
Uso        AP                                                        
ͼ


*/
Function PLSA166()
LOCAL cMotBlo   	:=  GetNewPar("MV_PLMCBL","001")

PRIVATE cCadastro 	:= 'Pesquisa de agendas'
//Ŀ
// Define opcoes da rotina...                                               
//
PRIVATE aRotina  := MenuDef()
                          

PRIVATE aCdCores  := {  { 'NOCHECKED'	,'Cancelado' },;                        
                        { 'BR_VERDE' 	,'Agenda em aberto'  },;
                        { 'BR_VERMELHO' ,'Agenda encerrada'  }}

PRIVATE aCores    := {	{ "BBD_CODCAN <> ' ' .AND. BBD_CODCAN <> '"+cMotBlo+"' " ,aCdCores[1,1] },;                        
						{ "BBD_NUMATE  = ' '"  ,aCdCores[2,1] },;
                        { "BBD_NUMATE <> ' '"  ,aCdCores[3,1] }}
                        
//Ŀ
// Define o cabecalho da tela de atualizacoes                               
//
PRIVATE cAlias    := "BBD"

//Ŀ
// Chama mBrowse padrao...                                                  
//
BBD->(DbSeek(xFilial("BBD")))
BBD->(mBrowse(06,01,22,75,'BBD',,"BBD->BBD_STATUS<>'0'",20,,,aCores))

//Ŀ
// Fim da Rotina Principal...                                               
//
Return

/*/


Ŀ
Funcao     PLS166LEG   Autor Geraldo Felix Junior. Data  08.01.02 
Ĵ
Descricao  Exibe a legenda...                                         
ٱ


/*/
Function PLS166Leg()

BrwLegenda("Movtos de Auditoria","Status" ,aCdCores)


Return

/*/


Ŀ
Programa  MenuDef    Autor  Darcio R. Sporl        Data 27/12/2006
Ĵ
Descrio  Utilizacao de menu Funcional                               
                                                                      
                                                                      
Ĵ
Retorno   Array com opcoes da rotina.                                 
Ĵ
ParametrosParametros do array a Rotina:                               
          1. Nome a aparecer no cabecalho                             
          2. Nome da Rotina associada                                 
          3. Reservado                                                
          4. Tipo de Transao a ser efetuada:                        
          		1 - Pesquisa e Posiciona em um Banco de Dados           
              2 - Simplesmente Mostra os Campos                       
              3 - Inclui registros no Bancos de Dados                 
              4 - Altera o registro corrente                          
              5 - Remove o registro corrente do Banco de Dados        
          5. Nivel de acesso                                          
          6. Habilita Menu Funcional                                  
Ĵ
   DATA    Programador   Manutencao efetuada                         
Ĵ
                                                                     
ٱ


/*/
Static Function MenuDef()
Private aRotina := {	{ STRPL01			, 'AxPesqui'		, 0 , K_Pesquisar  ,0 ,.F.},; 
						 					{ STRPL02		, 'AxVisual'		, 0 , K_Visualizar ,0 ,Nil},;
						 					{ "Atest. Retr."	, 'PLSA315ATD'	, 0 , K_Visualizar ,0 ,Nil},;
            					{ "Legenda"      	, 'PLS166LEG' 	, 0 , K_Visualizar ,0 ,Nil} }
Return(aRotina)