#include "TOTVS.CH"

#DEFINE LEVEL_CABEC "1"
#DEFINE LEVEL_ITEMS "2"

//-------------------------------------------------------------------
/*/{Protheus.doc} ReferenceValuesCollection
.
@author  Sakai
@version P12
@since   31/01/2024
/*/
//-------------------------------------------------------------------
Class ReferenceValuesCollection from CenCollection

    Data cLevel as Character

    public method New() Constructor
    public method initEntity(cLevel)
    public method setMapper()
 	 
    public method get()
    public method goTop()
    public method getNext()

EndClass

Method New() Class ReferenceValuesCollection
    _Super:new()
Return self

Method initEntity(cLevel) Class ReferenceValuesCollection
Return ReferenceValuesEntity():New(cLevel)

Method setMapper(cLevel) Class ReferenceValuesCollection
    self:cLevel  := cLevel
    self:oMapper := ReferenceValuesMapper():New(self:cLevel)
    self:oDao    := ReferenceValuesDao():New(self:oMapper:getFields())
Return

Method get(jRequest) Class ReferenceValuesCollection
    self:lFound := self:getDao():get(jRequest)
    if self:lFound 
        self:goTop()
    endIf    
Return self:found()

Method goTop() Class ReferenceValuesCollection
    self:nRecno := 1
    (self:getDao():getAliasTemp())->(DBGoTop())
Return

Method getNext() Class ReferenceValuesCollection
    self:oMapper:setEntity(self:initEntity(self:cLevel))
    self:oMapper:mapFromDao(self:getDao())
    self:hMap := self:oMapper:getEntity():getHMap()
    self:setKeyRelation()
    self:nRecno++
    (self:getDao():getAliasTemp())->(DbSkip())
Return self:oMapper:getEntity()