#include 'tlpp-core.th'

namespace agd.ProgramaParidadeCalcService

/*/{Protheus.doc} agdProgramaParidadeCalc
Classe responsavel por realizar os calculos do Programa de Paridade.
@type class
@version 12
@author jc.maldonado
@since 29/01/2025
/*/
class agdProgramaParidadeCalcService
    private data codigoProdutoInsumo as character
    private data precoProdutoInsumo  as numeric
    private data valorInsumo         as numeric

    public method new()
    public method setPrecoProduto()  as logical
    public method setValorInsumo()   as logical
    public method getValorParidade() as numeric
endClass

/*/{Protheus.doc} agdProgramaParidadeCalcService::new
Construtor
@type method
@version 12
@author jc.maldonado
@since 01/04/2025
@param codigoProdutoInsumo, character, codigo do produto
@param precoProduto, numeric, preco do produto
@param valorInsumo, numeric, valor do produto
/*/
method new(codigoProdutoInsumo as character, precoProduto as numeric, valorInsumo as numeric) class agdProgramaParidadeCalcService
    ::codigoProdutoInsumo := codigoProdutoInsumo
    ::precoProdutoInsumo  := precoProduto
    ::valorInsumo         := valorInsumo
return Self

/*/{Protheus.doc} agdProgramaParidadeCalcService::setPrecoProduto
Define o preço do produto.
@type method
@version 12
@author jc.maldonado
@since 01/04/2025
@param preco, numeric, preco do produto
@return logical, .t.
/*/
method setPrecoProduto(preco as numeric) as logical class agdProgramaParidadeCalcService
    ::precoProdutoInsumo := preco
return .t.

/*/{Protheus.doc} agdProgramaParidadeCalcService::setValorInsumo
Define o valor do insumo.
@type method
@version 12
@author jc.maldonado
@since 01/04/2025
@param valor, numeric, valor do insumo
@return logical, .t.
/*/
method setValorInsumo(valor as numeric) as logical class agdProgramaParidadeCalcService
    ::valorInsumo := valor
return .t.

/*/{Protheus.doc} agdProgramaParidadeCalcService::getValorParidade
Retorna o valor da paridade.
@type method
@version 12
@author jc.maldonado
@since 01/04/2025
@return numeric, valor da paridade
/*/
method getValorParidade() as numeric class agdProgramaParidadeCalcService
return round(::precoProdutoInsumo / ::valorInsumo, 2)
