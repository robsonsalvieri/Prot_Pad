#include 'totvs.ch'
#include 'tlpp-core.th'
#include 'fwmvcdef.ch'

namespace agd.tabelaPrecoRepository

using namespace agd.repositoryUtils

/*/{Protheus.doc} agdtabelaPrecoRepository
Classe repository da tabela de preço
@type class
@version P12
@author scheronlini.martins
@since 06/08/2025
/*/
class agdtabelaPrecoRepository from agdRepositoryUtils
	public method new()

	private method getFields()           as array
	private method getJoins()           as array

endclass

/*/{Protheus.doc} agdLookupRepository::New
Construtor
@type method
@version 12
@author lindembergson.pacheco
@since 20/05/2025
@return object, self
/*/
method new(cFields) class agdtabelaPrecoRepository
	_Super:New('DA0', self:getFields(), Self:getJoins())
return self




method getFields() as array class agdtabelaPrecoRepository
	local aFields        := {} as array

	aFields := {;
		{"codigotabela" ,   "DA0_CODTAB", "C", .T., "DA0"},;
		{"codigoproduto" ,  "DA1_CODPRO", "C", .T., "DA1"},;
		{"descricao",       "B1_DESC",   "C", .T., "SB1"},;
		{"nomecientifico",  "B5_CEME",   "C", .T., "SB5"},;
		{"precodevenda",    "DA1_PRCVEN","N", .T., "DA1"},;
		{"principioativo",  "NCM_CODREG","C", .T., "NCM"},;
		{"unidademedida",   "B1_UM", "C", .T., "SB1"},;
		{"fabricante",      "B1_FABRIC", "C", .T., "SB1"}, ;
		{"moeda",         "DA1_MOEDA", "C", .T., "DA1"} ;
		}

return aFields


method getJoins() as array class agdtabelaPrecoRepository
	local aJoins       := {} as array
	aJoins := {;
		{"INNER", "DA1", "DA0.DA0_CODTAB = DA1.DA1_CODTAB AND DA0.DA0_FILIAL = '"+ FWxFilial("DA1") + "'" } ,;
		{"INNER", "SB1", "SB1.B1_COD = DA1.DA1_CODPRO AND SB1.B1_FILIAL = '"+ FWxFilial("SB1") + "'" },;
		{"LEFT",  "SB5", "SB5.B5_COD = SB1.B1_COD AND SB5.B5_FILIAL = '"+ FWxFilial("SB5") + "'"},;
		{"LEFT",  "NCM", "NCM.NCM_PROD = SB1.B1_COD AND NCM.NCM_FILIAL = '"+ FWxFilial("NCM") + "'"} ;
		}
return aJoins
