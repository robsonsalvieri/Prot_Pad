#include 'totvs.ch'
#include 'tlpp-core.th'

namespace agd.historicoService 

using namespace agd.historicoRepository
using namespace agd.utilsService

/*/{Protheus.doc} agdHistoricoService
Serviço de historicos
@type class
@version 12
@author jc.maldonado
@since 20/05/2025
/*/
class agdHistoricoService from agdUtilsService
	public method new()
	public method listar()
	public method registrar()
endclass

/*/{Protheus.doc} agdHistoricoService::new
Construtor
@type method
@version 12
@author jc.maldonado
@since 20/05/2025
@return object, self
/*/
method new() class agdHistoricoService
	_Super:New()
return self

/*/{Protheus.doc} agdHistoricoService::listar
Listagem dos registros da tabela
@type method
@version 12
@author jc.maldonado
@since 20/05/2025
@param nPage, numeric, numero da pagina
@param nPageSize, numeric, tamanho da pagina
@param jQueryParam, json, query
/*/
method listar(nPage as numeric, nPageSize as numeric, jQueryParam as json) class agdHistoricoService
	local oHistoricoRepo as object
	
    default nPage       := 1
	default nPageSize   := 10
	default jQueryParam := nil

	oHistoricoRepo := agdHistoricoRepository():New()
	oHistoricoRepo:find(nPage, nPageSize, jQueryParam)

	::setFullResponse(oHistoricoRepo)

	FreeObj(oHistoricoRepo)
return

method registrar(cTabela as character, cChave as character, nOperation as integer, cCodUsuario as character, cMsgMemo as character) class agdHistoricoService
	local oHistoricoRepo as object

	default cMsgMemo    := ""
	default cCodUsuario := RetCodUsr()

	oHistoricoRepo := agdHistoricoRepository():New()
	oHistoricoRepo:save(cTabela, cChave, nOperation, cCodUsuario, cMsgMemo)

	::setFullResponse(oHistoricoRepo)

	FreeObj(oHistoricoRepo)
return
