#include "tlpp-core.th"

namespace totvs.protheus.backoffice.reconciliation.setuptaxes

//-------------------------------------------------------------------
/*/{Protheus.doc} SetupTaxesService
Classe de serviço, realizada instância e chamada de métodos de serviços

@author Totvs
/*/
//-------------------------------------------------------------------
class SetupTaxesService
    public method new()
    public method getInstance()
    public method getAllSetupTaxes()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} GetTaxesService
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new() class SetupTaxesService
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getInstance
Responsável por instanciar a classe service

@author Totvs
/*/
//-------------------------------------------------------------------
method getInstance() class SetupTaxesService
    static __instance As Object
    
    If ValType(__instance) == "U"
        __instance := SetupTaxesService():new()
    EndIf
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getAllSetupTaxes
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method getAllSetupTaxes(cTable as Character, nPage as Numeric) class SetupTaxesService
    Local oData      := SetupTaxesProtheusData():getData() as Object
    Local jResponse  := JsonObject():new() as Json

    oData:getAll(cTable, nPage)

    If oData:lOk
        jResponse := oData:getJSONResponse()
    EndIf

    oData:DeActivate()
    FreeObj(oData)

return jResponse
