#include "tlpp-core.th"

namespace totvs.protheus.backoffice.reconciliation.getaccountbalance

//-------------------------------------------------------------------
/*/{Protheus.doc} GetAccountBalanceService
Classe de serviço, realizada instância e chamada de métodos de serviços

@author Totvs
/*/
//-------------------------------------------------------------------
class GetAccountBalanceService
    public method new()
    public method getInstance()
    public method getAccountBalance()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} GetAccountBalanceService
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new() class GetAccountBalanceService
return

//-------------------------------------------------------------------
/*/{Protheus.doc} GetAccountBalanceService
Responsável por instanciar a classe controller

@author Totvs
/*/
//-------------------------------------------------------------------
method getInstance() class GetAccountBalanceService
    static __instance As Object

    If ValType(__instance) == "U"
        __instance := GetAccountBalanceService():new()
    EndIf
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getAccountBalance
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method getAccountBalance(nPage as Numeric, nPageSize as Numeric, cTabelaTemp as Character, cDataCQ1 as Character, cTpSald as Character) class GetAccountBalanceService
    Local oSettings := GetAccountBalanceProtheusData():getData() As Object
    Local jResponse := JsonObject():new() As Json

    oSettings:getAll(nPage, nPageSize,cTabelaTemp,cDataCQ1,cTpSald)
    IIf(oSettings:lOk,;
        jResponse := oSettings:getJSONResponse(),;
        jResponse := SetRestFault(oSettings:GetCode(), oSettings:getMessage()))

    oSettings:DeActivate()
    FreeObj(oSettings)
return jResponse


