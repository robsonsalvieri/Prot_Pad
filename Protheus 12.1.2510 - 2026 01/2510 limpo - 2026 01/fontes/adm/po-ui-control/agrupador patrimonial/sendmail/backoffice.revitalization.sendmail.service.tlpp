#include "tlpp-core.th"

namespace totvs.protheus.backoffice.revitalization.sendmail

//-------------------------------------------------------------------
/*/{Protheus.doc} SendMailService
Classe de serviço, realizada instância e chamada de métodos de serviços

@author Totvs
/*/
//-------------------------------------------------------------------
class SendMailService
    public method new()
    public method getInstance()
    public method getAllSendMail()
endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} SendMailService
Metodo construtor

@author Totvs
/*/
//-------------------------------------------------------------------
method new() class SendMailService
return

//-------------------------------------------------------------------
/*/{Protheus.doc} SendMailService
Responsável por instanciar a classe controller

@author Totvs
/*/
//-------------------------------------------------------------------
method getInstance() class SendMailService
    static __instance As Object

    If ValType(__instance) == "U"
        __instance := SendMailService():new()
    EndIf
return

//-------------------------------------------------------------------
/*/{Protheus.doc} getAllSendMail
Responsável por chamar a consulta e parsear o retorno no formato JSON

@author Totvs
/*/
//-------------------------------------------------------------------
method getAllSendMail(jBody as Json) class SendMailService
    Local oSettings := SendMailProtheusData():getData() As Object
    Local cReturn   := "" As Character

    cReturn := oSettings:getAll(jBody)

    oSettings:DeActivate()
    FreeObj(oSettings)
return cReturn
