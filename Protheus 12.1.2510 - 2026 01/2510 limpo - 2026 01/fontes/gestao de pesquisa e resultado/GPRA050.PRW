#INCLUDE "PROTHEUS.CH"
#INCLUDE "TCBROWSE.CH"
#INCLUDE "GPRA050.CH"
#INCLUDE "GPRDEF.CH"

/*


Ŀ
Funo    GPRA050    Autora  Solange Zanardi       Data  20/10/03 
Ĵ
Descrio  Cadastro de Grupos                                         
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.24/08/04710   -Notacao, Sintaxe e Logica                  
                                                                    
                                                                    
ٱ


*/

Function GPRA050(aRotAuto,nOpc)

//Ŀ
// Declaracao de Variaveis                                             
//
Private cCadastro := STR0001	   // "Cadastro de Grupos de Pesquisas"

Private aRotina   := MenuDef()

//Ŀ
// Definicao de variaveis para rotina de inclusao automatica    
//
Private l050Auto := ( aRotAuto <> NIL )

If (nOpc == NIL)
	nOpc := 3
Endif

//Ŀ
//Se for entrada automatica
//
DbSelectArea("SKE")
DbSetOrder(1)
If l050Auto
	MsRotAuto(nOpc,aRotAuto,"SKE")
Else
	mBrowse(6,1,22,75,"SKE")
Endif

Return(.T.)

/*/

Ŀ
Funo     MenuDef   Autor  Conrado Q. Gomes       Data  13.12.06 
Ĵ
Descrio  Definio do aRotina (Menu funcional)                      
Ĵ
Sintaxe    MenuDef()                                                  
Ĵ
Parametros                                                            
Ĵ
 Uso       SIGAGPR                                                    
ٱ


/*/
Static Function MenuDef()
	Local aRotina := { 	{STR0002 ,"AXPESQUI"	,0 ,1 ,0 ,.F.},;   //Pesquisar
						{STR0003 ,"GPRA050VIS"	,0 ,2 ,0 ,.T.},;   //Visualizar
						{STR0004 ,"GPRA050INC"	,0 ,3 ,0 ,.T.},;   //Incluir
						{STR0005 ,"GPRA050ALT"	,0 ,4 ,0 ,.T.},;   //Alterar
						{STR0006 ,"GPRA050EXC"	,0 ,5 ,0 ,.T.} }   //Excluir
Return(aRotina)

/*


Ŀ
Funo    GPRA050VIS Autora  Solange Zanardi       Data  20/10/03 
Ĵ
Descrio  Rotina de Visualizaao/Cadastro de Grupos                  
Ĵ
Sintaxe    GPRA050VIS(ExpC1,ExpN1,ExpN2)                              
Ĵ
Parametros ExpC1 = Alias do arquivo                                   
           ExpN1 = Numero do registro                                 
           ExpN2 = Opo selecionada                                  
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.24/08/04710   -Notacao, Sintaxe e Logica                  
                                                                    
                                                                    
ٱ


*/
Function Gpra050Vis(cAlias,nReg,nOpc)

Local nOpcao := 0			// Retorno da gravacao OK ou CANCELA

nOpcao := AxVisual(cAlias,nReg,nOpc,NIL,NIL,NIL,NIL,NIL,NIL,NIL)

DbSelectarea(cAlias)
Return(.T.)

/*


Ŀ
Funo    GPRA050INC Autora  Solange Zanardi       Data  20/10/03 
Ĵ
Descrio  Rotina de Inclusao /Cadastro de Grupos                     
Ĵ
Sintaxe    GPRA050INC(ExpC1,ExpN1,ExpN2)                              
Ĵ
Parametros ExpC1 = Alias do arquivo                                   
           ExpN1 = Numero do registro                                 
           ExpN2 = Opo selecionada                                  
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.24/08/04710   -Notacao, Sintaxe e Logica                  
                                                                    
                                                                    
ٱ


*/
Function Gpra050Inc(cAlias,nReg,nOpc)

Local nOpcao := 0			// Retorno da gravacao OK ou CANCELA

If ( Type("l050Auto") == "U" ) .OR. !l050Auto
	nOpcao := AxInclui(cAlias,nReg,nOpc,NIL,NIL,NIL,NIL,NIL,NIL,NIL)
Else
	nOpcao := AxIncluiAuto(cAlias,NIL,NIL,NIL,NIL)
Endif

DbSelectarea(cAlias)
Return(.T.)

/*


Ŀ
Funo    GPRA050ALT Autora  Solange Zanardi       Data  20/10/03 
Ĵ
Descrio  Rotina de Alteracao /Cadastro de Grupos                    
Ĵ
Sintaxe    GPRA050ALT(ExpC1,ExpN1,ExpN2)                              
Ĵ
Parametros ExpC1 = Alias do arquivo                                   
           ExpN1 = Numero do registro                                 
           ExpN2 = Opcao selecionada                                  
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.24/08/04710   -Notacao, Sintaxe e Logica                  
                                                                    
                                                                    
ٱ


*/
Function Gpra050Alt(cAlias,nReg,nOpc)

AxAltera(cAlias,nReg,nOpc,NIL,NIL,NIL,NIL,NIL,NIL,NIL,NIL)

DbSelectarea(cAlias)
Return(.T.)

/*


Ŀ
Funo    GPRA050EXC Autora  Solange Zanardi       Data  20/10/03 
Ĵ
Descrio  Rotina de Exclusao /Cadastro de Grupos                     
Ĵ
Sintaxe    GPRA050EXC(ExpC1,ExpN1,ExpN2)                              
Ĵ
Parametros ExpC1 = Alias do arquivo                                   
           ExpN1 = Numero do registro                                 
           ExpN2 = Opcao selecionada                                  
Ĵ
 Uso       SIGAGPR                                                    
Ĵ
Analista   Data/Bops/Ver Manutencao Efetuada                         
Ĵ
Marcelo K.24/08/04710   -Notacao, Sintaxe e Logica                  
                                                                    
                                                                    
ٱ


*/
Function Gpra050Exc(cAlias,nReg,nOpc)

AxDeleta(cAlias,nReg,nOpc,NIL,NIL,NIL,NIL,NIL,NIL,NIL,NIL)

Return(.T.)

