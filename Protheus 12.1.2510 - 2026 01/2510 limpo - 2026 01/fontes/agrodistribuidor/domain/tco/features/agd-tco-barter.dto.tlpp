#INCLUDE 'totvs.ch'
#INCLUDE 'tlpp-core.th'
#INCLUDE 'agd.tco.barter.dto.ch'
#INCLUDE 'agd.feature.tco.interface.ch'

/*/{Protheus.doc} agdTCOBarterDTO
Repositorio do TCO
@type class
@version 12
@author jean.schulze
@since 26/09/2025
/*/
class agdTCOBarterDTO implements FeatureTCO  
	public method new()
    Public Method getCodigo() as character
	Public Method getDescricao() as character
    Public Method getTipo() as character
	Public Method getRelease() as character
    Public Method getParametros() as array
    Public Method getCadastrosBasicos() as array    
    Public Method getCompartilhamentoTabela() as array
	Public Method getIdentificaoIntegracao() as character
	Public Method getTabelasDePara() as array 
    Public Method getDocumentacaoTDN() as character
	Public Method getAdapter() as array
	Public Method getCheckAtivacao() as array
    Public Method getCheckFinalizacao() as array
endClass

/*/{Protheus.doc} New
Constructor
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, retorno
/*/
method New() class agdTCOBarterDTO
return Self

/*/{Protheus.doc} getCodigo
Código da Feature
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getCodigo() as character Class agdTCOBarterDTO
return 'BARTER'

/*/{Protheus.doc} getDescricao
Descrição da Feature
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getDescricao() as character Class agdTCOBarterDTO
return STR0001

/*/{Protheus.doc} getTipo
Tipo Feature
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getTipo() as character Class agdTCOBarterDTO
return "1" //Negócio

/*/{Protheus.doc} getRelease
Release de Expedição
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getRelease() as character Class agdTCOBarterDTO
return "12.1.25"

/*/{Protheus.doc} getParametros
Lista de Parâmetros
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, {{cCodigoParam, xConteudoEsperado, arrJsonValoresPossiveis}, ...}
/*/
Method getParametros() as array Class agdTCOBarterDTO
	Local aParams := {}
		
	aadd(aParams, agdFeatUtils():buildParametros("MV_AGD0001", {;
				agdFeatUtils():buildOptions("1", STR0004),; // "Médio"
				agdFeatUtils():buildOptions("2", STR0005),; // "Unit FIFO"
				agdFeatUtils():buildOptions("3", STR0006),; // "Reposição"
				agdFeatUtils():buildOptions("4", STR0007)  })) // "Standard"

	aadd(aParams, agdFeatUtils():buildParametros("MV_AGD0002", {;
				agdFeatUtils():buildOptions("1", STR0008),; // "Nenhuma Ação" 
				agdFeatUtils():buildOptions("2", STR0009)  })) // "Força Lib. Crédito"
	
	// Acao de como proceder quando o Pedido de Venda estiver bloqueado
	aadd(aParams, agdFeatUtils():buildParametros("MV_AGDCTCC", {; 
				agdFeatUtils():buildOptions(".T.", STR0014),; // "Obrigatória"
				agdFeatUtils():buildOptions(".F.", STR0015)  })) // "Opcional"		

	aadd(aParams, agdFeatUtils():buildParametros("MV_AGD0003",  {;
				agdFeatUtils():buildOptions("1", STR0010),; // "Não Arredonda"
				agdFeatUtils():buildOptions("2", STR0011),; // "p/Cima"
				agdFeatUtils():buildOptions("3", STR0012),; // "p/Baixo"
				agdFeatUtils():buildOptions("4", STR0013)  })) // "Aritmético"	

	// Utiliza o Módulo SIGAAGR para Gestão de Contratos do Módulo SIGAAGD                                 
	aadd(aParams, agdFeatUtils():buildParametros("MV_AGDCTOG",{;                  
			agdFeatUtils():buildOptions(".T.", STR0016 ),; // "Sim"
			agdFeatUtils():buildOptions(".F.", STR0017 )}, "", .T., .F.)) // "Não"	

	// Determina os cadastros complementares que serão apresentados no cadastro de produto        
	aadd(aParams, agdFeatUtils():buildParametros("MV_CADPROD", {}, "AGRO", .T., .F.)) // "Complemento Produtos Agronegócio"
	
Return aParams

/*/{Protheus.doc} getCadastrosBasicos
Lista de Cadastros Básicos
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return array, {{cCodigoRotina, cTabelaBase}, ...}
/*/
Method getCadastrosBasicos() as array Class agdTCOBarterDTO
	Local arrayReturn := {}

	AAdd(arrayReturn, agdFeatUtils():buildCadastros("CRMA980",  "SA1" ))  // Clientes               
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA020",  "SA2" ))  // Fornecedores           
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA010",  "SB1" ))  // Produtos               
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA050",  "SA4" ))  // Transportadoras        
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA360",  "SE4" ))  // Condição de pagamento  
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("FINA010",  "SED" ))  // Naturezas              
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA090",  "SM2" ))  // Moedas                 
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("OMSA010",  "DA0" ))  // Tabela de preço                 
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("QIEA030",  "SAH" ))  // Unidade de Medidas      
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("ESTA0001", "D3Q" ))  // Conversao de Medidas      
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA080",  "SF4" ))  // Tes      
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA089",  "SFM" ))  // Tes Inteligente     
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA040",  "SA3" ))  // Vendedores       
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("MATA035",  "SBM" ))  // Grupo de Produtos    
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("OGA100" ,  "NJU" ))  // Safra   
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("OGA010",   "NJ0" ))  // Entidades    
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("AGDP040",  "NEG" ))  // Programa de Paridade
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("OMSA060",  "DA3" ))  // Veiculos      
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("AGRA800",  "NP3" ))  // Cultura     
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("CFGX019",  "SM4" ))  // Formulas   
	AAdd(arrayReturn, agdFeatUtils():buildCadastros("AGRA045",  "NNR" ))  // Local (Armazem)

Return arrayReturn

/*/{Protheus.doc} getCompartilhamentoTabela
Lista de Compartilhamento de tabelas
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, retorno
/*/
Method getCompartilhamentoTabela() Class agdTCOBarterDTO
	Local arrayReturn := {}
	Local cCompart:= FWModeAccess("NEA")

    AAdd(arrayReturn, {'NEA', cCompart}) //Negociação
	AAdd(arrayReturn, {'NEB', cCompart}) //Insumos da Negociacao         
	AAdd(arrayReturn, {'NEE', cCompart}) // Dados Contrato da Negociação
	AAdd(arrayReturn, {'NEF', cCompart}) // Negociação Contratos Compra
	AAdd(arrayReturn, {'NEG', cCompart}) // Programa de Paridade
	AAdd(arrayReturn, {'NEH', cCompart}) // Itens Programa de Paridade
	AAdd(arrayReturn, {'NEI', cCompart}) // Movimentos Contrato Compra
	AAdd(arrayReturn, {'NEJ', cCompart}) // Fechamento Financeiro Negociação
	AAdd(arrayReturn, {'NEK', cCompart}) // Itens Fechamento Financeiro
	AAdd(arrayReturn, {'NEL', cCompart}) // Venda Perdida da Negociação
	AAdd(arrayReturn, {'NEM', cCompart}) // Rateio de Entregas Negociação
	AAdd(arrayReturn, {'NEO', cCompart}) // Descarte de Embalagens
	AAdd(arrayReturn, {'NEP', cCompart}) // Propriedade Rural
	AAdd(arrayReturn, {'NEQ', cCompart}) // Pedido X Agrodistribuidor
	AAdd(arrayReturn, {'NEV', cCompart}) // Grupo Familiar
	AAdd(arrayReturn, {'NEX', cCompart}) // Clientes do Grupo Familiar
	AAdd(arrayReturn, {'NEN', cCompart}) // Impostos Retidos e Recolhidos

	AAdd(arrayReturn, {'NED', 'E'}) // Itens da Instrução de Embarque
	AAdd(arrayReturn, {'NEC', 'E'}) //Instrução de Embarque         
	

Return arrayReturn

/*/{Protheus.doc} getIdentificaoIntegracao
Retorna o Identificador para as configurações de Integração
@type method
@version 12
@author jean.schulze
@since 15/10/2025
@return character, retorno
/*/
Method getIdentificaoIntegracao() as character Class agdTCOBarterDTO
return ''

/*/{Protheus.doc} getTabelasDePara
Retorna a Lista de Tabelas e Campos disponiveis para realizar o de-para
@type method
@version 12
@author jean.schulze
@since 31/10/2025
@return array, lista de tabela e campo
/*/
Method getTabelasDePara() as array Class agdTCOBarterDTO
	Local arrayReturn := {} /*2 Posicoes: 1-Tabela, 2-Campo*/
return arrayReturn 

/*/{Protheus.doc} getDocumentacaoTDN
Retorna o link do TDN para a Feature
@type method
@version 12
@author jean.schulze
@since 15/10/2025
@return character, retorno
/*/
Method getDocumentacaoTDN() as character Class agdTCOBarterDTO
return ''

/*/{Protheus.doc} getAdapter
Lista de Adapters
@type method
@version 12
@author Gilson.Venturi
@since 10/10/2025
@return variant, retorno
/*/
Method getAdapter() Class agdTCOBarterDTO
	Local arrayReturn := {}
Return arrayReturn

/*/{Protheus.doc} getCheckAtivacao
Checagem de Ativação da Feature - Uso na seleção do WIZARD
@type method
@version 12
@author jean.schulze
@since 12/19/2025
@return variant, Array com os Erros/Impedimentos da Feature
/*/
Method getCheckAtivacao() Class agdTCOBarterDTO
	Local aErros  := {}

	/*Verifica se tem os campos virtuais*/
	aField := FWSX3Util():GetFieldStruct( "E1_AGDSTS" ) 
	if Len(aField) == 0 
		aadd(aErros, agdFeatUtils():setError(STR0025, "FIELD"))
	elseif AllTrim(GetSX3Cache("E1_AGDSTS", "X3_INIBRW")) != "AGDI060SE1()"
		aadd(aErros, agdFeatUtils():setError(STR0026, "FIELD"))
	endif

	aField := FWSX3Util():GetFieldStruct( "E2_AGDSTS" ) 
	if Len(aField) == 0
		aadd(aErros, agdFeatUtils():setError(STR0027, "FIELD"))
	elseif AllTrim(GetSX3Cache("E2_AGDSTS", "X3_INIBRW")) != "AGDI060SE2()"
		aadd(aErros, agdFeatUtils():setError(STR0028, "FIELD"))
	endif


Return aErros

/*/{Protheus.doc} getCheckFinalizacao
Checagem de Finalização da Feature - Uso no finalizar da Configuração
@type method
@version 12
@author jean.schulze
@since 12/19/2025
@return variant, 5
@return variant, Array com os Erros/Impedimentos da Feature
/*/
Method getCheckFinalizacao() Class agdTCOBarterDTO
Return {}



