#INCLUDE 'totvs.ch'
#INCLUDE 'tlpp-core.th'
#INCLUDE 'agd.feature.tco.interface.ch'
#INCLUDE 'agd.tco.originacao.protheus.dto.ch'

using namespace agd.tcoRepository

/*/{Protheus.doc} agdTCOOriginacaoProtheusDTO
Repositorio do TCO
@type class
@version 12
@author jean.schulze
@since 26/09/2025
/*/
class agdTCOOriginacaoProtheusDTO implements FeatureTCO
	public method new()
	Public Method getCodigo() as character
	Public Method getDescricao() as character
	Public Method getTipo() as character
	Public Method getRelease() as character
	Public Method getParametros() as array
	Public Method getCadastrosBasicos() as array
	Public Method getCompartilhamentoTabela() as array
	Public Method getIdentificaoIntegracao() as character
	Public Method getTabelasDePara() as array 
    Public Method getDocumentacaoTDN() as character
	Public Method getAdapter() as array
	Public Method getCheckAtivacao() as array
    Public Method getCheckFinalizacao() as array
endClass

/*/{Protheus.doc} New
Constructor
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, retorno
/*/
method New() class agdTCOOriginacaoProtheusDTO
return Self

/*/{Protheus.doc} getCodigo
Código da Feature
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getCodigo() as character Class agdTCOOriginacaoProtheusDTO
return "ORIGINACAO_PROTHEUS"

/*/{Protheus.doc} getDescricao
Descrição da Feature
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getDescricao() as character Class agdTCOOriginacaoProtheusDTO
return STR0001


/*/{Protheus.doc} getTipo
Tipo Feature
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getTipo() as character Class agdTCOOriginacaoProtheusDTO
return "1" //Negocio

/*/{Protheus.doc} getRelease
Release de Expedição
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return character, retorno
/*/
Method getRelease() as character Class agdTCOOriginacaoProtheusDTO
return "12.1.25"

/*/{Protheus.doc} getParametros
Lista de Parâmetros
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, retorno
/*/
Method getParametros() Class agdTCOOriginacaoProtheusDTO
	Local arrayReturn := {}
	
	aadd(arrayReturn, agdFeatUtils():buildParametros("MV_SIGAAGR", {;
		agdFeatUtils():buildOptions(".T.", STR0010),; // "Sim"
		agdFeatUtils():buildOptions(".F.", STR0011) ; // "Não"
	}, ".T.", .T.))

	aadd(arrayReturn, agdFeatUtils():buildParametros("MV_AGRORI", {;
		agdFeatUtils():buildOptions(".T.", STR0010),; // "Sim"
		agdFeatUtils():buildOptions(".F.", STR0011) ; // "Não"
	}, ".T.", .T.))

	aadd(arrayReturn, agdFeatUtils():buildParametros("MV_AGD0003", {;
		agdFeatUtils():buildOptions("1", STR0004),; // "Não Arredonda"
		agdFeatUtils():buildOptions("2", STR0005),; // "p/Cima"
		agdFeatUtils():buildOptions("3", STR0006),; // "p/Baixo"
		agdFeatUtils():buildOptions("4", STR0007) }))// "Aritmético"

	aadd(arrayReturn, agdFeatUtils():buildParametros("MV_AGDCTCC", {;
		agdFeatUtils():buildOptions(".T.", STR0008),; // "Obrigatória"
		agdFeatUtils():buildOptions(".F.", STR0009) })) // "Opcional"

	aadd(arrayReturn, agdFeatUtils():buildParametros("MV_AGDCTOG", {;
		agdFeatUtils():buildOptions(".T.", STR0010),; // "Sim"
		agdFeatUtils():buildOptions(".F.", STR0011) })) // "Não"

Return arrayReturn

/*/{Protheus.doc} getCadastrosBasicos
Lista de Cadastros Básicos
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, retorno
/*/
Method getCadastrosBasicos() Class agdTCOOriginacaoProtheusDTO
	Local arrayReturn := {}

	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("CRMA980",  "SA1" ))  // Clientes
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("MATA010",  "SB1" ))  // Produtos
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("MATA360",  "SE4" ))  // Condição de pagamento
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("FINA010",  "SED" ))  // Naturezas
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("OMSA010",  "DA0" ))  // Tabela de preço
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("QIEA030",  "SAH" ))  // Unidade de Medidas
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("ESTA0001", "D3Q" ))  // Conversao de Medidas
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("MATA080",  "SF4" ))  // Tes
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("MATA089",  "SFM" ))  // Tes Inteligente
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("OGA100" ,  "NJU" ))  // Safra
	AAdd(arrayReturn,  agdFeatUtils():buildCadastros("OGA010",   "NJ0" ))  // Entidades

Return arrayReturn

/*/{Protheus.doc} getCompartilhamentoTabela
Lista de Compartilhamento de tabelas
@type method
@version 12
@author jean.schulze
@since 26/09/2025
@return variant, retorno
/*/
Method getCompartilhamentoTabela() Class agdTCOOriginacaoProtheusDTO
	Local arrayReturn := {}
	Local cCompart:= FWModeAccess("NEA")

	AAdd(arrayReturn, {'NEA', cCompart}) // Negociação
	AAdd(arrayReturn, {'NEE', cCompart}) // Dados Contrato da Negociação
	AAdd(arrayReturn, {'NEF', cCompart}) // Negociação Contratos Compra
	AAdd(arrayReturn, {'NEI', cCompart}) // Movimentos Contrato Compra
	AAdd(arrayReturn, {'NEL', cCompart}) // Venda Perdida da Negociação

Return arrayReturn

/*/{Protheus.doc} getIdentificaoIntegracao
Retorna o Identificador para as configurações de Integração
@type method
@version 12
@author Gilson.Venturi
@since 15/10/2025
@return character, retorno
/*/
Method getIdentificaoIntegracao() as character Class agdTCOOriginacaoProtheusDTO
return "AGD-OGPROTHEUS" //15 caracteres no maximo

/*/{Protheus.doc} getTabelasDePara
Retorna a Lista de Tabelas e Campos disponiveis para realizar o de-para
@type method
@version 12
@author jean.schulze
@since 31/10/2025
@return array, lista de tabela e campo
/*/
Method getTabelasDePara() as array Class agdTCOOriginacaoProtheusDTO
	Local arrayReturn := {} /*2 Posicoes: 1-Tabela, 2-Campo*/
return arrayReturn 

/*/{Protheus.doc} getDocumentacaoTDN
Retorna o link do TDN para a Feature
@type method
@version 12
@author Gilson.Venturi
@since 15/10/2025
@return character, retorno
/*/
Method getDocumentacaoTDN() as character Class agdTCOOriginacaoProtheusDTO
return ''

/*/{Protheus.doc} getAdapter
Lista de Adapters
@type method
@version 12
@author Gilson.Venturi
@since 10/10/2025
@return variant, retorno
/*/
Method getAdapter() Class agdTCOOriginacaoProtheusDTO
	Local arrayReturn := {}

Return arrayReturn

/*/{Protheus.doc} getCheckAtivacao
Checagem de Ativação da Feature - Uso na seleção do WIZARD
@type method
@version 12
@author jean.schulze
@since 12/19/2025
@return variant, Array com os Erros/Impedimentos da Feature
/*/
Method getCheckAtivacao() Class agdTCOOriginacaoProtheusDTO
Return {}

/*/{Protheus.doc} getCheckFinalizacao
Checagem de Finalização da Feature - Uso no finalizar da Configuração
@type method
@version 12
@author jean.schulze
@since 12/19/2025
@return variant, 5
@return variant, Array com os Erros/Impedimentos da Feature
/*/
Method getCheckFinalizacao() Class agdTCOOriginacaoProtheusDTO
	Local aErros := {}
	Local oTcoRepo := nil
	
	//Verifica se o barter está ativo
	oTcoRepo := agdTCORepository():new()
	if !oTcoRepo:isFeatureActive("BARTER")
		aadd(aErros, agdFeatUtils():setError(STR0012, "MODULO"))
	endif

	FreeObj(oTcoRepo)
Return aErros
