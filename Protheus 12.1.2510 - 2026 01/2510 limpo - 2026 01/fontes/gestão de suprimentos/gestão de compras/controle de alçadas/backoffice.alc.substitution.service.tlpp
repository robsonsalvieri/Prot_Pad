#include "tlpp-core.th"
// #include 'BACKOFFICE.PGC.SUPPLIER.SERVICE.CH'

namespace alc.substitutionService
using namespace alc.substitutionRepository

/*/{Protheus.doc} alcSubstitutionService
	Classe service para a API de substituição dos aprovadores.
@author juan.felipe
@since 07/06/2024
/*/
CLASS alcSubstitutionService
    public Data oJsonResponse As Object
    public Data lOk   As Logical
    public Data nCode As Numeric
    public Data cMessage As Character

    public Method New()
    public Method getValidateApprover()
    public Method putPermanentSubstitution()
    public Method postTemporaryAbsent()
    public Method putTimelyTransfer()
EndClass

/*/{Protheus.doc} New
	Método construtor
@author juan.felipe
@since 07/06/2024
/*/
Method New() CLASS alcSubstitutionService
    Self:oJsonResponse := JsonObject():new()
    Self:lOk := .F.
    Self:nCode := 0
    Self:cMessage := ''
Return Nil

/*/{Protheus.doc} getValidateApprover
	Valida se o aprovador é superior.
@author juan.felipe
@since 07/06/2024
@param cOriginalApprover, character, código aprovador original.
@param cNewApprover, character, código aprovador substituto.
@param lPermanent, logical, indica se é transferência permanente.
@return oJsonResponse, object, resposta no formato json.
/*/
Method getValidateApprover(cOriginalApprover, cNewApprover, lPermanent, lTimely) Class alcSubstitutionService
    Local oSupplierRepository As Object
    Default cOriginalApprover := ''
    Default cNewApprover := ''
    Default lPermanent := .F.
    Default lTimely := .F.

    oSupplierRepository := alcSubstitutionRepository():New('PUT')

    Self:oJsonResponse := oSupplierRepository:getValidateApprover(cOriginalApprover, cNewApprover, lPermanent, lTimely)
    Self:lOk := oSupplierRepository:lOk

    FreeObj(oSupplierRepository)
Return Self:oJsonResponse 

/*/{Protheus.doc} putPermanentSubstitution
	Realiza transferência permanente do aprovador.
@author juan.felipe
@since 07/06/2024
@param oJsonRequest, object, json da requisição.
@return oJsonResponse, object, resposta no formato json.
/*/
Method putPermanentSubstitution(oJsonRequest) Class alcSubstitutionService
    Local oSupplierRepository As Object
	Default oJsonRequest := JsonObject():New()

    oSupplierRepository := alcSubstitutionRepository():New('PUT')

    Self:oJsonResponse := oSupplierRepository:putPermanentSubstitution(oJsonRequest)
    Self:lOk := oSupplierRepository:lOk

    FreeObj(oSupplierRepository)
Return Self:oJsonResponse 

/*/{Protheus.doc} postTemporaryAbsent
	Realiza transferência temporária do aprovador.
@author juan.felipe
@since 13/06/2024
@param oJsonRequest, object, json da requisição.
@return oJsonResponse, object, resposta no formato json.
/*/
Method postTemporaryAbsent(oJsonRequest) Class alcSubstitutionService
    Local oSupplierRepository As Object
	Default oJsonRequest := JsonObject():New()

    oSupplierRepository := alcSubstitutionRepository():New('POST')

    Self:oJsonResponse := oSupplierRepository:postTemporaryAbsent(oJsonRequest)
    Self:lOk := oSupplierRepository:lOk

    FreeObj(oSupplierRepository)
Return Self:oJsonResponse 

/*/{Protheus.doc} postTimelyTransfer
	Realiza transferência pontual dos documentos.
@author juan.felipe
@since 19/07/2024
@param oJsonRequest, object, json da requisição.
@return oJsonResponse, object, resposta no formato json.
/*/
Method putTimelyTransfer(oJsonRequest) Class alcSubstitutionService
    Local oSupplierRepository As Object
	Default oJsonRequest := JsonObject():New()

    oSupplierRepository := alcSubstitutionRepository():New('PUT')

    Self:oJsonResponse := oSupplierRepository:putTimelyTransfer(oJsonRequest)
    Self:lOk := oSupplierRepository:lOk

    FreeObj(oSupplierRepository)
Return Self:oJsonResponse 
