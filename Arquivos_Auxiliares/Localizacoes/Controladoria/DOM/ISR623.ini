?{"Nombre del Archivo INI","ISR623.INI"}
?{"Descripción Completa del Archivo Magnético","Direccion General de Impuestos Internos - Formato 623 - DGII2008"}
?{"A Quien si Destina","Los Agentes de Retención estan obligados a cumplir las obligaciones de la resolución."}
?{"Objetivo","Definir las características y contenido para el reporte de Envio de Retenciones del Estado."}
?{"Plazo de Entrega","Mensual"}
?{"Aplicativo Disponibilizado por DGII","DGII 2008 - Versión 1.3"}
?{"Versión del Aplicativo Contemplada pela Microsiga","1.0"}
?{"Legislación", "Norma General No. 01-07 2008"}
?{"Buscar en", "www.dgii.gov.do"}
?{"Atención", "La rutina va a generar el archivo con el siguiente nombre: Nombre del archivo + RNC de la sucursal (registrados en el campo M0_CGC)"}


[XXX Inicializacao]  
(PRE) _aTotal[001] := {CTOD("  /  /  "),CTOD("  /  /  ")}
(PRE) _aTotal[002] := "00000007"
(PRE) _aTotal[003] := "R"
//Contador de Registro 
(PRE) _aTotal[004] := 0
//Totalizador de Valores
(PRE) _aTotal[005] := 0 
//Painel de perguntas
(PRE) _aTotal[006] := {} 
(PRE) _aTotal[007] := {}
(PRE) _aTotal[008] := {}
(PRE) _aTotal[009] := {"INV",""}
(PRE) _aTotal[010] := ""
(PRE) _aTotal[011] := CtoD("")
(PRE) _aTotal[012] := ""
(PRE) _aTotal[013] := ""


[XXX Painel Principal]
(PRE) aAdd (_aTotal[006], "Procesamiento del Formato 623  –  Todas las retenciones generadas en el território nacional.")
(PRE) aAdd (_aTotal[006], "")
(PRE) aAdd (_aTotal[006], "Llenar correctamiente los datos solicitados.")
(PRE) aAdd (_aTotal[006], "Informaciones necesárias para el recargo automático del Formato 623  –  Todas las retenciones generadas en el território nacional.")  

[XXX Montagem do Wizard ]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][1], "Procesamiento del Informe.")
(PRE) aAdd (_aTotal[007][1], "INFORMACIÓN DE LA CLAUSURA ")
(PRE) aAdd (_aTotal[007][1], {})                            
(PRE) aAdd (_aTotal[007][1][3], {1,"Fecha de Cierre:",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,,3,,,,})

[XXX - Chamada Wizard]
(PRE) _aTotal[010] := IIF(lFirst,xMagWizard(_aTotal[006],_aTotal[007], "ISR623"),.F.)
(PRE) Iif( _atotal[010] == .T. ,xMagLeWiz("ISR623",@_aTotal[008], .T.), _aTotal[008] := {} )
(PRE) Iif(!Empty(_aTotal[008]),Iif(Empty(_aTotal[008][1][1]), Help(" ",1,"NODTFECH",,"Campo obligatorio: Fecha de Cierre ",4) , _aTotal[011]:= StoD(_aTotal[008][1][1]) ),Nil )   
(PRE) lAbtMT950 := IIf(lFirst,!_atotal[010] .Or. Empty(_aTotal[011]) ,.F.)

[XXX ABERTURA DA TABELA ]
(PRE) Processa({|| _aTotal[012] := CTDom623(_aTotal[002],_aTotal[003],lFirst,@_aTotal[011]) })
(PRE) Iif(Empty(_aTotal[012]),Help(" ",1,"NOARQ",,"No hay datos para la gama",4),Nil)
(PRE) lAbtMT950 := Empty(_aTotal[012]) 
(PRE) cArqDest := cNomArq

	
[ISR623 Artículos]       
(PRE) DbSelectArea("ISR623")
(PRE) ISR623->(dbGoTop())   
(PRE) ISR623->(dbSeek(cNomArq))                  
(PREREG) Alltrim(ISR623->NOMARQ) == Alltrim(cNomArq)
RNCENTIDAD C 009 0 ISR623->RNCENTIDAD
PERIODO    C 006 0 ISR623->PERIODRET
DT_RET     C 008 0 DtoS(ISR623->DATARET)
VALOR      C 019 0 PADL(Alltrim(TRANSFORM(ISR623->VALOR, "@R 9999999999999999.99")),19,"0")
NUMREF     C 019 0 PADL(Alltrim(ISR623->NUMREF),19,"0")
TIPOREF    C 019 0 PADL(Alltrim(ISR623->TIPREF),19)
BANCO      C 040 0 PADL(Alltrim(ISR623->NOM_BANCO),40)
(CONT) _aTotal[004]++
(CONT) _aTotal[005] += ISR623->VALOR

[XXX Cabecera]
(ORD) TOP
(PRE) SM0->(dbSetOrder(1))
(PRE) SM0->(dbSeek( cEmpAnt + cFilAnt ))
(PREREG) Alltrim(SM0->M0_CODIGO) == Alltrim(cEmpAnt) .And. Alltrim(SM0->M0_CODFIL) == Alltrim(cFilAnt)
IDENT      C 003 0 "623"
RNCAGENTE  C 011 0 SM0->M0_CGC
PERIODO    C 004 0 cValToChar(Year(_aTotal[011]))
DT_FECH    C 004 0 cValToChar(Day(_aTotal[011])) + cValToChar(Month(_aTotal[011]))
QTDREG     N 012 0 _aTotal[004]
VLRTOT     C 016 0 PADL(Alltrim(TRANSFORM(_aTotal[005], "@R 9999999999999999.99")),16,"0")
(POS) SFE->(DbCloseArea())

