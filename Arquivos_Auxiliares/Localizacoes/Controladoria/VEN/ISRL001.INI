?{"Nombre del Archivo INI","ISRL001.INI"}
?{"Descripción Completa del Archivo Magnético","Providencia Administrativa Nº.0299 - Publicada por la Gaceta Ofical Bolivarina de Venezuela Nº. 39.079 del 12/12/2008"}
?{"A Quien si Destina","Los Agentes de Retención estan obligados a cumplir las obligaciones de la resolución."}
?{"Objetivo","Definir las características y contenido para la Relacion Informativa de Retencion de ISRL."}
?{"Plazo de Entrega","Mensual"}
?{"Aplicativo Disponibilizado por SENIAT","SENIAT - Versão 1.0"}
?{"Versión del Aplicativo Contemplada pela Microsiga","1.0"}
?{"Legislación", "Providencia Administrativa nº 0299/2008."}
?{"Buscar en", "www.seniat.gov.ve"}

@XML

[XXX - Inicializacao]
(PRE) _aTotal[001] := {}
(PRE) _aTotal[002] := {}
(PRE) _aTotal[003] := .F.
(PRE) _aTotal[004] := {}
(PRE) _aTotal[10]  := ""
//Pegar Data Inicial e Final        
(PRE) _aTotal[11] := "20"+Subs(DTOS(mv_par01),3,2)+"-"+Subs(DTOS(mv_par01),5,2)+"-"+Subs(DTOS(mv_par01),7,2)            
(PRE) _aTotal[12] := "20"+Subs(DTOS(mv_par02),3,2)+"-"+Subs(DTOS(mv_par02),5,2)+"-"+Subs(DTOS(mv_par02),7,2) 
//Totalizadores: Valor Total e Quantidade de Registros Processados
(PRE) _aTotal[13]  := 0
(PRE) _aTotal[14]  := 0
(PRE) _aTotal[15]  := mv_par01 
(PRE) _aTotal[16]  := mv_par02      
     
                  
[XXX - Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd (_aTotal[001], "Procesamiento del Informe - Relacion Informativa de Retencion de ISRL")
(PRE) aAdd (_aTotal[001], "")
(PRE) aAdd (_aTotal[001], "Llenar correctamiente los datos solicitados.")
(PRE) aAdd (_aTotal[001], "Informaciones necesárias para el recargo automático de Retenções          Declaración Mensual.")


[XXX - Montagem do CFP Utilizado pela rotina - TELA 02]
(PRE) aAdd (_aTotal[002], {})
(PRE) aAdd (_aTotal[002][1], "Procesamiento del Informe.")
(PRE) aAdd (_aTotal[002][1], "Relacion Informativa de Retencion de ISRL")
(PRE) aAdd (_aTotal[002][1], {})
(PRE) aAdd (_aTotal[002][1][3], {1, "Año de Envío",,,,,,})                     
(PRE) aAdd (_aTotal[002][1][3], {2,,StrZero(Year(dDataBase),4),1,,,,04})
(PRE) aAdd (_aTotal[002][1][3], {0, "",,,,,,})   
(PRE) aAdd (_aTotal[002][1][3], {0, "",,,,,,}) 
(PRE) aAdd (_aTotal[002][1][3], {1, "Mes de Envío",,,,,,})                            
(PRE) aAdd (_aTotal[002][1][3], {2,,StrZero(Month(dDataBase),2),1,,,,02})
(PRE) aAdd (_aTotal[002][1][3], {0, "",,,,,,})   
(PRE) aAdd (_aTotal[002][1][3], {0, "",,,,,,})

[XXX - Llamada del Wizard]
(PRE) _atotal[003] := xMagWizard( _aTotal[001] , _aTotal[002] , "Relacion Informativa de Retencion de ISRL" )
(PRE) Iif (_atotal[003], xMagLeWiz ("Relacion Informativa de Retencion de ISRL", @_aTotal[004], .T.), Nil)
(PRE) lAbtMT950	:= !_atotal[003]  


[XXX - Armando archivo Transitório]
(PRE) CtGeraIRSL(_aTotal[15],_aTotal[16],_aTotal[002][1][3])
                       

[XXX - Cabecera del XML] 
(PRE) _aTotal[10]:= 'version="1.0" encoding="utf-8" ?'   
(PRE) ISRL->(dbGoTop()) 
Linha1     C 000 0 MontaXML("?xml "               ,                         ,   ,  , , ,  , .T., .F., .T., _aTotal[10], .F.,.F.)
Linha2     C 000 0 MontaXML('RelacionRetencionesISLR RifAgente="' + ALLTRIM(ISRL->RIFAGENTE) + '" Periodo="' + ISRL->EMISSAO + '"', , , , , , , .T., .F., .T., , .F.,.F.)  

[ISRL - Lectura de datos del archivo]
(PRE) ISRL->(dbGoTop())			                         
(PREREG) ISRL->(!EOF())
Linha3     C 000 0 MontaXML("DetalleRetencion"    ,                         ,   ,  , , , 3, .T., .F., .T., , .F., .F.) 
RIFSUJEITO C 000 0 MontaXML("RifRetenido"         , ISRL->RIFSUJEITO        ,   ,  , , , 4, .T., .T., .T., , .F., .F.)
NUMFATURA  C 000 0 MontaXML("NumeroFactura"       , ISRL->NUMFATURA         ,   ,  , , , 4, .T., .T., .T., , .F., .F.)             
ORDEMPAGO  C 000 0 MontaXML("NumeroControl"       , ISRL->ORDEMPAGO         ,   ,  , , , 4, .T., .T., .T., , .F., .F.)
CONCEITO   C 000 0 MontaXML("CodigoConcepto"      , ISRL->CONCEITO          ,   ,  , , , 4, .T., .T., .T., , .F., .F.)
VALORBASE  C 000 0 MontaXML("MontoOperacion"      , ALLTRIM(ISRL->VALORBASE),   ,  , , , 4, .T., .T., .T., , .F., .F.)
PERCENT    C 000 0 MontaXML("PorcentajeRetencion" , ALLTRIM(ISRL->PERCENT)  ,   ,  , , , 4, .T., .T., .T., , .F., .F.)
Linha4     C 000 0 MontaXML("DetalleRetencion"    ,                         ,   ,  , , , 3, .F., .T., .T., , .F., .F.) 

[XXX - Ultima TAG do XML]                                                 
TAGXML     C 000 0 MontaXML("RelacionRetencionesISLR",                      ,   ,  , , ,  , .F., .T., .T. )			

[XXX - Fin del XML]
(PRE) _aTotal[95] := mv_par04
(PRE) cArqDest    := _aTotal[95]
