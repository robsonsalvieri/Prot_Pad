?{"Nombre del archivo INI","EQU104IV.INI"}
?{"Descricao completa do arquivo magnetico","Apuracao dos Impostos IVA"}

[XXX Inicializacao]
(PRE) _aTotal[01] := MV_PAR02
(PRE) _aTotal[02] := MV_PAR03
(PRE) _aTotal[03] := {}
(PRE) _aTotal[04] := {}
(PRE) _aTotal[05] := .F.
(PRE) _aTotal[06] := {}
(PRE) _aTotal[99] := "XMLIVA"
[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd(_aTotal[03],"Formulário 104 - Declaração Imposto Valor Agregado - IVA")
(PRE) aAdd(_aTotal[03],"")
(PRE) aAdd(_aTotal[03],"Preencha corretamente as informações solicitadas.")
(PRE) aAdd(_aTotal[03],"Informações necessárias para preenchimento automático do Formulário 104. DeclaraçãoImposto Valor Agregado - IVA.")
[XXX Painel  - Configuracoes Gerais]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][1],"Apuração de IVA")
(PRE) aAdd(_aTotal[04][1],"Configurações gerais:")
(PRE) aAdd(_aTotal[04][1],{})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Tipo Declaração",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Se Substitutiva:",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"O-Original","S-Substitutiva"},,}) 
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Versão Formulário",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Núm.Formulário",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"@!",1,,,,3,,,})   
(PRE) aAdd(_aTotal[04][1][3],{2,,"@!",1,,,,12,,,})   
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Cód.Versão Form.",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Imposto Pago",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"@!",1,,,,8,,,})   
(PRE) aAdd(_aTotal[04][1][3],{2,,"@E 999,999,999.99",2,2,,,14})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"ID Representante legal",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Mora/Interesses",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"@!",1,,,,13,,,})   
(PRE) aAdd(_aTotal[04][1][3],{2,,"@E 999,999,999.99",2,2,,,14})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Ruc Contador",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Multa/Juros",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"@!",1,,,,13,,,})   
(PRE) aAdd(_aTotal[04][1][3],{2,,"@E 999,999,999.99",2,2,,,14})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
[XXX Chamada do Wizard]
(PRE) _aTotal[05]:= xMagWizard(_aTotal[03],_aTotal[04],"EQU104IV")
(PRE) Iif(_aTotal[05],xMagLeWiz("EQU104IV",@_aTotal[06],.T.),Nil)
(PRE) lAbtMT950	:=!_aTotal[05]
[XXX XMLIVA - Apuração de IVA]
(PRE) _aTotal[99] := FQImposto(_aTotal[06])
(POS)
[TRBXML - Apuração de IVA]       
(PRE) TRBXML->(dbGotop())
(ARQ) _aTotal[99]
(POS) 
LINXML     C 000 0 Alltrim(TRBXML->LINXML)+ Chr(13) + Chr(10)