?{"Nombre del archivo INI","SICOL.INI"}
?{"Descripcion Completa del Archivo Magnetico","Generacion de Percepciones y/o Retenciones."}
?{"Comentarios","Disponible para la provincia CABA."}  

[XXX Montaje del CFP que utiliza la rutina - PRINCIPAL]
(PRE) _aTotal[04] := {}      
(PRE) _aTotal[05] := {}      
(PRE) _aTotal[06] := .F.      
(PRE) _aTotal[07] := {}                        
(PRE) _aTotal[08]:={{{}},{},{}}

(PRE) _aTotal[20] := Chr(9)
(PRE) aAdd (_aTotal[04],"Percepciones y Retenciones")
(PRE) aAdd (_aTotal[04],"")
(PRE) aAdd (_aTotal[04],"Completar la informacion")
(PRE) aAdd (_aTotal[04],"Complete con la informacion necesaria para la generacion de los archivos para la provincia CABA.")

[XXX Panel 1 - Configuraciones generales]
(PRE) aAdd(_aTotal[05],{})
(PRE) aAdd(_aTotal[05][1],"Percepciones y Retenciones")
(PRE) aAdd(_aTotal[05][1],"Configuracion necesaria:")
(PRE) aAdd(_aTotal[05][1],{})
(PRE) aAdd(_aTotal[05][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[05][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[05][1][3],{1,"Provincia:",,,,,,})
(PRE) aAdd(_aTotal[05][1][3],{2,,"XX",1,,,,2,,,"12"})

(PRE) aAdd(_aTotal[05][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[05][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[05][1][3],{1, "Tipo del archivo: ",,,,,,})
(PRE) aAdd(_aTotal[05][1][3],{3,,,,,{"1-Retencion","2-Percepcion"},,})

[XXX Llamada Wizard]
(PRE) _aTotal[06] := xMagWizard(_aTotal[04],_aTotal[05],"SICOL")
(PRE) Iif(_aTotal[06],xMagLeWiz("SICOL",@_aTotal[07],.T.),Nil)
(PRE) lAbtMT950	:= !_aTotal[06]

[XXX Movimientos]                                                
(PRE) _aTotal[07][1][2] := SubStr(_aTotal[07][1][2],1,1)
(PRE) _aTotal[07][1][1] := Alltrim(_aTotal[07][1][1])
(PRE) _aTotal[01] := {{"","PER"},{"","RET"}}

[XXX Generacion del archivo SICOL]
(PRE) _aTotal[10]:=FISA809()

[TRBp Imprime los datos]
(PRE) TRBp->(dbGoTop())
SEQ01      C 011 0 TRBp->CGC
SEQ02      C 008 0 TRBp->NFISCAL
SEQ03      C 008 0 TRBp->EMISSAO
SEQ04      C 004 0 TRBp->FILIAL
SEQ05      C 016 2 PadL(AllTrim(Transform(TRBp->BASIMP,"@E 9999999999999.99")),16," ")
SEQ06      C 016 2 PadL(AllTrim(Transform(TRBp->VALIMP,"@E 9999999999999.99")),16," ")
SEQ07      C 001 0 TRBp->COMPROB
SEQ08      C 016 0 TRBp->SERIE

(POS)       
   
[TRBr Imprime os dados]
(PRE) TRBr->(dbGoTop())
SEQ01      C 011 0 TRBr->CGC
SEQ02      C 008 0 TRBr->EMISSAO
SEQ03      C 008 0 TRBr->NROCERT
SEQ04      C 016 2 PadL(AllTrim(Transform(TRBr->VALBASE,"@E 9999999999999.99")),16," ")
SEQ04      C 016 2 PadL(AllTrim(Transform(TRBr->RETENC,"@E 9999999999999.99")),16," ")

(POS)

[XXX arquivos temporarios]
(PRE) DelSICOL(_aTotal[10])