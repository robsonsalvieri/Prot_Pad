?{"Nome do Arquivo INI","GIAMTO.INI"}
?{"Descricao Completa do Arquivo Magnetico","Guia de Informacao e Apuracao do ICMS Mensal - TO"}
?{"A Quem se Destina","A apuracao do ICMS das empresas, tendo como base a escrita fiscal do contribuinte, abrangendo os valores relativos a todas as Entradas e Saidas, discriminados por Unidade da Federacao. Destina-se, ainda, a apuracao da Movimentacao Comercial entre as Unidades da Federacao, para Orientacao da Politica Tributaria Estadual"}
?{"Objetivo","E utilizado pela SEFAZ para medir o valor adicionado em cada municipio do Estado, nas operacoes relativas a circulacao de mercadorias, com base no qual e determinado o indice percentual da participacao dos municipios no produto da arrecadacao do ICMS."}
?{"Prazo de Entrega","Mensal, 15 (quinze) do mes subsequente ao periodo de referencia declarado."}
?{"Aplicativo Disponibilizado pelo Fisco","GIAM 10.0"}
?{"Versao do Aplicativo Contemplada pela Microsiga","Versao 10.0"}
?{"Comentarios",""}

[XXX Inicializacao]
(PRE) _aTotal[01] := 0
(PRE) _aTotal[02] := mv_par01
(PRE) _aTotal[03] := mv_par02
(PRE) _aTotal[04] := GIAMTO(_aTotal[02],_aTotal[03])
(PRE) _aTotal[05] := .F.

[RTA - Registro Tipo A - Informacoes Economico-Fiscais / Identificacao do Contribuinte / Apuracao do Imposto]
(PRE) RTA->(dbGoTop())
(PRE) _aTotal[05] := IIf(RTA->TARE=="S",.T.,.F.)
SEGMENTO   C 001 0 "A"
INSCRICAO  N 009 0 RTA->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTA->PERIODOREF
RETIFICA   N 002 0 RTA->RETIFICA
ATIVIDADE  N 007 0 RTA->ATIVIDADE
TIPOESTAB  C 001 0 RTA->TIPOESTAB
TARE       C 001 0 RTA->TARE
TIPOESCR   C 001 0 RTA->TIPOESCR
SALDOINI   N 014 2 RTA->SALDOINI
SALDOFIM   N 014 2 RTA->SALDOFIM
USAECF     C 001 0 RTA->USAECF
CPFDECLAR  C 011 0 RTA->CPFDECLAR
NOMEDECLAR C 050 0 RTA->NOMEDECLAR
CRCCONTAB  C 010 0 RTA->CRCCONTAB
UFCRCCONTA C 002 0 RTA->UFCRCCONTA
NOMECONTAB C 050 0 RTA->NOMECONTAB
FONECONTAB C 020 0 RTA->FONECONTAB
SAIDADEBI  N 014 2 RTA->SAIDADEBI
OUTROSDEB  N 014 2 RTA->OUTROSDEB
ESTORCRED  N 014 2 RTA->ESTORCRED
ENTRADEBI  N 014 2 RTA->ENTRADEBI
OUTROSCRED N 014 2 RTA->OUTROSCRED
ESTORDEB   N 014 2 RTA->ESTORDEB
SALDOCRED  N 014 2 RTA->SALDOCRED
DEDUCOES   N 014 2 RTA->DEDUCOES
DIFALIQREC N 014 2 RTA->DIFALIQREC
VLRPROD    N 014 2 RTA->VLRPROD
BASECALC   N 014 2 RTA->BASECALC
ICMSSUBST  N 014 2 RTA->ICMSSUBST
CREDICMS   N 014 2 RTA->CREDICMS
OUTRCREDI  N 014 2 RTA->OUTRCREDI
NUMTARE    C 020 0 RTA->NUMTARE
VERSAO     C 005 0 "10.00"
DTVENCTARE C 008 0 RTA->DTVENCTARE
DIFALIQATU N 014 2 RTA->DIFALIQATU
DIFALIQANT N 014 2 RTA->DIFALIQANT
TIPOENCERR C 001 0 RTA->TIPOENCERR
OBSERVACAO C 255 0 ""
COMPLALIQ  N 014 2 RTA->COMPLALIQ
DIFALQCONF N 014 2 RTA->DIFALQCONF
HOUVEMUD   C 001 0 RTA->HOUVEMUD
MUNICIPANT N 007 0 RTA->MUNICIPANT
DINIMUNATU C 008 0 RTA->DINIMUNATU
DFIMMUNATU C 008 0 RTA->DFIMMUNATU
DINIMUNANT C 008 0 RTA->DINIMUNANT
DFIMMUNANT C 008 0 RTA->DFIMMUNANT

(CONT) _aTotal[01]+=1


[RTB - Registro Tipo B - Entradas e Saidas de Mercadorias, Bens e/ou Servicos no Estabelecimento do Contribuinte]
(PRE) RTB->(dbGoTop())
SEGMENTO   C 001 0 "B"
INSCRICAO  N 009 0 RTB->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTB->PERIODOREF
RETIFICA   N 002 0 RTB->RETIFICA
ENTRSAIDA  C 001 0 RTB->ENTRSAIDA
CFOP       C 004 0 RTB->CFOP
BASECAL    N 014 2 RTB->BASECAL
ISENTAS    N 014 2 RTB->ISENTAS
OUTRAS     N 014 2 RTB->OUTRAS
SUBSTTRIB  N 014 2 RTB->SUBSTTRIB
VLRCONTAB  N 014 2 RTB->VLRCONTAB 
DEBCRED    N 014 2 RTB->CREDDEB
DOMICFISC  C 001 0 RTB->DOMICFISC
(CONT) _aTotal[01]+=1


[RTC - Registro Tipo C - Demonstrativo de Estoque]
(PRE) RTC->(dbGoTop())
SEGMENTO   C 001 0 "C"
INSCRICAO  N 009 0 RTC->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTC->PERIODOREF
RETIFICA   N 002 0 RTC->RETIFICA
EINITRIB   N 014 2 RTC->EINITRIB
EINIISENT  N 014 2 RTC->EINIISENT
EINIOUTRA  N 014 2 RTC->EINIOUTRA
EINISUBTR  N 014 2 RTC->EINISUBTR
EINIVLRTOT N 014 2 RTC->EINIVLRTOT
EFIMTRIB   N 014 2 RTC->EFIMTRIB
EFIMISENT  N 014 2 RTC->EFIMISENT
EFIMOUTRA  N 014 2 RTC->EFIMOUTRA
EFIMSUBTR  N 014 2 RTC->EFIMSUBTR
EFIMVLRTOT N 014 2 RTC->EFIMVLRTOT
(CONT) _aTotal[01]+=1


[RTD - Registro Tipo D - Detalhamento das Entradas/Saidas de Mercadorias e/ou Prestacoes de Servicos por Unidade da Federacao]
(PRE) RTD->(dbGoTop())
SEGMENTO   C 001 0 "D"
INSCRICAO  N 009 0 RTD->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTD->PERIODOREF
RETIFICA   N 002 0 RTD->RETIFICA
ENTRSAIDA  C 001 0 RTD->ENTRSAIDA
CODUF      N 002 0 RTD->CODUF
BASECONTR  N 014 2 RTD->BASECONTR
BASENCONTR N 014 2 RTD->BASENCONTR
ISENTAS    N 014 2 RTD->ISENTAS
OUTRAS     N 014 2 RTD->OUTRAS
ICMSSUBST  N 014 2 RTD->ICMSSUBST
VLRCONTRIB N 014 2 RTD->VLRCONTRIB
VLRNAOCONT N 014 2 If(RTD->ENTRSAIDA=='1',RTD->VLRNAOCONT,0)
CREDDEB    N 014 2 RTD->CREDDEB
DEBIMPNC   N 014 2 RTD->DEBIMPNC
DOMICFISC  C 001 0 RTD->DOMICFISC

(CONT) _aTotal[01]+=1


[RTE - Registro Tipo E - ICMS a Recolher]
(PRE) RTE->(dbGoTop())
SEGMENTO   C 001 0 "E"
INSCRICAO  N 009 0 RTE->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTE->PERIODOREF
RETIFICA   N 002 0 RTE->RETIFICA
TIPOICMS   C 001 0 RTE->TIPOICMS
DTVENC     C 008 0 RTE->DTVENC
VLRICMS    N 014 2 RTE->VLRICMS
(CONT) _aTotal[01]+=1

[RTJ - Registro Tipo J - Informações sobre TARE]
(PRE) RTJ->(dbGoTop())
(PREREG) _aTotal[05]
SEGMENTO   C 001 0 "J"
INSCRICAO  N 009 0 RTJ->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTJ->PERIODOREF
RETIFICA   N 002 0 RTJ->RETIFICA
NTARE      C 020 0 RTJ->NTARE
DTVENCTO   C 008 0 RTJ->DTVENCTO
(CONT) _aTotal[01]+=1

[RTK - Registro Tipo K - Especificação de Outros Creditos]
(PRE) RTK->(dbGoTop())
SEGMENTO   C 001 0 "K"
INSCRICAO  N 009 0 RTK->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTK->PERIODOREF
RETIFICA   N 002 0 RTK->RETIFICA
CODBASE    C 002 0 RTK->CODBASE
VLRCRED    N 014 2 RTK->VLRCRED
(CONT) _aTotal[01]+=1

[RTL - Registro Tipo L - Especificação das Deduções]
(PRE) RTL->(dbGoTop())
SEGMENTO   C 001 0 "L"
INSCRICAO  N 009 0 RTL->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTL->PERIODOREF
RETIFICA   N 002 0 RTL->RETIFICA
CODBASE    C 002 0 RTL->CODBASE
ICMSDEV    N 014 2 0
MEDICMS    N 014 2 0
VLRDED     N 014 2 RTL->VLRDED
(CONT) _aTotal[01]+=1

[RTM - Registro Tipo M - Saidas e/ou Prestações e Entradas e/ou Aquisições do Estabelecimento do Contribuinte por Municipio de Origem (campo 15)]
(PRE) RTM->(dbGoTop())
SEGMENTO   C 001 0 "M"
INSCRICAO  N 009 0 RTM->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTM->PERIODOREF
RETIFICA   N 002 0 RTM->RETIFICA
CODMUNORI  N 014 0 RTM->CODMUNORI
DOMICFISC  C 001 0 RTM->DOMICFISC
SAIDAS     N 014 2 RTM->SAIDAS
ENTRADAS   N 014 2 RTM->ENTRADAS
(CONT) _aTotal[01]+=1

[RTN - Registro Tipo N - Relação de Mercadorias e/ou Produtos adquiridos de outros Municipios Tocantinenses com Diferimento de do ICMS (campo 16 - Total das Notas Fiscais por Inscrição Estadual) ]
(PRE) RTN->(dbGoTop())
SEGMENTO   C 001 0 "N"
INSCRICAO  N 009 0 RTN->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTN->PERIODOREF
RETIFICA   N 002 0 RTN->RETIFICA
IDEMPCCI   C 009 0 RTN->IDEMPCCI
DOMICFISC  C 001 0 RTN->DOMICFISC
CODMUNORI  N 007 0 RTN->CODMUNORI
TOTNFEMP   N 014 2 RTN->TOTNFEMP
(CONT) _aTotal[01]+=1

[RTO - Registro Tipo O - Relação de Mercadorias e/ou Produtos adquiridos de outros Municipios Tocantinenses com Diferimento de do ICMS (campo 16 - Notas Fiscais por Inscrição Estadual) ]
(PRE) RTO->(dbGoTop())
SEGMENTO   C 001 0 "O"
INSCRICAO  N 009 0 RTO->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTO->PERIODOREF
RETIFICA   N 002 0 RTO->RETIFICA
IDEMPCCI   C 009 0 RTO->IDEMPCCI
DOMICFISC  C 001 0 RTO->DOMICFISC
NUMNOTA    N 007 0 RTO->NUMNOTA
VALNOTA    N 014 2 RTO->VALNOTA
(CONT) _aTotal[01]+=1

[RTP - Registro Tipo P - Detalhamento do Diferencial de Alíquotas por UF (7.6.1) ]
(PRE) RTP->(dbGoTop())
SEGMENTO   C 001 0 "P"
INSCRICAO  N 009 0 RTP->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTP->PERIODOREF
RETIFICA   N 002 0 RTP->RETIFICA
DOMICFISC  C 001 0 RTP->DOMICFISC
CODUF      C 002 0 RTP->CODUF
VALCONT    N 014 2 RTP->VALCONT
BASECALC   N 014 2 RTP->BASECALC
DIFALIQ    N 014 2 RTP->DIFALIQ
ALIQUOTA   N 004 2 RTP->ALIQUOTA
(CONT) _aTotal[01]+=1

[RTQ - Registro Tipo Q - Especificação da Complementação de Alíquotas por UF (7.9.1) ]
(PRE) RTQ->(dbGoTop())
SEGMENTO   C 001 0 "Q"
INSCRICAO  N 009 0 RTQ->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTQ->PERIODOREF
RETIFICA   N 002 0 RTQ->RETIFICA
DOMICFISC  C 001 0 RTQ->DOMICFISC
CODUF      C 002 0 RTQ->CODUF
VALCONT    N 014 2 RTQ->VALCONT
BASECALC   N 014 2 RTQ->BASECALC
COMALIQ    N 014 2 RTQ->COMPALIQ
ALIQUOTA   N 004 2 RTQ->ALIQUOTA
(CONT) _aTotal[01]+=1

[RTR - Registro Tipo R - Especificação de Outros Debitos (5.2.1) ]
(PRE) RTR->(dbGoTop())
SEGMENTO   C 001 0 "R"
INSCRICAO  N 009 0 RTR->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTR->PERIODOREF 
RETIFICA   N 002 0 RTR->RETIFICA
CODBASE    C 002 0 RTR->CODBASE
VLRDEBI    N 014 2 RTR->VLRDEBI
(CONT) _aTotal[01]+=1

[RTS - Registro Tipo S - Especificação do Diferencial de Alíquotas Consumidor Final (Saídas) por UF   7.13.1]
(PRE) RTS->(dbGoTop())
SEGMENTO   C 001 0 "S"
INSCRICAO  N 009 0 RTS->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTS->PERIODOREF
RETIFICA   N 002 0 RTS->RETIFICA
DOMICFISC  C 001 0 RTS->DOMICFISC
CODUF      C 002 0 RTS->CODUF
VALCONT    N 014 2 RTS->VALCONT
BASECALC   N 014 2 RTS->BASECALC
DIFALIQ    N 014 2 RTS->DIFALIQ
ALIQUOTA   N 004 2 RTS->ALIQUOTA
ORIGEM     N 014 2 RTS->ORIGEM
DESTINO    N 014 2 RTS->DESTINO
(CONT) _aTotal[01]+=1

[RTZ - Registro Tipo Z - Indica o Final da Declaracao]
(PRE) RTZ->(dbGoTop())
SEGMENTO   C 001 0 "Z"
INSCRICAO  N 009 0 RTZ->INSCRICAO
VAZIO      C 002 0 " "
PERIODOREF C 006 0 RTZ->PERIODOREF
RETIFICA   N 002 0 RTZ->RETIFICA
TOTALREG   N 003 0 _aTotal[01]

[XXX Deleta Temporarios]
(PRE) GIAMTODel(_aTotal[04])
(POS)
