?{"Nome do Arquivo INI","DIFTO.INI"}
?{"Descição Completa do Arquivo Magnético","É um demonstrativo anual, destinado à apuração das informações relativas ao ICMS das empresas, que servirá de base para o cálculo do Índice de Participação dos Municípios - IPM, dos municípios do Estado, conforme disposto na Constituição Federal. Quando o contribuinte se omite dessa declaração, prejudica o município onde exerce suas atividades, reduzindo, desta forma, a sua receita."}
?{"A Quem se Destina","Estão obrigados a entregar: o estabelecimento comercial ou industrial, seja matriz, filial, sucursal ou depósito, inscritos no Cadastro de Contribuintes do Estado do Tocantins - CCI-TO. Excluem-se da obrigatoriedade de apresentação do documento, os armazéns gerais, depósitos fechados do próprio depositante, estabelecimentos exclusivamente prestadores de serviços, assim entendido os contribuintes do Imposto Sobre Serviços de Qualquer Natureza – ISSQN, da competência dos Municípios e os produtores agropecuários não optantes pelo regime normal de escrituração."}
?{"Objetivo","A declaração do DIF tem como principal finalidade o cumprimento de obrigações necessárias por parte dos contribuintes do estado de Tocantins."}
?{"Prazo de Entrega","Até o dia 29 de Fevereiro do ano subsequete ao Exercício a ser Declarado."}
?{"Aplicativo Disponibilizado pelo Fisco","PROGRAMA DIF ELETRÔNICO"}
?{"Versão do Aplicativo Contemplada pelo Protheus","2020.1 - Caso exista mudança de estrutura de leiaute referente à essa versão (criação de novos registros, campos ou validações), deverá ser solicitada a atualização do DIFTO.INI."}
?{"Comentarios","Legislação vigente, leiaute atualizado, download do aplicativo, bem como maiores informações sobre essa obrigação acessória: http://dif.sefaz.to.gov.br"}

[XXX Inicializacao]
(PRE) _aTotal[02] := 0
(PRE) _aTotal[03] := 0
(PRE) _aTotal[04] := .F.
(PRE) _aTotal[05] := {}
(PRE) _aTotal[07] := ""
(PRE) _aTotal[96] := {}
(PRE) _aTotal[97] := {}

[XXX Wizard da rotina]
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³TELA PRINCIPAL³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
(PRE) aAdd (_aTotal[97], "Processamento da DIF - DOCUMENTOS DE INFORMAÇÕES FISCAIS")
(PRE) aAdd (_aTotal[97], "")
(PRE) aAdd (_aTotal[97], "Preencha corretamente as informações solicitadas.")
(PRE) aAdd (_aTotal[97], "Informações necessárias para a geração automática da DIF - DOCUMENTOS DE INFORMAÇÕES FISCAIS.")

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³TELAS SECUNDARIAS³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
[XXX Wizard da rotina]
(PRE) aAdd (_aTotal[96], {})
(PRE) aAdd (_aTotal[96][1], "Processamento da DIF - DOCUMENTOS DE INFORMAÇÕES FISCAIS")
(PRE) aAdd (_aTotal[96][1], "Informações necessárias para preenchimento do Segmento A – Identificação do Contribuinte")
(PRE) aAdd (_aTotal[96][1], {})
(PRE) aAdd (_aTotal[96][1][3], {1, "Período de Referência",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {2,,"@E 9999",2,0,,,4})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Retificação",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {3,,,1,,{"N=Não", "S=Sim"},,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1,"Atividade econômica principal",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {2,,"9999999",1,,,,7})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Tipo de Estabelecimento",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {3,,,1,,{"1=Único", "2-Matriz", "3-Filial"},,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Finalidade",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {3,,,1,,{"1=Informação anual", "2=Baixa Voluntária", "4=Suspensão Voluntária"},,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Tipo de Escrituração",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {3,,,1,,{"1=Fiscal", "2=Contábil"},,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Regime de Apuração",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {3,,,1,,{"3=Normal", "4=Simples Nacional"},,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Gerar Segmento G ?",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {3,,,2,,{"1=Sim", "2=Não"},,})
(PRE) aAdd (_aTotal[96][1][3], {1, "Versão",,,,,,})
(PRE) aAdd (_aTotal[96][1][3], {2,,"@R 9999.9 ",2,1,,,4})

(PRE) aAdd (_aTotal[96], {})
(PRE) aAdd (_aTotal[96][2], "Processamento da DIF - DOCUMENTOS DE INFORMAÇÕES FISCAIS")
(PRE) aAdd (_aTotal[96][2], "Informações necessárias para preenchimento do Segmento A – Identificação do Contribuinte")
(PRE) aAdd (_aTotal[96][2], {})
(PRE) aAdd (_aTotal[96][2][3], {1, "Período Fiscal de referência inicial",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,,3,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {1, "Período Fiscal de referência final",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,,3,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {1,"CPF do contador",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,"XXXXXXXXXXX",1,,,,11})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {1,"Responsável",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {1,"Saldo inicial de caixa",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,"@E 999,999,999.99",2,2,,,14})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {1,"Saldo final de caixa",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,"@E 999,999,999.99",2,2,,,14})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {1,"Valor de patrimônio líquido",,,,,,})
(PRE) aAdd (_aTotal[96][2][3], {2,,"@E 999,999,999.99",2,2,,,14})

(PRE) aAdd (_aTotal[96], {})
(PRE) aAdd (_aTotal[96][3], "Processamento da DIF - DOCUMENTOS DE INFORMAÇÕES FISCAIS")
(PRE) aAdd (_aTotal[96][3], "Classificação de CFOPs x Tipos de Entrada." +Chr(13)+Chr(10)+ "Insira os três digitos finais dos CFOPs Referentes a cada tipo de ENTRADA...")
(PRE) aAdd (_aTotal[96][3], {})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 01 - Compras:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 02 - Transferências:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 03 - Vendas Canceladas:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 04 - Transportes:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 05 - Comunicações:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 06 - Energia Elétrica:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 07 - Diferencial de Alíquota:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 08 - Compras Para Ativo Permanente:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 09 - Compras p/ Uso e Consumo:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 10 - Aquis. de Serv. Trib. Pelo ICMS:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {1,"Tipo 11 - Outras Entradas:",,,,,,})
(PRE) aAdd (_aTotal[96][3][3], {2,,,1,,,,80})

(PRE) aAdd (_aTotal[96], {})
(PRE) aAdd (_aTotal[96][4], "Processamento da DIF - DOCUMENTOS DE INFORMAÇÕES FISCAIS")
(PRE) aAdd (_aTotal[96][4], "Classificação de CFOPs x Tipos de Saída." +Chr(13)+Chr(10)+ "Insira os três digitos finais dos CFOPs Referentes a cada tipo de SAÍDA...")
(PRE) aAdd (_aTotal[96][4], {})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 01 - Vendas:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 02 - Transferências:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 03 - Compras Canceladas:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 04 - Energia Elétrica:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 05 - Comunicações:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 06 - Transportes:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 07 - Vendas do Ativo Permanente:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 08 - Vendas de Mat. P/ Uso e Consumo:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 09 - Prest. de Serv. Trib. Pelo ICMS:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {1,"Tipo 10 - Outras Saídas:",,,,,,})
(PRE) aAdd (_aTotal[96][4][3], {2,,,1,,,,80})

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³CHAMADA WIZARD³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
[XXX - Chamada da Wizard]
(PRE) _aTotal[04] := xMagWizard (_aTotal[97], _aTotal[96], "DIFTO") 
(PRE) Iif (_aTotal[04], xMagLeWiz ("DIFTO", @_aTotal[05], .T.), Nil)
(PRE) lAbtMT950 := Iif( !Empty(TcGetDb()), !_aTotal[04], .T.)

[XXX Preparacao das Tabelas]
(PRE) _aTotal[07] := CriaTabelas()
(PRE) DIFTOGera(AllTrim(_aTotal[05][1][1]), _aTotal[05][1][8] == "1", _aTotal[05])

[XXX Segmento A]
TIPOSEG    C 001 0 "A"
IE         C 009 0 PadL(AllTrim(SM0->M0_INSC), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(_aTotal[05][1][1]), 4))
RETIFICA   C 001 0 PadL(AllTrim(_aTotal[05][1][2]), 1)
ATIVECONO  N 007 0 VAL(PadL(AllTrim(_aTotal[05][1][3]), 7))
TPESTABE   N 001 0 VAL(PadL(AllTrim(_aTotal[05][1][4]), 1))
FINALID    N 001 0 VAL(PadL(AllTrim(_aTotal[05][1][5]), 1))
TPESCRIT   N 001 0 VAL(PadL(AllTrim(_aTotal[05][1][6]), 1))
REGAPURA   N 001 0 VAL(PadL(AllTrim(_aTotal[05][1][7]), 1))
CODMUNI    N 007 0 VAL(Iif(Len(Alltrim(SM0->M0_CODMUN))<=5,UfCodIBGE(SM0->M0_ESTENT),"")+SM0->M0_CODMUN)
PERFISINI  C 008 0 PadL(SubStr(AllTrim(_aTotal[05][2][1]), 7,2)+SubStr(AllTrim(_aTotal[05][2][1]), 5,2)+SubStr(AllTrim(_aTotal[05][2][1]), 1,4), 8)
PERFISFIM  C 008 0 PadL(SubStr(AllTrim(_aTotal[05][2][2]), 7,2)+SubStr(AllTrim(_aTotal[05][2][2]), 5,2)+SubStr(AllTrim(_aTotal[05][2][2]), 1,4), 8)
CPFCONTAD  C 011 0 PadL(AllTrim(_aTotal[05][2][3]), 11)
RESPONSA   C 080 0 PadL(AllTrim(_aTotal[05][2][4]), 80)
SALDOINI   N 014 2 VAL(AllTrim(_aTotal[05][2][5]))
SALDOFIM   N 014 2 VAL(AllTrim(_aTotal[05][2][6]))
VALORLIQ   N 014 2 VAL(AllTrim(_aTotal[05][2][7]))
MUDANDOM   C 001 0 "N"
VERSAO     C 006 0 (_aTotal[05][1][9])
(POSREG) _aTotal[02] += 1

[XXX Segmento B]
TIPOSEG    C 001 0 "B"
IE         C 009 0 PadL(AllTrim(SM0->M0_INSC), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(_aTotal[05][1][1]), 4))
CODMUNI    N 007 0 VAL(Iif(Len(Alltrim(SM0->M0_CODMUN))<=5,UfCodIBGE(SM0->M0_ESTENT),"")+SM0->M0_CODMUN)
PERFISINI  C 008 0 PadL(SubStr(AllTrim(_aTotal[05][2][1]), 7,2)+SubStr(AllTrim(_aTotal[05][2][1]), 5,2)+SubStr(AllTrim(_aTotal[05][2][1]), 1,4), 8)
PERFISFIM  C 008 0 PadL(SubStr(AllTrim(_aTotal[05][2][2]), 7,2)+SubStr(AllTrim(_aTotal[05][2][2]), 5,2)+SubStr(AllTrim(_aTotal[05][2][2]), 1,4), 8)
TIPDOMFIS  C 001 0 "A"
(POSREG) _aTotal[02] += 1

[SegmentoC Segmento C]
TIPOSEG    C 001 0 "C"
IE         C 009 0 PadL(AllTrim(SegmentoC->IE), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoC->Periodo), 4))
CODTIPENT  C 002 0 SegmentoC->TpEntrada
TIPDOMFIS  C 001 0 AllTrim(SegmentoC->DomiFiscal)
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoC->CodMuni), 7))
VALCONTAB  N 014 2 SegmentoC->ValContab
BASECALC   N 014 2 SegmentoC->ValBC
ISENTASNT  N 014 2 SegmentoC->ValIsenNT
SUBSTRIB   N 014 2 SegmentoC->ValSubst
(POSREG) _aTotal[02] += 1

[SegmentoD Segmento D]
TIPOSEG    C 001 0 "D"
IE         C 009 0 PadL(AllTrim(SegmentoD->IE), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoD->Periodo), 4))
CODIGOUF   C 002 0 PadL(AllTrim(SegmentoD->UF), 2)
TPDOMFIS   C 001 0 SegmentoD->DomiFiscal
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoD->CodMuni), 7))
VALCONTAB  N 014 2 SegmentoD->ValContab
BASECALC   N 014 2 SegmentoD->ValBC
ISENTASNT  N 014 2 SegmentoD->ValIsenNT
PETROLEO   N 014 2 SegmentoD->ValEnergia
OUTROSPRO  N 014 2 SegmentoD->ValOutros
SUBSTRIB   N 014 2 SegmentoD->ValSubst
(POSREG) _aTotal[02] += 1

[SegmentoE Segmento E]
TIPOSEG    C 001 0 "E"
IE         C 009 0 PadL(AllTrim(SegmentoE->IE), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoE->Periodo), 4))
CODTIPSAI  C 002 0 SegmentoE->TpSaida
TPDOMFIS   C 001 0 SegmentoE->DomiFiscal
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoE->CodMuni), 7))
VALCONTAB  N 014 2 SegmentoE->ValContab
BASECALC   N 014 2 SegmentoE->ValBC
ISENTASNT  N 014 2 SegmentoE->ValIsenNT
SUBSTRIB   N 014 2 SegmentoE->ValSubst
(POSREG) _aTotal[02] += 1

[SegmentoF Segmento F]
TIPOSEG    C 001 0 "F"
IE         C 009 0 PadL(AllTrim(SegmentoF->IE), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoF->Periodo), 4))
CODIGOUF   C 002 0 SegmentoF->UF
TPDOMFIS   C 001 0 SegmentoF->DomiFiscal
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoF->CodMuni), 7))
VALCONTRI  N 014 2 SegmentoF->ValContab
VALNCONTR  N 014 2 SegmentoF->ValContbNC
BCCONTRIB  N 014 2 SegmentoF->ValBC
BCNCONTRI  N 014 2 SegmentoF->ValBCNaoCt
ISENTAS    N 014 2 SegmentoF->ValIsenNT
SUBSTRIB   N 014 2 SegmentoF->ValSubst
STICMS     N 014 2 SegmentoF->ICMSST
(POSREG) _aTotal[02] += 1

[SegmentoG Segmento G]
(PREREG) SegmentoG->ValSai > 0 .Or. SegmentoG->ValEnt > 0
TIPOSEG    C 001 0 "G"
IE         C 009 0 PadL(AllTrim(SegmentoG->IE), 9)
PERIREFER  C 004 0 VAL(PadL(AllTrim(SegmentoG->Periodo), 4))
ORIGMUNIC  C 007 0 SegmentoG->CodMuniOri
TPMUNIFIS  C 001 0 SegmentoG->DomiFiscal
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoG->CodMuni), 7))
VALSAIDA   N 014 2 SegmentoG->ValSai
VALNCONTR  N 014 2 SegmentoG->ValEnt
(POSREG) _aTotal[02] += 1

[SegmentoH Segmento H]
TIPOSEG    C 001 0 "H"
IE         C 009 0 PadL(AllTrim(SegmentoH->IE), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoH->Periodo), 4))
IEORIGEM   C 009 0 PadL(AllTrim(SegmentoH->IEFornec), 9)
TPMUNIFIS  C 001 0 SegmentoH->DomiFiscal
CODMUNICI  C 007 0 VAL(PadL(AllTrim(SegmentoH->CodMuni), 7))
MUNIORIGE  N 007 0 VAL(PadL(AllTrim(SegmentoH->MuniOrig), 7))
(POSREG) _aTotal[02] += 1

[SegmentoI Segmento I]
(PREREG) SegmentoI->ValNota > 0
TIPOSEG    C 001 0 "I"
IE         C 009 0 PadL(AllTrim(SegmentoI->IE), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoI->Periodo), 4))
IEORIGEM   C 009 0 PadL(SegmentoI->IEFornec, 9)
TPMUNIFIS  C 001 0 SegmentoI->DomiFiscal
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoI->CodMuni), 7))
NUMERONF   N 007 0 VAL(PadL(AllTrim(SegmentoI->NumNota), 7))
VALORTOTA  N 014 2 SegmentoI->ValNota
(POSREG) _aTotal[02] += 1

[SegmentoK Segmento K]
TIPOSEG    C 001 0 "K"
IE         C 009 0 PadL(SegmentoK->IE, 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(SegmentoK->Periodo),4))
TIPOES     C 001 0 SegmentoK->TpMov
CFOP       C 004 0 SegmentoK->CFOP
TPMUNIFIS  C 001 0 SegmentoK->DomiFiscal
CODMUNICI  N 007 0 VAL(PadL(AllTrim(SegmentoK->CodMuni), 7))
VALCONTAB  N 014 2 SegmentoK->ValContab
BASECALC   N 014 2 SegmentoK->ValBC
OUTRAS     N 014 2 SegmentoK->ValIsenNT
SUBSTRIB   N 014 2 SegmentoK->ValSubst
(POSREG) _aTotal[02] += 1

[XXX Segmento Z]
TIPOSEG    C 001 0 "Z"
IE         C 009 0 PadL(AllTrim(SM0->M0_INSC), 9)
PERIREFER  N 004 0 VAL(PadL(AllTrim(_aTotal[05][1][1]), 4))
TOTALREG   C 003 0 _aTotal[02]

[XXX Finalizando Arquivo]
TIPOREG    C 003 0 "EOF"

(POS) DIFTOFim(_aTotal[07])
