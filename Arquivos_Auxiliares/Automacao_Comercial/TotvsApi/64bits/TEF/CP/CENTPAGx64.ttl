// Dados retornados do cartao
DLL FUNCTION GetchkCc_Number 	 LOCALNAME GetNumber 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION GetchkCc_Name   	 LOCALNAME GetName 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION GetchkCc_ExpMonth   LOCALNAME GetExpMonth 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION GetchkCc_ExpYear    LOCALNAME GetExpYear 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION GetchkGc_Amount 	 LOCALNAME GetAmount 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

// resposta de transacao
DLL FUNCTION getRspDsResponse	 	LOCALNAME Resposta 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

//resposta Aprovada e Declinada
DLL FUNCTION getRspOperationNumber	LOCALNAME ResOpNum 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION getRspAuth			LOCALNAME ResAutoriz 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION getRspCdResponse		LOCALNAME ResCd 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION getTx_Reference		LOCALNAME ResRef 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION getRspVoucher		LOCALNAME ResVoucher 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

//resposta com erro
DLL FUNCTION getRspDsError		LOCALNAME ResDsErro 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION getRspCdError		LOCALNAME ResCdErro 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

// Atribui Url
DLL FUNCTION PutdbgSetUrl LOCALNAME CfgUrl PARAMTYPE PASCAL (cParam1 AS PCHAR) AS VOID LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

// retorna url
DLL FUNCTION GetdbgSetUrl        LOCALNAME GetUrl 	PARAMTYPE PASCAL () AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

// Pin-Pad
DLL FUNCTION dbgStartTxEMV  LOCALNAME PinPad PARAMTYPE PASCAL (cParam1 AS PCHAR) AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION dbgSetCommPort LOCALNAME SetPinPad PARAMTYPE PASCAL (cParam1 AS PCHAR, cParam2 AS PCHAR) AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"
DLL FUNCTION PutchkGc_Amount LOCALNAME PutAmount PARAMTYPE PASCAL (cParam1 AS PCHAR) AS VOID LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"


// Venda
DLL FUNCTION sndVtaDirectaEMV LOCALNAME VtaDirecta PARAMTYPE PASCAL (cParam1 AS PCHAR, cParam2 AS PCHAR, cParam3 AS PCHAR, cParam4 AS PCHAR, cParam5 AS PCHAR, cParam6 AS PCHAR, cParam7 AS PCHAR, cParam8 AS PCHAR, cParam9 AS PCHAR, cParam10 AS PCHAR, cParam11 AS PCHAR, cParam12 AS PCHAR, cParam13 AS PBSTR, cParam14 AS PBSTR) AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV" 
DLL FUNCTION dbgEndOperation  LOCALNAME FechaPinPad 	PARAMTYPE PASCAL () AS VOID LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV"

// ADM
DLL FUNCTION sndCancelacion LOCALNAME CanVenDir PARAMTYPE PASCAL (cParam1 AS PCHAR, cParam2 AS PCHAR, cParam3 AS PCHAR, cParam4 AS PCHAR, cParam5 AS PCHAR, cParam6 AS PCHAR, cParam7 AS PCHAR, cParam8 AS PCHAR, cParam9 AS PCHAR) AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV" 
DLL FUNCTION sndReimpresion LOCALNAME ReiVenDir PARAMTYPE PASCAL (cParam1 AS PCHAR, cParam2 AS PCHAR, cParam3 AS PCHAR, cParam4 AS PCHAR, cParam5 AS PCHAR, cParam6 AS PCHAR) AS PCHAR LIB "cpIntegracionEMV" COCLASS "clsCpIntegracionEMV" INTERFACE "_clsCpIntegracionEMV" 



Function CentPag(cFunction, aParams, cDelimit, cFimStr)
    
    Local oRet		:= Nil							//Retorno da dll
	Local cBuffer 	:= ""                       	//Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""                         	//Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local cParam4	:= ""							//Variavel auxiliar
	Local cParam5	:= ""							//Variavel auxiliar
	Local cParam6	:= ""							//Variavel auxiliar
	Local cParam7	:= ""							//Variavel auxiliar
	Local cParam8	:= ""							//Variavel auxiliar
	Local cParam9	:= ""							//Variavel auxiliar
	Local cParam10	:= ""							//Variavel auxiliar
	Local cParam11	:= ""							//Variavel auxiliar
	Local cParam12	:= ""							//Variavel auxiliar
	Local cParam13  := ""							//Variavel auxiliar
	Local cParam14	:= ""							//Variavel auxiliar
	Local cParam15	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2 	:= 0							//Variavel auxiliar
	Local nParam3 	:= 0							//Variavel auxiliar
	Local nParam4 	:= 0 							//Variavel auxiliar
	Local nParam5 	:= 0							//Variavel auxiliar
	Local nParam6 	:= 0							//Variavel auxiliar
	
	//Executa o comando selecionado
	Do Case
		Case cFunction == Upper("PutdbgSetUrl") /// seta url
			cParam1 := DoEncode(aParams[3])
			oRet 	:= CfgUrl(cParam1)
			cBuffer := cFimStr
		Case cFunction == Upper("GetdbgSetUrl") // retorna url
			oRet 	:= GetUrl()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("GetchkCc_Number") // retorna numero de cartao
			oRet 	:= GetNumber()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("GetchkCc_ExpMonth")  // retorna mes do ano de validade
			oRet 	:= GetExpMonth()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("GetchkCc_ExpYear") // retorna o ano de validade
			oRet 	:= GetExpYear()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("GetchkCc_Name") // retorna o nome do cliente
			oRet 	:= GetName()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("GetchkGc_Amount")
			oRet 	:= GetAmount()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspDsResponse") // retorna  se venda foi aprovada
			oRet 	:= Resposta()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspOperationNumber") // Retorna numero de Operacao
			oRet 	:= ResOpNum()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspAuth") // Retorna Autorizacao
			oRet 	:= ResAutoriz()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspCdResponse") // Retorna Autorizacao
			oRet 	:= ResCd()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getTx_Reference") // Retorna Referencia
			oRet 	:= ResRef()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspVoucher") // Retorna Voucher
			oRet 	:= ResVoucher()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspDsError") // Retorna Descricao erro
			oRet 	:= ResDsErro()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("getRspCdError") // Retorna Cod erro
			oRet 	:= ResCdErro()
			cBuffer := AllTrim(oRet) + cFimStr	
		Case cFunction == Upper("dbgSetCommPort") // tipo de PinPad	
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	:= SetPinPad(cParam1,cParam2)
			cBuffer := cFimStr		
		Case cFunction == Upper("dbgStartTxEMV") // starta PinPad	
			cParam1 := DoEncode(aParams[3])
			oRet 	:= PinPad(cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
		Case cFunction == Upper("PutchkGc_Amount")
			cParam1 := DoEncode(aParams[3])
			oRet 	:= PutAmount(cParam1)
			cBuffer := cFimStr					
		Case cFunction == Upper("dbgEndOperation")		
			oRet 	:= FechaPinPad()
			cBuffer := cFimStr	
		Case cFunction == Upper("sndVtaDirectaEMV") // Venda	
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10])
			cParam9 := DoEncode(aParams[11])			
			cParam10 := DoEncode(aParams[12])			
			cParam11 := DoEncode(aParams[13])			
			cParam12 := DoEncode(aParams[14])			
			cParam13 := DoEncode(aParams[15])			
			cParam14 := DoEncode(aParams[16])			
			oRet 	 := VtaDirecta(cParam1,cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8, cParam9, cParam10, cParam11, cParam12, cParam13, cParam14)
			cBuffer := cFimStr		
		Case cFunction == Upper("sndCancelacion") // Venda	
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10])
			cParam9 := DoEncode(aParams[11])
			oRet 	:= CanVenDir(cParam1,cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8, cParam9)
			cBuffer := cFimStr		
		Case cFunction == Upper("sndReimpresion") // Venda	
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			oRet 	:= ReiVenDir(cParam1,cParam2, cParam3, cParam4, cParam5, cParam6)
			cBuffer := cFimStr		
		Otherwise
			cBuffer := "Function not found in BematechInterface.DLL/SO -> "+ cFunction
			MsgStop(cBuffer, "Library BematechInterface")
	EndCase
	
Return cBuffer

         