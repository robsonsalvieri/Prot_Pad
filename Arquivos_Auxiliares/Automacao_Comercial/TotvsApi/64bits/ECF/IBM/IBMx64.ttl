#IFNDEF LINUX                                                                                                         
	//INICIALIZACAO 
	DLL FUNCTION IBM_FI_AbrePortaSerial						  	  					LOCALNAME IB_ABRESER PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_FechaPortaSerial						  	  				LOCALNAME IB_FECHSER PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_LeituraX								  	  				LOCALNAME IB_LEITURX PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_ProgramaAliquota 					  	  			   		LOCALNAME IB_PROGALI PARAMTYPE PASCAL (cAliq AS PCHAR, bTipoIss AS INTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_ProgramaHorarioVerao 				  	 					LOCALNAME IB_PROGHOV PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_ModeloImpressora 					   			   			LOCALNAME IB_MODEIMP PARAMTYPE PASCAL (cModelo AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_AtivaDesativaGuilhotinaMFD 						   			LOCALNAME IB_HABGUIL PARAMTYPE PASCAL (iHabi AS INTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_AcionaGuilhotinaMFD 					   					LOCALNAME IB_ACIOGUI PARAMTYPE PASCAL (cAciona AS PINTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NomeiaTotalizadorNaoSujeitoIcms 	  						LOCALNAME IB_NOMETOT PARAMTYPE PASCAL (cIndice AS PINTEGER, cDescri AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	
	//CUPOM FISCAL
	DLL FUNCTION IBM_FI_AbreCupom 								  	  				LOCALNAME IB_ABREOCF PARAMTYPE PASCAL (cCnpj AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VendeItem 								 	  				LOCALNAME IB_VENITEM PARAMTYPE PASCAL (cCodigo AS PCHAR, cDescricao AS PCHAR, cAliquota AS PCHAR, cTpQuant AS PCHAR, nQtde AS PCHAR, piCasaDec AS INTEGER, cVlUnit AS PCHAR, cTipoDesc AS PCHAR, cValorDesc AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_CancelaItemGenerico 				  	  					LOCALNAME IB_CANITGE PARAMTYPE PASCAL (cItem AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_CancelaCupom 												LOCALNAME IB_CANCECF PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_FechaCupom 							  						LOCALNAME IB_FECHACF PARAMTYPE PASCAL (cFpagto AS PCHAR, cAcrDes AS PCHAR, cTpAcrDes AS PCHAR, cValAcrDes AS PCHAR, cValPago AS PCHAR, cMsgPromo AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VendeItemDepartamento 					 					LOCALNAME IB_VENITDP PARAMTYPE PASCAL (cCodigo AS PCHAR, cDescr AS PCHAR, cAliquota AS PCHAR, cVlUni AS PCHAR, cQtde AS PCHAR, cAcres AS PCHAR, cDescto AS PCHAR, cDepto AS PCHAR, cUnid AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_InicioFimCOOsMFD		 					 	 			LOCALNAME IB_INIFIMC PARAMTYPE PASCAL (cIniCO AS PCHAR, cFimCO AS PCHAR ) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VendaBruta				 					  	 			LOCALNAME IB_VNDBRUT PARAMTYPE PASCAL (cVenBru AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_StatusEstendidoMFD				 		  	 				LOCALNAME IB_STAESTE PARAMTYPE PASCAL (piStatus AS PINTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VerificaIndiceAliquotasIss			  			   			LOCALNAME IB_VERALII PARAMTYPE PASCAL (cAliqISS AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_EfetuaFormaPagamentoIndiceMFD			  					LOCALNAME IB_PGTINDI PARAMTYPE PASCAL (cIndice AS PCHAR, cValor AS PCHAR, cParcela AS PCHAR, cDescr AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	
	//RELATORIOS FISCAIS
	DLL FUNCTION IBM_FI_ReducaoZ 									  				LOCALNAME IB_REDUCAZ PARAMTYPE PASCAL (cData AS PCHAR, cHora AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_FechaRelatorioGerencial 				 					LOCALNAME IB_FECHARG PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 
	
	//OPERACOES NAO FISCAIS
	DLL FUNCTION IBM_FI_UsaComprovanteNaoFiscalVinculado 	 						LOCALNAME IB_USACNFV PARAMTYPE PASCAL (cMsg AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_FechaComprovanteNaoFiscalVinculado  						LOCALNAME IB_FCHCNFV PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_Sangria 									 				LOCALNAME IB_SANGRIA PARAMTYPE PASCAL (cValor AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_Suprimento 													LOCALNAME IB_SUPRIME PARAMTYPE PASCAL (cValor AS PCHAR, cForma AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	
	//INFORMACOES DA IMPRESSORA                                    	
	DLL FUNCTION IBM_FI_SubTotal 													LOCALNAME IB_SUBTOTA PARAMTYPE PASCAL (cSubTot AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NumeroCupom 							 					LOCALNAME IB_NUMCUPO PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VersaoFirmware 						 						LOCALNAME IB_VERFIRM PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_CNPJ_IE 									 				LOCALNAME IB_NUCGCIE PARAMTYPE PASCAL (cCNPJ AS PCHAR, cIE AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_GrandeTotal 							 					LOCALNAME IB_GRATOTA PARAMTYPE PASCAL (cGT AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NumeroOperacoesNaoFiscais 		 							LOCALNAME IB_NOPENFI PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NumeroCuponsCancelados 			  							LOCALNAME IB_NCPCANC PARAMTYPE PASCAL (cNCupom AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NumeroIntervencoes 											LOCALNAME IB_NUMINTE PARAMTYPE PASCAL (cNInterv AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NumeroReducoes 												LOCALNAME IB_NUMREDU PARAMTYPE PASCAL (cNumRed AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_UltimoItemVendido 					 						LOCALNAME IB_ULITVEN PARAMTYPE PASCAL (cNumItem AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_ClicheProprietario 					 						LOCALNAME IB_CLIPROP PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_NumeroCaixa 							 					LOCALNAME IB_NUMCAIX PARAMTYPE PASCAL (cNCaixa AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_NumeroLoja 							  						LOCALNAME IB_NUMLOJA PARAMTYPE PASCAL (cLoja AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VerificaModoOperacao 				 						LOCALNAME IB_VERMOOP PARAMTYPE PASCAL (pMod AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_FlagsFiscais 												LOCALNAME IB_FLAGFIS PARAMTYPE PASCAL (piFlag as PINTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_DataHoraImpressora 						 					LOCALNAME IB_DTHRIMP PARAMTYPE PASCAL (cData AS PCHAR, cHora AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_DataMovimento 												LOCALNAME IB_DTHMOVI PARAMTYPE PASCAL (cData AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VerificaAliquotasIss 				  						LOCALNAME IB_VERALIQ PARAMTYPE PASCAL (cAliq AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_RetornoAliquotas 											LOCALNAME IB_RETALIQ PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	                                                                 	
	//AUTENTICACAO                                                 	
	DLL FUNCTION  IBM_FI_Autenticacao 												LOCALNAME IB_AUTENTI PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"
	                                                               	
	//GAVETA DE DINHEIRO                                           	
	DLL FUNCTION IBM_FI_AcionaGaveta 												LOCALNAME IB_ABREGAV PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VerificaEstadoGaveta 				  						LOCALNAME IB_VESTGAV PARAMTYPE PASCAL (piFlag as PINTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	
	                                                                  	
	//IMPRESSORA FISCAL MFD(TERMINCA)                                	
	DLL FUNCTION IBM_FI_AbreCupomMFD 								 				LOCALNAME IB_ABRECFT PARAMTYPE PASCAL (cCnpj AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"    
	DLL FUNCTION IBM_FI_CancelaCupomMFD 							 				LOCALNAME IB_CANCCFT PARAMTYPE PASCAL (cCnpj AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_ProgramaFormaPagamentoMFD 			 						LOCALNAME IB_PROFPGT PARAMTYPE PASCAL (cForma AS PCHAR, cOper AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_EfetuaFormaPagamentoMFD 				 					LOCALNAME IB_EFFORPG PARAMTYPE PASCAL (cForma AS PCHAR, cValor AS PCHAR, cParcela AS PCHAR, cDescr AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_AcrescimoDescontoItemMFD 				 					LOCALNAME IB_ACDEITT PARAMTYPE PASCAL (cItem AS PCHAR, cAcrDes AS PCHAR, cTpAcrDes AS PCHAR, cValor AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_NomeiaRelatorioGerencialMFD 			  					LOCALNAME IB_NOREGER PARAMTYPE PASCAL (cIndice AS PCHAR, cDescr AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"  
	DLL FUNCTION IBM_FI_AutenticacaoMFD 							  				LOCALNAME IB_AUTEMFD PARAMTYPE PASCAL (cLinha AS PCHAR, cTexto AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_AbreComprovanteNaoFiscalVinculadoMFD 						LOCALNAME IB_ABCPNFV PARAMTYPE PASCAL (cForma AS PCHAR, nValor AS PCHAR, nNumCupom AS PCHAR, cCPF AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_AbreRecebimentoNaoFiscalMFD 			 					LOCALNAME IB_ABRECNF PARAMTYPE PASCAL (cCPF AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_FechaRecebimentoNaoFiscalMFD 		 						LOCALNAME IB_FECECFT PARAMTYPE PASCAL (cMsg AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_EfetuaRecebimentoNaoFiscalMFD 		 						LOCALNAME IB_RECNFIM PARAMTYPE PASCAL (cIndice AS PCHAR, cValor AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_IniciaFechamentoRecebimentoNaoFiscalMFD 					LOCALNAME IB_INFERCN PARAMTYPE PASCAL (cDesAc AS PCHAR, cTpDes AS PCHAR, cValAc AS PCHAR, cValDe AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_CancelaRecebimentoNaoFiscalMFD 								LOCALNAME IB_CANRECN PARAMTYPE PASCAL (cCPF AS PCHAR, cNome AS PCHAR, cEnd AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_AbreRelatorioGerencialMFD 									LOCALNAME IB_ABRREGE PARAMTYPE PASCAL (cIndice AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"    
	DLL FUNCTION IBM_FI_UsaRelatorioGerencialMFD 									LOCALNAME IB_USAREGE PARAMTYPE PASCAL (cMsg AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_NumeroSerieMFD 							 					LOCALNAME IB_NUMSEMF PARAMTYPE PASCAL (cNserie AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"   
	DLL FUNCTION IBM_FI_VersaoFirmwareMFD 						  					LOCALNAME IB_VEFIRMF PARAMTYPE PASCAL (cFrmWare AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_InscricaoMunicipalMFD 					 					LOCALNAME IB_INSMUNI PARAMTYPE PASCAL (cInsMun AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"   
	DLL FUNCTION IBM_FI_ContadoresTotalizadoresNaoFiscaisMFD 						LOCALNAME IB_TOTNFIS PARAMTYPE PASCAL (cContador AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VerificaTotalizadoresNaoFiscaisMFD   						LOCALNAME IB_VETONFM PARAMTYPE PASCAL (cNFiscal AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_VerificaFormasPagamentoMFD 			  						LOCALNAME IB_VEFPGMF PARAMTYPE PASCAL (cForma AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_VerificaRelatorioGerencialMFD 		 						LOCALNAME IB_VERGEMF PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"  
	DLL FUNCTION IBM_FI_ContadorComprovantesCreditoMFD 		  						LOCALNAME IB_CCOMPMF PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_ContadorRelatoriosGerenciaisMFD 	  						LOCALNAME IB_CORNGMF PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"              
	DLL FUNCTION IBM_FI_VerificaTotalizadoresParciaisMFD 							LOCALNAME IB_TOTPARM PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_DadosUltimaReducaoMFD 					 					LOCALNAME IB_DTULREM PARAMTYPE PASCAL (cReduc AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalDataMFD 			 					LOCALNAME IB_LERMEDT PARAMTYPE PASCAL (cDtInicio AS PCHAR,cDtFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalReducaoMFD 		 						LOCALNAME IB_LERMERE PARAMTYPE PASCAL (cDtInicio AS PCHAR,cDtFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalSerialDataMFD 	  						LOCALNAME IB_LERMESE PARAMTYPE PASCAL (cDtInicio AS PCHAR,cDtFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"   
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalSerialReducaoMFD 						LOCALNAME IB_LERMERM PARAMTYPE PASCAL (cRedIni AS PCHAR, cRedFim AS PCHAR, cFlag AS BYTE) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_LeituraChequeMFD 						 		 			LOCALNAME IB_LECHMFD PARAMTYPE PASCAL (cCMC7 As PCHAR) AS INTEGER LIB "IBMFI32.DLL"   
	DLL FUNCTION IBM_FI_ImprimeChequeMFD 						  		 			LOCALNAME IB_IMCHMFD PARAMTYPE PASCAL (cBanco As PCHAR, cValor As PCHAR, cFavorec As PCHAR, cCidade As PCHAR, cData As PCHAR, cMsg As PCHAR, cImpVer As PCHAR, cLinhas As PCHAR) AS INTEGER LIB "IBMFI32.DLL"   
	DLL FUNCTION IBM_FI_HabilitaDesabilitaRetornoEstendidoMFD 						LOCALNAME IB_HDRETMF PARAMTYPE PASCAL (cFlag AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_RetornoImpressoraMFD 				  						LOCALNAME IB_RETIMPR PARAMTYPE PASCAL (piACK AS PINTEGER, piST1 AS PINTEGER, piST2 AS PINTEGER, piST3 AS PINTEGER) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_SubTotalizaCupomMFD 										LOCALNAME IB_SUBTOTM PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"    
	DLL FUNCTION IBM_FI_TotalizaRecebimentoMFD 										LOCALNAME IB_TOTRECM PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL" 	
	DLL FUNCTION IBM_FI_IniciaFechamentoCupomMFD 									LOCALNAME IB_INICPMF PARAMTYPE PASCAL (cAcre AS PCHAR, cTpAcre AS PCHAR, cValAcre AS PCHAR, cValDesc AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_SubTotalizaRecebimentoMFD 			 						LOCALNAME IB_SUTTRMF PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_AcrescimoDescontoSubtotalRecebimentoMFD 		   			LOCALNAME IB_ACTOMFD PARAMTYPE PASCAL () AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_AcrescimoDescontoSubtotalMFD 								LOCALNAME IB_ACSUBMF PARAMTYPE PASCAL (cFlag AS PCHAR, cTipo AS PCHAR, cValor AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"     
	DLL FUNCTION IBM_FI_VerificaEstadoImpressoraMFD 			 					LOCALNAME IB_VERIMPM PARAMTYPE PASCAL (piACK AS PINTEGER, piST1 AS PINTEGER, piST2 AS PINTEGER, piST3 AS PINTEGER) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_TerminaFechamentoCupom 				 	 					LOCALNAME IB_TEMFCPM PARAMTYPE PASCAL (cMsgPro AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_DownloadMF 							 						LOCALNAME IB_DOWNLMF PARAMTYPE PASCAL (cArquivo AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"    
	DLL FUNCTION IBM_FI_DownloadMFD 												LOCALNAME IB_DOWNMFD PARAMTYPE PASCAL (cArquivo AS PCHAR, cTipo AS PCHAR, cPar1 AS PCHAR, cPar2 AS PCHAR, cUser AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"    
	DLL FUNCTION IBM_FI_FormatoDadosMFD 						  					LOCALNAME IB_FOMDAMF PARAMTYPE PASCAL (cArqOri AS PCHAR, cArqDes AS PCHAR, cTPDado AS PCHAR, cTipo AS PCHAR, cPar1 AS PCHAR, cPar2 AS PCHAR, cUser AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_VerificaEstadoImpressora 									LOCALNAME IB_ESTIMPR PARAMTYPE PASCAL (piACK AS PINTEGER, piST1 AS PINTEGER, piST2 AS PINTEGER ) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_AberturaDoDia 							 					LOCALNAME IB_ABREDIA PARAMTYPE PASCAL (cValor AS PCHAR, cFpagto AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"  
	DLL FUNCTION IBM_FI_DataHoraSoftwareBasico                 						LOCALNAME IB_SWUSRMF PARAMTYPE PASCAL (cData AS PCHAR, cHora AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_GeraAtoCotepe1704                                           LOCALNAME IB_CT1704  PARAMTYPE PASCAL ( cTpGer AS PCHAR, cParamIni AS PCHAR, cParamFim AS PCHAR, cArqDes AS PCHAR ) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION GeraRegistrosTipoE                                               	LOCALNAME IB_RGEMF   PARAMTYPE PASCAL (cArqOri AS PCHAR, cArqDes AS PCHAR, cDataIni AS PCHAR,cDataFim AS PCHAR, cNome As PCHAR, cEnd AS PCHAR, cParam1 AS PCHAR, cCMD AS PCHAR,  cParam2 AS PCHAR,  cParam3 AS PCHAR,  cParam4 AS PCHAR,  cParam5 AS PCHAR,  cParam6 AS PCHAR,  cParam7 AS PCHAR,  cParam8 AS PCHAR,  cParam9 AS PCHAR,  cParam10 AS PCHAR,  cParam11 AS PCHAR,  cParam12 AS PCHAR,  cParam13 AS PCHAR,  cParam14 AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_VerificaZPendente                                           LOCALNAME IB_REDZPEN PARAMTYPE PASCAL (nValor AS PINTEGER) AS INTEGER LIB "IBMFI32.DLL"
	DLL FUNCTION IBM_FI_EstornoNaoFiscalVinculadoMFD								LOCALNAME IB_ENFIVIN PARAMTYPE PASCAL (cCPFCNPJ AS PCHAR , cNome AS PCHAR , cEndereco AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
	
	//CONFIGURACAO DO CODIGO DE BARRAS - NOVO
	DLL FUNCTION IBM_FI_ConfiguraCodigoBarrasMFD 									LOCALNAME IB_CONCODB PARAMTYPE PASCAL (piAlt AS INTEGER, piLar AS INTEGER, piPos AS INTEGER, piFon AS INTEGER, piMar AS INTEGER) AS INTEGER LIB "IBMFI32.DLL" 
	
	//IMPRESSAO DO CODIGO DE BARRAS - NOVO
	DLL FUNCTION IBM_FI_CodigoBarrasCODE128MFD 										LOCALNAME IB_E128MFD PARAMTYPE PASCAL (cString AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
	DLL FUNCTION IBM_FI_CodigoBarrasITFMFD 											LOCALNAME IB_CITFMFD PARAMTYPE PASCAL (cString AS PCHAR) AS INTEGER LIB "IBMFI32.DLL" 
                                                                                    
    DLL FUNCTION IBM_FI_RetornoImpressoraPadraoIBM                                  LOCALNAME IB_ERRO PARAMTYPE PASCAL (nErro AS PINTEGER, cMsg AS PCHAR) AS INTEGER LIB "IBMFI32.DLL"
#ELSE
	//INICIALIZACAO 
	DLL FUNCTION IBM_FI_AbrePortaSerial						  	  					LOCALNAME IB_ABRESER PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_FechaPortaSerial						  	  				LOCALNAME IB_FECHSER PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_LeituraX								  	  				LOCALNAME IB_LEITURX PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_ProgramaAliquota 					  	  			   		LOCALNAME IB_PROGALI PARAMTYPE PASCAL (cAliq AS PCHAR, bTipoIss AS INTEGER) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_ProgramaHorarioVerao 				  	 					LOCALNAME IB_PROGHOV PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_ModeloImpressora 					   			   			LOCALNAME IB_MODEIMP PARAMTYPE PASCAL (cModelo AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_AtivaDesativaGuilhotinaMFD 						   			LOCALNAME IB_HABGUIL PARAMTYPE PASCAL (iHabi AS INTEGER) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_AcionaGuilhotinaMFD 					   					LOCALNAME IB_ACIOGUI PARAMTYPE PASCAL (cAciona AS PINTEGER) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NomeiaTotalizadorNaoSujeitoIcms 	  						LOCALNAME IB_NOMETOT PARAMTYPE PASCAL (cIndice AS PINTEGER, cDescri AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	
	//CUPOM FISCAL
	DLL FUNCTION IBM_FI_AbreCupom 								  	  				LOCALNAME IB_ABREOCF PARAMTYPE PASCAL (cCnpj AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VendeItem 								 	  				LOCALNAME IB_VENITEM PARAMTYPE PASCAL (cCodigo AS PCHAR, cDescricao AS PCHAR, cAliquota AS PCHAR, cTpQuant AS PCHAR, nQtde AS PCHAR, piCasaDec AS INTEGER, cVlUnit AS PCHAR, cTipoDesc AS PCHAR, cValorDesc AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_CancelaItemGenerico 				  	  					LOCALNAME IB_CANITGE PARAMTYPE PASCAL (cItem AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_CancelaCupom 												LOCALNAME IB_CANCECF PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_FechaCupom 							  						LOCALNAME IB_FECHACF PARAMTYPE PASCAL (cFpagto AS PCHAR, cAcrDes AS PCHAR, cTpAcrDes AS PCHAR, cValAcrDes AS PCHAR, cValPago AS PCHAR, cMsgPromo AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VendeItemDepartamento 					 					LOCALNAME IB_VENITDP PARAMTYPE PASCAL (cCodigo AS PCHAR, cDescr AS PCHAR, cAliquota AS PCHAR, cVlUni AS PCHAR, cQtde AS PCHAR, cAcres AS PCHAR, cDescto AS PCHAR, cDepto AS PCHAR, cUnid AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_InicioFimCOOsMFD		 					 	 			LOCALNAME IB_INIFIMC PARAMTYPE PASCAL (cIniCO AS PCHAR, cFimCO AS PCHAR ) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VendaBruta				 					  	 			LOCALNAME IB_VNDBRUT PARAMTYPE PASCAL (cVenBru AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_StatusEstendidoMFD				 		  	 				LOCALNAME IB_STAESTE PARAMTYPE PASCAL (piStatus AS PINTEGER) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VerificaIndiceAliquotasIss			  			   			LOCALNAME IB_VERALII PARAMTYPE PASCAL (cAliqISS AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_EfetuaFormaPagamentoIndiceMFD			  					LOCALNAME IB_PGTINDI PARAMTYPE PASCAL (cIndice AS PCHAR, cValor AS PCHAR, cParcela AS PCHAR, cDescr AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	
	//RELATORIOS FISCAIS
	DLL FUNCTION IBM_FI_ReducaoZ 									  				LOCALNAME IB_REDUCAZ PARAMTYPE PASCAL (cData AS PCHAR, cHora AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_FechaRelatorioGerencial 				 					LOCALNAME IB_FECHARG PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 
	
	//OPERACOES NAO FISCAIS
	DLL FUNCTION IBM_FI_UsaComprovanteNaoFiscalVinculado 	 						LOCALNAME IB_USACNFV PARAMTYPE PASCAL (cMsg AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_FechaComprovanteNaoFiscalVinculado  						LOCALNAME IB_FCHCNFV PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_Sangria 									 				LOCALNAME IB_SANGRIA PARAMTYPE PASCAL (cValor AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_Suprimento 													LOCALNAME IB_SUPRIME PARAMTYPE PASCAL (cValor AS PCHAR, cForma AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	
	//INFORMACOES DA IMPRESSORA                                    	
	DLL FUNCTION IBM_FI_SubTotal 													LOCALNAME IB_SUBTOTA PARAMTYPE PASCAL (cSubTot AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NumeroCupom 							 					LOCALNAME IB_NUMCUPO PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VersaoFirmware 						 						LOCALNAME IB_VERFIRM PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_CNPJ_IE 									 				LOCALNAME IB_NUCGCIE PARAMTYPE PASCAL (cCNPJ AS PCHAR, cIE AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_GrandeTotal 							 					LOCALNAME IB_GRATOTA PARAMTYPE PASCAL (cGT AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NumeroOperacoesNaoFiscais 		 							LOCALNAME IB_NOPENFI PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NumeroCuponsCancelados 			  							LOCALNAME IB_NCPCANC PARAMTYPE PASCAL (cNCupom AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NumeroIntervencoes 											LOCALNAME IB_NUMINTE PARAMTYPE PASCAL (cNInterv AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NumeroReducoes 												LOCALNAME IB_NUMREDU PARAMTYPE PASCAL (cNumRed AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_UltimoItemVendido 					 						LOCALNAME IB_ULITVEN PARAMTYPE PASCAL (cNumItem AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_ClicheProprietario 					 						LOCALNAME IB_CLIPROP PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_NumeroCaixa 							 					LOCALNAME IB_NUMCAIX PARAMTYPE PASCAL (cNCaixa AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_NumeroLoja 							  						LOCALNAME IB_NUMLOJA PARAMTYPE PASCAL (cLoja AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VerificaModoOperacao 				 						LOCALNAME IB_VERMOOP PARAMTYPE PASCAL (pMod AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_FlagsFiscais 												LOCALNAME IB_FLAGFIS PARAMTYPE PASCAL (piFlag as PINTEGER) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_DataHoraImpressora 						 					LOCALNAME IB_DTHRIMP PARAMTYPE PASCAL (cData AS PCHAR, cHora AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_DataMovimento 												LOCALNAME IB_DTHMOVI PARAMTYPE PASCAL (cData AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VerificaAliquotasIss 				  						LOCALNAME IB_VERALIQ PARAMTYPE PASCAL (cAliq AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_RetornoAliquotas 											LOCALNAME IB_RETALIQ PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	                                                                 	
	//AUTENTICACAO                                                 	
	DLL FUNCTION  IBM_FI_Autenticacao 												LOCALNAME IB_AUTENTI PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"
	                                                               	
	//GAVETA DE DINHEIRO                                           	
	DLL FUNCTION IBM_FI_AcionaGaveta 												LOCALNAME IB_ABREGAV PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VerificaEstadoGaveta 				  						LOCALNAME IB_VESTGAV PARAMTYPE PASCAL (piFlag as PINTEGER) AS INTEGER LIB "/ibmfi32.so" 
	
	                                                                  	
	//IMPRESSORA FISCAL MFD(TERMINCA)                                	
	DLL FUNCTION IBM_FI_AbreCupomMFD 								 				LOCALNAME IB_ABRECFT PARAMTYPE PASCAL (cCnpj AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "/ibmfi32.so"    
	DLL FUNCTION IBM_FI_CancelaCupomMFD 							 				LOCALNAME IB_CANCCFT PARAMTYPE PASCAL (cCnpj AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_ProgramaFormaPagamentoMFD 			 						LOCALNAME IB_PROFPGT PARAMTYPE PASCAL (cForma AS PCHAR, cOper AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_EfetuaFormaPagamentoMFD 				 					LOCALNAME IB_EFFORPG PARAMTYPE PASCAL (cForma AS PCHAR, cValor AS PCHAR, cParcela AS PCHAR, cDescr AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_AcrescimoDescontoItemMFD 				 					LOCALNAME IB_ACDEITT PARAMTYPE PASCAL (cItem AS PCHAR, cAcrDes AS PCHAR, cTpAcrDes AS PCHAR, cValor AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_NomeiaRelatorioGerencialMFD 			  					LOCALNAME IB_NOREGER PARAMTYPE PASCAL (cIndice AS PCHAR, cDescr AS PCHAR) AS INTEGER LIB "/ibmfi32.so"  
	DLL FUNCTION IBM_FI_AutenticacaoMFD 							  				LOCALNAME IB_AUTEMFD PARAMTYPE PASCAL (cLinha AS PCHAR, cTexto AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_AbreComprovanteNaoFiscalVinculadoMFD 						LOCALNAME IB_ABCPNFV PARAMTYPE PASCAL (cForma AS PCHAR, nValor AS PCHAR, nNumCupom AS PCHAR, cCPF AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_AbreRecebimentoNaoFiscalMFD 			 					LOCALNAME IB_ABRECNF PARAMTYPE PASCAL (cCPF AS PCHAR, cNome AS PCHAR, cEndereco AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_FechaRecebimentoNaoFiscalMFD 		 						LOCALNAME IB_FECECFT PARAMTYPE PASCAL (cMsg AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_EfetuaRecebimentoNaoFiscalMFD 		 						LOCALNAME IB_RECNFIM PARAMTYPE PASCAL (cIndice AS PCHAR, cValor AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_IniciaFechamentoRecebimentoNaoFiscalMFD 					LOCALNAME IB_INFERCN PARAMTYPE PASCAL (cDesAc AS PCHAR, cTpDes AS PCHAR, cValAc AS PCHAR, cValDe AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_CancelaRecebimentoNaoFiscalMFD 								LOCALNAME IB_CANRECN PARAMTYPE PASCAL (cCPF AS PCHAR, cNome AS PCHAR, cEnd AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_AbreRelatorioGerencialMFD 									LOCALNAME IB_ABRREGE PARAMTYPE PASCAL (cIndice AS PCHAR) AS INTEGER LIB "/ibmfi32.so"    
	DLL FUNCTION IBM_FI_UsaRelatorioGerencialMFD 									LOCALNAME IB_USAREGE PARAMTYPE PASCAL (cMsg AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_NumeroSerieMFD 							 					LOCALNAME IB_NUMSEMF PARAMTYPE PASCAL (cNserie AS PCHAR) AS INTEGER LIB "/ibmfi32.so"   
	DLL FUNCTION IBM_FI_VersaoFirmwareMFD 						  					LOCALNAME IB_VEFIRMF PARAMTYPE PASCAL (cFrmWare AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_InscricaoMunicipalMFD 					 					LOCALNAME IB_INSMUNI PARAMTYPE PASCAL (cInsMun AS PCHAR) AS INTEGER LIB "/ibmfi32.so"   
	DLL FUNCTION IBM_FI_ContadoresTotalizadoresNaoFiscaisMFD 						LOCALNAME IB_TOTNFIS PARAMTYPE PASCAL (cContador AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VerificaTotalizadoresNaoFiscaisMFD   						LOCALNAME IB_VETONFM PARAMTYPE PASCAL (cNFiscal AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_VerificaFormasPagamentoMFD 			  						LOCALNAME IB_VEFPGMF PARAMTYPE PASCAL (cForma AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_VerificaRelatorioGerencialMFD 		 						LOCALNAME IB_VERGEMF PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "/ibmfi32.so"  
	DLL FUNCTION IBM_FI_ContadorComprovantesCreditoMFD 		  						LOCALNAME IB_CCOMPMF PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_ContadorRelatoriosGerenciaisMFD 	  						LOCALNAME IB_CORNGMF PARAMTYPE PASCAL (cNumcup AS PCHAR) AS INTEGER LIB "/ibmfi32.so"              
	DLL FUNCTION IBM_FI_VerificaTotalizadoresParciaisMFD 							LOCALNAME IB_TOTPARM PARAMTYPE PASCAL (cDados AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_DadosUltimaReducaoMFD 					 					LOCALNAME IB_DTULREM PARAMTYPE PASCAL (cReduc AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalDataMFD 			 					LOCALNAME IB_LERMEDT PARAMTYPE PASCAL (cDtInicio AS PCHAR,cDtFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalReducaoMFD 		 						LOCALNAME IB_LERMERE PARAMTYPE PASCAL (cDtInicio AS PCHAR,cDtFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalSerialDataMFD 	  						LOCALNAME IB_LERMESE PARAMTYPE PASCAL (cDtInicio AS PCHAR,cDtFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "/ibmfi32.so"   
	DLL FUNCTION IBM_FI_LeituraMemoriaFiscalSerialReducaoMFD 						LOCALNAME IB_LERMERM PARAMTYPE PASCAL (cRedInicio AS PCHAR,cRedFim AS PCHAR,cFlag AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_LeituraChequeMFD 						 		 			LOCALNAME IB_LECHMFD PARAMTYPE PASCAL (cCMC7 As PCHAR) AS INTEGER LIB "/ibmfi32.so"   
	DLL FUNCTION IBM_FI_ImprimeChequeMFD 						  		 			LOCALNAME IB_IMCHMFD PARAMTYPE PASCAL (cBanco As PCHAR, cValor As PCHAR, cFavorec As PCHAR, cCidade As PCHAR, cData As PCHAR, cMsg As PCHAR, cImpVer As PCHAR, cLinhas As PCHAR) AS INTEGER LIB "/ibmfi32.so"   
	DLL FUNCTION IBM_FI_HabilitaDesabilitaRetornoEstendidoMFD 						LOCALNAME IB_HDRETMF PARAMTYPE PASCAL (cFlag AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_RetornoImpressoraMFD 				  						LOCALNAME IB_RETIMPR PARAMTYPE PASCAL (piACK AS PINTEGER, piST1 AS PINTEGER, piST2 AS PINTEGER, piST3 AS PINTEGER) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_SubTotalizaCupomMFD 										LOCALNAME IB_SUBTOTM PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"    
	DLL FUNCTION IBM_FI_TotalizaRecebimentoMFD 										LOCALNAME IB_TOTRECM PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so" 	
	DLL FUNCTION IBM_FI_IniciaFechamentoCupomMFD 									LOCALNAME IB_INICPMF PARAMTYPE PASCAL (cAcre AS PCHAR, cTpAcre AS PCHAR, cValAcre AS PCHAR, cValDesc AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_SubTotalizaRecebimentoMFD 			 						LOCALNAME IB_SUTTRMF PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_AcrescimoDescontoSubtotalRecebimentoMFD 		   			LOCALNAME IB_ACTOMFD PARAMTYPE PASCAL () AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_AcrescimoDescontoSubtotalMFD 								LOCALNAME IB_ACSUBMF PARAMTYPE PASCAL (cFlag AS PCHAR, cTipo AS PCHAR, cValor AS PCHAR) AS INTEGER LIB "/ibmfi32.so"     
	DLL FUNCTION IBM_FI_VerificaEstadoImpressoraMFD 			 					LOCALNAME IB_VERIMPM PARAMTYPE PASCAL (piACK AS PINTEGER, piST1 AS PINTEGER, piST2 AS PINTEGER, piST3 AS PINTEGER) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_TerminaFechamentoCupom 				 	 					LOCALNAME IB_TEMFCPM PARAMTYPE PASCAL (cMsgPro AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_DownloadMF 							 						LOCALNAME IB_DOWNLMF PARAMTYPE PASCAL (cArquivo AS PCHAR) AS INTEGER LIB "/ibmfi32.so"   
	DLL FUNCTION IBM_FI_DownloadMFD 												LOCALNAME IB_DOWNMFD PARAMTYPE PASCAL (cArquivo AS PCHAR, cTipo AS PCHAR, cPar1 AS PCHAR, cPar2 AS PCHAR, cUser AS PCHAR) AS INTEGER LIB "/ibmfi32.so"    
	DLL FUNCTION IBM_FI_FormatoDadosMFD 						  					LOCALNAME IB_FOMDAMF PARAMTYPE PASCAL (cArqOri AS PCHAR, cArqDes AS PCHAR, cTPDado AS PCHAR, cTipo AS PCHAR, cPar1 AS PCHAR, cPar2 AS PCHAR, cUser AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_VerificaEstadoImpressora 									LOCALNAME IB_ESTIMPR PARAMTYPE PASCAL (piACK AS PINTEGER, piST1 AS PINTEGER, piST2 AS PINTEGER ) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_AberturaDoDia 							 					LOCALNAME IB_ABREDIA PARAMTYPE PASCAL (cValor AS PCHAR, cFpagto AS PCHAR) AS INTEGER LIB "/ibmfi32.so"  
	DLL FUNCTION IBM_FI_DataHoraSoftwareBasico                 						LOCALNAME IB_SWUSRMF PARAMTYPE PASCAL (cData AS PCHAR, cHora AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_GeraAtoCotepe1704                                           LOCALNAME IB_CT1704  PARAMTYPE PASCAL ( cTpGer AS PCHAR, cParamIni AS PCHAR, cParamFim AS PCHAR, cArqDes AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION GeraRegistrosTipoE                                               	LOCALNAME IB_RGEMF PARAMTYPE PASCAL (cArqOri AS PCHAR, cArqDes AS PCHAR, cDataIni AS PCHAR,cDataFim AS PCHAR, cNome As PCHAR, cEnd AS PCHAR, cParam1 AS PCHAR, cCMD AS PCHAR,  cParam2 AS PCHAR,  cParam3 AS PCHAR,  cParam4 AS PCHAR,  cParam5 AS PCHAR,  cParam6 AS PCHAR,  cParam7 AS PCHAR,  cParam8 AS PCHAR,  cParam9 AS PCHAR,  cParam10 AS PCHAR,  cParam11 AS PCHAR,  cParam12 AS PCHAR,  cParam13 AS PCHAR,  cParam14 AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
	DLL FUNCTION IBM_FI_VerificaZPendente                                           LOCALNAME IB_REDZPEN PARAMTYPE PASCAL (nValor AS PINTEGER) AS INTEGER LIB "/ibmfi32.so"	   
	
	//CONFIGURACAO DO CODIGO DE BARRAS - NOVO
	DLL FUNCTION IBM_FI_ConfiguraCodigoBarrasMFD 									LOCALNAME IB_CONCODB PARAMTYPE PASCAL (piAlt AS INTEGER, piLar AS INTEGER, piPos AS INTEGER, piFon AS INTEGER, piMar AS INTEGER) AS INTEGER LIB "/ibmfi32.so" 
	
	//IMPRESSAO DO CODIGO DE BARRAS - NOVO
	DLL FUNCTION IBM_FI_CodigoBarrasCODE128MFD 										LOCALNAME IB_E128MFD PARAMTYPE PASCAL (cString AS PCHAR) AS INTEGER LIB "/ibmfi32.so" 
	DLL FUNCTION IBM_FI_CodigoBarrasITFMFD 	

   DLL FUNCTION IBM_FI_RetornoImpressoraPadraoIBM                                  LOCALNAME IB_ERRO PARAMTYPE PASCAL (nErro AS PINTEGER, cMsg AS PCHAR) AS INTEGER LIB "/ibmfi32.so"
#ENDIF

Function IBM(cFunction, aParams, cDelimit, cFimStr)
    
	Local oRet		:= Nil						//Retorno da dll
	Local cBuffer 	:= ""                   //Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""                   //Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local cParam4	:= ""							//Variavel auxiliar
	Local cParam5	:= ""							//Variavel auxiliar
	Local cParam6	:= ""							//Variavel auxiliar
	Local cParam7	:= ""							//Variavel auxiliar
	Local cParam8	:= ""							//Variavel auxiliar
	Local cParam9	:= ""							//Variavel auxiliar
	Local cParam10	:= ""							//Variavel auxiliar
	Local cParam11	:= ""							//Variavel auxiliar
	Local cParam12	:= ""							//Variavel auxiliar
	Local cParam13  := ""						//Variavel auxiliar
	Local cParam14	:= ""							//Variavel auxiliar
	Local cParam15	:= ""							//Variavel auxiliar   
	Local cParam16	:= ""							//Variavel auxiliar
	Local cParam17	:= ""							//Variavel auxiliar
	Local cParam18	:= ""							//Variavel auxiliar
	Local cParam19  := ""						//Variavel auxiliar
	Local cParam20	:= ""							//Variavel auxiliar
	Local cParam21	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2 	:= 0							//Variavel auxiliar
	Local nParam3 	:= 0							//Variavel auxiliar
	Local nParam4 	:= 0 							//Variavel auxiliar
	Local nParam5 	:= 0							//Variavel auxiliar
	Local nParam6 	:= 0							//Variavel auxiliar
	
	
	
	//Executa o comando selecionado
	Do Case
		
		Case cFunction == Upper("IBM_FI_AbrePortaSerial")
			oRet := IB_ABRESER()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
			
		Case cFunction == Upper("IBM_FI_FechaPortaSerial")
	   		oRet := IB_FECHSER()
	   		cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
	
		Case cFunction == Upper("IBM_FI_AbreCupomMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			oRet := IB_ABRECFT(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_CancelaCupomMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			oRet := IB_CANCCFT(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	 
			
		Case cFunction == Upper("IBM_FI_CancelaCupom")
			oRet := IB_CANCECF()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	
			
		Case cFunction == Upper("IBM_FI_VendeItem")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			nParam1 := val(aParams[8])
			cParam6 := DoEncode(aParams[9])
			cParam7 := DoEncode(aParams[10])		
			cParam8 := DoEncode(aParams[11]) 
			oRet := IB_VENITEM(cParam1,cParam2,cParam3,cParam4,cParam5,nParam1,cParam6,cParam7,cParam8) 
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)   
			
		Case cFunction == Upper("IBM_FI_CancelaItemGenerico")
			cParam1 := DoEncode(aParams[3])				
			oRet := IB_CANITGE(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_AcrescimoDescontoSubtotalMFD") /* Method AcresTotal - Muda parametro D-A*/
			cParam1 := DoEncode(aParams[3])				
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			oRet := IB_ACSUBMF(cParam1, cParam2, cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_AcrescimoDescontoItemMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])		
			oRet := IB_ACDEITT(cParam1,cParam2,cParam3,cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
		 
		Case cFunction == Upper("IBM_FI_EfetuaFormaPagamentoMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])		
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			oRet := IB_EFFORPG(cParam1,cParam2,cParam3,cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_FechaCupom")		
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])		
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			oRet :=	IB_FECHACF(cParam1,cParam2,cParam3,cParam4,cParam5,cParam6)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
			
		Case cFunction == Upper("IBM_FI_AbreComprovanteNaoFiscalVinculadoMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])		
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			oRet := IB_ABCPNFV(cParam1,cParam2,cParam3,cParam4,cParam5,cParam6)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_FechaComprovanteNaoFiscalVinculado")
			oRet := IB_FCHCNFV()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_AbreRecebimentoNaoFiscalMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			oRet := IB_ABRECNF(cParam1,cParam2,cParam3)  
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_FechaRecebimentoNaoFiscalMFD")
			cParam1 := DoEncode(aParams[3])
			oRet := IB_FECECFT(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_AbreRelatorioGerencialMFD")
			cParam1 := DoEncode(aParams[3])	
			oRet := IB_ABRREGE(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_FechaRelatorioGerencial")
			oRet := IB_FECHARG()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)     
			
		Case cFunction == Upper("IBM_FI_Sangria")
			cParam1 := DoEncode(aParams[3])	
			oRet := IB_SANGRIA(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)		
		
		Case cFunction == Upper("IBM_FI_Suprimento")
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])
			oRet := IB_SUPRIME(cParam1,cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_LeituraX")
			oRet := IB_LEITURX()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)                          
		
		Case cFunction == Upper("IBM_FI_ReducaoZ")		
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])			
			oRet := IB_REDUCAZ(cParam1,cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
					
		Case cFunction == Upper("IBM_FI_AberturaDoDia")  
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])			
			oRet := IB_ABREDIA(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)			
			
		Case cFunction == Upper("IBM_FI_LeituraMemoriaFiscalDataMFD")		
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])	
			cParam3 := DoEncode(aParams[5])
			oRet := IB_LERMEDT(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cDelimit + DoDecode(cParam2) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_LeituraMemoriaFiscalReducaoMFD")		
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])	
			cParam3 := DoEncode(aParams[5])
			oRet := IB_LERMERE(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
					
		Case cFunction == Upper("IBM_FI_LeituraMemoriaFiscalSerialDataMFD")		
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])	
			cParam3 := DoEncode(aParams[5])
			oRet := IB_LERMESE(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet))  + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_LeituraMemoriaFiscalSerialReducaoMFD")				
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])	
			cParam3 := DoEncode(aParams[5])  

			oRet := IB_LERMERM(cParam1,cParam2, cParam3) 
			cBuffer := AllTrim(Str(oRet))  + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_AutenticacaoMFD")		
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])	
			oRet := IB_AUTEMFD(cParam1,cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)		
			
		Case cFunction == Upper("IBM_FI_ProgramaFormaPagamentoMFD")		
			cParam1 := DoEncode(aParams[3])	
			cParam2 := DoEncode(aParams[4])			
			oRet := IB_PROFPGT(cParam1,cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_ContadoresTotalizadoresNaoFiscaisMFD")			
			cParam1 := DoEncode(aParams[3])	
			oRet := IB_TOTNFIS(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	
			
		Case cFunction == Upper("IBM_FI_ProgramaAliquota")		
			cParam1 := DoEncode(aParams[3])	
			nParam1 := Val(aParams[4])
			oRet := IB_PROGALI(cParam1,nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_ProgramaHorarioVerao")		
			oRet := IB_PROGHOV()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_UsaRelatorioGerencialMFD")		
			cParam1 := DoEncode(aParams[3])	
			oRet := IB_USAREGE(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	  
		
		Case cFunction == Upper("IBM_FI_AcionaGaveta")
			oRet := IB_ABREGAV()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	 
			
		Case cFunction == Upper("IBM_FI_RetornoImpressoraMFD") 
			nParam1 := val(aParams[3])	
			nParam2 := val(aParams[4])	                       
			nParam3 := val(aParams[5])	
			nParam4 := val(aParams[6])	 
			oRet := IB_RETIMPR(nParam1, nParam2, nParam3, nParam4)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cDelimit + AllTrim(Str(nParam2)) + cDelimit + AllTrim(Str(nParam3)) + cDelimit + AllTrim(Str(nParam4)) + cFimStr//Chr(2)		                              
		
		Case cFunction == Upper("IBM_FI_HabilitaDesabilitaRetornoEstendidoMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_HDRETMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)		                              		
		  
		Case cFunction == Upper("IBM_FI_NumeroSerieMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_NUMSEMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)  
			
		Case cFunction == Upper("IBM_FI_CNPJ_IE") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	:= IB_NUCGCIE(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cDelimit + DoDecode(cParam2) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_ModeloImpressora") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_MODEIMP(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_VersaoFirmwareMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_VEFIRMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 

		Case cFunction == Upper("IBM_FI_ClicheProprietario") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_CLIPROP(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	 
			
		Case cFunction == Upper("IBM_FI_InscricaoMunicipalMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_INSMUNI(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	

		Case cFunction == Upper("IBM_FI_NumeroLoja") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_NUMLOJA(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
		
		Case cFunction == Upper("IBM_FI_NumeroCaixa") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_NUMCAIX(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_RetornoAliquotas") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_RETALIQ(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_VerificaTotalizadoresParciaisMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_TOTPARM(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_UsaComprovanteNaoFiscalVinculado") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_USACNFV(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
		
	 	Case cFunction == Upper("IBM_FI_FlagsFiscais") 
			nParam1 := val(aParams[3])
			oRet 	:= IB_FLAGFIS(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cFimStr//Chr(2)		                              
			
		Case cFunction == Upper("IBM_FI_UltimoItemVendido") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_ULITVEN(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	
			
		Case cFunction == Upper("IBM_FI_SubTotal") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_SUBTOTA(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	  
			
		Case cFunction == Upper("IBM_FI_DataHoraImpressora") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	:= IB_DTHRIMP(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cDelimit + DoDecode(cParam2) + cFimStr//Chr(2) 
	    
    	Case cFunction == Upper("IBM_FI_DadosUltimaReducaoMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_DTULREM(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	 
	                                                                                             
		Case cFunction == Upper("IBM_FI_NumeroReducoes") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_NUMREDU(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	 
        
		Case cFunction == Upper("IBM_FI_NumeroCuponsCancelados") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_NCPCANC(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	          

		Case cFunction == Upper("IBM_FI_VerificaTotalizadoresNaoFiscaisMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_VETONFM(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	          

		Case cFunction == Upper("IBM_FI_VerificaRelatorioGerencialMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_VERGEMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	          
		  
		Case cFunction == Upper("IBM_FI_VerificaFormasPagamentoMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_VEFPGMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)	          		
		
		Case cFunction == Upper("IBM_FI_GrandeTotal") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_GRATOTA(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_InicioFimCOOsMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	:= IB_INIFIMC(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cDelimit + DoDecode(cParam2) + cFimStr//Chr(2)		
	   
		Case cFunction == Upper("IBM_FI_VendaBruta") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_VNDBRUT(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)			
					
	   Case cFunction == Upper("IBM_FI_VerificaEstadoGaveta") 
			nParam1 := val(aParams[3])
			oRet 	:= IB_VESTGAV(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_VerificaEstadoImpressora") 
			nParam1 := val(aParams[3])
			nParam2 := val(aParams[4])
			nParam3 := val(aParams[5])
			oRet 	:= IB_ESTIMPR(nParam1, nParam2, nParam3)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cDelimit + AllTrim(Str(nParam2)) + cDelimit + AllTrim(Str(nParam3)) + cFimStr//Chr(2)
			
		Case cFunction == Upper("IBM_FI_StatusEstendidoMFD") 
			nParam1 := val(aParams[3])
			oRet 	:= IB_STAESTE(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cFimStr//Chr(2)
		
		Case cFunction == Upper("IBM_FI_VerificaModoOperacao") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_VERMOOP(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)		
	   
		Case cFunction == Upper("IBM_FI_VerificaEstadoImpressoraMFD") 
			nParam1 := val(aParams[3])	
			nParam2 := val(aParams[4])	                                          
			nParam3 := val(aParams[5])	
			nParam4 := val(aParams[6])	 
			oRet := IB_VERIMPM(nParam1, nParam2, nParam3, nParam4)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cDelimit + AllTrim(Str(nParam2)) + cDelimit + AllTrim(Str(nParam3)) + cDelimit + AllTrim(Str(nParam4)) + cFimStr//Chr(2)		                              		
        
		Case cFunction == Upper("IBM_FI_DataMovimento") 
			cParam1 := DoEncode(aParams[3])
			oRet 	:= IB_DTHMOVI(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)			
		
		Case cFunction == Upper("IBM_FI_ConfiguraCodigoBarrasMFD") 
			nParam1 := val(aParams[3])
			nParam2 := val(aParams[4])
			nParam3 := val(aParams[5])
			nParam4 := val(aParams[6])
			nParam5 := val(aParams[7])
			oRet 	  := IB_CONCODB(nParam1, nParam2, nParam3, nParam4, nParam5)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_CodigoBarrasCODE128MFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_E128MFD(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	

		Case cFunction == Upper("IBM_FI_VerificaAliquotasIss") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_VERALIQ(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	 
	
		Case cFunction == Upper("IBM_FI_VerificaIndiceAliquotasIss") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_VERALII(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	 
	   
	   Case cFunction == Upper("IBM_FI_TerminaFechamentoCupom") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_TEMFCPM(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	
	  
	   Case cFunction == Upper("IBM_FI_IniciaFechamentoCupomMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			oRet 	  := IB_INICPMF(cParam1, cParam2, cParam3, cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)
	  
	 	Case cFunction == Upper("IBM_FI_SubTotalizaCupomMFD") 
			oRet 	  := IB_SUBTOTM()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	 
			
		Case cFunction == Upper("IBM_FI_NomeiaRelatorioGerencialMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	  := IB_NOREGER(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	 
			
	 	Case cFunction == Upper("IBM_FI_EfetuaFormaPagamentoIndiceMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])		
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			oRet := IB_EFFORPG(cParam1,cParam2,cParam3,cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)    
			
		Case cFunction == Upper("IBM_FI_NumeroCupom") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_NUMCUPO(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	 
   
  	 	Case cFunction == Upper("IBM_FI_CancelaRecebimentoNaoFiscalMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])		
			cParam3 := DoEncode(aParams[5])
			oRet := IB_CANRECN(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)    

	 	Case cFunction == Upper("IBM_FI_CodigoBarrasITFMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet := IB_CITFMFD(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 

		Case cFunction == Upper("IBM_FI_NomeiaTotalizadorNaoSujeitoIcms") 
			nParam1 := val(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet := IB_NOMETOT(nParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)   

		Case cFunction == Upper("IBM_FI_AtivaDesativaGuilhotinaMFD") 
			nParam1 := val(aParams[3])
			oRet := IB_HABGUIL(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 

		Case cFunction == Upper("IBM_FI_AcionaGuilhotinaMFD") 
			nParam1 := val(aParams[3])
			oRet := IB_ACIOGUI(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 

 		Case cFunction == Upper("IBM_FI_DownloadMF") 
			cParam1 := DoEncode(aParams[3])
			oRet := IB_DOWNLMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 
			
 		Case cFunction == Upper("IBM_FI_DownloadMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			oRet := IB_DOWNMFD(cParam1, cParam2, cParam3, cParam4, cParam5)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2) 

		Case cFunction == Upper("IBM_FI_FormatoDadosMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])                                          
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])       
			oRet := IB_FOMDAMF(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)   
			
		Case cFunction == Upper("IBM_FI_NumeroIntervencoes") 
			cParam1 := DoEncode(aParams[3])
			oRet := IB_NUMINTE(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_TotalizaRecebimentoMFD") 
			oRet := IB_TOTRECM()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)      

		Case cFunction == Upper("IBM_FI_SubTotalizaRecebimentoMFD") 
			oRet := IB_SUTTRMF()
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)      
		
		Case cFunction == Upper("IBM_FI_EfetuaRecebimentoNaoFiscalMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet := IB_RECNFIM(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	
		
		Case cFunction == Upper("IBM_FI_IniciaFechamentoRecebimentoNaoFiscalMFD") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			oRet := IB_INFERCN(cParam1, cParam2, cParam3, cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)		
		

      Case cFunction == Upper("IBM_FI_LeituraChequeMFD") 
	
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_LECHMFD(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 	
		Case cFunction == Upper("IBM_FI_ImprimeChequeMFD")   
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10])
			oRet := IB_IMCHMFD(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8)
		    cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	             
		    
		Case cFunction == Upper("IBM_FI_NumeroOperacoesNaoFiscais") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_NOPENFI(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
			
		Case cFunction == Upper("IBM_FI_ContadorRelatoriosGerenciaisMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_CORNGMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2) 
			
			Case cFunction == Upper("IBM_FI_ContadorComprovantesCreditoMFD") 
			cParam1 := DoEncode(aParams[3])
			oRet 	  := IB_CCOMPMF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cFimStr//Chr(2)   
			
		Case cFunction == Upper("IBM_FI_VendeItemDepartamento")   
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10]) 
			cParam9 := DoEncode(aParams[11])
			oRet := IB_VENITDP(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8, cParam9)
		    cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)	    
	
		Case cFunction == Upper("IBM_FI_DataHoraSoftwareBasico")   
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])

			oRet := IB_SWUSRMF(cParam1, cParam2)   
			
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) +  cDelimit + DoDecode(cParam2) + cFimStr//Chr(2)
		
		
		Case cFunction == Upper("GeraRegistrosTipoE")       
		
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10]) 
			cParam9 := DoEncode(aParams[11])
			cParam10 := DoEncode(aParams[12])
			cParam11 := DoEncode(aParams[13])
			cParam12 := DoEncode(aParams[14])
			cParam13 := DoEncode(aParams[15])
			cParam14 := DoEncode(aParams[16])
			cParam15 := DoEncode(aParams[17])
			cParam16 := DoEncode(aParams[18])
			cParam17 := DoEncode(aParams[19]) 
			cParam18 := DoEncode(aParams[20])
			cParam19 := DoEncode(aParams[21])
			cParam20 := DoEncode(aParams[22])
			cParam21 := DoEncode(aParams[23])		
			oRet := IB_RGEMF(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8, cParam9, cParam10, cParam11, cParam12, cParam13, cParam14, cParam15, cParam16, cParam17, cParam18, cParam19, cParam20, cParam21 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_GeraAtoCotepe1704") 
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])

			oRet := IB_CT1704(cParam1, cParam2, cParam3, cParam4 )
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam4) + cFimStr//Chr(2)

		
		Case cFunction == Upper("IBM_FI_RetornoImpressoraPadraoIBM")   
			nParam1 := Val(aParams[3])
			cParam2 := DoEncode(aParams[4])

			oRet := IB_ERRO(nParam1, cParam2)   
			
			cBuffer := AllTrim(Str(oRet)) + cDelimit + Str(nParam1) +  cDelimit + DoDecode(cParam2) + cFimStr//Chr(2)

		Case cFunction == Upper("IBM_FI_VerificaZPendente")  
			nParam1 := val(aParams[3])
			oRet := IB_REDZPEN(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + AllTrim(Str(nParam1)) + cFimStr//Chr(2)
			
		Case cFunction == Upper("IBM_FI_EstornoNaoFiscalVinculadoMFD")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])		
			cParam3 := DoEncode(aParams[5])

			oRet := IB_ENFIVIN(cParam1,cParam2,cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
				
		Otherwise		
			cBuffer := "Function not found in IBMInterface.DLL or IBMFI32.DLL -> "+ cFunction
			MsgStop(cBuffer, "Library IBMInterface")
	
	EndCase
	
Return cBuffer                                                   
