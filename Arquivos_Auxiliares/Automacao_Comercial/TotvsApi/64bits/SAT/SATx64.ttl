
DLL FUNCTION ConsultarSAT LOCALNAME SAT_CONSU PARAMTYPE PASCAL ( numeroSessao As Integer ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION EnviarDadosVenda LOCALNAME SAT_ENVIA PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosVenda As PChar) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ExtrairLogs LOCALNAME SAT_EXTRAI PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION AtualizarSoftwareSAT LOCALNAME SAT_ATUALI PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION AtivarSAT LOCALNAME SAT_ATIVAR PARAMTYPE PASCAL ( numeroSessao As Integer , subComando As Integer , codigoDeAtivacao As PChar , CNPJ As PChar , cUF As Integer ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION TrocarCodigoDeAtivacao LOCALNAME SAT_TROCAR PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , opcao As Integer , novoCodigo As PChar , confNovoCodigo As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConsultarStatusOperacional LOCALNAME SAT_STATUS PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION TesteFimAFim LOCALNAME SAT_FIMAFIM PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosVenda As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION BloquearSAT LOCALNAME SAT_BLOQUE PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION DesbloquearSAT LOCALNAME SAT_DESBLOQ PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConsultarNumeroSessao LOCALNAME SAT_NUMSES PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , cNumeroDeSessao As Integer) As PCHAR LIB "dllsat.dll"

DLL FUNCTION DesligarSAT LOCALNAME SAT_DESLIG PARAMTYPE PASCAL () As PCHAR LIB "dllsat.dll"

DLL FUNCTION AssociarAssinatura LOCALNAME SAT_ASSINA PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , CNPJvalue As PChar , assinaturaCNPJs As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION CancelarUltimaVenda LOCALNAME SAT_CANCEL PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , chave As PChar , dadosCancelamento As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ComunicarCertificadoICPBRASIL LOCALNAME SAT_ICPBRA PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , certificado As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConfigurarInterfaceDeRede LOCALNAME SAT_REDE PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosConfiguracao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConfigurarInterfaceDeRedeMFE LOCALNAME SAT_REDEMFE PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosConfiguracao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConsultarStatusOperacionalMFE LOCALNAME SAT_STAMFE PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION EnviarStatusAC LOCALNAME SAT_ENVSTATUSAC PARAMTYPE PASCAL ( numeroSessao As Integer , codigoDeAtivacao As PChar, descricaoFornecedor As PChar, versaoAC As PChar ) As PCHAR LIB "dllsat.dll"

//FUNCOES EMULADOR SAT

DLL FUNCTION ConsultarSAT LOCALNAME ESAT_CONS PARAMTYPE CSTD ( numeroSessao As Integer ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION EnviarDadosVenda LOCALNAME ESAT_ENVIA PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosVenda As PChar) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ExtrairLogs LOCALNAME ESAT_EXTRA PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION AtualizarSoftwareSAT LOCALNAME ESAT_ATUAL PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION AtivarSAT LOCALNAME ESAT_ATIVA PARAMTYPE CSTD ( numeroSessao As Integer , subComando As Integer , codigoDeAtivacao As PChar , CNPJ As PChar , cUF As Integer ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION TrocarCodigoDeAtivacao LOCALNAME ESAT_TROCA PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , opcao As Integer , novoCodigo As PChar , confNovoCodigo As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConsultarStatusOperacional LOCALNAME ESAT_STATU PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION TesteFimAFim LOCALNAME ESAT_FIMAFI PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosVenda As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION BloquearSAT LOCALNAME ESAT_BLOQU PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION DesbloquearSAT LOCALNAME ESAT_DESBLO PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConsultarNumeroSessao LOCALNAME ESAT_NUMSE PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , cNumeroDeSessao As Integer) As PCHAR LIB "dllsat.dll"

DLL FUNCTION DesligarSAT LOCALNAME ESAT_DESLI PARAMTYPE CSTD () As PCHAR LIB "dllsat.dll"

DLL FUNCTION AssociarAssinatura LOCALNAME ESAT_ASSIN PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , CNPJvalue As PChar , assinaturaCNPJs As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION CancelarUltimaVenda LOCALNAME ESAT_CANCE PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , chave As PChar , dadosCancelamento As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ComunicarCertificadoICPBRASIL LOCALNAME ESAT_ICPBR PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , certificado As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConfigurarInterfaceDeRede LOCALNAME ESAT_REDE PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosConfiguracao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConfigurarInterfaceDeRedeMFE LOCALNAME ESAT_REDEMFE PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar , dadosConfiguracao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION ConsultarStatusOperacionalMFE LOCALNAME ESAT_STMFE PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar ) As PCHAR LIB "dllsat.dll"

DLL FUNCTION EnviarStatusAC LOCALNAME ESAT_ENVSTATSAC PARAMTYPE CSTD ( numeroSessao As Integer , codigoDeAtivacao As PChar, descricaoFornecedor As PChar, versaoAC As PChar ) As PCHAR LIB "dllsat.dll"


Function SAT(cFunction, aParams, cDelimit, cFimStr)
    
	Local oRet		:= Nil							//Retorno da dll
	Local cBuffer 	:= ""                       	//Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""							//Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2	:= 0							//Variável auxiliar
	Local nParam3	:= 0							//Variavel auxiliar
	
	//Executa o comando selecionado
	Do Case
	
		Case cFunction == Upper("ConsultarSAT")

			nParam1 := Val(aParams[3])
			oRet 	:= SAT_CONSU(nParam1)
			cBuffer := AllTrim(oRet) + cFimStr

		Case cFunction == Upper("EnviarDadosVenda")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2	:= DoEncode(aParams[5])
			oRet 	:= SAT_ENVIA(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr	

		Case cFunction == Upper("ExtrairLogs")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= SAT_EXTRAI(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("AtualizarSoftwareSAT")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= SAT_ATUALI(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("AtivarSAT")

			nParam1 := Val(aParams[3])
			nParam2	:= Val(aParams[4])
			cParam1	:= DoEncode(aParams[5])
			cParam2	:= DoEncode(aParams[6])
			nParam3	:= Val(aParams[7])
			oRet 	:= SAT_ATIVAR(nParam1,nParam2,cParam1,cParam2,nParam3)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("TrocarCodigoDeAtivacao")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			nParam2	:= Val(aParams[5])
			cParam2	:= DoEncode(aParams[6])
			cParam3	:= DoEncode(aParams[7])
			oRet 	:= SAT_TROCAR(nParam1,cParam1,nParam2,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr
					
		Case cFunction == Upper("ConsultarStatusOperacional")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= SAT_STATUS(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr		
	
		Case cFunction == Upper("TesteFimAFim")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2	:= DoEncode(aParams[5])
			oRet 	:= SAT_FIMAFIM(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("BloquearSAT")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= SAT_BLOQUE(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("DesbloquearSAT")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= SAT_DESBLOQ(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("ConsultarNumeroSessao")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			nParam2 := Val(aParams[5])
			oRet 	:= SAT_NUMSES(nParam1,cParam1,nParam2)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("DesligarSAT")

			oRet 	:= SAT_DESLIG()
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("AssociarAssinatura")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			oRet 	:= SAT_ASSINA(nParam1,cParam1,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("CancelarUltimaVenda")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			oRet 	:= SAT_CANCEL(nParam1,cParam1,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("ComunicarCertificadoICPBRASIL")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			oRet 	:= SAT_ICPBRA(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("ConfigurarInterfaceDeRede")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			oRet 	:= SAT_REDE(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr

		Case cFunction == Upper("ConsultarStatusOperacionalMFE")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= SAT_STAMFE(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr				
			
		Case cFunction == Upper("ConfigurarInterfaceDeRedeMFE")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			oRet 	:= SAT_REDEMFE(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr	

		Case cFunction == Upper("EnviarStatusAC")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			oRet 	:= SAT_ENVSTATUSAC(nParam1,cParam1,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr			
			
		Case cFunction == Upper("EML_ConsultarSAT")

			nParam1 := Val(aParams[3])
			oRet 	:= ESAT_CONS(nParam1)
			cBuffer := AllTrim(oRet) + cFimStr

		Case cFunction == Upper("EML_EnviarDadosVenda")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2	:= DoEncode(aParams[5])
			oRet 	:= ESAT_ENVIA(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr	

		Case cFunction == Upper("EML_ExtrairLogs")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= ESAT_EXTRA(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_AtualizarSoftwareSAT")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= ESAT_ATUAL(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_AtivarSAT")

			nParam1 := Val(aParams[3])
			nParam2	:= Val(aParams[4])
			cParam1	:= DoEncode(aParams[5])
			cParam2	:= DoEncode(aParams[6])
			nParam3	:= Val(aParams[7])
			oRet 	:= ESAT_ATIVA(nParam1,nParam2,cParam1,cParam2,nParam3)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_TrocarCodigoDeAtivacao")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			nParam2	:= Val(aParams[5])
			cParam2	:= DoEncode(aParams[6])
			cParam3	:= DoEncode(aParams[7])
			oRet 	:= ESAT_TROCA(nParam1,cParam1,nParam2,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr
					
		Case cFunction == Upper("EML_ConsultarStatusOperacional")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= ESAT_STATU(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_TesteFimAFim")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2	:= DoEncode(aParams[5])
			oRet 	:= ESAT_FIMAFI(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_BloquearSAT")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= ESAT_BLOQU(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_DesbloquearSAT")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= ESAT_DESBLO(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_ConsultarNumeroSessao")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			nParam2 := Val(aParams[5])
			oRet 	:= ESAT_NUMSE(nParam1,cParam1,nParam2)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_DesligarSAT")

			oRet 	:= ESAT_DESLI()
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_AssociarAssinatura")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			oRet 	:= ESAT_ASSIN(nParam1,cParam1,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_CancelarUltimaVenda")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			oRet 	:= ESAT_CANCE(nParam1,cParam1,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_ComunicarCertificadoICPBRASIL")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			oRet 	:= ESAT_ICPBR(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr
			
		Case cFunction == Upper("EML_ConfigurarInterfaceDeRede")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			oRet 	:= ESAT_REDE(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr

		Case cFunction == Upper("EML_ConfigurarInterfaceDeRedeMFE")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			oRet 	:= ESAT_REDEMFE(nParam1,cParam1,cParam2)
			cBuffer := AllTrim(oRet) + cFimStr	

		Case cFunction == Upper("EML_EnviarStatusAC")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			oRet 	:= ESAT_ENVSTATSAC(nParam1,cParam1,cParam2,cParam3)
			cBuffer := AllTrim(oRet) + cFimStr				

		Case cFunction == Upper("EML_ConsultarStatusOperacionalMFE")

			nParam1 := Val(aParams[3])
			cParam1	:= DoEncode(aParams[4])
			oRet 	:= ESAT_STMFE(nParam1,cParam1)
			cBuffer := AllTrim(oRet) + cFimStr				
			
		Otherwise
			cBuffer := "Function not found in dllsat.dll-> "+ cFunction
			MsgStop(cBuffer, "Library SAT")

	EndCase
	
Return cBuffer

