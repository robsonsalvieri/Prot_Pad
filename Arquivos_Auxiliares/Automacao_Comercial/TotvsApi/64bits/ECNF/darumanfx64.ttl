DLL FUNCTION regPortaComunicacao_DUAL_DarumaFramework 	LOCALNAME DRNF_REGPORTA 	PARAMTYPE PASCAL (stParametro AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION regVelocidade_DUAL_DarumaFramework 	LOCALNAME DRNF_VELO 		PARAMTYPE PASCAL (stParametro AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION rStatusImpressora_DUAL_DarumaFramework  	LOCALNAME DRNF_STATUS   	PARAMTYPE PASCAL () AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION iImprimirTexto_DUAL_DarumaFramework   	LOCALNAME DRNF_TEXTO   		PARAMTYPE PASCAL (stTexto AS PCHAR, iTam As Integer ) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION iAcionarGaveta_DUAL_DarumaFramework	LOCALNAME DRNF_ABRGVT		PARAMTYPE PASCAL () AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION iImprimirBMP_DUAL_DarumaFramework		LOCALNAME DRNF_IMPBMP		PARAMTYPE PASCAL (stArqOrigem as PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
//metodos de confifuracao de registro
DLL FUNCTION regAlterarValor_Daruma			LOCALNAME DRNF_RGAVL		PARAMTYPE PASCAL (sPathChave AS PCHAR, sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll' 
DLL FUNCTION regRetornaValorChave			LOCALNAME DRNF_RGRVL		PARAMTYPE PASCAL (sProduto AS PCHAR, sChave AS PCHAR, sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
//Métodos de Contingencia OffLine	
DLL FUNCTION tCFCancelarOffline_NFCe_Daruma		LOCALNAME DNFCE_CNOF		PARAMTYPE PASCAL (sNNF AS PCHAR, sNSerie AS PCHAR, sChAcesso AS PCHAR, sJustificativa AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION tEnviarContingenciaOffline_NFCe_Daruma 	LOCALNAME DNFCE_ENOF		PARAMTYPE PASCAL (iQtdDoc  As Integer) AS INTEGER LIB 'DarumaFrameWork.dll' 
DLL FUNCTION tEnviarContingenciaCancOffline_NFCe_Daruma	LOCALNAME DNFCE_CNOE		PARAMTYPE PASCAL (iQtdDoc  As Integer) AS INTEGER LIB 'DarumaFrameWork.dll' 
// Metodos de Emissao
DLL FUNCTION aCFAbrir_NFCe_Daruma			LOCALNAME DNFCE_ABR		PARAMTYPE PASCAL (sCPF  AS PCHAR, sNome  AS PCHAR, sLgr  AS PCHAR, sNro  AS PCHAR, sBairro  AS PCHAR, scMun  AS PCHAR, sMunicipio  AS PCHAR, sUF  AS PCHAR, sCEP  AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION aCFAbrirNumSerie_NFCe_Daruma		LOCALNAME DNFCE_ABSR            PARAMTYPE PASCAL (sNNF AS PCHAR, sNSerie AS PCHAR, sCPF  AS PCHAR, sNome  AS PCHAR, sLgr  AS PCHAR, sNro  AS PCHAR, sBairro  AS PCHAR, scMun  AS PCHAR, sMunicipio  AS PCHAR, sUF  AS PCHAR, sCEP  AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION aCFVenderXml_NFCe_Daruma			LOCALNAME DNFCE_XITEM		PARAMTYPE PASCAL (cXML AS PCHAR ) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION aCFTotalizar_NFCe_Daruma			LOCALNAME DNFCE_TOTLZ		PARAMTYPE PASCAL (sTpDescAcr AS PCHAR, sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'		
DLL FUNCTION aCFEfetuarPagamento_NFCe_Daruma		LOCALNAME DNFCE_EFPAG		PARAMTYPE PASCAL (sFormaPgto AS PCHAR, sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'			
DLL FUNCTION aCFValorLeiImposto_NFCe_Daruma		LOCALNAME DNFCE_VLLEI		PARAMTYPE PASCAL (sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION tCFEncerrarConfigMsg_NFCe_Daruma		LOCALNAME DNFCE_ENMSG		PARAMTYPE PASCAL (sMsgPromo AS PCHAR, sMsgFisco AS PCHAR, sUsoFuturo AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION tCFCancelar_NFCe_Daruma			LOCALNAME DNFCE_CANCE		PARAMTYPE PASCAL (sNNF AS PCHAR, sNSerie AS PCHAR, sChAcesso AS PCHAR, sProtAutor AS PCHAR, sJustif AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION tCFInutilizar_NFCe_Daruma			LOCALNAME DNFCE_INUTI		PARAMTYPE PASCAL (sInic AS PCHAR, sFim AS PCHAR, sSerie AS PCHAR , sJustific AS PCHAR)  AS INTEGER LIB 'DarumaFrameWork.dll'
//Metodos de Retornos e Status
DLL FUNCTION rRetornarInformacao_NFCe_Daruma		LOCALNAME DNFCE_RTINF		PARAMTYPE PASCAL (sTpInter AS PCHAR, sInic AS PCHAR, sFim AS PCHAR, sSerie AS PCHAR, sChaveAcesso AS PCHAR, sInfoCons AS PCHAR, sResposta AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION rAvisoErro_NFCe_Daruma			LOCALNAME DNFCE_ERRWS		PARAMTYPE PASCAL (sCodigo AS PCHAR, sMensagem AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION rInfoEstendida_NFCe_Daruma			LOCALNAME DNFCE_INFEST		PARAMTYPE PASCAL (sIndice AS PCHAR, sRetorno AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION rCFVerificarStatus_NFCe_Daruma		LOCALNAME DNFCE_NFCEST		PARAMTYPE PASCAL () AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION rStatusWS_NFCe_Daruma			LOCALNAME DNFCE_WSNST		PARAMTYPE PASCAL () AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION rStatusImpressora_NFCe_Daruma		LOCALNAME DNFCE_PRTST		PARAMTYPE PASCAL () AS INTEGER LIB 'DarumaFrameWork.dll'
//Metodos de config de nfce
DLL FUNCTION regRetornarValor_NFCe_Daruma		LOCALNAME DNFCE_RGRVL		PARAMTYPE PASCAL (sChave AS PCHAR, sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION regAlterarValor_NFCe_Daruma		LOCALNAME DNFCE_RGAVL		PARAMTYPE PASCAL (sChave AS PCHAR, sValor AS PCHAR) AS INTEGER LIB 'DarumaFrameWork.dll'
//Metodos de impressão de nfce				
DLL FUNCTION iCFImprimir_NFCe_Daruma			LOCALNAME DNFCE_IMPRI		PARAMTYPE PASCAL (cXMLEnv AS PCHAR, cXMLRec AS PCHAR, cUrlQR AS PCHAR , nColunas As Integer, nTpNFCE As Integer)  AS INTEGER LIB 'DarumaFrameWork.dll'
DLL FUNCTION iCFReimprimir_NFCe_Daruma			LOCALNAME DNFCE_REMPR		PARAMTYPE PASCAL (sNNF AS PCHAR, sNSerie AS PCHAR, sChAcesso AS PCHAR)  AS INTEGER LIB 'DarumaFrameWork.dll'


Function DarumaNf(cFunction, aParams, cDelimit, cFimStr)
    
    Local oRet		:= Nil							//Retorno da dll
	Local cBuffer 	:= ""                       				//Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""                         				//Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local cParam4	:= ""							//Variavel auxiliar
	Local cParam5	:= ""							//Variavel auxiliar
	Local cParam6	:= ""							//Variavel auxiliar
	Local cParam7	:= ""							//Variavel auxiliar
	Local cParam8	:= ""							//Variavel auxiliar
	Local cParam9	:= ""							//Variavel auxiliar
	Local cParam10	:= ""							//Variavel auxiliar
	Local cParam11	:= ""							//Variavel auxiliar
	Local cParam12	:= ""							//Variavel auxiliar
	Local cParam13  := ""							//Variavel auxiliar
	Local cParam14	:= ""							//Variavel auxiliar
	Local cParam15	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2 	:= 0							//Variavel auxiliar
	Local nParam3 	:= 0							//Variavel auxiliar
	Local nParam4 	:= 0 							//Variavel auxiliar
	Local nParam5 	:= 0							//Variavel auxiliar
	Local nParam6 	:= 0							//Variavel auxiliar
	
	//Executa o comando selecionado
	Do Case
	
		Case cFunction == Upper("regPortaComunicacao_DUAL_DarumaFramework")
			
			oRet := DRNF_REGPORTA(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("rStatusImpressora_DUAL_DarumaFramework")
			
			oRet := DRNF_STATUS()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		
		Case cFunction == Upper("regVelocidade_DUAL_DarumaFramework")
			
			oRet := DRNF_VELO(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("iImprimirTexto_DUAL_DarumaFramework")
			
			cParam1 := DoEncode(aParams[3])
			nParam1 := Val(aParams[4])
			oRet 	:= DRNF_TEXTO(cParam1, nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			
		Case cFunction == Upper("iAcionarGaveta_DUAL_DarumaFramework")
			
			oRet 	:= DRNF_ABRGVT()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			
		Case cFunction == Upper("iImprimirBMP_DUAL_DarumaFramework")

			cParam1 := DoEncode(aParams[3])
			oRet	:= DRNF_IMPBMP(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		Case cFunction == Upper("regAlterarValor_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			
			oRet 	:=  DRNF_RGAVL(cParam1, nParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("regRetornaValorChave_DarumaFramework")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			oRet 	:=  DRNF_RGRVL(cParam1, cParam2, cParam3)
			cBuffer := AllTrim(Str(oRet)) +  cDelimit + DoDecode(cParam3) + cFimStr

		Case cFunction == Upper("regRetornarValor_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	:=  DNFCE_RGRVL(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) +  cDelimit + DoDecode(cParam2) + cFimStr


		Case cFunction == Upper("regAlterarValor_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet 	:=  DNFCE_RGAVL(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr



		Case cFunction == Upper("tCFCancelarOffline_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])

			oRet := DNFCE_CNOF(cParam1, cParam2, cParam3, cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("tEnviarContingenciaOffline_NFCe_Daruma") 	
			
			nParam1 := Val(aParams[3])
			oRet := DNFCE_ENOF(nParam1 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("tEnviarContingenciaCancOffline_NFCe_Daruma")	
			nParam1 := Val(aParams[3])
			oRet := DNFCE_CNOE(nParam1 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("aCFAbrir_NFCe_Daruma")	
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10])
			cParam9 := DoEncode(aParams[11])
			oRet := DNFCE_ABR(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8, cParam9)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("aCFAbrirNumSerie_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := DoEncode(aParams[9])
			cParam8 := DoEncode(aParams[10])
			cParam9 := DoEncode(aParams[11])
			cParam10 := DoEncode(aParams[12])
			cParam11 := DoEncode(aParams[13])
			oRet := DNFCE_ABSR(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7, cParam8, cParam9, cParam10, cParam11) 
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("aCFVenderXml_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			oRet := DNFCE_XITEM(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("aCFTotalizar_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])	
			oRet := DNFCE_TOTLZ(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("aCFEfetuarPagamento_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])	
		
			oRet := DNFCE_EFPAG(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("aCFValorLeiImposto_NFCe_Daruma")	
			cParam1 := DoEncode(aParams[3])
	
			oRet := DNFCE_VLLEI(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("tCFEncerrarConfigMsg_NFCe_Daruma")	

			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			oRet := DNFCE_ENMSG(cParam1, cParam2, cParam3)	
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		
		Case cFunction == Upper("tCFCancelar_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])

			oRet := DNFCE_CANCE(cParam1, cParam2, cParam3, cParam4, cParam5)
			cBuffer := AllTrim(Str(oRet)) + cFimStr		

		Case cFunction == Upper("rRetornarInformacao_NFCe_Daruma")

			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			cParam7 := space(550)

			oRet := DNFCE_RTINF(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6, cParam7)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam7) + cFimStr
		Case cFunction == Upper("rAvisoErro_NFCe_Daruma")			
			cParam1 := space(5)
			cParam2 := space(600)
			oRet := DNFCE_ERRWS(cParam1, cParam2)
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1)+cDelimit + DoDecode(cParam2) + cFimStr


 		Case cFunction == Upper("rInfoEstendida_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			oRet := DNFCE_INFEST(cParam1, cParam2)	
			cBuffer := AllTrim(Str(oRet)) +  cDelimit + DoDecode(cParam2) + cFimStr
		Case cFunction == Upper("rCFVerificarStatus_NFCe_Daruma")	
			oRet := DNFCE_NFCEST()
			cBuffer := AllTrim(Str(oRet)) +  cFimStr
		Case cFunction == Upper("rStatusWS_NFCe_Daruma") 
			oRet := DNFCE_WSNST()
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("rStatusImpressora_NFCe_Daruma")
			oRet := DNFCE_PRTST()	
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("iCFImprimir_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			nParam1 := Val(aParams[6])
			nParam2 := Val(aParams[7])
			oRet := DNFCE_IMPRI(cParam1, cParam2, cParam3, nParam1 , nParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		
		Case cFunction == Upper("tCFInutilizar_NFCe_Daruma")

			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			oRet := DNFCE_INUTI(cParam1, cParam2, cParam3, cParam4)
			cBuffer := AllTrim(Str(oRet)) + cFimStr


		Case cFunction == Upper("iCFReimprimir_NFCe_Daruma")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])

			oRet := DNFCE_REMPR(cParam1, cParam2, cParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr		


		Otherwise
			cBuffer := "Function not found in DarumaFrameWork.DLL/SO -> "+ cFunction
			MsgStop(cBuffer, "Library DarumaFrameWork")

	EndCase
	
Return cBuffer

