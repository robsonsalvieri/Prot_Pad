DLL FUNCTION IniciaPorta LOCALNAME BEMANF_IniciaPorta PARAMTYPE PASCAL (Porta As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION BematechTX LOCALNAME BEMANF_BemaTX PARAMTYPE PASCAL ( comando As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ComandoTX  LOCALNAME BEMANF_ComandoTX PARAMTYPE PASCAL ( BufTrans As PCHAR,  Flag As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION CaracterGrafico LOCALNAME BEMANF_Chargraf PARAMTYPE PASCAL  ( BufTrans As PCHAR,  TamBufTrans As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION Le_Status LOCALNAME BEMANF_LeStts PARAMTYPE PASCAL () As Integer Lib "MP2032.DLL"

DLL FUNCTION AutenticaDoc LOCALNAME BEMANF_AutenticaDoc PARAMTYPE PASCAL ( texto As PCHAR,  tempo As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION DocumentInserted LOCALNAME BEMANF_DocInserido PARAMTYPE PASCAL () As Integer Lib "MP2032.DLL"

DLL FUNCTION FechaPorta LOCALNAME BEMANF_FechaPorta PARAMTYPE PASCAL () As Integer Lib "MP2032.DLL"

DLL FUNCTION Le_Status_Gaveta  LOCALNAME BEMANF_EstGav PARAMTYPE PASCAL () As Integer Lib "MP2032.DLL"

DLL FUNCTION ConfiguraTamanhoExtrato LOCALNAME BEMANF_CfgTamExt PARAMTYPE PASCAL ( NumeroLinhas As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION HabilitaExtratoLongo LOCALNAME BEMANF_HabExtLng PARAMTYPE PASCAL ( Flag As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION HabilitaEsperaImpressao LOCALNAME BEMANF_HbWaitImp PARAMTYPE PASCAL ( Flag As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION EsperaImpressao LOCALNAME BEMANF_WaitImp PARAMTYPE PASCAL () As Integer Lib "MP2032.DLL"

DLL FUNCTION ConfiguraModeloImpressora LOCALNAME BEMANF_ModelImp PARAMTYPE PASCAL ( ModeloImpressora As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION AcionaGuilhotina LOCALNAME BEMANF_Guilhotina PARAMTYPE PASCAL ( Modo As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION FormataTX LOCALNAME BEMANF_FormatoTX PARAMTYPE PASCAL ( BufTrans As PCHAR,  TpoLtra As Integer,  Italic As Integer,  Sublin As Integer,  Expand As Integer,  Enfat As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION HabilitaPresenterRetratil LOCALNAME BEMANF_PresPort PARAMTYPE PASCAL ( iFlag As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION ProgramaPresenterRetratil LOCALNAME BEMANF_ProgPresPort PARAMTYPE PASCAL ( iTempo As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION VerificaPapelPresenter LOCALNAME BEMANF_VerPapel PARAMTYPE PASCAL () As Integer Lib "MP2032.DLL"

DLL FUNCTION ConfiguraTaxaSerial LOCALNAME BEMANF_TxSerial PARAMTYPE PASCAL ( TaxaSerial As Integer) As Integer Lib "MP2032.DLL"  //9600 ou 115200

// Função para Configuração dos Códigos de Barras
DLL FUNCTION ConfiguraCodigoBarras LOCALNAME BEMANF_CCBar PARAMTYPE PASCAL ( Altura As Integer,  Largura As Integer,  PosicaoCaracteres As Integer,  Fonte As Integer,  Margem As Integer) As Integer Lib "MP2032.DLL"
 

// Funções para impressão dos códigos de barras
DLL FUNCTION ImprimeCodigoBarrasUPCA LOCALNAME BEMANF_UPCA PARAMTYPE PASCAL ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasUPCE LOCALNAME BEMANF_BarUPCE PARAMTYPE PASCAL  ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasEAN13 LOCALNAME BEMANF_EAN13 PARAMTYPE PASCAL  ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasEAN8 LOCALNAME BEMANF_BEAN8 PARAMTYPE PASCAL  ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasCODE39 LOCALNAME BEMANF_CODE39 PARAMTYPE PASCAL  ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasCODE93 LOCALNAME BEMANF_BCODE93 PARAMTYPE PASCAL ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasCODE128 LOCALNAME BEMANF_CCODE128 PARAMTYPE PASCAL ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasITF LOCALNAME BEMANF_ITF PARAMTYPE PASCAL ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasCODABAR  LOCALNAME BEMANF_ABAR PARAMTYPE PASCAL ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasISBN LOCALNAME BEMANF_ISBN PARAMTYPE PASCAL  ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasMSI LOCALNAME BEMANF_MSI PARAMTYPE PASCAL  ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasPLESSEY LOCALNAME BEMANF_PLESSEY PARAMTYPE PASCAL ( Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoBarrasPDF417 LOCALNAME BEMANF_PDF417 PARAMTYPE PASCAL ( NivelCorrecaoErros As Integer,  Altura As Integer,  Largura As Integer,  Colunas As Integer,  Codigo As PCHAR) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeCodigoQRCODE LOCALNAME BEMANF_QRCODE PARAMTYPE PASCAL (errorCorrectionLevel As integer, moduleSize As integer, codeType As integer, QRCodeVersion As integer, encodingModes As integer, codeQr As PChar) As integer Lib "MP2032.DLL"


// Funções para impressão de BitMap
DLL FUNCTION ImprimeBitmap LOCALNAME BEMANF_ImpBMP PARAMTYPE PASCAL  ( Name As PCHAR,  mode As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION ImprimeBmpEspecial LOCALNAME BEMANF_IBMPEsp PARAMTYPE PASCAL  ( Name As PCHAR,  xScale As Integer,  yScale As Integer,  angle As Integer)  As Integer Lib "MP2032.DLL"

DLL FUNCTION AjustaLarguraPapel LOCALNAME BEMANF_AjLargPapel PARAMTYPE PASCAL ( Width As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION SelectDithering LOCALNAME BEMANF_SelDithering PARAMTYPE PASCAL  ( Tipo As Integer) As Integer Lib "MP2032.DLL"

DLL FUNCTION PrinterReset LOCALNAME BEMANF_Reset PARAMTYPE PASCAL () AS Integer Lib "MP2032.DLL"

DLL FUNCTION LeituraStatusEstendido LOCALNAME BEMANF_LeEst PARAMTYPE PASCAL () AS Integer Lib "MP2032.DLL"

DLL FUNCTION IoControl LOCALNAME BEMANF_IoControl PARAMTYPE PASCAL () AS Integer Lib "MP2032.DLL"


Function BemaNF(cFunction, aParams, cDelimit, cFimStr)
    
	Local oRet		:= Nil						//Retorno da dll
	Local cBuffer 	:= ""                       				//Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""                         				//Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local cParam4	:= ""							//Variavel auxiliar
	Local cParam5	:= ""							//Variavel auxiliar
	Local cParam6	:= ""							//Variavel auxiliar
	Local cParam7	:= ""							//Variavel auxiliar
	Local cParam8	:= ""							//Variavel auxiliar
	Local cParam9	:= ""							//Variavel auxiliar
	Local cParam10	:= ""							//Variavel auxiliar
	Local cParam11	:= ""							//Variavel auxiliar
	Local cParam12	:= ""							//Variavel auxiliar
	Local cParam13 := ""							//Variavel auxiliar
	Local cParam14	:= ""							//Variavel auxiliar
	Local cParam15	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2 	:= 0							//Variavel auxiliar
	Local nParam3 	:= 0							//Variavel auxiliar
	Local nParam4 	:= 0 							//Variavel auxiliar
	Local nParam5 	:= 0							//Variavel auxiliar
	Local nParam6 	:= 0							//Variavel auxiliar
	
	//Executa o comando selecionado
	Do Case
	
		Case cFunction == Upper("IniciaPorta")
			cParam1 := DoEncode(aParams[3])

			oRet := BEMANF_IniciaPorta(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("FechaPorta")
			oRet := BEMANF_FechaPorta()
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("BematechTX")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_BemaTX(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		
		Case cFunction == Upper("ComandoTX")
			//Usado para enviar à impressora comandos de acionamento de gaveta, habilitar tabela de caracteres....etc...

			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_ComandoTX(cParam1, Len(cParam1))
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("CaracterGrafico")
			//Esta função tem por objetivo imprimir o caracter gráfico criado.
			//DESENHO
		        //   1 2 3 4 5 6 7 8 9
			//bit 7 = 128  *               *
			//bit 6 = 064  * *             *
			//bit 5 = 032  * * *           *
			//bit 4 = 016  * * * *         *
			//bit 3 = 008  * * * * *       *
			//bit 2 = 004  * * * * * *     *
			//bit 1 = 002  * * * * * * *   *
			//bit 0 = 001  * * * * * * * * *
			// Sequencia de bytes para a montagem do desenho acima
			//cBuffer := chr(255) + chr(000) + chr(000) + chr(000) +  chr(127) + chr(000) + chr(000) + chr(000) +  chr(063) + chr(000) + chr(000) + chr(000) 
			//cBuffer += chr(031) + chr(000) + chr(000) + chr(000) +  chr(015) + chr(000) + chr(000) + chr(000) +  chr(007) + chr(000) + chr(000) + chr(000) 
			//cBuffer += chr(003) + chr(000) + chr(000) + chr(000) + chr(001) + chr(000) + chr(000) + chr(000) +   chr(255) + chr(000) + chr(000) + chr(000)
			//cBuffer := cBuffer + CHR(13) + CHR(10)		
			
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_Chargraf( cParam1, Len( cParam1 ) )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("DocumentInserted")
			oRet := BEMANF_DocInserido()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			//1 (um)        : Existe documento inserido para autenticação.
			//0 (zero)        : Não existe documento inserido para autenticação.

		Case cFunction == Upper("Le_Status")
			oRet := BEMANF_LeStts()
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("AutenticaDoc")
			cParam1 := DoEncode(aParams[3])	//Texto a ser impresso
			nParam1 := Val(aParams[4])			// Tempo de esperar em milisegundos

			oRet := BEMANF_AutenticaDoc(cParam1 , nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			
		Case cFunction == Upper("Le_Status_Gaveta")
			oRet	:= BEMANF_EstGav()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			//Retornos :	0 (zero) : Erro de Comunicação.
			//			1 (um)    : Gaveta Aberta.
			//			2 (dois) : Gaveta Fechada.

		Case cFunction == Upper("ConfiguraTamanhoExtrato")
			//Esta função configura a quantidade de linhas impressas no extrato, antes de começar a expulsá-lo (eject). 
			//A quantidade de linhas pode variar de 1 a 150 linhas. O Default é 90 linhas.

			nParam1 := Val(aParams[3])
			oRet := BEMANF_CfgTamExt(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("HabilitaExtratoLongo")
			 //0 (zero)	: Desabilitado.
			//1 (um)		: Habilitado.
			oRet := BEMANF_HabExtLng(1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("HabilitaEsperaImpressao")
			//Esta função habilita ou desabilita o envio do caracter ETX (03h), que mantém a impressora ocupada até o término da impressão de todo o texto (string).
			//0 (zero)		: Desabilitado.
			//1 (um)		: Habilitado.
			oRet := BEMANF_HbWaitImp(1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("EsperaImpressao")
			//Função sem retorno, o resultado final é a execução do comando que habilita espera
			oRet := BEMANF_WaitImp()
            cBuffer := AllTrim(Str(oRet)) + cFimStr
			
		Case cFunction == Upper("ConfiguraModeloImpressora")
			//função deve ser usada antes da função IniciarPorta
			//0: MP-20 TH, MP-2000 CI ou MP-2000 TH (DEFAULT)
			//1: MP-20 MI, MP-20 CI ou MP-20 S
			//2: Blocos térmicos (com comunicacao serial DTR/DSR)
			//3: Bloco 112 mm
			//4: ThermalKiosk
			//5: MP-4000 TH
			//7: MP-4200 TH
			//8: MP-2500 TH
			nParam1 := Val(aParams[3])
			oRet := BEMANF_ModelImp(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("AcionaGuilhotina")
			//0 (zero)        : Modo Parcial (Parcial Cut).
			//1 (um)        : Modo Total (Full Cut).
			nParam1 := Val(aParams[3])
			oRet := BEMANF_Guilhotina(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("FormataTX")
			//Esta função tem por objetivo enviar textos para a impressora, com formatações, informadas pelos parâmetros.
			// TipoLetra:  1 = comprimido / 2 = normal  / 3 = elite
			// Itálico:  1 = ativa o modo itálico / 0 = desativa o modo itálico
			// Sublinhado:  1 = ativa o modo sublinhado / 0 = desativa o modo sublinhado
			// Expandido: 1 = ativa o modo expandido / 0 = desativa o modo expandido
			// Enfatizado (negrito): 1 = ativa o modo enfatizado / 0 = desativa o modo enfatizado
			//Modo de usar: FormataTX( "Texto a ser impresso", TipoLetra, Itálico, Sublinhado, Expandido, Enfatizado)

			cParam1 := DoEncode(aParams[3])
			nParam1 := Val(aParams[4])
			nParam2 := Val(aParams[5])
			nParam3 := Val(aParams[6])
			nParam4 := Val(aParams[7])
			nParam5 := Val(aParams[8])
			oRet := BEMANF_FormatoTX(cParam1 , nParam1 , nParam2 , nParam3, nParam4, nParam5)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("HabilitaPresenterRetratil")
			//1 = Habilitado / 0 = Desabilitado
			nParam1 := Val(aParams[3])
			oRet := BEMANF_PresPort( nParam1 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ProgramaPresenterRetratil")
			//Programa o tempo de espera para retração do papel, caso o mesmo não seja retirado do bocal do Presenter.
			// Parâmetro: iTempo: Variável do tipo INTEIRA, entre 0 (zero) e 60 segundos, definindo o tempo de espera. Default = 5 (cinco) segundos.
			nParam1 := Val(aParams[3])
			oRet := BEMANF_ProgPresPort( nParam1 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("VerificaPapelPresenter")
			oRet := BEMANF_VerPapel()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			//oRet em:
			//-1 (menos um)        : Erro de execução da função.
			//0 (zero)        : Problemas da verificação do papel no presenter.
			//1 (um)        : Papel posicionado no presenter.
			//2 (dois)        : Papel não posicionado no presenter.
			//3 (três)        : Erro desconhecido.

		Case cFunction == Upper("ConfiguraCodigoBarras")
			//Altura - Inteiro entre 1 à 255. (default 162)
			//Largura - Inteiro entre 0 à 2. -> Largura = 0 (barras finas) / Largura = 1 (barras médias) - default / Largura = 2 (barras grossas)
			//Posição dos Caracteres - Inteiro entre 0 à 3. -> Posição = 0 (não imprime os caracteres do código)/ Posição = 1 (imprime os caracteres acima do código)/Posição = 2 (imprime os caracteres abaixo do código) - default/Posição = 3 (imprime os caracteres acima e abaixo do código)
			//Fonte - Inteiro entre 0 à 1. -> Fonte = 0 (normal)  / Fonte = 1 (condensado)
			//Margem - Inteiro entre 0 à 575 (dots pitch) -> Margem = 0 (sem margem) default
			nParam1 := Val(aParams[3])
			nParam2 := Val(aParams[4])
			nParam3 := Val(aParams[5])
			nParam4 := Val(aParams[6])
			nParam5 := Val(aParams[7])
			oRet := BEMANF_CCBar(nParam1 , nParam2 , nParam3, nParam4, nParam5)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasUPCA")
			//aParams1: STRING com o tamanho de 11 dígitos de 0 à 9.
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_UPCA(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasUPCE")
			//aParams1: STRING com o tamanho de 6 dígitos de 0 à 9.
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_BarUPCE(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasEAN13")
			//aParams1: STRING com o tamanho de 12 dígitos de 0 à 9.
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_EAN13(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasEAN8")
			//aParams1: STRING com o tamanho de 7 dígitos de 0 à 9.
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_BEAN8(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasCODE39")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_CODE39(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasCODE93")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_BCODE93(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasCODE128")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_CCODE128(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasITF")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_ITF(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasCODABAR")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_ABAR(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasISBN")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_ISBN(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasMSI")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_MSI(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasPLESSEY")
			cParam1 := DoEncode(aParams[3])
			oRet := BEMANF_PLESSEY(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoBarrasPDF417")
			//Nível de Correção de Erros - Inteiro entre 0 à 8.
			//Quanto mais alto o nível, melhor a leitura do código, maior a impressão e menor o número de informações que poderão ser impressas.
			//Altura - Inteiro entre 1 à 8.
			//Altura do caracter do código (pitch). 1 pitch = altura de 0,125 mm.
			//Largura - Inteiro entre 1 à 4.
			//Largura do caracter do código (pitch). 1 pitch = altura de 0,125 mm.
			//Número de Colunas Impressa na Linha - Inteiro entre 0 à 30.
			//"0" (zero) utiliza o máximo de colunas que o mecanismo permite para a largura informada (pitch). Caso não caiba na linha a impressora ajusta, automaticamente, para o máximo de colunas permitido na linha.			
			nParam1 := Val(aParams[3])
			nParam2 := Val(aParams[4])
			nParam3 := Val(aParams[5])
			nParam4 := Val(aParams[6])
			cParam1 := DoEncode(aParams[7])
			oRet := BEMANF_PDF417(nParam1 , nParam2 , nParam3, nParam4, cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeCodigoQRCode")
			/* Nível de Restauração: variável INT para definir o nível de restauração do código, onde:
				0 - Aproximadamente 7% de restauração.
				1 - Aproximadamente 15% de restauração.
				2 - Aproximadamente 25% de restauração.
				3 - Aproximadamente 30% de restauração. 

			Tamanho do módulo: variável INT para definir o tamanho do módulo do código, compreendido entre 1 e 127.
			Tipo: variável INT com o tipo do código, compreendido entre 0 e 1, onde 0 é para a impressão em tamanho normal e 1 para tamanho reduzido.
			Versão do código: variável INT para definir a versão do código QRCODE, compreendido entre 1 e 40.
			Formato do Código: variável INT para definir quais dados serão impressões no código QRCODE, onde:
				- Para o tamanho normal
					0 &endash; Somente números até 7.089 caracteres.
					1 &endash; Alfanumérico com até 4.296 caracteres.
					2 &endash; Binário (8 bits) com até 2.953 bytes.
					3 &endash; Kanji com até 1.817 caracteres. 

				- Para o tamanho reduzido.
					0 &endash; Somente números até 35 caracteres.
					1 &endash; Alfanumérico com até 21 caracteres.
					2 &endash; Binário (8 bits) com até 15 bytes.
					3 &endash; Kanji com até 9 caracteres. 

			Código: variável STRING com os dados que serão impressos no código QRCODE.*/			
			
			nParam1 := Val(aParams[3])
			nParam2 := Val(aParams[4])
			nParam3 := Val(aParams[5])
			nParam4 := Val(aParams[6])
			nParam5 := Val(aParams[7])
			cParam1 := DoEncode(aParams[8])
			oRet := BEMANF_QRCODE(nParam1 , nParam2 , nParam3, nParam4, nParam5, cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr                             

		Case cFunction == Upper("ImprimeBitmap")
			cParam1 := DoEncode(aParams[3]) //Caminho da imagem
			oRet := BEMANF_ImpBMP(cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ImprimeBmpEspecial")
			//sFileName: STRING com o caminho completo do arquivo contendo o bitmap.
			//xScale: Variável do tipo INTEIRA, indicando o escalonamento da imagem na horizontal em porcentagem. Ex: 100 (%) indica largura atual; 200 (%) indica largura 2 vezes maior; -1 (menos um) indica ajuste da largura na página.
			//yScale: Variável do tipo INTEIRA, indicando o escalonamento da imagem na vertical em porcentagem. Ex: 100 (%) indica altura atual; 50 (%) indica metade da altura. Ignorado se parâmetro xScale seja –1 (menos um).
			//iAngle: Variável do tipo INTEIRA, usada para girar o bitmap na impressão. Ex: 0 (°) indica sem rotacionamento da imagem; 45 (°) indica rotacionar a imagem em 45 graus.
			cParam1 := DoEncode(aParams[3])
			nParam1 := Val(aParams[4])
			nParam2 := Val(aParams[5])
			nParam3 := Val(aParams[6])
			oRet := BEMANF_IBMPEsp(cParam1, nParam1 , nParam2 , nParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("AjustaLarguraPapel")
			//iWidth: Variável do tipo INTEIRA, indicando a bitola do papel em milímetros. Podendo ser: 48, 58, 76, 80 ou 112.
			nParam1 := Val(aParams[3])
			oRet := BEMANF_AjLargPapel( nParam1 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("SelectDithering")
			//Seleciona qual algoritmo de dithering (halftoning), a ser utilizado na impressão do bitmap.
			nParam1 := Val(aParams[3])
			oRet := BEMANF_SelDithering( nParam1 )
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("PrinterReset")
			//reseta a impressora
			oRet := BEMANF_Reset()
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("LeituraStatusEstendido")
			oRet := BEMANF_LeEst()
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("IoControl")
			oRet := BEMANF_IoControl()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			
		Case cFunction == Upper("ConfiguraTaxaSerial")
			oRet := BEMANF_TxSerial()
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Otherwise
			cBuffer := "Function not found in MP2032.DLL/SIUSBXP.DLL-> "+ cFunction
			MsgStop(cBuffer, "Library BematechInterface")

	EndCase
	
Return cBuffer

