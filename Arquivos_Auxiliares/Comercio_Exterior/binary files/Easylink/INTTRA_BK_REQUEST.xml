<?xml version="1.0" encoding="ISO-8859-1" ?>
<EASYLINK>
   <SERVICE>
      <ID>001</ID>
      <DATA_SELECTION>
         <EEC_PREEMB>cProcesso</EEC_PREEMB>
         <CMD>EEC->(DbSeek(xFilial("EEC")+#TAG EEC_PREEMB#))</CMD>
         <IF COND = "!Empty(#TAG EEC_PREEMB#)">
            <CMD>EEC->(DbSeek(xFilial("EEC")+#TAG EEC_PREEMB#))</CMD>
            <XML>
               <Message>
                  <Header>
                     <MessageType MessageVersion = '"1.0"'>"BookingRequest"</MessageType>
                     <DocumentIdentifier>#TAG EEC_PREEMB#</DocumentIdentifier>
                     <DateTime DateType = '"Document"'>Substr(DTOS(Date()),3,2)+Substr(DTOS(Date()),5,4)+Substr(Time(),1,2)+Substr(Time(),4,2)</DateTime>
                     <Parties>
                        <PartnerInformation PartnerRole = '"Sender"'>
                           <ALIAS_01>"EYI"</ALIAS_01>
                           <ORDER_01>1</ORDER_01>
                           <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                           <PartnerIdentifier Agency = '"AssignedBySender"'>Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                           <PartnerName>Left(EYI->EYI_NOMEIN,35)</PartnerName>
                           <ALIAS_02>"EE3"</ALIAS_02>
                           <ORDER_02>1</ORDER_02>
                           <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL")))</SEEK_02>
                           <WHILE_02 REPL = '"1"' COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                              <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                 <ContactInformation>
                                    <ContactName>Left(EE3->EE3_NOME,35)</ContactName>
                                    <IF_01 COND = "!Empty(EE3->EE3_EMAIL)">
                                       <CommunicationValue CommunicationType = '"Email"'>EE3->EE3_EMAIL</CommunicationValue>
                                    </IF_01>
                                    <IF_02 COND = "Empty(EE3->EE3_EMAIL) .And. !Empty(EE3->EE3_FONE)">
                                       <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                    </IF_02>
                                    <IF_03 COND = "Empty(EE3->EE3_EMAIL) .And. Empty(EE3->EE3_FONE) .And. !Empty(EE3->EE3_FAX)">
                                       <CommunicationValue CommunicationType = '"Fax"'>EE3->EE3_FAX</CommunicationValue>
                                    </IF_03>
                                 </ContactInformation>
                                 <EXIT/>
                              </IF>
                              <SKIP>"EE3"</SKIP>
                           </WHILE_02>
                        </PartnerInformation>
                        <PartnerInformation PartnerRole = '"Recipient"'>
                           <PartnerIdentifier Agency = '"AssignedByRecipient"'>"INTTRA"</PartnerIdentifier>
                        </PartnerInformation>
                     </Parties>
                  </Header>
                  <MessageBody>
                     <MessageProperties>
                        <ShipmentID>
                           <ShipmentIdentifier MessageStatus = "cOpcao">cID</ShipmentIdentifier>
                        </ShipmentID>
                        <DateTime DateType = '"Message"'>Left(DTOS(Date()),4)+Substr(DTOS(Date()),5,4)+Substr(Time(),1,2)+Substr(Time(),4,2)</DateTime>
                        <ALIAS>"EE3"</ALIAS>
                        <ORDER>2</ORDER>
                        <IF_01 COND = "!Empty(EEC->EEC_RESPON)">
                           <SEEK>xFilial("EE3")+AvKey(EEC->EEC_RESPON,"EE3_NOME")</SEEK>
                           <ContactInformation>
                              <ContactName>Left(EE3->EE3_NOME,35)</ContactName>
                              <IF_01 COND = "!Empty(EE3->EE3_EMAIL)">
                                 <CommunicationValue CommunicationType = '"Email"'>EE3->EE3_EMAIL</CommunicationValue>
                              </IF_01>
                              <IF_02 COND = "Empty(EE3->EE3_EMAIL) .And. !Empty(EE3->EE3_FONE)">
                                 <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                              </IF_02>
                              <IF_03 COND = "Empty(EE3->EE3_EMAIL) .And. Empty(EE3->EE3_FONE) .And. !Empty(EE3->EE3_FAX)">
                                 <CommunicationValue CommunicationType = '"Fax"'>EE3->EE3_FAX</CommunicationValue>
                              </IF_03>
                           </ContactInformation>
                        </IF_01>
                        <ALIAS_01>"EE3"</ALIAS_01>
                        <ORDER_01>1</ORDER_01>
                        <SEEK_01>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL")))</SEEK_01>
                        <IF_12 COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                           <PushNotificationContactInformation>
                              <WHILE COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                                 <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                    <IF COND = "!Empty(EE3->EE3_EMAIL)">
                                       <CommunicationValue CommunicationType = '"Email"'>Alltrim(EE3->EE3_EMAIL)</CommunicationValue>
                                    </IF>
                                 </IF>
                                 <SKIP>"EE3"</SKIP>
                              </WHILE>
                           </PushNotificationContactInformation>
                        </IF_12>
                        <IF_02 COND = "!Empty(EEC->EEC_NRCONH)">
                           <ReferenceInformation ReferenceType = '"BillOfLandingNumber"'>Left(EEC->EEC_NRCONH,35)</ReferenceInformation>
                        </IF_02>
                        <IF_03 COND = "!Empty(EEC->EEC_REFIMP)">
                           <ReferenceInformation ReferenceType = '"ConsigneeOrderNumber"'>Left(EEC->EEC_REFIMP,35)</ReferenceInformation>
                        </IF_03>
                        <ALIAS_02>"EEB"</ALIAS_02>
                        <ORDER_02>1</ORDER_02>
                        <SEEK_02>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_02>
                        <WHILE_01 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                           <IF COND = "Left(EEB->EEB_TIPOAG,1)=='4'">
                              <IF COND = "!Empty(EEB->EEB_CONTR)">
                                 <ReferenceInformation ReferenceType = '"ContractNumber"'>Left(EEB->EEB_CONTR,35)</ReferenceInformation>
                              </IF>
                              <EXIT/>
                           </IF>
                           <SKIP>"EEB"</SKIP>
                        </WHILE_01>
                        <ALIAS_03>"EXL"</ALIAS_03>
                        <ORDER_03>1</ORDER_03>
                        <SEEK_03>xFilial("EXL")+EEC->EEC_PREEMB</SEEK_03>
                        <IF_04 COND = "!Empty(EXL->EXL_REFADD)">
                           <ReferenceInformation ReferenceType = '"ContractPartyReference"'>Left(EXL->EXL_REFADD,35)</ReferenceInformation>
                        </IF_04>
                        <ALIAS_04>"EEB"</ALIAS_04>
                        <ORDER_04>1</ORDER_04>
                        <SEEK_04>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_04>
                        <WHILE_02 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                           <IF COND = "Left(EEB->EEB_TIPOAG,1)=='C'">
                              <IF COND = "!Empty(EEB->EEB_REFAGE)">
                                 <ReferenceInformation ReferenceType = '"FreightForwarderReference"'>Left(EEB->EEB_REFAGE,35)</ReferenceInformation>
                              </IF>
                              <EXIT/>
                           </IF>
                           <SKIP>"EEB"</SKIP>
                        </WHILE_02>
                        <!--Pedidos -->
                        <PEDIDOS PRINT = '"N"'>DetPedidos(EEC->EEC_PREEMB)</PEDIDOS>
                        <FOR
                           INI = "1"
                           TO = "Len(#TAG PEDIDOS#)"
                           VAR = "'nInc'"
                           STEP = "1"
                           REPL = "'1'">
                           <ReferenceInformation ReferenceType = '"PurchaseOrderNumber"'>Left(#TAG PEDIDOS#[nInc],35)</ReferenceInformation>
                        </FOR>
                        <ReferenceInformation ReferenceType = '"ShipperIdentifyingNumber"'>Left(EEC->EEC_PREEMB,35)</ReferenceInformation>
                        <IF_05 COND = "!Empty(EXL->EXL_CBKCOM)">
                           <ShipmentComments CommentType = '"General"'>EXL->(MSMM(EXL_CBKCOM,AVSX3("EXL_BKCOM",3),,,3))</ShipmentComments>
                        </IF_05>
                        <IF_06 COND = "!Empty(EXL->EXL_CBKTCO)">
                           <ShipmentComments CommentType = '"TemperatureControl"'>EXL->(MSMM(EXL_CBKTCO,AVSX3("EXL_BKTPCO",3),,,3))</ShipmentComments>
                        </IF_06>
                        <IF_07 COND = 'EXL->EXL_TIPMOV == "1"'>
                           <HaulageDetails MovementType = '"PortToPort"' ServiceType = '"FullLoad"'>''</HaulageDetails>
                        </IF_07>
                        <IF_08 COND = 'EXL->EXL_TIPMOV == "2"'>
                           <HaulageDetails MovementType = '"DoorToPort"' ServiceType = "'FullLoad'">''</HaulageDetails>
                        </IF_08>
                        <IF_09 COND = 'EXL->EXL_TIPMOV == "3"'>
                           <HaulageDetails MovementType = '"PortToDoor"' ServiceType = "'FullLoad'">''</HaulageDetails>
                        </IF_09>
                        <IF_11 COND = 'EXL->EXL_TIPMOV == "4"'>
                           <HaulageDetails MovementType = '"DoorToDoor"' ServiceType = "'FullLoad'">''</HaulageDetails>
                        </IF_11>
                        <TransportationDetails TransportStage = '"Main"' TransportMode = '"Maritime"'>
                           <ConveyanceInformation>
                              <IF_01 COND = "!Empty(EEC->EEC_EMBARC)">
                                 <ALIAS>"EE6"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("EE6")+AvKey(EEC->EEC_EMBARC,"EE6_COD")</SEEK>
                                 <ConveyanceName>Left(EE6_NOME,35)</ConveyanceName>
                              </IF_01>
                              <IF_02 COND = "!Empty(EEC->EEC_VIAGEM)">
                                 <VoyageTripNumber>Left(EEC->EEC_VIAGEM,35)</VoyageTripNumber>
                              </IF_02>
                              <IF_03 COND = "Empty(EEC->EEC_VIAGEM) .and. !Empty(EEC->EEC_EMBARC)">
                                 <VoyageTripNumber>Left(EE6->EE6_VIAGEM,35)</VoyageTripNumber>
                              </IF_03>
                              <ALIAS>"EEB"</ALIAS>
                              <ORDER>1</ORDER>
                              <SEEK>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK>
                              <WHILE REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                                 <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="4"'>
                                    <ALIAS>"SY5"</ALIAS>
                                    <ORDER>1</ORDER>
                                    <SEEK>xFilial("SY5")+AvKey(EEB->EEB_CODAGE,"Y5_COD")</SEEK>
                                    <CarrierSCAC>SY5->Y5_SCAC</CarrierSCAC>
                                 </IF>
                                 <SKIP>"EEB"</SKIP>
                              </WHILE>
                           </ConveyanceInformation>
                           <!--Port to Port -->
                           <IF_01 COND = 'EXL->EXL_TIPMOV == "1"'>
                              <!--Porto de Origem -->
                              <Location LocationType = '"PlaceOfReceipt"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_ORIGEM</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETD)">
                                    <DateTime DateType = '"EstimatedDeparture"'>DTOS(EEC->EEC_ETD)</DateTime>
                                 </IF>
                              </Location>
                              <!--Porto de Destino -->
                              <Location LocationType = '"PlaceOfDelivery"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_DEST</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETA)">
                                    <DateTime DateType = '"EstimatedArrival"'>DTOS(EEC->EEC_ETA)</DateTime>
                                 </IF>
                              </Location>
                           </IF_01>
                           <!--Door to Port -->
                           <IF_02 COND = 'EXL->EXL_TIPMOV == "2"'>
                              <!--Local de Recebimento -->
                              <Location LocationType = '"PlaceOfReceipt"'>
                                 <IF COND = "!Empty(EXL->EXL_LOCREC)">
                                    <ALIAS>"SY9"</ALIAS>
                                    <ORDER>2</ORDER>
                                    <SEEK>xFilial("SY9")+EXL->EXL_LOCREC</SEEK>
                                    <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                    <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                    <IF COND = "!Empty(EXL->EXL_ETDORI)">
                                       <DateTime DateType = '"EstimatedDeparture"'>DTOS(EXL->EXL_ETDORI)</DateTime>
                                    </IF>
                                    <IF COND = "!Empty(EXL->EXL_DTRETI)">
                                       <DateTime DateType = '"EquipmentPickup"'>DTOS(EXL->EXL_DTRETI)</DateTime>
                                    </IF>
                                 </IF>
                              </Location>
                              <!--Porto de Origem -->
                              <Location LocationType = '"PortOfLoading"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_ORIGEM</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETD)">
                                    <DateTime DateType = '"EstimatedDeparture"'>DTOS(EEC->EEC_ETD)</DateTime>
                                 </IF>
                              </Location>
                              <!--Porto de Destino -->
                              <Location LocationType = '"PlaceOfDelivery"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_DEST</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETA)">
                                    <DateTime DateType = '"EstimatedArrival"'>DTOS(EEC->EEC_ETA)</DateTime>
                                 </IF>
                              </Location>
                           </IF_02>
                           <!--Port to Door -->
                           <IF_03 COND = 'EXL->EXL_TIPMOV == "3"'>
                              <!--Porto de Origem -->
                              <Location LocationType = '"PlaceOfReceipt"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_ORIGEM</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETD)">
                                    <DateTime DateType = '"EstimatedDeparture"'>DTOS(EEC->EEC_ETD)</DateTime>
                                 </IF>
                              </Location>
                              <!--Porto de Destino -->
                              <Location LocationType = '"PortOfDischarge"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_DEST</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETA)">
                                    <DateTime DateType = '"EstimatedArrival"'>DTOS(EEC->EEC_ETA)</DateTime>
                                 </IF>
                              </Location>
                              <!--Local de Entrega -->
                              <IF COND = "!Empty(EXL->EXL_LOCENT)">
                                 <Location LocationType = '"PlaceOfDelivery"'>
                                    <ALIAS>"SY9"</ALIAS>
                                    <ORDER>2</ORDER>
                                    <SEEK>xFilial("SY9")+EXL->EXL_LOCENT</SEEK>
                                    <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                    <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                    <IF COND = "!Empty(EEC->EEC_ETADES)">
                                       <DateTime DateType = '"EstimatedArrival"'>DTOS(EEC->EEC_ETADES)</DateTime>
                                    </IF>
                                 </Location>
                              </IF>
                           </IF_03>
                           <!--Door to Door -->
                           <IF_04 COND = 'EXL->EXL_TIPMOV == "4"'>
                              <!--Local de Recebimento -->
                              <Location LocationType = '"PlaceOfReceipt"'>
                                 <IF COND = "!Empty(EXL->EXL_LOCREC)">
                                    <ALIAS>"SY9"</ALIAS>
                                    <ORDER>2</ORDER>
                                    <SEEK>xFilial("SY9")+EXL->EXL_LOCREC</SEEK>
                                    <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                    <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                    <IF_01 COND = "!Empty(EXL->EXL_ETDORI)">
                                       <DateTime DateType = '"EstimatedDeparture"'>DTOS(EXL->EXL_ETDORI)</DateTime>
                                    </IF_01>
                                    <IF_02 COND = "!Empty(EXL->EXL_DTRETI)">
                                       <DateTime DateType = '"EquipmentPickup"'>DTOS(EXL->EXL_DTRETI)</DateTime>
                                    </IF_02>
                                 </IF>
                              </Location>
                              <!--Porto de Origem -->
                              <Location LocationType = '"PortOfLoading"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_ORIGEM</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETD)">
                                    <DateTime DateType = '"EstimatedDeparture"'>DTOS(EEC->EEC_ETD)</DateTime>
                                 </IF>
                              </Location>
                              <!--Porto de Destino -->
                              <Location LocationType = '"PortOfDischarge"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EEC->EEC_DEST</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                 <IF COND = "!Empty(EEC->EEC_ETA)">
                                    <DateTime DateType = '"EstimatedArrival"'>DTOS(EEC->EEC_ETA)</DateTime>
                                 </IF>
                              </Location>
                              <!--Local de Entrega -->
                              <IF COND = "!Empty(EXL->EXL_LOCENT)">
                                 <Location LocationType = '"PlaceOfDelivery"'>
                                    <ALIAS>"SY9"</ALIAS>
                                    <ORDER>2</ORDER>
                                    <SEEK>xFilial("SY9")+EXL->EXL_LOCENT</SEEK>
                                    <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                    <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                                    <IF COND = "!Empty(EEC->EEC_ETADES)">
                                       <DateTime DateType = '"EstimatedArrival"'>DTOS(EEC->EEC_ETADES)</DateTime>
                                    </IF>
                                 </Location>
                              </IF>
                           </IF_04>
                        </TransportationDetails>
                        <!--Participantes -->
                        <Parties>
                           <!--Solicitante do Booking -->
                           <PartnerInformation PartnerRole = '"BookingParty"'>
                              <ALIAS_01>"EYI"</ALIAS_01>
                              <ORDER_01>1</ORDER_01>
                              <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                              <PartnerIdentifier Agency = '"AssignedBySender"'>Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                              <PartnerName>Left(EYI->EYI_NOMEIN,35)</PartnerName>
                              <!--Contato -->
                              <ALIAS_02>"EE3"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL")))</SEEK_02>
                              <WHILE_02 COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                                 <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                    <ContactInformation>
                                       <ContactName>Left(EE3->EE3_NOME,35)</ContactName>
                                       <IF COND = "!Empty(EE3->EE3_FONE)">
                                          <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                       </IF>
                                    </ContactInformation>
                                    <EXIT/>
                                 </IF>
                                 <SKIP>EE3</SKIP>
                              </WHILE_02>
                           </PartnerInformation>
                           <!--Armador -->
                           <ALIAS_01>"EEB"</ALIAS_01>
                           <ORDER_01>1</ORDER_01>
                           <SEEK_01>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_01>
                           <WHILE_01 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                              <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="4"'>
                                 <ALIAS>"SY5"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("SY5")+AvKey(EEB->EEB_CODAGE,"Y5_COD")</SEEK>
                                 <PartnerInformation PartnerRole = '"Carrier"'>
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>SY5->Y5_SCAC</PartnerIdentifier>
                                    <PartnerName>Left(SY5->Y5_NOME,35)</PartnerName>
                                 </PartnerInformation>
                              </IF>
                              <SKIP>"EEB"</SKIP>
                           </WHILE_01>
                           <!--Consignatário -->
                           <ALIAS_02>"EXJ"</ALIAS_02>
                           <ORDER_02>1</ORDER_02>
                           <SEEK_02>xFilial("EXJ")+If(!Empty(EEC->EEC_CONSIG),EEC->(EEC_CONSIG+EEC_COLOJA),EEC->(EEC_IMPORT+EEC_IMLOJA))</SEEK_02>
                           <IF_01 COND = "!Empty(EEC->EEC_CONSIG)">
                              <PartnerInformation PartnerRole = '"Consignee"'>
                                 <IF_01 COND = "!Empty(EXJ->EXJ_INTTRA)">
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                 </IF_01>
                                 <PartnerName>Posicione('SA1', 1, xFilial('SA1')+EEC->(EEC_CONSIG+EEC_COLOJA), 'A1_NOME')</PartnerName>
                              </PartnerInformation>
                           </IF_01>
                           <IF_02 COND = "Empty(EEC->EEC_CONSIG)">
                              <PartnerInformation PartnerRole = '"Consignee"'>
                                 <IF_01 COND = "!Empty(EXJ->EXJ_INTTRA)">
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                 </IF_01>
                                 <PartnerName>Left(EEC->EEC_IMPODE,35)</PartnerName>
                              </PartnerInformation>
                           </IF_02>
                           <!--Agente no Exterior. FreightForwarder -->
                           <ALIAS_03>"EEB"</ALIAS_03>
                           <ORDER_03>1</ORDER_03>
                           <SEEK_03>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_03>
                           <WHILE_03 REPL='"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                              <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="C"'>
                                 <ALIAS>"SY5"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("SY5")+AvKey(EEB->EEB_CODAGE,"Y5_COD")</SEEK>
                                 <PartnerInformation PartnerRole = '"FreightForwarder"'>
                                    <IF COND = "!Empty(SY5->Y5_CODIN)">
                                       <PartnerIdentifier Agency = '"AssignedBySender"'>SY5->Y5_CODIN</PartnerIdentifier>
                                    </IF>
                                    <PartnerName>Left(SY5->Y5_NOME,35)</PartnerName>
                                 </PartnerInformation>
                                 <EXIT/>
                              </IF>
                              <SKIP>"EEB"</SKIP>
                           </WHILE_03>
                           <!--Notify Principal -->
                           <ALIAS_04>"EEN"</ALIAS_04>
                           <ORDER_04>1</ORDER_04>
                           <SEEK_04>xFilial("EEN")+EEC->EEC_PREEMB+"Q"</SEEK_04>
                           <IF_03 COND = "EEN->(!EOF())">
                              <EEN_IMPORT PRINT = "'N'">EEN->EEN_IMPORT</EEN_IMPORT>
                              <EEN_IMLOJA PRINT = "'N'">EEN->EEN_IMLOJA</EEN_IMLOJA>
                              <ALIAS>"EXJ"</ALIAS>
                              <ORDER>1</ORDER>
                              <SEEK>xFilial("EXJ")+#TAG EEN_IMPORT#+#TAG EEN_IMLOJA#</SEEK>
                              <IF COND = "EXJ->(!EOF())">
                                 <IF COND = "!Empty(EXJ->EXJ_INTTRA)">
                                    <PartnerInformation PartnerRole = '"NotifyParty"'>
                                       <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                       <PartnerName>Left(EEN->EEN_IMPODE,35)</PartnerName>
                                    </PartnerInformation>
                                 </IF>
                              </IF>
                           </IF_03>
                           <!--Notify Adicional -->
                           <ALIAS_05>"EEN"</ALIAS_05>
                           <ORDER_05>1</ORDER_05>
                           <SEEK_05>xFilial("EEN")+EEC->EEC_PREEMB+"Q"</SEEK_05>
                           <WHILE_05 COND = 'EEN->(!EOF()) .and. EEN->(EEN_FILIAL+EEN_PROCES+EEN_OCORRE) == xFilial("EEN")+EEC->EEC_PREEMB+"Q"'>
                              <IF COND = "EEN->EEN_IMPORT != #TAG EEN_IMPORT# .and. EEN->EEN_IMLOJA != #TAG EEN_IMLOJA#">
                                 <ALIAS>"EXJ"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("EXJ")+EEN->(EEN_IMPORT+EEN_IMLOJA)</SEEK>
                                 <IF COND = "EXJ->(!EOF())">
                                    <IF COND = "!Empty(EXJ->EXJ_INTTRA)">
                                       <PartnerInformation PartnerRole = '"NotifyParty2"'>
                                          <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                          <PartnerName>Left(EEN->EEN_IMPODE,35)</PartnerName>
                                       </PartnerInformation>
                                    </IF>
                                 </IF>
                                 <EXIT/>
                              </IF>
                              <SKIP>EEN</SKIP>
                           </WHILE_05>
                           <!--Shipper -->
                           <PartnerInformation PartnerRole = '"Shipper"'>
                              <ALIAS_01>"EYI"</ALIAS_01>
                              <ORDER_01>1</ORDER_01>
                              <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                              <PartnerIdentifier Agency = "'AssignedBySender'">Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                              <PartnerName>Left(EYI->EYI_NOMEIN,35)</PartnerName>
                              <!--Contato -->
                              <ALIAS_02>"EE3"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL")))</SEEK_02>
                              <WHILE_02 COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                                 <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                    <ContactInformation>
                                       <ContactName>Left(EE3->EE3_NOME,35)</ContactName>
                                       <IF COND = "!Empty(EE3->EE3_FONE)">
                                          <CommunicationValue CommunicationType = "'Telephone'">EE3->EE3_FONE</CommunicationValue>
                                       </IF>
                                    </ContactInformation>
                                    <EXIT/>
                                 </IF>
                                 <SKIP>EE3</SKIP>
                              </WHILE_02>
                           </PartnerInformation>
                           <IF_04 COND = 'EXL->EXL_TIPMOV == "2" .Or. EXL->EXL_TIPMOV == "4"'>
                              <PartnerInformation PartnerRole = "'ShipFrom'">
                                 <ALIAS_01>'SA2'</ALIAS_01>
                                 <ORDER_01>1</ORDER_01>
                                 <SEEK_01>xFilial("SA1")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA), EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                                 <PartnerName>AllTrim(Left(SA2->A2_NOME, 35))</PartnerName>
                                 <ALIAS_02>'EE3'</ALIAS_02>
                                 <ORDER_02>1</ORDER_02>
                                 <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")),EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL")))</SEEK_02>
                                 <WHILE_01 REPL = '"1"' COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                                    <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                       <ContactInformation>
                                          <ContactName>Left(EE3->EE3_NOME,35)</ContactName>
                                          <IF_01 COND = "!Empty(EE3->EE3_EMAIL)">
                                             <CommunicationValue CommunicationType = '"Email"'>EE3->EE3_EMAIL</CommunicationValue>
                                          </IF_01>
                                          <IF_02 COND = "Empty(EE3->EE3_EMAIL) .And. !Empty(EE3->EE3_FONE)">
                                             <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                          </IF_02>
                                          <IF_03 COND = "Empty(EE3->EE3_EMAIL) .And. Empty(EE3->EE3_FONE) .And. !Empty(EE3->EE3_FAX)">
                                             <CommunicationValue CommunicationType = '"Fax"'>EE3->EE3_FAX</CommunicationValue>
                                          </IF_03>
                                       </ContactInformation>
                                       <EXIT/>
                                    </IF>
                                    <SKIP>"EE3"</SKIP>
                                 </WHILE_01>
                                 <AddressInformation>
                                    <AddressLine>AllTrim(Left(SA2->A2_END, 35))</AddressLine>
                                    <IF_01 COND = 'AllTrim(SubStr(SA2->A2_END, 35)) != ""'>
                                       <AddressLine>AllTrim(SubStr(SA2->A2_END, 35))</AddressLine>
                                    </IF_01>
                                    <AddressLine>SA2->(AllTrim(A2_MUN)+" "+AllTrim(A2_CEP)+" "+AllTrim(A2_EST))</AddressLine>
                                 </AddressInformation>
                              </PartnerInformation>
                           </IF_04>
                           <IF_05 COND = 'EXL->EXL_TIPMOV == "3" .Or. EXL->EXL_TIPMOV == "4"'>
                              <PartnerInformation PartnerRole = "'ShipTo'">
                                 <ALIAS_01>'SA2'</ALIAS_01>
                                 <ORDER_01>1</ORDER_01>
                                 <SEEK_01>xFilial('SA1')+IF(Empty(EEC->EEC_CONSIG),EEC->(EEC_CONSIG+EEC_COLOJA), EEC->(EEC_IMPORT+EEC_IMLOJA))</SEEK_01>
                                 <PartnerName>AllTrim(Left(SA1->A1_NOME, 35))</PartnerName>
                                 <ALIAS_02>'EE3'</ALIAS_02>
                                 <ORDER_02>1</ORDER_02>
                                 <SEEK_02>xFilial("EE3")+"I"+If(!Empty(EEC->EEC_CONSIG),EEC->(AvKey(EEC_CONSIG, "EE3_CONTAT")+AvKey(EEC_COLOJA, "EE3_COMPL")),EEC->(AvKey(EEC_IMPORT, "EE3_CONTAT")+AvKey(EEC_IMLOJA, "EE3_COMPL")))</SEEK_02>
                                 <WHILE_01 REPL = '"1"' COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"I"+If(!Empty(EEC->EEC_CONSIG),EEC->(AvKey(EEC_CONSIG, "EE3_CONTAT")+AvKey(EEC_COLOJA, "EE3_COMPL")),EEC->(AvKey(EEC_IMPORT, "EE3_CONTAT")+AvKey(EEC_IMLOJA, "EE3_COMPL"))))'>
                                    <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                       <ContactInformation>
                                          <ContactName>AllTrim(Left(EE3->EE3_NOME,35))</ContactName>
                                          <IF_01 COND = "!Empty(EE3->EE3_EMAIL)">
                                             <CommunicationValue CommunicationType = '"Email"'>EE3->EE3_EMAIL</CommunicationValue>
                                          </IF_01>
                                          <IF_02 COND = "Empty(EE3->EE3_EMAIL) .And. !Empty(EE3->EE3_FONE)">
                                             <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                          </IF_02>
                                          <IF_03 COND = "Empty(EE3->EE3_EMAIL) .And. Empty(EE3->EE3_FONE) .And. !Empty(EE3->EE3_FAX)">
                                             <CommunicationValue CommunicationType = '"Fax"'>EE3->EE3_FAX</CommunicationValue>
                                          </IF_03>
                                       </ContactInformation>
                                       <EXIT/>
                                    </IF>
                                    <SKIP>"EE3"</SKIP>
                                 </WHILE_01>
                                 <AddressInformation>
                                    <AddressLine>AllTrim(Left(SA1->A1_END, 35))</AddressLine>
                                    <IF_01 COND = 'AllTrim(SubStr(SA1->A1_END, 35)) != ""'>
                                       <AddressLine>AllTrim(SubStr(SA1->A1_END, 35))</AddressLine>
                                    </IF_01>
                                    <AddressLine>SA1->(AllTrim(A1_MUN)+" "+AllTrim(A1_CEP)+" "+AllTrim(A1_EST))</AddressLine>
                                 </AddressInformation>
                              </PartnerInformation>
                           </IF_05>
                        </Parties>
                     </MessageProperties>
                     <MessageDetails>
                        <!--Detalhes de Containeres -->
                        <EQUIPMENT PRINT = '"N"'>DetBkEquipment(EEC->EEC_PREEMB)</EQUIPMENT>
                        <FOR_01
                           REPL = '"1"'
                           INI = "1"
                           TO = "Len(#TAG EQUIPMENT#)"
                           VAR = "'nInc'"
                           STEP = "1">
                           <EquipmentDetails>
                              <LineNumber>nInc</LineNumber>
                              <EquipmentType>
                                 <EquipmentTypeCode>#TAG EQUIPMENT#[nInc][1]</EquipmentTypeCode>
                              </EquipmentType>
                              <EquipmentCount>Str(#TAG EQUIPMENT#[nInc][2])</EquipmentCount>
                              <IF_01 COND = "!Empty(#TAG EQUIPMENT#[nInc][3])">
                                 <EquipmentTemperature UOM = '"CEL"'>#TAG EQUIPMENT#[nInc][3]</EquipmentTemperature>
                              </IF_01>
                              <IF_02 COND = "!Empty(#TAG EQUIPMENT#[nInc][4])">
                                 <EquipmentAirFlow UOM = '"CBM"'>#TAG EQUIPMENT#[nInc][4]</EquipmentAirFlow>
                              </IF_02>
                           </EquipmentDetails>
                        </FOR_01>
                        <!--Detalhes das Embalagens e Mercadorias -->
                        <PACKAGES PRINT = '"N"'>DetPackages(EEC->EEC_PREEMB, .T.)</PACKAGES>
                        <FOR_02
                           REPL = '"1"'
                           INI = "1"
                           TO ="Len(#TAG PACKAGES#)"
                           VAR = "'nInc'"
                           STEP = "1">
                           <GoodsDetails>
                              <LineNumber>nInc</LineNumber>
                              <PackageDetail>
                                 <NumberOfPackages>AllTrim(Str(#TAG PACKAGES#[nInc][4]))</NumberOfPackages>
                                 <PackageTypeCode>"PCS"</PackageTypeCode>
                              </PackageDetail>
                              <ALIAS_01>"EE9"</ALIAS_01>
                              <ORDER_01>3</ORDER_01>
                              <SEEK_01>xFilial("EE9")+EEC->EEC_PREEMB+#TAG PACKAGES#[nInc][1]</SEEK_01>
                              <PackageDetailComments CommentType = '"GoodsDescription"'>EE9->(MSMM(EE9_DESC,AVSX3("EE9_VM_DES",3),,,3))</PackageDetailComments>
                              <PESOBR Print = '"N"'>CalcPeso(EE9->EE9_PEDIDO,EE9->EE9_SEQUEN,#TAG PACKAGES#[nInc][6],.F.)[2]</PESOBR>
                              <IF_01 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                                 <PackageDetailWeight UOM = '"KGM"'>Transform(#TAG PESOBR#,"99999999999999.999")</PackageDetailWeight>
                              </IF_01>
                              <IF_02 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                                 <PackageDetailWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG",EE9->EE9_COD_I,#TAG PESOBR#,.F.),"99999999999999.999")</PackageDetailWeight>
                              </IF_02>
                              <!--Mercadorias Perigosas -->
                              <ALIAS_02>"EYJ"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EYJ")+#TAG PACKAGES#[nInc][2]</SEEK_02>
                              <IF_03 COND = "EYJ->(!EOF()) .and. !Empty(EYJ->EYJ_GRAVID)">
                                 <IF_01 COND = 'EYJ->EYJ_GRAVID == "1"'>
                                    <HazardousGoods PackingGroupCode = '"MinorDanger"'>
                                       <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                          <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                       </IF_01>
                                       <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                          <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                       </IF_02>
                                       <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                          <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                       </IF_03>
                                       <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                          <FlashpointTemperature UOM = '"CEL"'>Str(EYJ->EYJ_TEMRIS)</FlashpointTemperature>
                                       </IF_04>
                                       <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                          <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                       </IF_05>
                                       <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                          <EmergencyResponseContact>
                                             <ContactInformation>
                                                <ContactName>Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                             </ContactInformation>
                                          </EmergencyResponseContact>
                                       </IF_06>
                                    </HazardousGoods>
                                 </IF_01>
                                 <IF_02 COND = 'EYJ->EYJ_GRAVID == "2"'>
                                    <HazardousGoods PackingGroupCode = '"MediumDanger"'>
                                       <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                          <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                       </IF_01>
                                       <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                          <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                       </IF_02>
                                       <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                          <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                       </IF_03>
                                       <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                          <FlashpointTemperature UOM = '"CEL"'>Str(EYJ->EYJ_TEMRIS)</FlashpointTemperature>
                                       </IF_04>
                                       <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                          <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                       </IF_05>
                                       <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                          <EmergencyResponseContact>
                                             <ContactInformation>
                                                <ContactName>Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                             </ContactInformation>
                                          </EmergencyResponseContact>
                                       </IF_06>
                                    </HazardousGoods>
                                 </IF_02>
                                 <IF_03 COND = 'EYJ->EYJ_GRAVID == "3"'>
                                    <HazardousGoods PackingGroupCode = '"GreatDanger"'>
                                       <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                          <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                       </IF_01>
                                       <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                          <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                       </IF_02>
                                       <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                          <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                       </IF_03>
                                       <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                          <FlashpointTemperature UOM = '"CEL"'>Str(EYJ->EYJ_TEMRIS)</FlashpointTemperature>
                                       </IF_04>
                                       <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                          <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                       </IF_05>
                                       <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                          <EmergencyResponseContact>
                                             <ContactInformation>
                                                <ContactName>Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                             </ContactInformation>
                                          </EmergencyResponseContact>
                                       </IF_06>
                                    </HazardousGoods>
                                 </IF_03>
                              </IF_03>
                           </GoodsDetails>
                        </FOR_02>
                     </MessageDetails>
                  </MessageBody>
               </Message>
            </XML>
         </IF>
      </DATA_SELECTION>
      <DATA_SEND>
         <SEND>''</SEND>
         <CMD>FRM101FLMan('BK', 3, #TAG XML#, #TAG EEC_PREEMB#, cNomFile)</CMD>
      </DATA_SEND>
      <DATA_RECEIVE>
         <SRV_STATUS>.T.</SRV_STATUS>
      </DATA_RECEIVE>
   </SERVICE>
</EASYLINK>
