DLL FUNCTION PrintNormal 	LOCALNAME xPrintNormal		PARAMTYPE PASCAL (cParam1 AS INTEGER, cParam2 AS PCHAR) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION Open		LOCALNAME xOpen			PARAMTYPE PASCAL (cParam1 AS PCHAR) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION Close		LOCALNAME xClose		PARAMTYPE PASCAL () AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION GetResultCode	LOCALNAME xGetResultCode	PARAMTYPE PASCAL () AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION ClaimDevice	LOCALNAME xClaimDevice		PARAMTYPE PASCAL (cParam1 AS INTEGER) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION CutPaper		LOCALNAME xCutPaper		PARAMTYPE PASCAL (cParam1 AS INTEGER) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION TransactionPrint	LOCALNAME xTransactionPrint	PARAMTYPE PASCAL (cParam1 AS INTEGER, cParam2 AS INTEGER) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION PrintBarCode	LOCALNAME xPrintBarCode		PARAMTYPE PASCAL (cParam1 AS INTEGER, cParam2 AS PCHAR, cParam3 AS INTEGER, cParam4 AS INTEGER, cParam5 AS INTEGER, cParam6 AS INTEGER, cParam7 AS INTEGER) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION PutDeviceEnabled 	LOCALNAME xSetDeviceEnabled 	PARAMTYPE PASCAL (cParam1 AS INTEGER) AS VOID LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION GetRecLineWidth  	LOCALNAME xGetRecLineWidth  	PARAMTYPE PASCAL ()                   AS INTEGER  LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION GetDeviceName  	LOCALNAME xGetDeviceName  	PARAMTYPE PASCAL ()                   AS PCHARR  LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

DLL FUNCTION PrintBitmap 	LOCALNAME xPrintBitmap		PARAMTYPE PASCAL (cParam1 AS INTEGER, cParam2 AS PCHAR, cParam3 AS INTEGER, cParam4 AS INTEGER) AS INTEGER LIB "OPOS" COCLASS "POSPrinter" INTERFACE "IOPOSPOSPrinter_1_5"

Function t88(cFunction, aParams, cDelimit, cFimStr)
    
    Local oRet		:= Nil							//Retorno da dll
	Local cBuffer 	:= ""                       	//Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""                         	//Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local cParam4	:= ""							//Variavel auxiliar
	Local cParam5	:= ""							//Variavel auxiliar
	Local cParam6	:= ""							//Variavel auxiliar
	Local cParam7	:= ""							//Variavel auxiliar
	Local cParam8	:= ""							//Variavel auxiliar
	Local cParam9	:= ""							//Variavel auxiliar
	Local cParam10	:= ""							//Variavel auxiliar
	Local cParam11	:= ""							//Variavel auxiliar
	Local cParam12	:= ""							//Variavel auxiliar
	Local cParam13  := ""							//Variavel auxiliar
	Local cParam14	:= ""							//Variavel auxiliar
	Local cParam15	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2 	:= 0							//Variavel auxiliar
	Local nParam3 	:= 0							//Variavel auxiliar
	Local nParam4 	:= 0 							//Variavel auxiliar
	Local nParam5 	:= 0							//Variavel auxiliar
	Local nParam6 	:= 0							//Variavel auxiliar
	
	//Executa o comando selecionado
	Do Case

		Case cFunction == Upper("Open") // Venda	
			cParam1  := DoEncode(aParams[3])
			oRet 	 := xOpen(cParam1)			
		Case cFunction == Upper("Close") // Venda	
			oRet 	 := xClose()
			cBuffer := AllTrim(Str(oRet)) + cFimStr			
		Case cFunction == Upper("PrintNormal") // Venda	
			nParam1 := Val(aParams[3])
			cParam1 := DoEncode(aParams[4])
			oRet 	 := xPrintNormal(nParam1,cParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		Case cFunction == Upper("PrintBitmap") // Venda	
			nParam1 := Val(aParams[3])
			cParam1 := DoEncode(aParams[4])
			nParam2 := Val(aParams[5])
			nParam1 := Val(aParams[6])
			oRet 	:= xPrintBitmap(nParam1,cParam1,nParam2,nParam3)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		Case cFunction == Upper("ClaimDevice")
			nParam1 := Val(aParams[3])
			oRet 	:= XClaimDevice(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		Case cFunction == Upper("CutPaper")
			nParam1 := Val(aParams[3])
			oRet 	:= XCutPaper(nParam1)
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		Case cFunction == Upper("PutDeviceEnabled")
			nParam1 := Val(aParams[3])
			oRet 	:= xSetDeviceEnabled(nParam1)
		Case cFunction == Upper("TransactionPrint")
			nParam1 := Val(aParams[3])
			nParam2 := Val(aParams[4])
			oRet 	:= XTransactionPrint(nParam1, nParam2)
			cBuffer := AllTrim(Str(oRet)) + cFimStr		
		Case cFunction == Upper("GetDeviceName")
			
			MsgStop("01", "Library BematechInterface")
		
			oRet 	:= XGetDeviceName()
			
			MsgStop("02", "Library BematechInterface")
			cBuffer := AllTrim(oRet) + cFimStr	

			MsgStop(cBuffer, "Library BematechInterface")
		
		Case cFunction == Upper("PrintBarCode")
			
			MsgStop(aParams[3], "01")
			MsgStop(aParams[4], "02")
			MsgStop(aParams[5], "03")
			MsgStop(aParams[6], "04")
			MsgStop(aParams[7], "05")
			MsgStop(aParams[8], "06")
			MsgStop(aParams[9], "07")

			nParam1 := Val(aParams[3])
			cParam1 := DoEncode(aParams[4])
			nParam2 := Val(aParams[5])
			nParam3 := Val(aParams[6])
			nParam4 := Val(aParams[7])
			nParam5 := Val(aParams[8])
			nParam6 := Val(aParams[9])
			oRet 	:= XPrintBarCode(nParam1, cParam1, nParam2,nParam3,nParam4,nParam5,nParam6)
			cBuffer := AllTrim(Str(oRet)) + cFimStr						
		Case cFunction == Upper("GetRecLineWidth")
			oRet 	:= XGetRecLineWidth()
			cBuffer := AllTrim(Str(oRet)) + cFimStr
		Otherwise
			cBuffer := "Function not found in BematechInterface.DLL/SO -> "+ cFunction
			MsgStop(cBuffer, "Library BematechInterface")
	EndCase
	
Return cBuffer

