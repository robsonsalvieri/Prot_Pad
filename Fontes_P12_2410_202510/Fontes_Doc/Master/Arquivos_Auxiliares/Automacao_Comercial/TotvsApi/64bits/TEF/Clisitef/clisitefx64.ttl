#IFNDEF LINUX
	DLL FUNCTION ConfiguraIntSiTefInterativo						LOCALNAME SIT_CONF   PARAMTYPE PASCAL ( pEnderecoIP AS PCHAR, pCodigoLoja AS PCHAR, pNumeroTerminal AS PCHAR, ConfiguraResultado AS SMALLINT) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION ConfiguraIntSiTefInterativoEx						LOCALNAME SIT_CONFEX   PARAMTYPE PASCAL ( pEnderecoIP AS PCHAR, pCodigoLoja AS PCHAR, pNumeroTerminal AS PCHAR, ConfiguraResultado AS SMALLINT, pParamAdic AS PCHAR) AS INTEGER LIB "CliSiTEF64i.DLL"

	DLL FUNCTION IniciaFuncaoSiTefInterativo						LOCALNAME SIT_INICIA PARAMTYPE PASCAL ( Modalidade AS INTEGER, pValor AS PCHAR, pNumeroCupomFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR, pOperador AS PCHAR, pRestricoes AS PCHAR) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION FinalizaTransacaoSiTefInterativo					LOCALNAME SIT_FINAL  PARAMTYPE PASCAL ( nConfirma AS INTEGER, pNumeroCupomFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR) AS VOID LIB "CliSiTEF64i.DLL"
	DLL FUNCTION ContinuaFuncaoSiTefInterativo						LOCALNAME SIT_CONTIN PARAMTYPE PASCAL ( ProximoComando AS PINTEGER, TipoCampo AS PINTEGER, TamanhoMinimo AS PSMALLINT, TamanhoMaximo AS PSMALLINT, pBuffer AS PCHAR, TamMaxBuffer AS INTEGER, ContinuaNavegacao AS INTEGER) AS INTEGER LIB "CliSiTEF64i.DLL"
	
	DLL FUNCTION EscreveMensagemPermanentePinPad					LOCALNAME SIT_MSNPIN PARAMTYPE PASCAL ( pMensagem AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION VerificaPresencaPinPad								LOCALNAME SIT_VERPIN PARAMTYPE PASCAL ( ) AS INTEGER LIB "CliSiTEF64i.DLL"

	DLL FUNCTION ObtemDadoPinPadDiretoEx							LOCALNAME SIT_DIGCPF PARAMTYPE PASCAL ( pChaveAcesso As PCHAR, pIdentificador As PCHAR, pEntrada As PCHAR, pSaida As PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"

	DLL FUNCTION CorrespondenteBancarioSiTefInterativo				LOCALNAME SIT_CORRES PARAMTYPE PASCAL ( pNumeroCupomFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR, pOperador AS PCHAR, pRestricoes AS PCHAR) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION ValidaCampoCodigoEmBarras							LOCALNAME SIT_VLDBAR PARAMTYPE PASCAL ( pDados AS PCHAR, pTipo AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"

	DLL FUNCTION IniciaFuncaoSiTefInterativoConsultaVidalink 		LOCALNAME SIT_VDLCON PARAMTYPE PASCAL ( pCodigoAutorizacao AS PCHAR, pCodigoProduto AS PCHAR, pCuponFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR, pOperador AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION InformaProdutoVendaVidalink						LOCALNAME SIT_VDLPRO PARAMTYPE PASCAL ( nIndiceProduto AS INTEGER, pCodigoProduto AS PCHAR,  nQuantidade AS INTEGER, pValorVenda AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION IniciaFuncaoSiTefInterativoVendaVidalink			LOCALNAME SIT_VDLVEN PARAMTYPE PASCAL ( pCodigoAutorizacao AS PCHAR, nNumeroProdutos AS INTEGER, pCuponFiscal AS PCHAR,  pDataFiscal AS PCHAR,  pHorario AS PCHAR, pOperador AS PCHAR) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION IniciaFuncaoSiTefInterativoCancelamentoVidalink	LOCALNAME SIT_VDLCAN PARAMTYPE PASCAL ( nParcialTotal AS INTEGER,  pCuponFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR,  pOperador AS PCHAR) AS INTEGER LIB "CliSiTEF64i.DLL"

	DLL FUNCTION LeSimNaoPinPad										LOCALNAME SIT_LSNPIN PARAMTYPE PASCAL ( pMensagem AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION LeCartaoDireto										LOCALNAME SIT_LECART PARAMTYPE PASCAL ( pMensagem AS PCHAR, pTrilha1 AS PCHAR, pTrilha2 AS PCHAR) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION InterrompeLeCartaoDireto							LOCALNAME SIT_CANCLE PARAMTYPE PASCAL ( ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION LeSenhaDireto										LOCALNAME SIT_LESENH PARAMTYPE PASCAL ( pParam AS PCHAR, pSenha AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION EnviaRecebeSiTefDireto								LOCALNAME SIT_ENVDIR PARAMTYPE PASCAL ( RedeDestino	AS SMALLINT		, FuncaoSitef AS SMALLINT	, OffSetCartao AS SMALLINT	, DadosTx AS PCHAR				, ;
																											TamDadosTx AS SMALLINT		, DadosRx AS PCHAR			, TamMaxDadosRx AS SMALLINT	, CodigoResposta AS PSMALLINT	, ;
																											TempoEsperaRx AS SMALLINT	, CupomFiscal AS PCHAR		, DataFiscal AS PCHAR		, Horario AS PCHAR				, ;
																											Operador AS PCHAR			, TipoTransacao AS SMALLINT ) AS INTEGER LIB "CliSiTEF64i.DLL"
	
	DLL FUNCTION ObtemVersao										LOCALNAME SIT_OBTVER PARAMTYPE PASCAL ( pClisitef AS PCHAR, pClisitefI AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"
	DLL FUNCTION ObtemQuantidadeTransacoesPendentes					LOCALNAME SIT_OBTQTR PARAMTYPE PASCAL ( pDataFiscal AS PCHAR , pCupomFiscal AS PCHAR ) AS INTEGER LIB "CliSiTEF64i.DLL"

#ELSE

	DLL FUNCTION ConfiguraIntSiTefInterativo						LOCALNAME SIT_CONF   PARAMTYPE PASCAL ( pEnderecoIP AS PCHAR, pCodigoLoja AS PCHAR, pNumeroTerminal AS PCHAR, ConfiguraResultado AS SMALLINT) AS INTEGER LIB "./libclisitef.so"
  	DLL FUNCTION ConfiguraIntSiTefInterativoEx						LOCALNAME SIT_CONFEX   PARAMTYPE PASCAL ( pEnderecoIP AS PCHAR, pCodigoLoja AS PCHAR, pNumeroTerminal AS PCHAR, ConfiguraResultado AS SMALLINT, pParamAdic AS PCHAR) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION IniciaFuncaoSiTefInterativo						LOCALNAME SIT_INICIA PARAMTYPE PASCAL ( Modalidade AS INTEGER, pValor AS PCHAR, pNumeroCupomFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR, pOperador AS PCHAR, pRestricoes AS PCHAR) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION FinalizaTransacaoSiTefInterativo					LOCALNAME SIT_FINAL  PARAMTYPE PASCAL ( nConfirma AS INTEGER, pNumeroCupomFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR) AS VOID LIB "./libclisitef.so"
	DLL FUNCTION ContinuaFuncaoSiTefInterativo						LOCALNAME SIT_CONTIN PARAMTYPE PASCAL ( ProximoComando AS PINTEGER, TipoCampo AS PINTEGER, TamanhoMinimo AS PSMALLINT, TamanhoMaximo AS PSMALLINT, pBuffer AS PCHAR, TamMaxBuffer AS INTEGER, ContinuaNavegacao AS INTEGER) AS INTEGER LIB "./libclisitef.so"

	DLL FUNCTION EscreveMensagemPermanentePinPad					LOCALNAME SIT_MSNPIN PARAMTYPE PASCAL ( pMensagem AS PCHAR ) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION VerificaPresencaPinPad								LOCALNAME SIT_VERPIN PARAMTYPE PASCAL ( ) AS INTEGER LIB "./libclisitef.so"
	
	DLL FUNCTION ObtemDadoPinPadDiretoEx							LOCALNAME SIT_DIGCPF PARAMTYPE PASCAL ( pChaveAcesso As PCHAR, pIdentificador As PCHAR, pEntrada As PCHAR, pSaida As PCHAR ) AS INTEGER LIB "./libclisitef.so"

	DLL FUNCTION CorrespondenteBancarioSiTefInterativo				LOCALNAME SIT_CORRES PARAMTYPE PASCAL ( pNumeroCupomFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR, pOperador AS PCHAR, pRestricoes AS PCHAR) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION ValidaCampoCodigoEmBarras							LOCALNAME SIT_VLDBAR PARAMTYPE PASCAL ( pDados AS PCHAR, pTipo AS PCHAR ) AS INTEGER LIB "./libclisitef.so"

	DLL FUNCTION IniciaFuncaoSiTefInterativoConsultaVidalink 		LOCALNAME SIT_VDLCON PARAMTYPE PASCAL ( pCodigoAutorizacao AS PCHAR, pCodigoProduto AS PCHAR, pCuponFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR, pOperador AS PCHAR ) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION InformaProdutoVendaVidalink						LOCALNAME SIT_VDLPRO PARAMTYPE PASCAL ( nIndiceProduto AS INTEGER, pCodigoProduto AS PCHAR,  nQuantidade AS INTEGER, pValorVenda AS PCHAR ) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION IniciaFuncaoSiTefInterativoVendaVidalink			LOCALNAME SIT_VDLVEN PARAMTYPE PASCAL ( pCodigoAutorizacao AS PCHAR, nNumeroProdutos AS INTEGER, pCuponFiscal AS PCHAR,  pDataFiscal AS PCHAR,  pHorario AS PCHAR, pOperador AS PCHAR) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION IniciaFuncaoSiTefInterativoCancelamentoVidalink	LOCALNAME SIT_VDLCAN PARAMTYPE PASCAL ( nParcialTotal AS INTEGER,  pCuponFiscal AS PCHAR, pDataFiscal AS PCHAR, pHorario AS PCHAR,  pOperador AS PCHAR) AS INTEGER LIB "./libclisitef.so"

	DLL FUNCTION LeSimNaoPinPad										LOCALNAME SIT_LSNPIN PARAMTYPE PASCAL ( pMensagem AS PCHAR ) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION LeCartaoDireto										LOCALNAME SIT_LECART PARAMTYPE PASCAL ( pMensagem AS PCHAR, pTrilha1 AS PCHAR, pTrilha2 AS PCHAR) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION InterrompeLeCartaoDireto							LOCALNAME SIT_CANCLE PARAMTYPE PASCAL ( ) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION LeSenhaDireto										LOCALNAME SIT_LESENH PARAMTYPE PASCAL ( pParam AS PCHAR, pSenha AS PCHAR ) AS INTEGER LIB "./libclisitef.so"

	DLL FUNCTION EnviaRecebeSiTefDireto								LOCALNAME SIT_ENVDIR PARAMTYPE PASCAL ( RedeDestino	AS SMALLINT		, FuncaoSitef AS SMALLINT	, OffSetCartao AS SMALLINT	, DadosTx AS PCHAR				, ;
																											TamDadosTx AS SMALLINT		, DadosRx AS PCHAR			, TamMaxDadosRx AS SMALLINT	, CodigoResposta AS PSMALLINT	, ;
																											TempoEsperaRx AS SMALLINT	, CupomFiscal AS PCHAR		, DataFiscal AS PCHAR		, Horario AS PCHAR				, ;
																											Operador AS PCHAR			, TipoTransacao AS SMALLINT ) AS INTEGER LIB "./libclisitef.so"

	DLL FUNCTION ObtemVersao										LOCALNAME SIT_OBTVER PARAMTYPE PASCAL ( pClisitef AS PCHAR, pClisitefI AS PCHAR ) AS INTEGER LIB "./libclisitef.so"
	DLL FUNCTION ObtemQuantidadeTransacoesPendentes					LOCALNAME SIT_OBTQTR PARAMTYPE PASCAL ( pDataFiscal AS PCHAR , pCupomFiscal AS PCHAR ) AS INTEGER LIB "./libclisitef.so"
#ENDIF

Function Clisitef(cFunction, aParams, cDelimit, cFimStr)
    
    Local oRet		:= Nil							//Retorno da dll
	Local cBuffer 	:= ""                       	//Retorno da funcao
	Local cParam1	:= ""							//Variavel auxiliar
	Local cParam2	:= ""                         	//Variavel auxiliar
	Local cParam3	:= ""							//Variavel auxiliar
	Local cParam4	:= ""							//Variavel auxiliar
	Local cParam5	:= ""							//Variavel auxiliar
	Local cParam6	:= ""							//Variavel auxiliar
	Local cParam7	:= ""							//Variavel auxiliar
	Local cParam8	:= ""							//Variavel auxiliar
	Local cParam9	:= ""							//Variavel auxiliar
	Local cParam10	:= ""							//Variavel auxiliar
	Local cParam11	:= ""							//Variavel auxiliar
	Local cParam12	:= ""							//Variavel auxiliar
	Local cParam13  := ""							//Variavel auxiliar
	Local cParam14	:= ""							//Variavel auxiliar
	Local cParam15	:= ""							//Variavel auxiliar
	Local nParam1 	:= 0							//Variavel auxiliar
	Local nParam2 	:= 0							//Variavel auxiliar
	Local nParam3 	:= 0							//Variavel auxiliar
	Local nParam4 	:= 0 							//Variavel auxiliar
	Local nParam5 	:= 0							//Variavel auxiliar
	Local nParam6 	:= 0							//Variavel auxiliar
    Local nParam7	:= 0
    Local nParam8   := 0	

	//Executa o comando selecionado
	Do Case
	
		Case cFunction == Upper("ConfiguraIntSiTefInterativo")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			nParam1 := Val(aParams[6])
			
			oRet := SIT_CONF(cParam1, cParam2, cParam3, nParam1)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr   
		
		Case cFunction == Upper("ConfiguraIntSiTefInterativoEx")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			nParam1 := Val(aParams[6])
			cParam4 := DoEncode(aParams[7])
			
			oRet := SIT_CONFEX(cParam1, cParam2, cParam3, nParam1, cParam4)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr

		Case cFunction == Upper("ObtemDadoPinPadDiretoEx")

			cParam1	:= DoEncode(aParams[3]) // Chave	-> string vazia
			cParam2	:= DoEncode(aParams[4]) // Codigo 	-> string vazia
			cParam3	:= DoEncode(aParams[5]) // Entrada	-> "011111DIGITE SEU CPF                  CONFIRME O CPF  "
			cParam4	:= Space(20000) // Saida			-> "011100000000000"

			oRet 	:= SIT_DIGCPF( cParam1, cParam2, cParam3, cParam4 )

			cBuffer	:=	AllTrim(Str(oRet)) + cDelimit +;
			 			SubStr( AllTrim(DoDecode(cParam4) ) ,5, 15) + cFimStr

		Case cFunction == Upper("IniciaFuncaoSiTefInterativo")
			
			nParam1 := Val(aParams[3])
			cParam1 := DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			cParam4 := DoEncode(aParams[7])
			cParam5 := DoEncode(aParams[8])
			cParam6 := DoEncode(aParams[9])
			
			oRet := SIT_INICIA(nParam1, cParam1, cParam2, cParam3, cParam4, cParam5, cParam6)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr		

		Case cFunction == Upper("ContinuaFuncaoSiTefInterativo")
			
			nParam1 := Val(aParams[3])
			nParam2 := Val(aParams[4])
			nParam3 := Val(aParams[5])
			nParam4 := Val(aParams[6])
			cParam1 := DoEncode(AllTrim(aParams[7]))
			nParam5 := Val(aParams[8])
			nParam6 := Val(aParams[9])
			
			SETBUFFSIZE(cParam1,20000)
						
			oRet := SIT_CONTIN(nParam1, nParam2, nParam3, nParam4, cParam1, nParam5, nParam6)
			
			cBuffer := AllTrim(Str(oRet)) + cDelimit + ;
			 		   AllTrim(Str(nParam1)) + cDelimit + ;
			 		   AllTrim(Str(nParam2)) + cDelimit + ;
			 		   AllTrim(Str(nParam3)) + cDelimit + ;
			 		   AllTrim(Str(nParam4)) + cDelimit + ;
			 		   DoDecode(cParam1) + cDelimit + ;
			 		   AllTrim(Str(nParam5)) + cDelimit + ;
			 		   AllTrim(Str(nParam6)) + cFimStr

		Case cFunction == Upper("FinalizaTransacaoSiTefInterativo")
			
			nParam1 := Val(aParams[3])
			cParam1 := DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
						
			SIT_FINAL(nParam1, cParam1, cParam2, cParam3)
			
			cBuffer := "1" + cDelimit + ;
			 		   DoDecode(cParam1) + cDelimit + ;
			           DoDecode(cParam2) + cDelimit + ;
			           DoDecode(cParam3) + cFimStr  			 		   
			
		Case cFunction == Upper("EnviaRecebeSitefDireto")
			
			nParam1 := Val(aParams[3])
			nParam2 := Val(aParams[4])
			nParam3 := Val(aParams[5])
			cParam1 := DoEncode(aParams[6])
			nParam4 := Val(aParams[7])
			cParam2 := DoEncode(aParams[8])
			nParam5 := Val(aParams[9])
			nParam6 := Val(aParams[10])
			nParam7 := Val(aParams[11])	
			cParam3 := DoEncode(aParams[12])
			cParam4 := DoEncode(aParams[13])
			cParam5 := DoEncode(aParams[14])
			cParam6 := DoEncode(aParams[15])
			nParam8 := Val(aParams[16])	
						
			oRet := SIT_ENVDIR(nParam1, nParam2, nParam3, cParam1, nParam4, cParam2, nParam5, nParam6, nParam7, cParam3, cParam4, cParam5, cParam6, nParam8)
			
			cBuffer := AllTrim(Str(oRet)) + cDelimit + ;
			 		   AllTrim(Str(nParam1)) + cDelimit + ;
			 		   AllTrim(Str(nParam2)) + cDelimit + ;
			 		   AllTrim(Str(nParam3)) + cDelimit + ;
			 		   DoDecode(cParam1) + cDelimit + ;
   			 		   AllTrim(Str(nParam4)) + cDelimit + ;
			 		   DoDecode(cParam2) + cDelimit + ;			 		   
			 		   AllTrim(Str(nParam5)) + cDelimit + ;
			 		   AllTrim(Str(nParam6)) + cDelimit + ;			 		   
			 		   AllTrim(Str(nParam7)) + cDelimit + ;
			 		   DoDecode(cParam3) + cDelimit + ;
			 		   DoDecode(cParam4) + cDelimit + ;			 		   			 		   
			 		   DoDecode(cParam5) + cDelimit + ;			 		   			 		   
			 		   DoDecode(cParam6) + cDelimit + ;			 		   			 		   
			 		   AllTrim(Str(nParam8)) + cFimStr
		
		Case cFunction == Upper("CorrespondenteBancarioSiTefInterativo")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			
			oRet := SIT_CORRES(cParam1, cParam2, cParam3, cParam4, cParam5)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			

		Case cFunction == Upper("ValidaCampoCodigoEmBarras")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			
			oRet := SIT_VLDBAR(cParam1, cParam2)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			

		Case cFunction == Upper("VerificaPresencaPinPad")
			
			oRet := SIT_VERPIN()
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			
		
		Case cFunction == Upper("EscreveMensagemPermanentePinPad")
			
			cParam1 := DoEncode(aParams[3])
			
			oRet := SIT_MSNPIN(cParam1)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			

		Case cFunction == Upper("IniciaFuncaoSiTefInterativoConsultaVidalink")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
			cParam4 := DoEncode(aParams[6])
			cParam5 := DoEncode(aParams[7])
			cParam6 := DoEncode(aParams[8])
			
			oRet := SIT_VDLCON(cParam1, cParam2, cParam3, cParam4, cParam5, cParam6)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			

		Case cFunction == Upper("InformaProdutoVendaVidalink")
			
			nParam1 := Val(aParams[3])
			cParam1 := DoEncode(aParams[4])
			nParam2 := Val(aParams[5])
			cParam2 := DoEncode(aParams[6])
			
			oRet := SIT_VDLPRO(nParam1, cParam1, nParam2, cParam2)			
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr						

		Case cFunction == Upper("IniciaFuncaoSiTefInterativoVendaVidalink")
			
			cParam1 := DoEncode(aParams[3])
			nParam1 := Val(aParams[4])			
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			cParam4 := DoEncode(aParams[7])
			cParam5 := DoEncode(aParams[8])
			
			oRet := SIT_VDLVEN(cParam1, nParam1, cParam2, cParam3, cParam4, cParam5)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			
		
		Case cFunction == Upper("IniciaFuncaoSiTefInterativoCancelamentoVidalink")
			
			nParam1 := Val(aParams[3])			
			cParam1 := DoEncode(aParams[4])
			cParam2 := DoEncode(aParams[5])
			cParam3 := DoEncode(aParams[6])
			cParam4 := DoEncode(aParams[7])
			
			oRet := SIT_VDLCAN(nParam1, cParam1, cParam2, cParam3, cParam4)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr	
					
		Case cFunction == Upper("LeCartaoDireto")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			cParam3 := DoEncode(aParams[5])
						
			oRet := SIT_LECART(cParam1, cParam2, cParam3)
			
			cBuffer := AllTrim(Str(oRet)) + cDelimit + ;
			 		   DoDecode(cParam1) + cDelimit + ;
			           DoDecode(cParam2) + cDelimit + ;
			           DoDecode(cParam3) + cFimStr  			 		   

		Case cFunction == Upper("InterrompeLeCartaoDireto")
			
			oRet := SIT_CANCLE()
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			

		Case cFunction == Upper("LeSenhaDireto")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
						
			oRet := SIT_LESENH(cParam1, cParam2)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr			

		Case cFunction == Upper("LeSimNaoPinPad")
			
			cParam1 := DoEncode(aParams[3])
						
			oRet := SIT_LSNPIN(cParam1)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr	
			
		Case cFunction == Upper("ObtemVersao")
			
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
						
			oRet := SIT_OBTVER(cParam1, cParam2)
			
			cBuffer := AllTrim(Str(oRet)) + cDelimit + DoDecode(cParam1) + cDelimit + DoDecode(cParam2) + cFimStr
		
		Case cFunction == Upper("ObtemQuantidadeTransacoesPendentes")
			cParam1 := DoEncode(aParams[3])
			cParam2 := DoEncode(aParams[4])
			
			oRet := SIT_OBTQTR(cParam1, cParam2)
			
			cBuffer := AllTrim(Str(oRet)) + cFimStr
			
		Otherwise
			
			cBuffer := "Function not found in CliSiTEF64i.DLL/libclisitef.so -> "+ cFunction
			MsgStop(cBuffer, "Library ClisitefInterface")
	
	EndCase
	
Return cBuffer