<?xml version="1.0" encoding="ISO-8859-1" ?>
<EASYLINK>
   <SERVICE>
      <ID>003</ID>
      <DATA_SELECTION>
         <EEC_PREEMB>cProcesso</EEC_PREEMB>
         <CMD>EEC->(DbSeek(xFilial("EEC")+#TAG EEC_PREEMB#))</CMD>
         <IF COND = "!Empty(#TAG EEC_PREEMB#)">
            <CMD>EEC->(DbSeek(xFilial("EEC")+#TAG EEC_PREEMB#))</CMD>
            <XML>
               <Message>
                  <Header>
                     <MessageType MessageVersion = '"1.0"'>"ShippingInstruction"</MessageType>
                     <DocumentIdentifier>#TAG EEC_PREEMB#</DocumentIdentifier>
                     <DateTime DateType = '"Document"'>Right(DToS(Date()), 6)+Substr(Time(),1,2)+Substr(Time(),4,2)</DateTime>
                     <Parties>
                        <PartnerInformation PartnerRole = '"Sender"'>
                           <ALIAS_01>"EYI"</ALIAS_01>
                           <ORDER_01>1</ORDER_01>
                           <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                           <PartnerIdentifier Agency = '"AssignedBySender"'>Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                           <PartnerName>AllTrim(Left(EYI->EYI_NOMEIN,35))</PartnerName>
                           <ALIAS_02>"EE3"</ALIAS_02>
                           <ORDER_02>1</ORDER_02>
                           <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_02>
                           <WHILE_02 REPL = '"1"' COND = 'EE3->(!EOF()) .and. EE3->(EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL) == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))'>
                              <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                 <ContactInformation>
                                    <ContactName ContactType = '"Informational"'>Left(EE3->EE3_NOME,35)</ContactName>
                                    <IF_01 COND = "!Empty(EE3->EE3_EMAIL)">
                                       <CommunicationValue CommunicationType = '"Email"'>EE3->EE3_EMAIL</CommunicationValue>
                                    </IF_01>
                                    <IF_02 COND = "Empty(EE3->EE3_EMAIL) .And. !Empty(EE3->EE3_FONE)">
                                       <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                    </IF_02>
                                    <IF_03 COND = "Empty(EE3->EE3_EMAIL) .And. Empty(EE3->EE3_FONE) .And. !Empty(EE3->EE3_FAX)">
                                       <CommunicationValue CommunicationType = '"Fax"'>EE3->EE3_FAX</CommunicationValue>
                                    </IF_03>
                                 </ContactInformation>
                                 <EXIT/>
                              </IF>
                              <SKIP>"EE3"</SKIP>
                           </WHILE_02>
                        </PartnerInformation>
                        <PartnerInformation PartnerRole = '"Recipient"'>
                           <PartnerIdentifier Agency = '"AssignedByRecipient"'>"INTTRA"</PartnerIdentifier>
                        </PartnerInformation>
                     </Parties>
                  </Header>
                  <MessageBody>
                     <MessageProperties>
                        <!--Identificação do Embarque -->
                        <ShipmentID>
                           <ShipmentIdentifier MessageStatus = "cOpcao">cProcesso + cNomFile</ShipmentIdentifier>
                           <DocumentVersion>"001"</DocumentVersion>
                           -->> VERIFICAR(Caso não seja o documento Original)
                        </ShipmentID>
                        <!--Data de criação do SI -->
                        <DateTime DateType = '"Document"'>Left(DTOS(Date()),4)+Substr(DTOS(Date()),5,4)+Substr(Time(),1,2)+Substr(Time(),4,2)</DateTime>
                        <!--Tipo de Pagamento de Frete -->
                        <IF_01 COND = 'EEC->EEC_FRPPCC == "CC"'>
                           <ChargeCategory PrepaidorCollectIndicator = '"Collect"' ChargeType = '"AllCharges"'>""</ChargeCategory>
                        </IF_01>
                        <IF_02 COND = 'EEC->EEC_FRPPCC == "PP"'>
                           <ChargeCategory PrepaidorCollectIndicator = '"Prepaid"' ChargeType = '"AllCharges"'>""</ChargeCategory>
                        </IF_02>
                        <!--Valor Total do Embarque -->
                        <ALIAS_01>"SYF"</ALIAS_01>
                        <ORDER_01>1</ORDER_01>
                        <SEEK_01>xFilial("SYF")+EEC->EEC_MOEDA</SEEK_01>
                        <ALIAS_02>"EXL"</ALIAS_02>
                        <ORDER_02>1</ORDER_02>
                        <SEEK_02>xFilial("EXL")+EEC->EEC_PREEMB</SEEK_02>
                        <IF_03 COND = 'EXL->EXL_ENVVAL == "1"'>
                           <ShipmentDeclaredValue Currency = "AllTrim(SYF->YF_ISO)">Str(EEC->EEC_TOTPED)</ShipmentDeclaredValue>
                        </IF_03>
                        <!--Detalhes da Carta de Crédito -->
                        <IF_04 COND = "!Empty(EEC->EEC_LC_NUM)">
                           <LetterOfCreditDetails>
                              <LetterOfCreditNumber>Left(EEC->EEC_LC_NUM,35)</LetterOfCreditNumber>
                              <IF_01 COND = "!Empty(EEC->EEC_SL_LC)">
                                 <DateTime DateType = '"IssueDate"'>DtoS(EEC->EEC_SL_LC)</DateTime>
                              </IF_01>
                              <ALIAS>"EEL"</ALIAS>
                              <ORDER>1</ORDER>
                              <SEEK>xFilial("EEL")+EEC->EEC_LC_NUM</SEEK>
                              <IF_02 COND = "!Empty(EEL->EEL_DT_VEN)">
                                 <DateTime DateType = '"ExpiryDate"'>DtoS(EEL->EEL_DT_VEN)</DateTime>
                              </IF_02>
                           </LetterOfCreditDetails>
                        </IF_04>
                        <!--Localidades do B/L-->
                        <BlLocations>
                           <!--Local de Pagamento de Frete -->
                           <IF COND = "!Empty(EXL->EXL_LOCFRE)">
                              <Location LocationType = '"FreightPaymentLocation"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EXL->EXL_LOCFRE</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                              </Location>
                           </IF>
                           <!--BL Release -->
                           <ALIAS>"SY9"</ALIAS>
                           <ORDER>2</ORDER>
                           <SEEK>xFilial("SY9")+EEC->EEC_ORIGEM</SEEK>
                           <Location LocationType = '"BillOfLadingRelease"'>
                              <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                              <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                           </Location>
                        </BlLocations>
                        <!--Número do Booking -->
                        <IF_05 COND = "!Empty(EXL->EXL_BOOK)">
                           <ReferenceInformation ReferenceType = '"BookingNumber"'>Left(EXL->EXL_BOOK,35)</ReferenceInformation>
                        </IF_05>
                        <!--Número do BL -->
                        <IF_06 COND = "!Empty(EEC->EEC_NRCONH)">
                           <ReferenceInformation ReferenceType = '"BillOfLadingNumber"'>Left(EEC->EEC_NRCONH,35)</ReferenceInformation>
                        </IF_06>
                        <!--Número de Referência do Despachante -->
                        <ALIAS_03>"EEB"</ALIAS_03>
                        <ORDER_03>1</ORDER_03>
                        <SEEK_03>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_03>
                        <WHILE_03 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                           <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="6"'>
                              <IF COND = "!Empty(EEB->EEB_REFAGE)">
                                 <ReferenceInformation ReferenceType = '"BrokeReferenceNumber"'>Left(EEB->EEB_REFAGE,35)</ReferenceInformation>
                              </IF>
                              <EXIT/>
                           </IF>
                           <SKIP>"EEB"</SKIP>
                        </WHILE_03>
                        <!--Número de Referência do Importador -->
                        <IF_07 COND = "!Empty(EEC->EEC_REFIMP)">
                           <ReferenceInformation ReferenceType = '"ConsigneeOrderNumber"'>Left(EEC->EEC_REFIMP,35)</ReferenceInformation>
                        </IF_07>
                        <!--Número de Contrato com o Armador -->
                        <ALIAS_04>"EEB"</ALIAS_04>
                        <ORDER_04>1</ORDER_04>
                        <SEEK_04>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_04>
                        <WHILE_04 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                           <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="4"'>
                              <IF COND = "!Empty(EEB->EEB_CONTR)">
                                 <ReferenceInformation ReferenceType = '"ContractNumber"'>Left(EEB->EEB_CONTR,35)</ReferenceInformation>
                              </IF>
                              <EXIT/>
                           </IF>
                           <SKIP>"EEB"</SKIP>
                        </WHILE_04>
                        <!--Identificação do Exportador -->
                        <ReferenceInformation ReferenceType = '"ExportersReferenceNumber"'>Left(EEC->EEC_PREEMB,35)</ReferenceInformation>
                        <!--Referencia do Freight Forwarder -->
                        <ALIAS_05>"EEB"</ALIAS_05>
                        <ORDER_05>1</ORDER_05>
                        <SEEK_05>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_05>
                        <WHILE_05 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                           <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="C"'>
                              <IF COND = "!Empty(EEB->EEB_REFAGE)">
                                 <ReferenceInformation ReferenceType = '"FreightForwarderReference"'>Left(EEB->EEB_REFAGE,35)</ReferenceInformation>
                              </IF>
                              <EXIT/>
                           </IF>
                           <SKIP>"EEB"</SKIP>
                        </WHILE_05>
                        <!--Invoices -->
                        <ALIAS_06>"EXP"</ALIAS_06>
                        <ORDER_06>1</ORDER_06>
                        <SEEK_06>xFilial("EXP")+EEC->EEC_PREEMB</SEEK_06>
                        <WHILE_06 REPL = '"1"' COND = 'EXP->(!EOF()) .and. EXP->(EXP_FILIAL+EXP_PREEMB) == xFilial("EXP")+EEC->EEC_PREEMB'>
                           <ReferenceInformation ReferenceType = '"InvoiceNumber"'>Left(EXP->EXP_NRINVO,35)</ReferenceInformation>
                           <SKIP>"EEB"</SKIP>
                        </WHILE_06>
                        <!--Pedidos -->
                        <PEDIDOS Print = '"N"'>DetPedidos(EEC->EEC_PREEMB)</PEDIDOS>
                        <FOR_01
                           INI = "1"
                           TO = "Len(#TAG PEDIDOS#)"
                           VAR = '"nInc"'
                           STEP = "1"
                           REPL = '"1"'>
                           <ReferenceInformation ReferenceType = '"PurchaseOrderNumber"'>Left(#TAG PEDIDOS#[nInc],35)</ReferenceInformation>
                        </FOR_01>
                        <!--Identificação do Embarcador -->
                        <ReferenceInformation ReferenceType = '"ShipperIdentifyingNumber"'>Left(EEC->EEC_PREEMB,35)</ReferenceInformation>
                        <IF_08 COND = "!Empty(EXL->EXL_CSICOM) .Or.  !Empty(EXL->EXL_BLCLA1) .Or. !Empty(EXL->EXL_BLCLA2) .Or. !Empty(EXL->EXL_BLCLA3) ">
                           <Instructions>
                              <!--Comentários do Shipping Instructions-->
                              <IF_01 COND = "!Empty(EXL->EXL_CSICOM)">
                                 <ShipmentComments CommentType = '"General"'>EXL->(MSMM(EXL_CSICOM,AVSX3("EXL_SICOM",3),,,3))</ShipmentComments>
                                 -->> VERIFICAR(Memo)
                              </IF_01>
                              <!--Clausula de BL 01 -->
                              <IF_02 COND = "!Empty(EXL->EXL_BLCLA1)">
                                 <IF_01 COND = "Empty(EXL->EXL_CBLCL1)">
                                    <ShipmentComments CommentType = '"BlClause"' ClauseType = "EXL->EXL_BLCLA1">""</ShipmentComments>
                                 </IF_01>
                                 <IF_02 COND = "!Empty(EXL->EXL_CBLCL1)">
                                    <ShipmentComments CommentType = '"BlClause"' ClauseType = "EXL->EXL_BLCLA1">EXL->(MSMM(EXL_CBLCL1,AVSX3("EXL_BLCLM1",3),,,3))</ShipmentComments>
                                 </IF_02>
                              </IF_02>
                              <!--Clausula de BL 02 -->
                              <IF_03 COND = "!Empty(EXL->EXL_BLCLA2)">
                                 <IF_01 COND = "Empty(EXL->EXL_CBLCL2)">
                                    <ShipmentComments CommentType = '"BlClause"' ClauseType = "EXL->EXL_BLCLA2">""</ShipmentComments>
                                 </IF_01>
                                 <IF_02 COND = "!Empty(EXL->EXL_CBLCL2)">
                                    <ShipmentComments CommentType = '"BlClause"' ClauseType = "EXL->EXL_BLCLA2">EXL->(MSMM(EXL_CBLCL2,AVSX3("EXL_BLCLM2",3),,,3))</ShipmentComments>
                                 </IF_02>
                              </IF_03>
                              <!--Clausula de BL 03 -->
                              <IF_04 COND = "!Empty(EXL->EXL_BLCLA3)">
                                 <IF_01 COND = "Empty(EXL->EXL_CBLCL3)">
                                    <ShipmentComments CommentType = '"BlClause"' ClauseType = "EXL->EXL_BLCLA3">""</ShipmentComments>
                                 </IF_01>
                                 <IF_02 COND = "!Empty(EXL->EXL_CBLCL3)">
                                    <ShipmentComments CommentType = '"BlClause"' ClauseType = "EXL->EXL_BLCLA3">EXL->(MSMM(EXL_CBLCL3,AVSX3("EXL_BLCLM3",3),,,3))</ShipmentComments>
                                 </IF_02>
                              </IF_04>
                           </Instructions>
                        </IF_08>
                        <ControlTotal>
                           <!--Total de Containeres -->
                           <TOT_EQUIP Print = '"N"'>TotEquipment(EEC->EEC_PREEMB)</TOT_EQUIP>
                           <NumberOfEquipment>Str(#TAG TOT_EQUIP#)</NumberOfEquipment>
                           <!--Total de Embalagens Externas-->
                           <TOT_PACKAGE Print = '"N"'>TotPackages(EEC->EEC_PREEMB)</TOT_PACKAGE>
                           <NumberOfPackages>Str(#TAG TOT_PACKAGE#)</NumberOfPackages>
                           <!--Peso Bruto Total -->
                           <IF_01 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                              <GrossWeight UOM = '"KGM"'>Transform(EEC->EEC_PESBRU,"99999999999999.999")</GrossWeight>
                           </IF_01>
                           <IF_02 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                              <GrossWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG",,EEC->EEC_PESBRU,.F.),"99999999999999.999")</GrossWeight>
                           </IF_02>
                           <TOT_VOLUME Print = '"N"'>TotVolume(EEC->EEC_PREEMB)</TOT_VOLUME>
                           <GrossVolume UOM = '"MTQ"'>Transform(#TAG TOT_VOLUME#,"99999999999999.999")</GrossVolume>
                        </ControlTotal>
                        <IF_09 COND = 'EXL->EXL_TIPMOV == "1"'>
                           <HaulageDetails MovementType = '"PortToPort"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                        </IF_09>
                        <IF_10 COND = 'EXL->EXL_TIPMOV == "2"'>
                           <HaulageDetails MovementType = '"DoorToPort"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                        </IF_10>
                        <IF_11 COND = 'EXL->EXL_TIPMOV == "3"'>
                           <HaulageDetails MovementType = '"PortToDoor"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                        </IF_11>
                        <IF_12 COND = 'EXL->EXL_TIPMOV == "4"'>
                           <HaulageDetails MovementType = '"DoorToDoor"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                        </IF_12>
                        <TransportationDetails TransportStage = '"Main"' TransportMode = '"Maritime"'>
                           <ConveyanceInformation>
                              <IF_01 COND = "!Empty(EEC->EEC_EMBARC)">
                                 <ALIAS>"EE6"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("EE6")+AvKey(EEC->EEC_EMBARC,"EE6_COD")</SEEK>
                                 <ConveyanceName>Left(EE6_NOME,35)</ConveyanceName>
                              </IF_01>
                              <IF_02 COND = "!Empty(EEC->EEC_VIAGEM)">
                                 <VoyageTripNumber>Left(EEC->EEC_VIAGEM,17)</VoyageTripNumber>
                              </IF_02>
                              <IF_03 COND = "Empty(EEC->EEC_VIAGEM) .and. !Empty(EEC->EEC_EMBARC)">
                                 <VoyageTripNumber>Left(EE6->EE6_VIAGEM,17)</VoyageTripNumber>
                              </IF_03>
                              <ALIAS>"EEB"</ALIAS>
                              <ORDER>1</ORDER>
                              <SEEK>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK>
                              <WHILE REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                                 <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="4"'>
                                    <ALIAS>"SY5"</ALIAS>
                                    <ORDER>1</ORDER>
                                    <SEEK>xFilial("SY5")+AvKey(EEB->EEB_CODAGE,"Y5_COD")</SEEK>
                                    <CarrierSCAC>SY5->Y5_SCAC</CarrierSCAC>
                                    <EXIT/>
                                 </IF>
                              </WHILE>
                           </ConveyanceInformation>
                           <!--Local de Recebimento -->
                           <IF_01 COND = "!Empty(EXL->EXL_LOCREC)">
                              <Location LocationType = '"PlaceOfReceipt"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EXL->EXL_LOCREC</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                              </Location>
                           </IF_01>
                           <!--Porto de Origem -->
                           <Location LocationType = '"PortOfLoading"'>
                              <ALIAS>"SY9"</ALIAS>
                              <ORDER>2</ORDER>
                              <SEEK>xFilial("SY9")+EEC->EEC_ORIGEM</SEEK>
                              <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                              <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                           </Location>
                           <!--Porto de Destino -->
                           <Location LocationType = '"PortOfDischarge"'>
                              <ALIAS>"SY9"</ALIAS>
                              <ORDER>2</ORDER>
                              <SEEK>xFilial("SY9")+EEC->EEC_DEST</SEEK>
                              <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                              <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                           </Location>
                           <!--Local de Entrega -->
                           <IF_02 COND = "!Empty(EXL->EXL_LOCENT)">
                              <Location LocationType = '"PlaceOfDelivery"'>
                                 <ALIAS>"SY9"</ALIAS>
                                 <ORDER>2</ORDER>
                                 <SEEK>xFilial("SY9")+EXL->EXL_LOCENT</SEEK>
                                 <LocationCode Agency = '"UN"'>SY9->Y9_UNCODE</LocationCode>
                                 <LocationName>AllTrim(SY9->Y9_DESCR)</LocationName>
                              </Location>
                           </IF_02>
                        </TransportationDetails>
                        <!--Participantes -->
                        <Parties>
                           <!--Armador -->
                           <ALIAS_01>"EEB"</ALIAS_01>
                           <ORDER_01>1</ORDER_01>
                           <SEEK_01>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_01>
                           <WHILE_01 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                              <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="4"'>
                                 <ALIAS>"SY5"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("SY5")+AvKey(EEB->EEB_CODAGE,"Y5_COD")</SEEK>
                                 <PartnerInformation PartnerRole = '"Carrier"'>
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>SY5->Y5_SCAC</PartnerIdentifier>
                                    <PartnerName>Left(SY5->Y5_NOME,35)</PartnerName>
                                 </PartnerInformation>
                              </IF>
                              <SKIP>"EEB"</SKIP>
                           </WHILE_01>
                           <!--Consignatário -->
                           <ALIAS_02>"EXJ"</ALIAS_02>
                           <ORDER_02>1</ORDER_02>
                           <SEEK_02>xFilial("EXJ")+If(!Empty(EEC->EEC_CONSIG),EEC->(EEC_CONSIG+EEC_COLOJA),EEC->(EEC_IMPORT+EEC_IMLOJA))</SEEK_02>
                           <IF_01 COND = "!Empty(EXJ->EXJ_INTTRA)">
                              <PartnerInformation PartnerRole = '"Consignee"'>
                                 <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                 <PartnerName>Left(EEC->EEC_IMPODE,35)</PartnerName>
                              </PartnerInformation>
                           </IF_01>
                           <!--Exportador -->
                           <PartnerInformation PartnerRole = '"Exporter"'>
                              <ALIAS_01>"EYI"</ALIAS_01>
                              <ORDER_01>1</ORDER_01>
                              <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                              <PartnerIdentifier Agency = '"AssignedBySender"'>Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                              <PartnerName>Left(EYI->EYI_NOMEIN,35)</PartnerName>
                              <!--Contato -->
                              <ALIAS_02>"EE3"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_02>
                              <WHILE_02 REPL = '"1"' COND = 'EE3->(!EOF()) .and. EE3->(EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL) == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))'>
                                 <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                    <ContactInformation>
                                       <ContactName ContactType = '"Informational"'>Left(EE3->EE3_NOME,35)</ContactName>
                                       <IF COND = "!Empty(EE3->EE3_FONE)">
                                          <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                       </IF>
                                    </ContactInformation>
                                    <EXIT/>
                                 </IF>
                                 <SKIP>"EE3"</SKIP>
                              </WHILE_02>
                           </PartnerInformation>
                           <!--Agente no Exterior. FreightForwarder -->
                           <ALIAS_03>"EEB"</ALIAS_03>
                           <ORDER_03>1</ORDER_03>
                           <SEEK_03>xFilial("EEB")+EEC->EEC_PREEMB+"Q"</SEEK_03>
                           <WHILE_03 REPL = '"1"' COND = 'EEB->(!EOF()) .and. EEB->(EEB_FILIAL+EEB_PEDIDO+EEB_OCORRE)== xFilial("EEB")+EEC->EEC_PREEMB+"Q"'>
                              <IF COND = 'Left(EEB->EEB_TIPOAG,1)=="C"'>
                                 <ALIAS>"SY5"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("SY5")+AvKey(EEB->EEB_CODAGE,"Y5_COD")</SEEK>
                                 <PartnerInformation PartnerRole = '"FreightForwarder"'>
                                    <IF COND = "!Empty(SY5->Y5_CODIN)">
                                       <PartnerIdentifier Agency = '"AssignedBySender"'>SY5->Y5_CODIN</PartnerIdentifier>
                                    </IF>
                                    <PartnerName>Left(SY5->Y5_NOME,35)</PartnerName>
                                 </PartnerInformation>
                                 <EXIT/>
                              </IF>
                              <SKIP>"EEB"</SKIP>
                           </WHILE_03>
                           <!--Notifys do Processo -->
                           <ALIAS_04>"EEN"</ALIAS_04>
                           <ORDER_04>1</ORDER_04>
                           <SEEK_04>xFilial("EEN")+EEC->EEC_PREEMB+"Q"</SEEK_04>
                           <IF_02 COND = 'EEN->(!EOF()) .and. EEN->(EEN_FILIAL+EEN_PROCES+EEN_OCORRE) == xFilial("EEN")+EEC->EEC_PREEMB+"Q"'>
                              <PartnerInformation PartnerRole = '"NotifyParty"'>
                                 <ALIAS>"EXJ"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("EXJ")+EEN->(EEN_IMPORT+EEN_IMLOJA)</SEEK>
                                 <IF_01 COND = "EXJ->(!EOF())">
                                    <IF COND = "!Empty(EXJ->EXJ_INTTRA)">
                                       <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                    </IF>
                                 </IF_01>
                                 <PartnerName>Left(EEN->EEN_IMPODE,35)</PartnerName>
                              </PartnerInformation>
                              <SKIP>"EEN"</SKIP>
                              <IF_02 COND = 'EEN->(!EOF()) .and. EEN->(EEN_FILIAL+EEN_PROCES+EEN_OCORRE) == xFilial("EEN")+EEC->EEC_PREEMB+"Q"'>
                                 <PartnerInformation PartnerRole = '"NotifyParty1"'>
                                    <ALIAS>"EXJ"</ALIAS>
                                    <ORDER>1</ORDER>
                                    <SEEK>xFilial("EXJ")+EEN->(EEN_IMPORT+EEN_IMLOJA)</SEEK>
                                    <IF_01 COND = "EXJ->(!EOF())">
                                       <IF COND = "!Empty(EXJ->EXJ_INTTRA)">
                                          <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                       </IF>
                                    </IF_01>
                                    <PartnerName>Left(EEN->EEN_IMPODE,35)</PartnerName>
                                 </PartnerInformation>
                                 <SKIP>"EEN"</SKIP>
                              </IF_02>
                              <IF_03 COND = 'EEN->(!EOF()) .and. EEN->(EEN_FILIAL+EEN_PROCES+EEN_OCORRE) == xFilial("EEN")+EEC->EEC_PREEMB+"Q"'>
                                 <PartnerInformation PartnerRole = '"NotifyParty2"'>
                                    <ALIAS>"EXJ"</ALIAS>
                                    <ORDER>1</ORDER>
                                    <SEEK>xFilial("EXJ")+EEN->(EEN_IMPORT+EEN_IMLOJA)</SEEK>
                                    <IF_01 COND = "EXJ->(!EOF())">
                                       <IF COND = "!Empty(EXJ->EXJ_INTTRA)">
                                          <PartnerIdentifier Agency = '"AssignedBySender"'>EXJ->EXJ_INTTRA</PartnerIdentifier>
                                       </IF>
                                    </IF_01>
                                    <PartnerName>Left(EEN->EEN_IMPODE,35)</PartnerName>
                                 </PartnerInformation>
                                 <SKIP>"EEN"</SKIP>
                              </IF_03>
                           </IF_02>
                           <!--Requisitante do SI -->
                           <PartnerInformation PartnerRole = '"Requestor"'>
                              <ALIAS_01>"EYI"</ALIAS_01>
                              <ORDER_01>1</ORDER_01>
                              <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                              <PartnerIdentifier Agency = '"AssignedBySender"'>Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                              <PartnerName>Left(EYI->EYI_NOMEIN,35)</PartnerName>
                              <!--Contato -->
                              <ALIAS_02>"EE3"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_02>
                              <WHILE_02 REPL = '"1"' COND = 'EE3->(!EOF()) .and. EE3->(EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL) == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))'>
                                 <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                    <ContactInformation>
                                       <ContactName ContactType = '"Informational"'>Left(EE3->EE3_NOME,35)</ContactName>
                                       <IF COND = "!Empty(EE3->EE3_FONE)">
                                          <CommunicationValue CommunicationType = '"Telephone"'>EE3->EE3_FONE</CommunicationValue>
                                       </IF>
                                    </ContactInformation>
                                    <EXIT/>
                                 </IF>
                                 <SKIP>"EE3"</SKIP>
                              </WHILE_02>
                              <IF_01 COND = "!Empty(EXL->EXL_TIPOBL) .And. !Empty(EXL->EXL_QTDBL)">
                                 <IF_01 COND = 'EXL->EXL_TIPOBL == "1"'>
                                    <IF_01 COND = "!Empty(EXL->EXL_QTDBL)">
                                       <DocumentationRequirements>
                                          <Documents DocumentType = '"BillOfLadingOriginal"' Freighted = 'If(EXL->EXL_IMPFRE=="1","True","False")'/>
                                          <Quantity>Str(EXL->EXL_QTDBL)</Quantity>
                                       </DocumentationRequirements>
                                       <IF_01 COND = "!Empty(EXL->EXL_QTDBLC)">
                                          <DocumentationRequirements>
                                             <Documents DocumentType = '"BillOfLadingCopy"' Freighted = 'If(EXL->EXL_IMPFRE=="1","True","False")'/>
                                             <Quantity>Str(EXL->EXL_QTDBLC)</Quantity>
                                          </DocumentationRequirements>
                                       </IF_01>
                                    </IF_01>
                                 </IF_01>
                                 <IF_02 COND = 'EXL->EXL_TIPOBL == "2"'>
                                    <IF COND = "!Empty(EXL->EXL_QTDBL)">
                                       <DocumentationRequirements>
                                          <Documents DocumentType = '"SeaWayBill"' Freighted = 'If(EXL->EXL_IMPFRE=="1","True","False")'/>
                                          <Quantity>Str(EXL->EXL_QTDBL)</Quantity>
                                       </DocumentationRequirements>
                                    </IF>
                                 </IF_02>
                              </IF_01>
                           </PartnerInformation>
                           <!--Shipper -->
                           <PartnerInformation PartnerRole = '"Shipper"'>
                              <ALIAS_01>"EYI"</ALIAS_01>
                              <ORDER_01>1</ORDER_01>
                              <SEEK_01>xFilial("EYI")+If(!Empty(EEC->EEC_EXPORT),EEC->(EEC_EXPORT+EEC_EXLOJA),EEC->(EEC_FORN+EEC_FOLOJA))</SEEK_01>
                              <PartnerIdentifier Agency = "'AssignedBySender'">Left(EYI->EYI_CODIN,35)</PartnerIdentifier>
                              <PartnerName>Left(EYI->EYI_NOMEIN,35)</PartnerName>
                              <!--Contato -->
                              <ALIAS_02>"EE3"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL")))</SEEK_02>
                              <WHILE_02 COND = 'EE3->(!EOF() .and. EE3_FILIAL+EE3_CODCAD+EE3_CONTAT+EE3_COMPL == xFilial("EE3")+"X"+If(!Empty(EEC->EEC_EXPORT),EEC->(AvKey(EEC_EXPORT, "EE3_CONTAT")+AvKey(EEC_EXLOJA, "EE3_COMPL")), EEC->(AvKey(EEC_FORN, "EE3_CONTAT")+AvKey(EEC_FOLOJA, "EE3_COMPL"))))'>
                                 <IF COND = 'EE3->EE3_INTTRA == "1"'>
                                    <ContactInformation>
                                       <ContactName ContactType = '"Informational"'>Left(EE3->EE3_NOME,35)</ContactName>
                                       <IF COND = "!Empty(EE3->EE3_FONE)">
                                          <CommunicationValue CommunicationType = "'Telephone'">EE3->EE3_FONE</CommunicationValue>
                                       </IF>
                                    </ContactInformation>
                                    <EXIT/>
                                 </IF>
                                 <SKIP>EE3</SKIP>
                              </WHILE_02>
                           </PartnerInformation>
                        </Parties>
                     </MessageProperties>
                     <MessageDetails>
                        <!--Detalhes de Containeres -->
                        <CMD_01 Print = '"N"'>oEasyLink:NewVar("nLine", 0)</CMD_01>
                        <ALIAS>"EX9"</ALIAS>
                        <ORDER>1</ORDER>
                        <SEEK>xFilial("EX9")+EEC->EEC_PREEMB</SEEK>
                        <WHILE REPL = '"1"' COND = 'EX9->(!EOF()) .and. EX9->(EX9_FILIAL+EX9_PREEMB) == xFilial("EX9")+EEC->EEC_PREEMB'>
                           <EquipmentDetails>
                              <LINE Print = '"N"'>oEasyLink:SetVar("nLine", oEasyLink:RetVar("nLine") + 1)</LINE>
                              <LineNumber>#TAG LINE#</LineNumber>
                              <EquipmentIdentifier EquipmentSupplier = 'If(EX9->EX9_FORCTR == "A","Carrier","Shipper")'>Left(EX9->EX9_CONTNR,17)</EquipmentIdentifier>
                              <EquipmentType>
                                 <EquipmentTypeCode>EX9->EX9_TIPO</EquipmentTypeCode>
                                 <ALIAS>"EYG"</ALIAS>
                                 <ORDER>1</ORDER>
                                 <SEEK>xFilial("EYG")+EX9->EX9_TIPO</SEEK>
                                 <EquipmentDescription>Left(EYG->EYG_DESCON,35)</EquipmentDescription>
                              </EquipmentType>
                              <IF_01 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                                 <EquipmentGrossWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG","",Frm102PesCont(EX9->EX9_CONTNR),.F.),"99999999999999.999")</EquipmentGrossWeight>
                              </IF_01>
                              <IF_02 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                                 <EquipmentGrossWeight UOM = '"KGM"'>Transform(Frm102PesCont(EX9->EX9_CONTNR),"99999999999999.999")</EquipmentGrossWeight>
                              </IF_02>
                              <IF_03 COND = "!Empty(EX9->EX9_TEMP) .And. EX9->EX9_ENVTMP = '1' ">
                                 <EquipmentTemperature UOM = '"CEL"'>Transform(EX9->EX9_TEMP,"99.9")</EquipmentTemperature>
                              </IF_03>
                              <IF_04 COND = "!Empty(EX9->EX9_VENT) .And. EX9->EX9_ENVTMP = '1' ">
                                 <EquipmentAirFlow UOM = '"CBM"'>Transform(EX9->EX9_VENT,"99.999")</EquipmentAirFlow>
                              </IF_04>
                              <IF_05 COND = "!Empty(EX9->EX9_LACRE)">
                                 <EquipmentSeal SealingParty = 'If(EX9->EX9_FORLCR == "A","Carrier","Shipper")'>Left(EX9->EX9_LACRE,15)</EquipmentSeal>
                              </IF_05>
                              <IF_06 COND = "!Empty(EX9->EX9_OBS)">
                                 <EquipmentComments CommentType = '"Equipment"'>EX9->(MSMM(EX9_OBS,AVSX3("EX9_VM_OBS",3),,,3))</EquipmentComments>
                              </IF_06>
                              <IF_07 COND = "!Empty(EX9->EX9_CCOTEM) .And. EX9->EX9_ENVTMP = '1' ">
                                 <EquipmentComments CommentType = '"Temperature"'>EX9->(MSMM(EX9_CCOTEM,AVSX3("EX9_COMTEM",3),,,3))</EquipmentComments>
                              </IF_07>
                           </EquipmentDetails>
                           <SKIP>"EX9"</SKIP>
                        </WHILE>
                        <!--Detalhes das Embalagens e Mercadorias -->
                        <!--Agupado por itens com mesma embalagem externa pertencentes ao mesmo container -->
                        <PACKAGES PRINT = '"N"'>AvSiPackages(EEC->EEC_PREEMB)</PACKAGES>
                        <FOR
                           INI = "1"
                           TO = "Len(#TAG PACKAGES#)"
                           VAR = '"nInc"'
                           STEP = "1"
                           REPL = '"1"'>
                           <GoodsDetails>
                              <LineNumber>nInc</LineNumber>
                              <PackageDetail Level = '"Outer"'>
                                 <NumberOfPackages>Str(#TAG PACKAGES#[nInc][5])</NumberOfPackages>
                                 <PackageTypeCode>#TAG PACKAGES#[nInc][3]</PackageTypeCode>
                              </PackageDetail>
                              <PackageDetailComments CommentType = '"GoodsDescription"'>#TAG PACKAGES#[nInc][2]</PackageDetailComments>
                              <PackageDetailGrossVolume UOM = '"MTQ"'>Transform(#TAG PACKAGES#[nInc][7],"99999999999999.999")</PackageDetailGrossVolume>
                              <IF_01 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                                 <PackageDetailGrossWeight UOM = '"KGM"'>Transform(#TAG PACKAGES#[nInc][6],"99999999999999.999")</PackageDetailGrossWeight>
                              </IF_01>
                              <IF_02 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                                 <PackageDetailGrossWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG","",#TAG PACKAGES#[nInc][6],.F.),"99999999999999.999")</PackageDetailGrossWeight>
                              </IF_02>
                              <DetailsReferenceInformation ReferenceType = '"PurchaseOrderNumber"'>#TAG PACKAGES#[nInc][9]</DetailsReferenceInformation>
                              <IF_03 COND = "!Empty(EEC->EEC_CODMAR)">
                                 <PackageMarks>
                                    <Marks>EEC->(MSMM(EEC_CODMAR,AVSX3("EEC_MARCAC",3),,,3))</Marks>
                                 </PackageMarks>
                              </IF_03>
                              <FOR_01
                                 INI = "1"
                                 TO = "Len(#TAG PACKAGES#[nInc][8])"
                                 VAR = '"nInc2"'
                                 STEP = "1"
                                 REPL = '"1"'>
                                 <SplitGoodsDetails>
                                    <EquipmentIdentifier>#TAG PACKAGES#[nInc][8][nInc2][1]</EquipmentIdentifier>
                                    <SplitGoodsNumberOfPackages>Str(#TAG PACKAGES#[nInc][8][nInc2][2])</SplitGoodsNumberOfPackages>
                                    <SplitGoodsGrossVolume UOM = '"MTQ"'>Transform(#TAG PACKAGES#[nInc][8][nInc2][4],"99999999999999.999")</SplitGoodsGrossVolume>
                                    <IF_01 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                                       <SplitGoodsGrossWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG","",#TAG PACKAGES#[nInc][8][nInc2][3],.F.),"99999999999999.999")</SplitGoodsGrossWeight>
                                    </IF_01>
                                    <IF_02 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                                       <SplitGoodsGrossWeight UOM = '"KGM"'>Transform(#TAG PACKAGES#[nInc][8][nInc2][3],"99999999999999.999")</SplitGoodsGrossWeight>
                                    </IF_02>
                                 </SplitGoodsDetails>
                              </FOR_01>
                              <!--Mercadorias Perigosas -->
                              <ALIAS_02>"EYJ"</ALIAS_02>
                              <ORDER_02>1</ORDER_02>
                              <SEEK_02>xFilial("EYJ")+AvKey(#TAG PACKAGES#[nInc][10], "EYJ_COD")</SEEK_02>
                              <IF_05 COND = "EYJ->(!EOF()) .and. !Empty(EYJ->EYJ_GRAVID)">
                                 <IF_01 COND = 'EYJ->EYJ_GRAVID == "1"'>
                                    <HazardousGoods PackingGroupCode = '"MinorDanger"'>
                                       <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                          <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                       </IF_01>
                                       <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                          <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                       </IF_02>
                                       <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                          <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                       </IF_03>
                                       <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                          <FlashpointTemperature UOM = '"CEL"'>StrZero(EYJ->EYJ_TEMRIS, 3)</FlashpointTemperature>
                                       </IF_04>
                                       <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                          <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                       </IF_05>
                                       <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                          <EmergencyResponseContact>
                                             <ContactInformation>
                                                <ContactName ContactType = "'Emergency'">Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                             </ContactInformation>
                                          </EmergencyResponseContact>
                                       </IF_06>
                                    </HazardousGoods>
                                 </IF_01>
                                 <IF_02 COND = 'EYJ->EYJ_GRAVID == "2"'>
                                    <HazardousGoods PackingGroupCode = '"MediumDanger"'>
                                       <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                          <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                       </IF_01>
                                       <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                          <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                       </IF_02>
                                       <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                          <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                       </IF_03>
                                       <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                          <FlashpointTemperature UOM = '"CEL"'>StrZero(EYJ->EYJ_TEMRIS, 3)</FlashpointTemperature>
                                       </IF_04>
                                       <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                          <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                       </IF_05>
                                       <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                          <EmergencyResponseContact>
                                             <ContactInformation>
                                                <ContactName ContactType = "'Emergency'">Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                             </ContactInformation>
                                          </EmergencyResponseContact>
                                       </IF_06>
                                    </HazardousGoods>
                                 </IF_02>
                                 <IF_03 COND = 'EYJ->EYJ_GRAVID == "3"'>
                                    <HazardousGoods PackingGroupCode = '"GreatDanger"'>
                                       <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                          <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                       </IF_01>
                                       <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                          <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                       </IF_02>
                                       <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                          <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                       </IF_03>
                                       <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                          <FlashpointTemperature UOM = '"CEL"'>StrZero(EYJ->EYJ_TEMRIS, 3)</FlashpointTemperature>
                                       </IF_04>
                                       <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                          <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                       </IF_05>
                                       <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                          <EmergencyResponseContact>
                                             <ContactInformation>
                                                <ContactName ContactType = "'Emergency'">Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                             </ContactInformation>
                                          </EmergencyResponseContact>
                                       </IF_06>
                                    </HazardousGoods>
                                 </IF_03>
                              </IF_05>
                           </GoodsDetails>
                        </FOR>
                     </MessageDetails>
                  </MessageBody>
               </Message>
            </XML>
         </IF>
      </DATA_SELECTION>
      <DATA_SEND>
         <SEND>''</SEND>
         <IF COND = "!Empty(#TAG EEC_PREEMB#)">
            <CMD>FRM101FLMan('SI', 3, #TAG XML#, #TAG EEC_PREEMB#, cNomFile)</CMD>
         </IF>
      </DATA_SEND>
      <DATA_RECEIVE>
         <SRV_STATUS>.T.</SRV_STATUS>
      </DATA_RECEIVE>
   </SERVICE>
</EASYLINK>
