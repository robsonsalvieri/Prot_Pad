?{"Nombre del Archivo INI","SUSS.INI"}
?{"Descripcion","Generación del archivo SIRE- Sistema Integral de Retenciones Electrónicas"}

[XXX Inicializacao]
(PRE) _aTotal[01] := MV_PAR01
(PRE) _aTotal[02] := MV_PAR02
(PRE) _aTotal[03] := {}
(PRE) _aTotal[04] := {}
(PRE) _aTotal[05] := .F.
(PRE) _aTotal[06] := {}

[XXX Creación del CFP Utilizado por la rutina - PRINCIPAL]
(PRE) aAdd(_aTotal[03],"Sistema Integral de Retenciones Electronicas")
(PRE) aAdd(_aTotal[03],"")
(PRE) aAdd(_aTotal[03],"Llene correctamente las informaciones solicitadas.")
(PRE) aAdd(_aTotal[03],"Informaciones necesarias para la generacion del archivo del Sistema Integral de Retenciones Electronicas.")

[XXX Painel  - Configuraciones Generales]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][1],"Sistema Integral de Retenciones Electronicas")
(PRE) aAdd(_aTotal[04][1],"Configuraciones generales:")
(PRE) aAdd(_aTotal[04][1],{})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Proveedor?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,,1,,,,200,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Orden de Pago?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,,1,,,,200,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Cliente (Percepcion)?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,,1,,,,200,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Numero documento (Percepcion)?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,,1,,,,200,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Especie (Percepcion)?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"NF","NCC","NDC","TODOS"},,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Impuestos?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"SUSS","IVA","Ganancias Beneficiarios del Exterior","AMBOS"},,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Tabla de Equivalencia - Regimen?",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"",1,,,,4})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})

[XXX Chamada do Wizard]
(PRE) _aTotal[05] := xMagWizard(_aTotal[03],_aTotal[04],"SIRE")
(PRE) Iif(_aTotal[05],xMagLeWiz("SIRE",@_aTotal[06],.T.),Nil)
(PRE) lAbtMT404	:= !_aTotal[05]
(PRE) lAbtMT950 := !_aTotal[05]
[XXX Generando archivo de trabajo SUSS]
(PRE) _aTotal[99] := SUSS(_aTotal[01],_aTotal[02], _aTotal[06])


[TRB IMPRESSAO DOS DADOS]
(PRE) TRB->(dbGoTop())
FORMULARIO C 004 0 TRB->FORMULARIO
VERSION    C 004 0 TRB->VERSION 
CODTRAZA   C 010 0 TRB->CODTRAZA
CUIT       C 011 0 TRB->CUIT
IMPUESTO   C 003 0 TRB->IMPUESTO
REGIMEN    C 003 0 TRB->REGIMEN
CUITRET    C 011 0 TRB->CUITRET
FCHRET     C 010 0 TRB->FCHRET
TIPCOMP    C 002 0 TRB->TIPCOMP
FCHCOMP    C 010 0 TRB->FCHCOMP
NROCOMPRO  C 016 0 TRB->NROCOMPRO
IMPCOMP    C 014 0 PADL(ALLTRIM(TRB->IMPCOMP),14," ")
IMPRETE    C 014 0 PADL(ALLTRIM(TRB->IMPRETE),14," ")
NROCERTORI C 025 0 TRB->NROCERTORI
FCHCERTORI C 010 0 TRB->FCHCERTORI
IMPCERTORI C 014 0 PADL(ALLTRIM(TRB->IMPCERTORI),14," ")
OTROS      C 030 0 TRB->OTROS

(POS)

[TRB1 IMPRESSAO DOS DADOS]
(ARQ) &("IVA_RETENCIONES.TXT")
(PREREG) ( Iif (( Select("TRB1")>0),.T.,.F.))
(PRE) TRB1->(dbGoTop())

VERSION    C 004 0  TRB1->VERSION     
CODTRAZA   C 036 0  TRB1->CODTRAZA       
IMPUESTO   C 003 0  TRB1->IMPUESTO    
REGIMEN    C 003 0  TRB1->REGIMEN     
FCHRETPER  C 010 0  TRB1->FCHRETPER      
CONDICION  C 002 0  TRB1->CONDICION   
IMPOSIBIL  C 001 0  TRB1->IMPOSIBIL   
NRORETMOT  C 030 0  TRB1->NRORETMOT   
IMPRETPER  C 014 0  TRB1->IMPRETPER   
IMPCAL     C 014 0  TRB1->IMPCAL    
REGEXCL    C 001 0  TRB1->REGEXCL   
POREXCL    C 006 0  TRB1->POREXCL   
FECHPUB    C 010 0  TRB1->FECHPUB   
TIPOCOMP   C 002 0  TRB1->TIPOCOMP  
FCHCOMP    C 010 0  TRB1->FCHCOMP   
NROCOMP    C 016 0  TRB1->NROCOMP   
COE        C 012 0  TRB1->COE       
COEORI     C 012 0  TRB1->COEORI    
CAE        C 014 0  TRB1->CAE       
IMPCMP     C 014 0  TRB1->IMPCMP    
MOTEMI     C 030 0  TRB1->MOTEMI    
RETPERCL   C 011 0  TRB1->RETPERCL  
CERORG     C 025 0  TRB1->CERORG    
CERORGFCH  C 010 0  TRB1->CERORGFCH 
CERORGIMP  C 014 0  TRB1->CERORGIMP 
MOTANUL    C 001 0  TRB1->MOTANU

(POS)


[TRB2 IMPRESSAO DOS DADOS]
(ARQ) &("IVA_PERCEPCIONES.TXT")
(PREREG) ( Iif (( Select("TRB2")>0),.T.,.F.))
(PRE) TRB2->(dbGoTop())

VERSION    C 004 0  TRB2->VERSION     
CODTRAZA   C 036 0  TRB2->CODTRAZA       
IMPUESTO   C 003 0  TRB2->IMPUESTO    
REGIMEN    C 003 0  TRB2->REGIMEN     
FCHRETPER  C 010 0  TRB2->FCHRETPER      
CONDICION  C 002 0  TRB2->CONDICION   
IMPOSIBIL  C 001 0  TRB2->IMPOSIBIL   
NRORETMOT  C 030 0  TRB2->NRORETMOT   
IMPRETPER  C 014 0  TRB2->IMPRETPER   
IMPCAL     C 014 0  TRB2->IMPCAL    
REGEXCL    C 001 0  TRB2->REGEXCL   
POREXCL    C 006 0  TRB2->POREXCL   
FECHPUB    C 010 0  TRB2->FECHPUB   
TIPOCOMP   C 002 0  TRB2->TIPOCOMP  
FCHCOMP    C 010 0  TRB2->FCHCOMP   
NROCOMP    C 016 0  TRB2->NROCOMP   
COE        C 012 0  TRB2->COE       
COEORI     C 012 0  TRB2->COEORI    
CAE        C 014 0  TRB2->CAE       
IMPCMP     C 014 0  TRB2->IMPCMP    
MOTEMI     C 030 0  TRB2->MOTEMI    
RETPERCL   C 011 0  TRB2->RETPERCL  
CERORG     C 025 0  TRB2->CERORG    
CERORGFCH  C 010 0  TRB2->CERORGFCH 
CERORGIMP  C 014 0  TRB2->CERORGIMP 
MOTANUL    C 001 0  TRB2->MOTANU     

(POS)

[TRB3 IMPRESSAO DOS DADOS]
(ARQ) &("GANANCIAS_BENEFICIARIOS_EXTERIOR.TXT")
(PREREG) ( Iif (( Select("TRB3")>0),.T.,.F.))
(PRE) TRB3->(dbGoTop())

FORMULARIO C 004 0  TRB3->FORMULARIO     
VERSION    C 004 0  TRB3->VERSION       
CODTRAZA   C 010 0  TRB3->CODTRAZA    
CUIT       C 011 0  PADL(TRB3->CUIT,11," ")  
IMPUESTO   C 003 0  TRB3->IMPUESTO      
REGIMEN    C 003 0  TRB3->REGIMEN   
CUITORD    C 011 0  PADL(TRB3->CUITORD,11," ")  
FCHRET     C 010 0  TRB3->FCHRET   
TIPCOMP    C 002 0  TRB3->TIPCOMP   
FCHCOMP    C 010 0  TRB3->FCHCOMP    
NROCOMPRO  C 016 0  TRB3->NROCOMPRO   
IMPCOMP    C 014 0  PADL(TRB3->IMPCOMP,14," ")   
FILLER     C 014 0  TRB3->FILLER
NROCERTORI C 025 0  PADL(TRB3->NROCERTORI,14," ")   
FCHCERTORI C 010 0  TRB3->FCHCERTORI  
IMPCERTORI C 014 0  PADL(TRB3->IMPCERTORI,14," ")   
MOTEMINCC  C 030 0  TRB3->MOTEMINCC       
NRORET     C 001 0  TRB3->NRORET
NORETMOT   C 030 0  TRB3->NORETMOT       
APLCDI     C 001 0  TRB3->APLCDI
CODLIAQ	   C 004 0  PADL(TRB3->CODLIAQ,4," ")    
APACRE     C 001 0  TRB3->APACRE  
RETCVENIF  C 050 0  TRB3->RETCVENIF    
RETNOMDE   C 060 0  TRB3->RETNOMDE 
RETDOMEXT  C 060 0  TRB3->RETDOMEXT 
RETDOMEXTP C 003 0  PADL(TRB3->RETDOMEXTP,3," ")    
RETTIPPER  C 001 0  TRB3->RETTIPPER 
RETNACCONP C 003 0  PADL(TRB3->RETNACCONP,3," ")  
RETNACCONF C 010 0  TRB3->RETNACCONF   

(POS)
[XXX Deleta Temporarios]
(PRE) FDelSUSS(_aTotal[99])


