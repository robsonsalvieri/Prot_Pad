[XXX INICIALIZACION]
(PRE) SD1->(DbSetOrder(1))
(PRE) SB1->(DbSetOrder(1))
(PRE) SYA->(DbSetOrder(1))
(PRE) SAH->(DbSetOrder(1))

(PRE) _aTotal[002] := chr(13) + chr(10)
(PRE) _aTotal[003] := "99999999999999.99"
(PRE) _aTotal[004] := {"SD1",""}
(PRE) _aTotal[005] := M486SecCod(Time(),SF1->F1_EMISSAO)
(PRE) _aTotal[006] := Alltrim(SF1->F1_SERIE) + Alltrim(SF1->F1_DOC) + Alltrim(SF1->F1_ESPECIE)
(PRE) _aTotal[007] := M486GENCDC("05",SUBSTR(SM0->M0_CGC,1,RAT("-",SM0->M0_CGC)-1),Substr(SM0->M0_CGC,RAT("-",SM0->M0_CGC)+ 1,1),SUBSTR(SF1->F1_DOC,1,3),SUBSTR(SF1->F1_DOC,4,3),SUBSTR(SF1->F1_DOC,7),"1",SF1->F1_EMISSAO,"1",_aTotal[005],SF1->F1_ESPECIE)
(PRE) _aTotal[008] := AllTrim(STR(CalcMod11(SUBSTR(_aTotal[007],1,43))))
(PRE) _aTotal[009] := M486CONDPAG(SF1->F1_FILIAL, SF1->F1_DOC,SF1->F1_SERIE, SF1->F1_FORNECE,SF1->F1_LOJA,SF1->F1_ESPECIE,SF1->F1_COND,SF1->F1_MOEDA,SF1->F1_TXMOEDA)
(PRE) _aTotal[010] := ObtColSAT("S030",SUBSTR(SM0->M0_CGC,1,10) , 1, 10, 18,2) 
(PRE) _aTotal[011] := SUBSTR(DTOS(SF1->F1_EMISSAO),0,4) + "-" + SUBSTR(DTOS(SF1->F1_EMISSAO),5,2) + "-" + SUBSTR(DTOS(SF1->F1_EMISSAO),7,2) + "T" + SF1->F1_HORA
(PRE) _aTotal[012] := ObtColSAT("S030",SUBSTR(SM0->M0_CGC,1,10) , 1, 10, 20,3)
(PRE) _aTotal[013] :=.f.
(PRE) _aTotal[014] := ObtColSAT("S030",SUBSTR(SM0->M0_CGC,1,10) , 1, 10, 23,4)
(PRE) _aTotal[015] := M486IMPPAR(ALLTRIM(SF1->F1_ESPECIE),SF1->F1_DOC,SF1->F1_SERIE, SF1->F1_FORNECE,SF1->F1_LOJA, CTO->CTO_MOESAT,"","")
(PRE) _aTotal[016] := ""
(PRE) _aTotal[017] :=  M486SUBTOT(ALLTRIM(SF1->F1_ESPECIE),SF1->F1_DOC,SF1->F1_SERIE, SF1->F1_FORNECE,SF1->F1_LOJA)
(PRE) _aTotal[024] := ObtColSAT("S030",SUBSTR(SM0->M0_CGC,1,10) , 1, 10, 11,6)
(PRE) _aTotal[025] := {0,0}

(PREREG) FsQuery(_aTotal[004],1,"D1_DOC='" + SF1->F1_DOC + "' AND D1_SERIE='" + SF1->F1_SERIE + "' AND D1_FORNECE='" + SF1->F1_FORNECE + "' AND D1_LOJA='" + SF1->F1_LOJA + "'","SD1->D1_DOC=SF1->F1_DOC .AND. SD1->D1_SERIE=SF1->F1_SERIE .AND. SD1->D1_FORNECE=SF1->F1_FORNECE .AND. SD1->D1_LOJA=SF1->F1_LOJA","D1_ITEM") .And. .T.

[XXX ENCABEZADO]
(PRE) If(AllTrim(SF1->F1_ESPECIE)<>"NDI",CTO->(MsSeek(xFilial("CTO")+Strzero(SF1->F1_MOEDA,2))) , .T.)
(PRE) If(AllTrim(SF1->F1_ESPECIE)<>"NDI",SA1->(MSSeek(xFilial("SA1")+SF1->F1_FORNECE+SF1->F1_LOJA)) , .T.)
(PRE) If(AllTrim(SF1->F1_ESPECIE)<>"NDI",SYA->(MsSeek(xFilial("SYA")+SA1->A1_PAIS)) , .T.)
(PREREG) (_aTotal[001] := '<rDE' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += ' xmlns="http://ekuatia.set.gov.py/sifen/xsd" ' + _aTotal[002],.T.)  
(PREREG) (_aTotal[001] += ' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += ' xsi:schemaLocation="http://ekuatia.set.gov.py/sifen/xsd/ siRecepDE_v150.xsd">' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += ' <dVerFor>150</dVerFor>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '	<DE Id="' + _aTotal[007] + '">' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		<dDVId>' + _aTotal[008] + '</dDVId>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		<dFecFirma></dFecFirma> ' + _aTotal[002],.T.) 
(PREREG) (_aTotal[001] += '		<dSisFact>1</dSisFact>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		<gOpeDE>' + _aTotal[002],.T.) 
(PREREG) (_aTotal[001] += '        	<iTipEmi>1</iTipEmi>' + _aTotal[002],.T.) 
(PREREG) (_aTotal[001] += '        	<dDesTipEmi>Normal</dDesTipEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '			<dCodSeg>' + SUBSTR(_aTotal[007],35,9) + '</dCodSeg>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		</gOpeDE>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		<gTimb>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<iTiDE>5</iTiDE>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dDesTiDE>Nota de crédito electrónica</dDesTiDE> ' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dNumTim>'+ ALLTRIM(SF1->F1_NUMTIM) +'</dNumTim>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dEst>' + SUBSTR(SF1->F1_DOC,1,3) + '</dEst>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dPunExp>' + SUBSTR(SF1->F1_DOC,4,3) + '</dPunExp>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dNumDoc>' + SUBSTR(SF1->F1_DOC,7) + '</dNumDoc>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += IIF(!EMPTY(SF1->F1_SERIE2),'        	<dSerieNum>' + SF1->F1_SERIE2 + '</dSerieNum>' + _aTotal[002],""),.T.)
(PREREG) (_aTotal[001] += '			<dFeIniT>' +FecIniTimb(SF1->F1_SERIE, SF1->F1_ESPECIE) + '</dFeIniT>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		</gTimb>' + _aTotal[002],.T.)

(PREREG) (_aTotal[001] += '		<gDatGralOpe>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '			<dFeEmiDE>' + _aTotal[011] + '</dFeEmiDE>' + _aTotal[002],.T.)
// Campos inherentes a la operación comercial (D010-D099)
																	 
																			 
																								 
(PREREG) (_aTotal[001] +=  _aTotal[015] + _aTotal[002],.T.)
//EMISOR
(PREREG) (_aTotal[001] += '			<gEmis>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dRucEm>' + SUBSTR(SM0->M0_CGC,1,RAT("-",SM0->M0_CGC)-1)+'</dRucEm>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDVEmi>' + Substr(SM0->M0_CGC,RAT("-",SM0->M0_CGC)+ 1,1) + '</dDVEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<iTipCont>1</iTipCont>' + _aTotal[002],.T.)
//Si se realiza el proceso en producción habilitar la siguiente linea, si se realizan pruebas comentarla
//(PREREG) (_aTotal[001] += '				<dNomEmi>'+ alltrim(SM0->M0_NOME) + '</dNomEmi>' + _aTotal[002],.T.)
//Si se realiza el proceso en testes habilitar la siguiente linea, si se realizan producción comentarla
(PREREG) (_aTotal[001] += '				<dNomEmi>'+  "DE generado en ambiente de prueba - sin valor comercial ni fiscal" + '</dNomEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dNomFanEmi>'+ alltrim(SM0->M0_NOMECOM) + '</dNomFanEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDirEmi>'+ alltrim(SM0->M0_ENDENT) + '</dDirEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += IIF(Empty(_aTotal[024]),'				<dNumCas>0</dNumCas>' + _aTotal[002],'    				<dNumCas>'+ _aTotal[024] + '</dNumCas>' + _aTotal[002]),.T.)
(PREREG) (_aTotal[001] += '				<cDepEmi>' + _aTotal[010]+ '</cDepEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesDepEmi>' + alltrim(ObtColSAT("S003",_aTotal[010], 1, 2, 3,28)) + '</dDesDepEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<cDisEmi>' + alltrim(_aTotal[012]) + '</cDisEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesDisEmi>' + alltrim(ObtColSAT("S031",_aTotal[012], 1, 3, 4,30))+ '</dDesDisEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<cCiuEmi>' +  alltrim(_aTotal[014])  + '</cCiuEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesCiuEmi>' +  alltrim(ObtColSAT("S012",_aTotal[014], 48, 4, 52,30))+ '</dDesCiuEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dTelEmi>'+ SM0->M0_TEL+ '</dTelEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dEmailE>contabilidad@bancard.com.py</dEmailE>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<gActEco>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '					<cActEco>' + ALLTRIM(SM0->M0_DSCCNA) + '</cActEco>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '					<dDesActEco>'+ ObtColSAT("S006",SUBSTR(SM0->M0_DSCCNA,1,6) , 2, 5, 7,166)+'</dDesActEco>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				</gActEco>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '			</gEmis>' + _aTotal[002],.T.)
//RECEPTOR
(PREREG) (_aTotal[001] += '			<gDatRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<iNatRec>1</iNatRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<iTiOpe>1</iTiOpe>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<cPaisRec>' + SYA->YA_CODERP + '</cPaisRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesPaisRe>'+ ObtColSAT("S005",SYA->YA_CODERP, 1, 3, 4,52)+'</dDesPaisRe>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += IIF(!Empty(SA1->A1_CGC)  ,'				<iTiContRec>' + IIF(SA1->A1_PESSOA $ "F","1","2") + '</iTiContRec>' + _aTotal[002],''),.T.)
(PREREG) (_aTotal[001] += IIF(!Empty(SA1->A1_CGC)  ,'				<dRucRec>' +  SUBSTR(SA1->A1_CGC,1,RAT("-",SA1->A1_CGC)-1) + '</dRucRec>' + _aTotal[002],''),.T.)
(PREREG) (_aTotal[001] += IIF(!Empty(SA1->A1_CGC)  ,'				<dDVRec>' + Substr(SA1->A1_CGC,RAT("-",SA1->A1_CGC)+ 1,1) + '</dDVRec>' + _aTotal[002],''),.T.)
(PREREG) (_aTotal[001] += IIF( Empty(SA1->A1_CGC)  ,'				<iTipIDRec>' + SA1->A1_TIPDOC + '</iTipIDRec>' + _aTotal[002],''),.T.)
(PREREG) (_aTotal[001] += IIF( Empty(SA1->A1_CGC)  ,'				<dDTipIDRec>' +  ObtColSAT("S018", SA1->A1_TIPDOC, 1, 1, 2,41) + '</dDTipIDRec>' + _aTotal[002],''),.T.)
(PREREG) (_aTotal[001] += IIF( Empty(SA1->A1_CGC)  ,'				<dNumIDRec>' +  IIF(AllTrim(SA1->A1_TIPDOC)=="5","0",ALLTRIM(SA1->A1_NIF)) + '</dNumIDRec>' + _aTotal[002],''),.T.)
(PREREG) (_aTotal[001] += '				<dNomRec>' + ALLTRIM(SA1->A1_NOME)+ '</dNomRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dNomFanRec>' + ALLTRIM(SA1->A1_NREDUZ)+ '</dNomFanRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDirRec>' + SA1->A1_END + '</dDirRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dNumCasRec>' + SA1->A1_NUM + '</dNumCasRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<cDepRec>' + SA1->A1_DEPTO + '</cDepRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesDepRec>' + alltrim(ObtColSAT("S003",SA1->A1_DEPTO, 1, 2, 3,28)) +'</dDesDepRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<cDisRec>' + SA1->A1_DISTR+ '</cDisRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesDisRec>'+ AllTrim(ObtColSAT("S031",SA1->A1_DISTR, 1, 3, 4,30)) + '</dDesDisRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<cCiuRec>' + ALLTRIM(SA1->A1_CIUDAD) + '</cCiuRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '				<dDesCiuRec>' + alltrim(ObtColSAT("S012",SA1->A1_CIUDAD, 48, 4, 52,30)) + '</dDesCiuRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += IIF(!Empty(SA1->A1_TEL)  ,'				<dTelRec>' + SA1->A1_TEL + '</dTelRec>' + _aTotal[002],''),.T.)																																										
(PREREG) (_aTotal[001] += '				<dCodCliente>' + alltrim(SA1->A1_COD) + '</dCodCliente>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '			</gDatRec>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		</gDatGralOpe>' + _aTotal[002],.T.)
//TIPO DE PRESENCIA
(PREREG) (_aTotal[001] += '		<gDtipDE>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<gCamNCDE>' + _aTotal[002],.T.) 
(PREREG) (_aTotal[001] += '    			<iMotEmi>' + AllTrim(SF1->F1_TIPREF) + '</iMotEmi>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        		<dDesMotEmi>'+ ObtColSAT("S021",SF1->F1_TIPREF, 1, 1, 2,30)+'</dDesMotEmi>' + _aTotal[002],.T.) 
(PREREG) (_aTotal[001] += '        	</gCamNCDE>' + _aTotal[002],.T.)
// CONDICIONES DE PAGO
//(PREREG) (_aTotal[001] +=  _aTotal[009] + _aTotal[002],.T.)
[SD1 GENERANDO_XML]
(PRE) DbGoTop()
(PREREG) (SB1->(DbSeek(xFilial("SB1") + SD1->D1_COD)),.T.)
(PREREG) (SAH->(DbSeek(xFilial("SAH") + SB1->B1_UM)),.T.)
(PREREG) _aTotal[016] := M486IMPDPAR(ALLTRIM(SF1->F1_ESPECIE),SF1->F1_DOC,SF1->F1_SERIE, SF1->F1_FORNECE,SF1->F1_LOJA, SD1->D1_TES,SD1->D1_ITEM,SD1->D1_COD,@_aTotal[025])																																			 

(PREREG) (_aTotal[001] += '        	<gCamItem>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '    			<dCodInt>' + alltrim(SB1->B1_COD) + '</dCodInt>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '    			<dDesProSer>' + alltrim(SB1->B1_DESC) + '</dDesProSer>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '    			<cUniMed>' + alltrim(SAH->AH_COD_CO) + '</cUniMed>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '    			<dDesUniMed>' + ObtColSAT("S002",SAH->AH_COD_CO, 1, 3, 29,6) + '</dDesUniMed>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '    			<dCantProSer>' + ALLTRIM(TRANSFORM(SD1->D1_QUANT,"9999999999.9999") )+ '</dCantProSer>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] +=  _aTotal[016] + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	</gCamItem>' + _aTotal[002],.T.)

[XXX INVOICE_FIN]

(PREREG) (_aTotal[001] += '		</gDtipDE>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		<gTotSub>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dSubExe>'+ ALLTRIM(TRANSFORM(_aTotal[017,1],"999999999999999.9999"))+'</dSubExe>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dSubExo>'+ ALLTRIM(TRANSFORM(_aTotal[017,2],"999999999999999.9999"))+'</dSubExo>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dSub5>'+ ALLTRIM(TRANSFORM(_aTotal[017,3],"999999999999999.9999"))+'</dSub5>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dSub10>'+ ALLTRIM(TRANSFORM(_aTotal[017,4],"999999999999999.9999"))+'</dSub10>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotOpe>'+ ALLTRIM(TRANSFORM(_aTotal[017,5],"999999999999999.9999"))+'</dTotOpe>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotDesc>'+ ALLTRIM(TRANSFORM(_aTotal[025][1],"999999999999999.9999"))+'</dTotDesc>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotDescGlotem>'+ ALLTRIM(TRANSFORM(_aTotal[017,6],"999999999999999.9999"))+'</dTotDescGlotem>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotAntItem>0</dTotAntItem>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotAnt>0</dTotAnt>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dPorcDescTotal>0</dPorcDescTotal>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dDescTotal>'+ ALLTRIM(TRANSFORM(_aTotal[025][1],"999999999999999.9999"))+'</dDescTotal>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dAnticipo>0</dAnticipo>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dRedon>0.0</dRedon>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotGralOpe>'+ ALLTRIM(TRANSFORM(SF1->F1_VALBRUT,"999999999999999.9999"))+'</dTotGralOpe>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dIVA5>'+ ALLTRIM(TRANSFORM(_aTotal[017,7],"999999999999999.9999"))+'</dIVA5>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dIVA10>'+ ALLTRIM(TRANSFORM(_aTotal[017,8],"999999999999999.9999"))+'</dIVA10>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dTotIVA>'+ ALLTRIM(TRANSFORM(_aTotal[017,9],"999999999999999.9999"))+'</dTotIVA>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '        	<dBaseGrav5>'+ ALLTRIM(TRANSFORM(_aTotal[017,10],"999999999999999.9999"))+'</dBaseGrav5>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '			<dBaseGrav10>'+ ALLTRIM(TRANSFORM(_aTotal[017,11],"999999999999999.9999"))+'</dBaseGrav10>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '			<dTBasGraIVA>'+ ALLTRIM(TRANSFORM(_aTotal[017,12],"999999999999999.9999"))+'</dTBasGraIVA>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '		</gTotSub>' + _aTotal[002],.T.)


[XXX DOCUMENTO_ASOCIADO]
(PRE) _aTotal[018] := M486ASOC(SF1->F1_ESPECIE,SF1->F1_DOC,SF1->F1_SERIE,SF1->F1_FORNECE,SF1->F1_LOJA,"1")
(PREREG) (_aTotal[001] += '		<gCamDEAsoc>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += _aTotal[018],.T.)
(PREREG) (_aTotal[001] += '		</gCamDEAsoc>' + _aTotal[002],.T.)

(PREREG) (_aTotal[001] += ' </DE>' + _aTotal[002],.T.)
(PREREG) (_aTotal[001] += '</rDE>' + _aTotal[002],.T.)
(PREREG) ENCODEUTF8(_aTotal[001])
(POS) FsQuery(_aTotal[004],2)

[XXX FACTURA]
(PRE) _aTotal[094] := _aTotal[006] + ".XML"
(ARQ) _aTotal[094]
