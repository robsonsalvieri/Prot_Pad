?{"Nombre del Archivo INI","LIBCBOL.INI"}
?{"Descripción Completa del Archivo Magnético","Archivo Magnético Libro de Compras IVA"}
?{"¿Para quién?","Los sujetos pasivos o terceros responsables obligados a presentar el Libro de Compras y Ventas de IVA."}
?{"Objetivo","Su objetivo es aumentar la eficiencia de la labor fiscalizadora y, a su vez, facilitar a los contribuyentes en sus obligaciones formales."}
?{"Plazo de Entrega","Mensual"}
?{" "," "}
?{" "," "}
?{"Comentarios",""}

[XXX Inicializacao]
(PRE) _aTotal[03] := {}
(PRE) _aTotal[04] := {}
(PRE) _aTotal[05] := .F.
(PRE) _aTotal[06] := {}

[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd(_aTotal[03],"LIBCBOL")
(PRE) aAdd(_aTotal[03],"")
(PRE) aAdd(_aTotal[03],"Complete las informaciones solicitadas.")
(PRE) aAdd(_aTotal[03],"Información necesaria para la generación del archivo magnético.")


[XXX Painel  - Configuracoes Gerais]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][1],"Bolivia")
(PRE) aAdd(_aTotal[04][1],"Configuraciones generales")
(PRE) aAdd(_aTotal[04][1],{})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"De Sucursal: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,Replicate("X",TamSX3("F3_FILIAL")[01]),1,,,,TamSX3("F3_FILIAL")[01],,,"SM0"})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Hasta Sucursal: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,Replicate("X",TamSX3("F3_FILIAL")[01]),1,,,,TamSX3("F3_FILIAL")[01],,,"SM0"})


(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1, "Tipo de Documento: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"1-Manuales","2-En Linea","3-Ambos"},,})


(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1, "Formato de los Archivos Generados: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"1- TXT y XML","2-TXT y XLSX"},,})



[XXX Chamada do Wizard]
(PRE) _aTotal[05] := xMagWizard(_aTotal[03],_aTotal[04],"DAVINCIC")
(PRE) Iif(_aTotal[05],xMagLeWiz("DAVINCIC",@_aTotal[06],.T.),Nil)
(PRE) lAbtMT950	:= !_aTotal[05]

[XXX Registro SIP - Retencao e Percecpcao]
(PRE) LIBBOL("C",_aTotal[06][1][1],_aTotal[06][1][2],_aTotal[06][1][3],_aTotal[06][1][4])
(PRE) _aTotal[01] := Alltrim(MV_PAR04)+StrZero(Month(mv_par01),2)+Str(Year(mv_par01),4)+"_"+Alltrim(SM0->M0_CGC)+".TXT"
(POS)



[LCV Livro de Compras IVA]	
(DEL)|M
(ARQ) (_aTotal[01])
(PRE) dbGoTop()
NUMSEQ     C 006 0 LCV->NUMSEQ
ESPECIF    C 001 0 "1"
NIT        C 012 0 LCV->NIT
RAZSOC     C 240 0 LCV->RAZSOC
NUMAUT     C 100 0 LCV->NUMAUT
NFISCAL    C 020 0 LCV->NFISCAL
POLIZA     C 015 0 LCV->POLIZA
EMISSAO    C 010 0 DtoC(LCV->EMISSAO)
VALCONT    C 014 2 IIf(Empty(LCV->VALCONT),"0",Str(LCV->VALCONT,14,2))
VALICE     C 014 2 IIf(Empty(LCV->VALICE),"0",Str(LCV->VALICE,14,2))
VALIEHD    C 014 2 IIf(Empty(LCV->VALEHD),"0",Str(LCV->VALEHD,14,2))
VALIPJ     C 014 2 IIf(Empty(LCV->VALIPJ),"0",Str(LCV->VALIPJ,14,2))
VALTAS     C 014 2 IIf(Empty(LCV->VALTAS),"0",Str(LCV->VALTAS,14,2))
OTROS      C 014 2 IIf(Empty(LCV->VALOTR),"0",Str(LCV->VALOTR,14,2))
EXENTAS    C 014 2 IIf(Empty(LCV->EXENTAS),"0",Str(LCV->EXENTAS,14,2))
TAXAZERO   C 014 2 IIf(Empty(LCV->TAXAZERO),"0",Str(LCV->TAXAZERO,14,2))
SUBTOT     C 014 2 IIf(Empty(LCV->SUBTOT),"0",Str(LCV->SUBTOT,14,2))
DESCONT    C 014 2 IIf(Empty(LCV->DESCONT),"0",Str(LCV->DESCONT,14,2))
VALGIFT    C 014 2 IIf(Empty(LCV->VALGIFT),"0",Str(LCV->VALGIFT,14,2))
BASEIMP    C 014 2 IIf(Empty(LCV->BASEIMP),"0",Str(LCV->BASEIMP,14,2))
VALIMP     C 014 2 IIf(Empty(LCV->VALIMP),"0",Str(LCV->VALIMP,14,2))
TIPONF     C 001 0 LCV->TIPONF
CODCTR     C 017 0 LCV->CODCTR


[XXX Finalizacao         ]
(PRE) LCV->(dbCloseArea())

(PRE) LIBBOLDel()
