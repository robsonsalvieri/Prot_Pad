?{"Nombre del Archivo INI","FORMA609.INI"}
?{"Descripción Completa del Archivo Magnético","DIreccion General de Impuestos Internos - Formato 609 - DGII2008"}
?{"A Quien si Destina","Los Agentes de Retención estan obligados a cumplir las obligaciones de la resolución."}
?{"Objetivo","Definir las características y contenido para el reporte de Envio de Pagos al Exterior."}
?{"Plazo de Entrega","Mensual"}
?{"Aplicativo Disponibilizado por DGII","DGII 2008 - Versión 2.0"}
?{"Versión del Aplicativo Contemplada pela Microsiga","1.0"}
?{"Legislación", "Norma General No. 01-07 2008"}
?{"Buscar en", "www.dgii.gov.do"}

[XXX Inicializacao]  
(PRE) _aTotal[001] := {CTOD("  /  /  "),CTOD("  /  /  ")}
(PRE) _aTotal[002] := "00000001"
(PRE) _aTotal[003] := "R"
//Contador de Registro 
(PRE) _aTotal[004] := 0
//Totalizador de Valores
(PRE) _aTotal[005] := 0 
//Painel de perguntas
(PRE) _aTotal[006] := {} 
(PRE) _aTotal[007] := {}
(PRE) _aTotal[008] := {}
(PRE) _aTotal[009] := {"INV",""}
(PRE) _aTotal[010] := ""
(PRE) _aTotal[011] := CtoD("")
(PRE) _aTotal[012] := ""
(PRE) _aTotal[013] := ""


[XXX Painel Principal]
(PRE) aAdd (_aTotal[006], "Procesamiento del Formato 609  –  Todas las retenciones generadas en el território nacional.")
(PRE) aAdd (_aTotal[006], "")
(PRE) aAdd (_aTotal[006], "Llenar correctamiente los datos solicitados.")
(PRE) aAdd (_aTotal[006], "Informaciones necesárias para el recargo automático del Formato 609  –  Todas las retenciones generadas en el território nacional.")  

[XXX Montagem do Wizard ]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][1], "Procesamiento del Informe.")
(PRE) aAdd (_aTotal[007][1], "INFORMACIÓN DE LA CLAUSURA ")
(PRE) aAdd (_aTotal[007][1], {})                            
(PRE) aAdd (_aTotal[007][1][3], {1,"Fecha de Cierre:",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,,3,,,,})

[XXX - Chamada Wizard]
(PRE) _aTotal[010] := IIF(lFirst,xMagWizard(_aTotal[006],_aTotal[007], "ISR609"),.F.)
(PRE) Iif( _atotal[010] == .T. ,xMagLeWiz("ISR609",@_aTotal[008], .T.), _aTotal[008] := {} )
(PRE) Iif(!Empty(_aTotal[008]),Iif(Empty(_aTotal[008][1][1]), Help(" ",1,"NODTFECH",,"Campo obligatorio: Fecha de Cierre ",4) , _aTotal[011]:= StoD(_aTotal[008][1][1]) ),Nil )   
(PRE) lAbtMT950 := IIf(lFirst,!_aTotal[010],.F.)

[XXX ABERTURA DA TABELA Temporario]
(PRE) Processa({|| _aTotal[012] := CtGera609(_aTotal[002],_aTotal[003],lFirst,@_aTotal[011]) })
(PRE) Iif(Empty(_aTotal[012]),Help(" ",1,"NOARQ",,"No hay datos para la gama",4),Nil)
(PRE) lAbtMT950 := Empty(_aTotal[012]) 
(PRE) cArqDest := cNomArq

[ISR609 Itens]       
(PRE) DbSelectArea("ISR609")
(PRE) ISR609->(dbGoTop())   
(PRE) ISR609->(dbSeek(cNomArq))                  
(PREREG) Alltrim(ISR609->NOMARQ) == Alltrim(cNomArq)
RAZAOSOC   C 030 0 ISR609->RAZAOSOC
TP_SERV    C 002 0 ISR609->TIPOSERV
DT_FAT     C 008 0 DtoS(ISR609->DATAFACT)
DT_RET     C 008 0 DtoS(ISR609->DATACERT)
VALOR_ISR  C 012 0 PADL(Alltrim(TRANSFORM(ISR609->VALISR , "@R 99999999.99")),12,"0")
VALOR_NOTA C 012 0 PADL(Alltrim(TRANSFORM(ISR609->VALNOTA, "@R 99999999.99")),12,"0")
(CONT) _aTotal[004]++
(CONT) _aTotal[005] += ISR609->VALNOTA

[XXX Cabeçalho]
(ORD) TOP
(PRE) SM0->(dbSetOrder(1))
(PRE) SM0->(dbSeek( cEmpAnt + cFilAnt ))
(PREREG) Alltrim(SM0->M0_CODIGO) == Alltrim(cEmpAnt) .And. Alltrim(SM0->M0_CODFIL) == Alltrim(cFilAnt)
IDENT      C 005 0 "609"
RNCAGENTE  C 009 0 Alltrim(SM0->M0_CGC)
PERIODO    C 006 0 Substr(DTOS(_aTotal[011]),1,6)
QTDREG     N 012 0 _aTotal[004]
VLRTOT     C 016 0 PADL(Alltrim(TRANSFORM(_aTotal[005], "@R 9999999999999.99")),16,"0")
(POS) SFE->(DbCloseArea())

