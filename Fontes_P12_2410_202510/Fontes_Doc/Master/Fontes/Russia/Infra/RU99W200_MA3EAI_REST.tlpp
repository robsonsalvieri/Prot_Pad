// #include 'totvs.ch'
// #include 'tlpp-core.th'
// #include 'tlpp-rest.th'
// #Include 'FWMVCDef.ch'
// #INCLUDE "RU99W200.CH"
// //#include "protheus.ch"

// #DEFINE MODEL_ENCODING "cp1251"
// #DEFINE MSG_INFO    "1"
// #DEFINE REC_OPER   "1"
// #DEFINE SEND_OPER  "2"
// #DEFINE MVC_TYPE   "1"
// #DEFINE MILE_TYPE  "2"
// #DEFINE CUSTOM_TYPE  "3"

// //#include 'fw-tlpp-core.th'
// NameSpace np.framework.eairest

// // TO DO: Add/Fix all {Protheus.doc}

// /*/{Protheus.doc} RU99W20001_MA3EAISchedStatus
//     Returns Schedule status response
//     @type function
//     @version 1.0
//     @author bsobieski
//     @since 15/12/2023
//     @return Logical
//     @see https://tdn.totvs.com.br/display/public/FRAMESPSQDS/Classe+Automatic
// /*/
// @Get(endpoint="/api/ma3eai/v1/schedstatus/",description="[np.framework.eairest.RU99W20028_ScheduleStatusDOC]")
// Function RU99W20001_MA3EAISchedStatus()

// 	Local lAvailable := FWSchdAvaiable()
//     Local aMA3EAISched := totvs.framework.schedule.utils.getSchedsByRotine("NP.FRAMEWORK.EAI.MA3EAISCHED") // All schedule IDs that contain the routine passed
// 	Local oJson := jsonObject():New() as Json
//     Local oEaiSchedule := jsonObject():New() as Json
//     Local oScheduleAuto := totvs.framework.schedule.automatic():new()
//     Local nI := 1 as Numeric

//     np.framework.eai.TrySetEnv()

//     oJson['MA3ScheduleAvailable'] := lAvailable
//     oJson['MA3Schedules'] := {}
//     For nI := 1 To Len(aMA3EAISched)
//         oScheduleAuto:SetSchedule(aMA3EAISched[nI]) // Indicates the Schedule to be changed
//         oEaiSchedule := jsonObject():New()
//         oEaiSchedule['code']         := aMA3EAISched[nI]
//         oEaiSchedule['description']  := oScheduleAuto:oSchedule:CDESCRICAO // oScheduleAuto:cDescription == Nil
//         oEaiSchedule['companyBranch']:= oScheduleAuto:oSchedule:CEMPFIL
//         oEaiSchedule['environment']  := oScheduleAuto:oSchedule:CENV // oScheduleAuto:cEnvironment == Nil
//         oEaiSchedule['status']       := oScheduleAuto:oSchedule:CSTATUS // oScheduleAuto:cStatus == Nil
//         oEaiSchedule['userId']       := oScheduleAuto:oSchedule:CUSERID // oScheduleAuto:cUser == Nil
//         oEaiSchedule['userName']     := FwGetUserName(oScheduleAuto:oSchedule:CUSERID)
//         oEaiSchedule['messageError'] := oScheduleAuto:GETERRORMESSAGE()
//         aUtcDate := LocaltoUtc(dtos(oScheduleAuto:oSchedule:ddate),oScheduleAuto:oSchedule:CTIME+":00")
//         If Len(aUtcDate) == 2
//             oEaiSchedule['dateTimeCreated'] := Substr(aUtcDate[1],1,4)+"-"+Substr(aUtcDate[1],5,2)+"-"+Substr(aUtcDate[1],7,2)+"T"+aUtcDate[2]+"Z"
//         Endif
//         aUtcDate := LocaltoUtc(dtos(oScheduleAuto:oSchedule:DLASTDAYEXEC),oScheduleAuto:oSchedule:CLASTTIMEEXEC+":00")
//         If Len(aUtcDate) == 2
//             oEaiSchedule['lastExecDate'] := Substr(aUtcDate[1],1,4)+"-"+Substr(aUtcDate[1],5,2)+"-"+Substr(aUtcDate[1],7,2)+"T"+aUtcDate[2]+"Z"
//         Endif
//         Aadd(oJson['MA3Schedules'],oEaiSchedule)
//     Next nI

// 	oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 	oRest:setResponse(oJson:toJson())

// Return .T.

// /*/{Protheus.doc} RU99W20028_ScheduleStatusDOC()
//     Returns Schedule status REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20028_ScheduleStatusDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] :=  EncodeUTF8(STR0082,MODEL_ENCODING) // EAI Schedule status 
//     oDoc["description"] := EncodeUTF8(STR0083,MODEL_ENCODING) // Returns information about EAI schedule status
//     oDoc:DelName("params")
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20002_MA3EAIQueueSummary
//     Returns Queue Summary
//     @type function
//     @version 1.0
//     @author bsobieski
//     @since 15/12/2023
//     @return Logical
// /*/
// @Get(endpoint="/api/ma3eai/v1/queuesummary/",description="[np.framework.eairest.RU99W20029_QueueSummaryDOC]")
// Function RU99W20002_MA3EAIQueueSummary()
	
//     Local oJson     := jsonObject():New() as Json
// 	Local oJsonTMP  := jsonObject():New() as Json
//     Local cQuery    := ""
//     Local cAliasTMP :=  GetNextAlias()
//     Local nX as Numeric
//     Local aColors := {} as Array
    
//     np.framework.eai.TrySetEnv()

//     oJson['data']               :=  jsonObject():New()
//     oJson['data']['items']      :=  {}
//     oJson['data']['categories'] :=  {}
//     oJson['data']['ok'] := .T.
//     oJson['data']['status'] := 200
//     oJson['data']['statusText'] := 'success'

//     aColors := np.framework.eai.RU99X20016_GetLegendColors("F6Y_STATUS")

//     For nX:=1 to Len(aColors)
//         oJsonTMP  := jsonObject():New()
//         oJsonTMP[ 'id']     := 'status_'+aColors[nX][1]
//         oJsonTMP[ 'label']  := Alltrim(aColors[nX][3])
//         oJsonTMP[ 'color']  := aColors[nX][2]
//         aadd(oJson['data']['categories'],oJsonTMP)
//         FreeObj(oJsonTMP)
//     Next

//     cQuery  := " SELECT COUNT(*) QTY, F6Y_STATUS FROM "+RetSqlName("F6Y") 
//     cQuery  += " where d_e_l_e_t_ = '' "
//     cQuery  += " AND F6Y_FILIAL = '"+xFilial("F6Y")+"' "
//     cQuery  += " GROUP BY F6Y_STATUS "
//     DbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), cAliasTMP, .F., .T.)
//     cTimeStamp := FWTimeStamp(6)
    
//     oJsonTMP  := jsonObject():New()
//     For nX:=1 To Len(aColors)
//         oJsonTMP['status_'+aColors[nX,1]]  := 0
//     Next
// 	while !(cAliasTMP)->(EOF())
//         //oJsonTMP['status']    := 
//         oJsonTMP['status_'+(cAliasTMP)->F6Y_STATUS]  := (cAliasTMP)->QTY
//         DbSkip()
//     Enddo
//     oJsonTMP['timeStamp']  := cTimeStamp
//     Aadd(oJson['data']['items'],oJsonTMP)
//     FreeObj(oJsonTMP)
//     // oJsonTMP  := jsonObject():New()

// 	(cAliasTMP)->(DbCloseArea())
// 	oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 	oRest:setResponse(oJson:toJson() )

// Return .T.

// /*/{Protheus.doc} RU99W20029_QueueSummaryDOC()
//     Returns Queue summary REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20029_QueueSummaryDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0084,MODEL_ENCODING) // EAI Queue summary
//     oDoc["description"] := EncodeUTF8(STR0085,MODEL_ENCODING) // Returns information about all EAI Queue records 
//     oDoc:DelName("params")
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20003_MA3EAIAdapters
//     TODO: Implement method
//     List adapters by type (receive, send)
//     @type function
//     @version 1
//     @author bsobieski
//     @since 15/12/2023
//     @return Json, 
//         {"code": string,
//         "description": string,
//         "type": string (send/receive),
//         "insert": boolean,
//         "update": boolean,
//         "delete": boolean,
//         "doc": { format : Json/XML sheet }
//         }
// /*/
// @Get(endpoint="/api/ma3eai/v1/adapter/",description="[np.framework.eairest.RU99W20030_AdaptersListDOC]")
// Function RU99W20003_MA3EAIAdapters()

// 	Local aQueries := GetEAIQuery(cTable = 'F6F')
// 	Local cFields := "" as Character
// 	Local jQuery := jsonObject():New() As Json
// 	Local jResponse := jsonObject():New() As Json
// 	Local nPageSize as Numeric

//     np.framework.eai.TrySetEnv()

// 	jQuery := oRest:GetQueryRequest()
// 	If jQuery['fields'] <> Nil
// 		cFields:= jQuery["fields"]
// 	Endif
// 	If jQuery['take'] <> Nil
// 		nPageSize:= Val(jQuery["take"])
// 	Endif

// 	jResponse := np.framework.eairest.getData(aQueries=aQueries, cTable='F6F',cFields=cFields,nPageSize=nPageSize)

// 	If jResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(jResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20030_AdaptersListDOC()
//     Returns Queue summary REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20030_AdaptersListDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0086,MODEL_ENCODING) // EAI adapters list
//     oDoc["description"] := EncodeUTF8(STR0087,MODEL_ENCODING) // Returns list of all EAI adapters present in the system
//     oDoc["params"][1]["name"] := "fields"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0088,MODEL_ENCODING) // Names of fields values of which to be returned in information
//     oDoc["params"][1]["in"] := "query"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .F.
//     Aadd(oDoc["params"],jsonObject():New())
//     oDoc["params"][2]["name"] := "take"
//     oDoc["params"][2]["description"] := EncodeUTF8(STR0089,MODEL_ENCODING) // Page size of information to be returned
//     oDoc["params"][2]["in"] := "query"
//     oDoc["params"][2]["type"] := "integer"
//     oDoc["params"][2]["required"] := .F.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20004_MA3EAIColumns()
//     Returns response with columns setup for listing
//     @type function
//     @version 1
//     @author bsobieski
//     @since 15/12/2023
//     @return Json,
//         {'columns':array}
// /*/
// @Get(endpoint="/api/ma3eai/v1/columnsSetup/:object",description="[np.framework.eairest.RU99W20031_ColumnsSetupDOC]")
// Function RU99W20004_MA3EAIColumns()

// 	Local jPath     := oRest:getPathParamsRequest() As Json
// 	Local cTable    := "" as  character
// 	Local cBox      := "" as  character
// 	Local oJson     := jsonObject():new() as Json
// 	Local aItems    := {} as Array
// 	Local aItem     := {} as Array
// 	Local nX as Numeric
// 	Local oLookupItem      as Json

//     np.framework.eai.TrySetEnv()

// 	If (jPath['object'] == Nil)
// 		oJson:FromJson(MA3EAIErrorResponse(cMessage="Input is empty")) // Input is empty
// 	Else
// 		Do Case
// 		Case jPath['object'] == "queue"
// 			cTable := "F6Y"
// 		Case jPath['object'] == "queue-detail"
// 			cTable := "F6Z"
// 		Case jPath['object'] == "adapter"
// 			cTable := "F6F"
// 		Case jPath['object'] == "adapterDetail"
// 			cTable := "F6G"
// 		Case jPath['object'] == "log"
// 			cTable := "F5L"
// 		EndCase
// 		If Empty(cTable)
// 			oJson:FromJson(MA3EAIErrorResponse(cMessage="Could not determine table from passed name")) // Could not determine table from passed name
// 		Else
// 			oJson['columns'] := {}
// 			SX3->(DBSETORDER(1))
// 			SX3->(DbSeek(cTable))
// 			oCol := GetDxModel('columns')
// 			oCol['dataField']   := "ID"
// 			oCol['caption']     := "Internal ID"
// 			oCol['dataType']    := "number"
// 			oCol['visible']     := .F.
// 			AADd(oJson['columns'], oCol)
// 			FreeObj(oCol)

// 			While !SX3->(Eof()) .And. SX3->X3_ARQUIVO == cTable
// 				If cNivel >= SX3->x3_nivel
// 					aColors := np.framework.eai.RU99X20016_GetLegendColors(Alltrim(SX3->X3_CAMPO))
// 					oCol := GetDxModel('columns')
// 					oCol['dataField']           := Alltrim(SX3->X3_CAMPO)
// 					oCol['allowFiltering']      := !('_MSUID' $ Alltrim(SX3->X3_CAMPO))
// 					oCol['allowHeaderFiltering']:= .F.
// 					oCol['caption']   := Alltrim(X3Descric())// Alltrim(X3TITULO())
// 					oCol['visible']   := X3USO(sx3->x3_usado)
// 					If Len(aColors) > 0
// 						oCol['_legends'] := jsonObject():New()
// 						For nX:=1 To Len(aColors)
// 							//aadd(oCol['_legends'],jsonObject():New())
// 							oCol['_legends']["color_"+aColors[nX,1]] := jsonObject():New()
// 							//oCol['_legends'][]['value'] := aColors[1]
// 							oCol['_legends']["color_"+aColors[nX,1]]['color'] := aColors[nX,2]
// 							oCol['_legends']["color_"+aColors[nX,1]]['label'] := aColors[nX,3]
// 						Next
// 						oCol['cellTemplate'] := 'dot'
// 					Endif
// 					oCol['visible']   := X3USO(sx3->x3_usado)

// 					If  Alltrim(SX3->X3_CAMPO) $ "F6Y_DTINS|F6Y_LASTPR|F5L_DTINS|F6Z_DTINS"
// 						oCol['width'] := 160
// 						oCol['dataType']  := "datetime"
// 					ElseIf SX3->X3_TIPO == "C"
// 						oCol['width'] := MAX(SX3->X3_TAMANHO * 10,120)
// 						oCol['dataType']  := "string"
// 					ElseIf SX3->X3_TIPO == "D"
// 						oCol['width'] := 120
// 						oCol['dataType']  := "date"
// 					ElseIf SX3->X3_TIPO == "N"
// 						oCol['width'] := 150
// 						oCol['dataType']  := "number"
// 					ElseIf SX3->X3_TIPO == "L"
// 						oCol['width']       := 120
// 						oCol['dataType']    := "boolean"
// 					ElseIf SX3->X3_TIPO == "M"
// 						oCol['width']       := 200
// 						oCol['dataType']    := "string"
// 						oCol['encodeHtml']  := .F.
// 						//TODO:Add Template
// 					Endif
// 					cBox := X3CBOX()
// 					If !Empty(cBox)
// 						nSize := SX3->X3_TAMANHO
// 						oCol['lookup']    := GetDxModel('lookup')
// 						aItems := StrTokArr2( cBox, ";", .F.)
// 						For nX:=1 To Len(aItems)
// 							oLookupItem :=  GetDxModel('labelValueJson')
// 							aItem := StrTokArr2( aItems[nX], "=", .F.)
// 							oLookupItem['value'] := Alltrim(aItem[1])
// 							oLookupItem['label'] := Alltrim(aItem[2])
// 							oLookupItem['text']  := Alltrim(aItem[2])
// 							nSize := Max(nSize,Len(Alltrim(aItem[2])))
// 							aadd(oCol['lookup']['dataSource'],oLookupItem)
// 							FreeObj(oLookupItem)
// 						Next
// 						oCol['allowHeaderFiltering'] := .T.
// 						oCol['allowFiltering'] := .F.
// 						oCol['headerFilter'] := jsonObject():New()
// 						oCol['headerFilter']['dataSource'] := oCol['lookup']['dataSource']
// 						oCol['width'] := nSize * 10
// 					Endif
// 					oCol['minWidth'] := 120
// 					AADd(oJson['columns'], oCol)
// 					FreeObj(oCol)
// 				Endif
// 				SX3->(DbSkip())
// 			Enddo
// 		Endif
// 	Endif

//     If oJson <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(oJson)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20031_ColumnsSetupDOC()
//     Returns Queue summary REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20031_ColumnsSetupDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug 
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0090,MODEL_ENCODING) // EAI columns parameters
//     oDoc["description"] := EncodeUTF8(STR0091,MODEL_ENCODING) // Returns parameters of EAI columns to be showed in Angular app
//     oDoc["params"][1]["name"] := "object"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0092,MODEL_ENCODING) // Name of the table that provides column info
//     oDoc["params"][1]["in"] := "path"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .T.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20005_MA3EAIAdapterInfo()
//     Responses to GET request with adapter information by it's code
//     @type function
//     @author idashkov
//     @since 08.02.2024
//     @return Logical
//     @example "GET: http://127.0.0.1:8089/rest/api/api/ma3eai/v1/adapterinfo/RU69T01JSN"
// /*/
// @Get(endpoint="/api/ma3eai/v1/adapterinfo/:code",description="[np.framework.eairest.RU99W20022_AdapterInfoDOC]")
// Function RU99W20005_MA3EAIAdapterInfo()

//     Local jPath := oRest:getPathParamsRequest() As Json
//     Local aQueries := {} as Array
// 	Local cCode := "" as Character
// 	Local jResponse := jsonObject():New() As Json

//     np.framework.eai.TrySetEnv()

// 	If jPath['code'] <> Nil
// 		cCode := jPath['code']
// 	Endif

//     If Empty(cCode)
//         jResponse:FromJson(MA3EAIErrorResponse(cMessage=STR0013)) // Adapter code is empty
//     Else
//         aQueries := np.framework.eairest.FormatQuery(cTable="F6G",; // Returns endpoints info from database for this adapter
//             lReqTotalCount=.T., cFilterVars=cCode, cSkip="",cPageSize="",;
//             cFilterExp="F6G_ADAPTE = ?", lDebug=.T., cOrder="")
//         jResponse := np.framework.eairest.getAdapterInfo(aQueries=aQueries,cAdapterCode=cCode)
//     EndIf

// 	If jResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(jResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20006_MA3EAIResponse
//     Response format
//     @type function
//     @version 1
//     @author bsobieski
//     @since 15/12/2023
//     @param lSuccess, Logical, Response is successful
//     @param cMessage, Character, Mesasge
//     @param oError, Object, Error
//     @param aData, Array, Additional data
//     @return Character, Json in String format
// /*/
// Function RU99W20006_MA3EAIResponse(lSuccess as Logical,cMessage as Character,oError,aData) as Character
	
//     Local oJsonResp := jsonObject():New()
// 	Local cJsonResp := "" as Character

// 	oJsonResp['success'] := lSuccess
// 	oJsonResp['message'] := cMessage
// 	If Valtype(oError) <> "U"
// 		oJsonResp['error'] := oError
// 	Endif
// 	If Valtype(aData) <> "U" .And. (Valtype(aData) <> "A" .Or. Len(aData) > 0)
// 		oJsonResp['data'] := aData
// 	Endif
// 	cJsonResp := oJsonResp:toJson() // If aData[1] has XML format, this operation will lead to adding \n into text, be advised
// 	FreeObj(oJsonResp)

// Return cJsonResp

// /*/{Protheus.doc} RU99W20007_MA3EAIError
//     Error format
//     @type function
//     @version 1
//     @author bsobieski
//     @since 15/12/2023
//     @param cCode, Character, Error code
//     @param cMessage, Character, Message
//     @param cTarget, Character, Where the error happened
//     @param aDetails, Array, Additional data (can be in error formar), unspecified format
//     @return Character, Json in String format
// */
// Function RU99W20007_MA3EAIError(cCode as Character,cMessage as Character,cTarget as Character,aDetails as Array) as Character
	
//     Local oJsonResp := jsonObject():New()
// 	Local cJsonResp := "" as Character
//     //    detailedMessage: "Technical and more detailed error message",
//     //    helpUrl: "link to error documentation",
//     //    detailedMessage: "Technical and more detailed error message",
//     //    helpUrl: "link to error documentation",
// 	oJsonResp['type'] := "error"
// 	If Valtype(cCode) <> "U"
// 		oJsonResp['code'] := cCode
// 	Endif
// 	If Valtype(cMessage)  <> "U"
// 		oJsonResp['message'] := cMessage
// 	Endif
// 	If Valtype(cTarget) <> "U"
// 		oJsonResp['target'] := cTarget
// 	Endif
// 	If Valtype(aDetails) <> "U"
// 		oJsonResp['details'] := aDetails
// 	Endif
// 	cJsonResp := oJsonResp:toJson()
// 	FreeObj(oJsonResp)

// Return cJsonResp

// @Put(endpoint="/api/ma3eai/v1/eaireceive/",description="[np.framework.eairest.RU99W20023_PutEaiReceiveDOC]")
// Function RU99W20008_MA3EAIPutReceiveRest()
// Return RU99W20014_MA3EAIReceiveRest(MODEL_OPERATION_UPDATE)

// @Post(endpoint="/api/ma3eai/v1/eaireceive/",description="[np.framework.eairest.RU99W20024_PostEaiReceiveDOC]")
// Function RU99W20009_MA3EAIPostReceiveRest()
// Return RU99W20014_MA3EAIReceiveRest(MODEL_OPERATION_INSERT)

// @Delete(endpoint="/api/ma3eai/v1/eaireceive/",description="[np.framework.eairest.RU99W20025_DeleteEaiReceiveDOC]")
// Function RU99W20010_MA3EAIDeleteReceiveRest()
// Return RU99W20014_MA3EAIReceiveRest(MODEL_OPERATION_DELETE)

// @Put(endpoint="/api/ma3eai/v1/eaireceive/:adapterCode") // Description is already included in PUT of /api/ma3eai/v1/eaireceive/
// Function RU99W20011_MA3EAIPutReceiveRestPathParam()
// Return RU99W20014_MA3EAIReceiveRest(MODEL_OPERATION_UPDATE)

// @Post(endpoint="/api/ma3eai/v1/eaireceive/:adapterCode") // Description is already included in POST of /api/ma3eai/v1/eaireceive/
// Function RU99W20012_MA3EAIPostReceiveRestPathParam()
// Return RU99W20014_MA3EAIReceiveRest(MODEL_OPERATION_INSERT)

// @Delete(endpoint="/api/ma3eai/v1/eaireceive/:adapterCode") // Description is already included in DELETE of /api/ma3eai/v1/eaireceive/
// Function RU99W20013_MA3EAIDeleteReceiveRestPathParam()
// Return RU99W20014_MA3EAIReceiveRest(MODEL_OPERATION_DELETE)

// /*/{Protheus.doc} RU99W20014_MA3EAIReceiveRest()
//     Endpoint for receiving MA3 documents from REST service,
//     processing recieved request
//     @type function
//     @version 1
//     @author bsobieski
//     @since 15/12/2023
//     @param nOperation, Numeric, 3=Insert,4=Update;5=Delete
//     @return Json, MA3 EAI Response object
// /*/
// Function RU99W20014_MA3EAIReceiveRest(nOperation as Numeric)
    
// 	Local jPath := oRest:getPathParamsRequest() As Json
//     Local cAdapter  :=  "" as Character
// 	Local cBody     := oRest:getBodyRequest() as Character
// 	Local oJsonBody := jsonObject():New()
//     Local oXmlBody  := TXmlManager():New()
//     Local cXmlName  := ""
// 	Local lRet      := .T.
// 	Local oJsonRet  :=  jsonObject():New() as Json
// 	Local aDetails  :=  {} as Array
// 	Local oError    :=  jsonObject():New() as Json
// 	Local cError    as Character
// 	Local cJson     := "" as Character
// 	Local cFormat   := GetTextFormat(cBody) as Character 
// 	Local aReturnTransf as Array

//     np.framework.eai.TrySetEnv()

//     If jPath['adapterCode'] <> Nil
// 		cAdapter := AllTrim(jPath['adapterCode'])
// 	Endif

// 	aReturnTransf := np.framework.eai.RU99X20012_TransformReceivedData(nOperation,cFormat,cBody)
// 	If ValType(aReturnTransf) == "A"
// 		cFormat := aReturnTransf[1]
// 		cBody   := aReturnTransf[2]
// 	Endif
// 	If cFormat == "JSON"
// 		cJson := oJsonBody:FromJson(cBody)
// 		If !Empty(cJson)
// 			cError := RU99W20007_MA3EAIError(cMessage=cJson)
// 			oError:FromJson(cError)
// 			Aadd(aDetails,oError)
// 			FreeObj(oError)
// 			oError := jsonObject():New()
// 			cJsonRet := MA3EAIErrorResponse(cMessage=STR0001,aDetails=aDetails) // Error in Json structure
// 			lRet := .F.
// 		Endif
// 		If lRet .And. oJsonBody['header'] == Nil
// 			cJsonRet := MA3EAIErrorResponse(cMessage=STR0001+' '+STR0002) // Error in Json structure // [header is absent]  
// 			lRet := .F.
// 		Endif
// 		If lRet .And. oJsonBody['header']['adapter'] == Nil
// 			cJsonRet := MA3EAIErrorResponse(cMessage=STR0001+' '+STR0003) // Error in Json structure // [header.adapter] not defined
// 			lRet := .F.
// 		Endif
// 		If lRet .And. oJsonBody['header']['operation'] <> Nil .And.;
//         ((oJsonBody['header']['operation']=="DELETE" .And. nOperation <> MODEL_OPERATION_DELETE) .Or.;
//         (oJsonBody['header']['operation']=="UPDATE" .And. nOperation <> MODEL_OPERATION_UPDATE) .Or.;
//         (oJsonBody['header']['operation']=="INSERT" .And. nOperation <> MODEL_OPERATION_INSERT) )
// 			cMessage := i18n(STR0004,; // 
// 				{IIf(nOperation==MODEL_OPERATION_DELETE, "DELETE",IIf(nOperation==MODEL_OPERATION_UPDATE,"UPDATE","INSERT")) ,;
// 				oJsonBody['header']['operation'] })
// 			cJsonRet := MA3EAIErrorResponse(cMessage=cMessage)
// 			lRet := .F.
// 		Endif
// 		If Empty(cAdapter)
//             cAdapter := oJsonBody['header']['adapter']
//         EndIf
// 	ElseIf cFormat == "XML"
//         If oXMLBody:Read(cBody,/*cURL*/, /*cEncoding*/, /*nOptions*/) .And. lRet
//             cXmlName := oXMLBody:cName
//         Else
// 			cJsonRet := MA3EAIErrorResponse(cMessage=STR0005+' '+STR0006) // Error in Xml structure // [could not parse text]
//             lRet := .F.
//         EndIf
//         If !(oXMLBody:XPathHasNode("/"+cXmlName+"/header")) .And. lRet
// 			cJsonRet := MA3EAIErrorResponse(cMessage=STR0005+' '+STR0007) // Error in Xml structure // [there is no header node]
//             lRet := .F. 
//         EndIf
//         If !(oXMLBody:XPathHasNode("/"+cXmlName+"/content")) .And. lRet
//             cJsonRet := MA3EAIErrorResponse(cMessage=STR0005+' '+STR0008) // Error in Xml structure // [there is no content node]
//             lRet := .F. 
//         EndIf
//         If lRet 
//             cOperation := np.framework.eai.RU99X20017_XPathGetInfo(oXMLBody,"/"+cXmlName+"/header/operation")
//             If ValType(cOperation) == 'U'
//                 cJsonRet := MA3EAIErrorResponse(cMessage=STR0005+' '+STR0009) // Error in Xml structure // [there is no operation defined in header]
//                 lRet := .F. 
//             ElseIf ((cOperation=="DELETE" .And. nOperation <> MODEL_OPERATION_DELETE) .Or.;
//             (cOperation=="UPDATE" .And. nOperation <> MODEL_OPERATION_UPDATE) .Or.;
//             (cOperation=="INSERT" .And. nOperation <> MODEL_OPERATION_INSERT) )
//                 cMessage := i18n(STR0004,; // Error in operation header. Expected #1, received #2.
// 				{IIf(nOperation==MODEL_OPERATION_DELETE, "DELETE",IIf(nOperation==MODEL_OPERATION_UPDATE,"UPDATE","INSERT")),cOperation})
//                 cJsonRet := MA3EAIErrorResponse(cMessage=cMessage)
//                 lRet := .F. 
//             EndIf
//         EndIf
//         If lRet
//             If Empty(cAdapter)
//                 cAdapter := np.framework.eai.RU99X20017_XPathGetInfo(oXMLBody,"/"+cXmlName+"/header/adapter")
//                 If ValType(cAdapter) == 'U'
//                     cJsonRet := MA3EAIErrorResponse(cMessage=STR0005+' '+STR0010) // Error in Xml structure // [there is no adapter defined in header]
//                     lRet := .F. 
//                 EndIf
//             EndIf
//         EndIf
//     Else
//         cJsonRet := MA3EAIErrorResponse(cMessage=STR0011) // Error in recieved data [unknown message format]
//         lRet := .F. 
// 	Endif

// 	If lRet
//         cJsonRet := np.framework.eai.RU99X20002_EAIReceiveQueue(cAdapter=cAdapter,nOperation=nOperation,cContent=cBody,cFormat=cFormat)
//         oJsonRet:FromJson(cJsonRet)
//         lRet := oJsonRet['success'] // TO DO: fix lRet == Nil
//         oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
//     Endif

// 	If lRet
// 		oRest:setStatusCode(200)
// 	Else
// 		oRest:setStatusCode(500)
// 	Endif
//     oRest:setResponse(cJsonRet)
// 	FreeObj(oJsonRet)
// 	FreeObj(oJsonBody)

// Return

// /*/{Protheus.doc} RU99W20015_MA3EAIQueue()
//     Get MA3EAI Queued messages
//     @type function  
//     @author bsobieski
//     @since 15/12/2023
//     @return Json, Queued messages on F6Y order by last added by default
// /*/
// @Get(endpoint="/api/ma3eai/v1/queue/",description="[np.framework.eairest.RU99W20032_QueueDOC]")
// Function RU99W20015_MA3EAIQueue()
// 	Local aQueries      := GetEAIQuery(cTable = 'F6Y')
// 	Local cFields		:= "" as Character
// 	Local jQuery        := jsonObject():New() As Json
// 	Local jResponse     := jsonObject():New() As Json
// 	Local nPageSize as Numeric
	
//     np.framework.eai.TrySetEnv()

//     jQuery := oRest:GetQueryRequest()
// 	If jQuery['fields'] <> Nil
// 		cFields := jQuery["fields"]
// 	Endif
// 	If jQuery['take'] <> Nil
// 		nPageSize := Val(jQuery["take"])
// 	Endif

// 	jResponse := np.framework.eairest.getData(aQueries=aQueries, cTable='F6Y',cFields=cFields,nPageSize=nPageSize)

// 	If jResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(jResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20032_QueueDOC()
//     Returns Queue summary REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20032_QueueDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0093,MODEL_ENCODING) // EAI Queue messages
//     oDoc["description"] := EncodeUTF8(STR0094,MODEL_ENCODING) // Returns list of all EAI Queue messages present in the system
//     oDoc["params"][1]["name"] := "fields"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0088,MODEL_ENCODING) // Names of fields values of which to be returned in information
//     oDoc["params"][1]["in"] := "query"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .F.
//     Aadd(oDoc["params"],jsonObject():New())
//     oDoc["params"][2]["name"] := "take"
//     oDoc["params"][2]["description"] := EncodeUTF8(STR0089,MODEL_ENCODING) // Page size of information to be returned
//     oDoc["params"][2]["in"] := "query"
//     oDoc["params"][2]["type"] := "integer"
//     oDoc["params"][2]["required"] := .F.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20016_MA3EAIAllQueueDetails
//     Get MA3EAI Queued messages LOG
//     @type function  
//     @author idashkov
//     @since 15.03.2024
//     @return Json, Queued messages on F6Y order by last added by default
// /*/
// @Get(endpoint="/api/ma3eai/v1/queue-detail/",description="[np.framework.eairest.RU99W20033_QueueDetailsDOC]")
// Function RU99W20016_MA3EAIAllQueueDetails()
// Return np.framework.eairest.RU99W20017_MA3EAIQueueDetails()

// /*/{Protheus.doc} RU99W20033_QueueDetailsDOC()
//     Returns Queue detail REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20033_QueueDetailsDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0095,MODEL_ENCODING) // EAI Queue details
//     oDoc["description"] := EncodeUTF8(STR0096,MODEL_ENCODING) // Returns redcords of EAI Queue log. If specific uuid is provided, then logs for specific message in EAI Queue will be returned, otherwise - all Queue logs avaliable. 
//     oDoc["params"][1]["name"] := "uuid"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0097,MODEL_ENCODING) // Uuid of EAI Queue record
//     oDoc["params"][1]["in"] := "path"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .F.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20017_MA3EAIQueueDetails
//     Get MA3EAI Queued messages LOG for certain record in the queue by it's uuid
//     @type function  
//     @author bsobieski
//     @since 15/12/2023
//     @return Json, Queued messages on F6Y order by last added by default
// /*/
// @Get(endpoint="/api/ma3eai/v1/queue-detail/:uuid") // Description is already included in GET of /api/ma3eai/v1/queue-detail/
// Function RU99W20017_MA3EAIQueueDetails()
	
//     Local jPath := oRest:getPathParamsRequest() As Json
//     Local aQueries      := GetEAIQuery(cTable = 'F6Z')
// 	Local cFields		:= "" as Character
// 	Local jQuery        := jsonObject():New() As Json
// 	Local jResponse     := jsonObject():New() As Json
// 	Local nPageSize as Numeric
//     Local cQueueUuid := "" as Character
    
//     np.framework.eai.TrySetEnv()

//     If jPath['uuid'] <> Nil
// 		cQueueUuid := AllTrim(jPath['uuid'])
// 	Endif

//     jQuery := oRest:GetQueryRequest()
// 	If jQuery['fields'] <> Nil
// 		cFields:= jQuery["fields"]
// 	Endif
// 	If jQuery['take'] <> Nil
// 		nPageSize:= Val(jQuery["take"])
// 	Endif

// 	If !Empty(cQueueUuid)
//         aQueries := np.framework.eairest.FormatQuery(cTable="F6Z",lReqTotalCount=.F.,cSkip = "", cPageSize="",cFilterVars=cQueueUuid,; 
//                                                     cFilterExp="F6Z_QUUID = ?",lDebug=.F.,cOrder="")
//         jResponse := np.framework.eairest.getData(aQueries=aQueries, cTable='F6Z',cFields=cFields,nPageSize=nPageSize)
//     Else
//         jResponse := np.framework.eairest.getData(aQueries=aQueries, cTable='F6Z',cFields=cFields,nPageSize=nPageSize)
//     EndIF

// 	If jResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(jResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20018_MA3EAIQueueAction()
//     Get MA3EAI messages desired queue action to be done 
//     with the list of uuids to be affected by it
//     @type function  
//     @author idashkov
//     @since 18.03.2024
//     @return Json, Response
// /*/
// @Put(endpoint="/api/ma3eai/v1/queue-action/:operation",description="[np.framework.eairest.RU99W20034_QueueActionDOC]")
// Function RU99W20018_MA3EAIQueueAction()

//     Local jPath := oRest:getPathParamsRequest() As Json
// 	Local cQueueUuids	:= "" as Character
//     Local aQueueUuids   := {} as Array
// 	Local jQuery        := jsonObject():New() As Json
// 	Local jResponse     := jsonObject():New() As Json
//     Local cQueueOperation := "" as Character
//     Local lRet := .T. as Logical
//     Local cStatusFilter := ""
	
//     np.framework.eai.TrySetEnv()

//     If jPath['operation'] <> Nil
// 		cQueueOperation := Upper(AllTrim(jPath['operation']))
// 	Endif

//     jQuery := oRest:GetQueryRequest()
// 	If jQuery['uuids'] <> Nil
// 		cQueueUuids := Upper(AllTrim(jQuery["uuids"]))
//         If !Empty(cQueueUuids)
//             aQueueUuids:= StrToArray(cQueueUuids,',')
//         EndIf
// 	Endif

//     Do Case
//         Case cQueueOperation == "BLOCK"
//             cStatusFilter := " !(F6Y_STATUS == '5' .Or. F6Y_STATUS == '4' .Or. F6Y_STATUS == '7') " 
//         Case cQueueOperation == "UNBLOCK"
//             cStatusFilter := " F6Y_STATUS == '5' " 
//         Case cQueueOperation == "REPROCESS" .Or. cQueueOperation == "RETRY"
//             cStatusFilter := " F6Y_STATUS == '4' " 
//         Otherwise
//             jResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0014,{cQueueOperation}))) // Error, unknown queue operation type in the input - '#1'
//             lRet := .F.
//     EndCase

//     If lRet
//         If !Empty(aQueueUuids) .Or. cQueueOperation == "REPROCESS" .Or. cQueueOperation == "RETRY"
//             jResponse := np.framework.eairest.ApplyActionOnQueue(cStatusFilter,cQueueOperation,aQueueUuids)
//         Else
//             jResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0015,{cQueueOperation}))) // Error, uuids for queue records are not provided
//             lRet := .F. 
//         EndIf
//     EndIf

// 	If jResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
//         oRest:setResponse(jResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20034_QueueActionDOC()
//     Returns Queue detail REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20034_QueueActionDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0098,MODEL_ENCODING) // EAI Queue action
//     oDoc["description"] := EncodeUTF8(STR0099,MODEL_ENCODING) // Performs a specific action upon EAI Queue. Can block, unblock messages in the Queue or retry to process them.
//     oDoc["params"][1]["name"] := "operation"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0100,MODEL_ENCODING) // Operation to be processed. Can be BLOCK, UNBLOCK or RETRY
//     oDoc["params"][1]["in"] := "path"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .T.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} ApplyActionOnQueue()
//     Aplies required MA3EAI messages queue action to the database 
//     to cahnge statused and tries of messages in the queue
//     @type function  
//     @author idashkov
//     @since 18.03.2024
//     @param cFilter, Character, String with constraints on records to be considered for action to be implemented
//     @param cOperation, Character, Type of action to be implemented
//     @param aQueueUuids, Array, Uuids of EAI queue messages to be affected by action
//     @return Json, Response with error or info about made operations
// /*/
// Static Function ApplyActionOnQueue(cFilter as Character, cOperation as Character, aQueueUuids as Array) As Json

//     Local aArea := FwGetArea()
//     Local oResponse := jsonObject():New() As Json
//     Local nI := 1 
//     Local cNewStatus := ""
//     Local nAffectedRecords := 0
//     Local lRet := .T.
//     Local nNewTries := 1
//     Local oModelF6Y as Object
//     Local oStruF6Y 	:= FWFormStruct( 1, 'F6Y', /*bAvalCampo*/,/*lViewUsado*/ )

//     np.framework.eai.TrySetEnv()

//     oStruF6Y:AddField(                              ; // Ord. Tipo Desc.
//         GetSX3Cache('F6Y_MSUID',"X3_TITULO"),       ; // [01] C Field title
//         AllTrim( 'Example Field 1' ),               ; // [02] C Field ToolTip
//         'F6Y_MSUID',                                ; // [03] C Field identifier (ID)
//         GetSX3Cache('F6Y_MSUID',"X3_TIPO"),         ; // [04] C Field type
//         GetSX3Cache('F6Y_MSUID',"X3_TAMANHO"),      ; // [05] N Field size
//         GetSX3Cache('F6Y_MSUID',"X3_DECIMAL"),      ; // [06] N Field decimal
//         {||.T.},                                    ; // [07] B Field validation code block
//         NIL,                                        ; // [08] B Validation code block When of the field
//         {},                                         ; // [09] A List of allowed values for the field
//         NIL,                                        ; // [10] L Indicates whether the field has mandatory completion
//         {||""},                                     ; // [11] B Field initialization code block
//         NIL,                                        ; // [12] L Indicates whether this is a key field
//         NIL,                                        ; // [13] L Indicates whether the field can receive value in an update operation.
//         .F.                                         ; // [14] L Indicates whether it is a virtual field
//     )

//     F6G->(DbSetOrder(1)) // F6G_filial+F6G_adapte+F6G_item
//     F6Y->(DbSetOrder(1)) // F6Y_filial+F6Y_msuid
//     F6Y->(DbSetFilter({|| &cFilter},cFilter))
//     F6Y->(DbGoTop())

//     If Len(aQueueUuids) > 0
//         For nI := 1 To Len(aQueueUuids)
//             oModelF6Y := MPFormModel():New('RU99D205', /*bPreValidacao*/, /*bPosValidacao*/, /*bCommit*/, /*bCancel*/ ) // Constructiong model here and avoiding oModelF6Y := FWLoadModel( 'RU99D204' ) just to have F6Y_MSUID field in the model
//             oModelF6Y:AddFields( 'F6YMASTER', /*cOwner*/, oStruF6Y, /*bPreValidacao*/, /*bPosValidacao*/, /*bCarga*/ )
//             oModelF6Y:SetPrimaryKey( { "F6Y_FILIAL", "F6Y_MSUID"} )
//             oModelF6Y:SetOperation( MODEL_OPERATION_UPDATE)
//             DbSelectArea("F6Y")
//             If F6Y->(MsSeek(xFilial("F6Y")+Upper(aQueueUuids[nI])))
//                 BEGIN TRANSACTION
//                 If !(oModelF6Y:IsActive())
//                     lRet := oModelF6Y:Activate()
//                 EndIf
//                 If lRet
//                     oModelF6Y:LoadValue('F6YMASTER' ,'F6Y_FILIAL', xFilial("F6Y") )
//                     oModelF6Y:LoadValue('F6YMASTER' ,'F6Y_ADAPTE', F6Y->F6Y_ADAPTE)
//                     oModelF6Y:LoadValue('F6YMASTER' ,'F6Y_MSUID',  F6Y->F6Y_MSUID)
//                     Do Case
//                         Case cOperation == "BLOCK"
//                             cNewStatus := "5" // Blocked
//                         Case cOperation == "UNBLOCK"
//                             If Empty(F6Y->F6Y_DATA2)
//                                 cNewStatus := "1" // Queued
//                             Else
//                                 cNewStatus := "2" // Ready to be processed
//                             EndIF
//                         Case cOperation == "REPROCESS" .OR. cOperation == "RETRY"
//                             cNewStatus := "3" // Retry pending
//                             If F6G->(MsSeek(xFilial("F6G")+F6Y->F6Y_ADAPTE))
//                                 If F6G->F6G_TRIES > 0
//                                     nNewTries := F6G->F6G_TRIES
//                                 EndIf
//                             EndIf
//                             lRet := oModelF6Y:SetValue('F6YMASTER' ,'F6Y_TRIES'    	, nNewTries)
//                             If !lRet
//                                 oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0017,{nNewTries,cOperation}))) // Error: Could not set new number of tries (#1) into EAI queue model. Operation '#2' is cancelled.
//                             EndIf
//                     EndCase
//                     If lRet
//                         lRet := oModelF6Y:SetValue('F6YMASTER' ,'F6Y_STATUS'    	, cNewStatus)
//                     Endif
//                     If lRet
//                         lRet := oModelF6Y:VldData()
//                         If lRet
//                             oModelF6Y:CommitData()
//                             nAffectedRecords += 1
//                         Else
//                             oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0018,{cOperation}))) // Error: Could not validate EAI queue model. Operation '#1' is cancelled.
//                         Endif
//                     Else
//                         oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0019,{np.framework.eai.getCboxTranslate(cNewStatus,"F6Y_STATUS"),cOperation}))) //
//                     Endif
//                     If oModelF6Y:IsActive()
//                         oModelF6Y:Deactivate()
//                     EndIf
//                 Else
//                     oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0020,{cOperation}))) // Error: Could not activate EAI queue model.
//                 EndIf
//                 If !lRet
//                     If oResponse == jsonObject():New()
//                         oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0021,{cOperation}))) // Error: Unknown database error. Operation '#1' is cancelled.
//                     EndIf
//                     DisarmTransaction()
//                 EndIf
//                 End Transaction
//             Else
//                 oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0016,{aQueueUuids[nI],cOperation}))) // Error: Could not find required uuid '#1' with a suitable status. Operation '#2' is cancelled.
//                 lRet := .F.
//                 Exit
//             EndIf
//         Next nI
//     ElseIf cOperation == "REPROCESS" .OR. cOperation == "RETRY"
//         cNewStatus := "3" // Retry pending
//         While F6Y->(!Eof()) .And. lRet
//             BEGIN TRANSACTION
//             oModelF6Y := MPFormModel():New('RU99D205', /*bPreValidacao*/, /*bPosValidacao*/, /*bCommit*/, /*bCancel*/ ) // Constructiong model here and avoiding oModelF6Y := FWLoadModel( 'RU99D204' ) just to have F6Y_MSUID field in the model
//             oModelF6Y:AddFields( 'F6YMASTER', /*cOwner*/, oStruF6Y, /*bPreValidacao*/, /*bPosValidacao*/, /*bCarga*/ )
//             oModelF6Y:SetPrimaryKey( { "F6Y_FILIAL", "F6Y_MSUID"} )
//             oModelF6Y:SetOperation( MODEL_OPERATION_UPDATE)
//             DbSelectArea("F6Y")
//             If !(oModelF6Y:IsActive())
//                 lRet := oModelF6Y:Activate()
//             EndIf
//             lRet := oModelF6Y:SetValue('F6YMASTER' ,'F6Y_STATUS'    	, cNewStatus)
//             If lRet
//                 nNewTries := 1
//                 If F6G->(MsSeek(xFilial("F6G")+F6Y->F6Y_ADAPTE))
//                     If F6G->F6G_TRIES > 0
//                         nNewTries := F6G->F6G_TRIES
//                     EndIf
//                 EndIf
//                 lRet := oModelF6Y:SetValue('F6YMASTER' ,'F6Y_TRIES'    	, nNewTries)
//                 If lRet
//                     lRet := oModelF6Y:VldData()
//                     If lRet
//                         oModelF6Y:CommitData()
//                         nAffectedRecords += 1
//                         Aadd(aQueueUuids,F6Y->F6Y_MSUID)
//                     Else
//                         oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0020,{cOperation}))) // Error: Could not activate EAI queue model.
//                     Endif
//                 Else
//                     oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0017,{nNewTries,cOperation}))) // Error: Could not set new status value (#1) into queue model. Operation '#2' is cancelled.
//                 Endif
//                 F6Y->(dbSkip())
//             Else
//                 oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0019,{np.framework.eai.getCboxTranslate(cNewStatus,"F6Y_STATUS"),cOperation}))) // Error: Could not set new status value (#1) into queue model. Operation '#2' is cancelled.
//             EndIf
//             If oModelF6Y:IsActive()
//                 oModelF6Y:Deactivate()
//             EndIf
//             If !lRet
//                 If oResponse == jsonObject():New()
//                     oResponse:FromJson(MA3EAIErrorResponse(cMessage=i18n(STR0021,{cOperation}))) // Error: Unknown database error. Operation '#1' is cancelled.
//                 EndIf
//                 DisarmTransaction()
//             EndIf
//             End Transaction
//         EndDo
//     Else
//         lRet := .F.
//     EndIf

//     If lRet
//         oResponse["success"] := .T.
//         oResponse["operation"] := cOperation
//         oResponse["recordsChanged"] := nAffectedRecords
//         oResponse["usedUuids"] := aQueueUuids
//     EndIf
//     F6Y->(dbClearFilter())
//     FWRestArea(aArea)

// Return oResponse

// /*/{Protheus.doc} RU99W20019_MA3EAILog
//     Get MA3EAI Log messages
//     @type function
//     @author bsobieski
//     @since 15/12/2023
//     @return Json, Log messages on F6Y order by last added by default
// /*/
// @Get(endpoint="/api/ma3eai/v1/log/",description="[np.framework.eairest.RU99W20035_LogDOC]")
// Function RU99W20019_MA3EAILog()

// 	Local aQueries      := GetEAIQuery(cTable = 'F5L')
// 	Local cFields		:= "" as Character
// 	Local jQuery        := jsonObject():New() As Json
// 	Local jResponse     := jsonObject():New() As Json
// 	Local nPageSize as Numeric

//     np.framework.eai.TrySetEnv()

// 	jQuery := oRest:GetQueryRequest() 
// 	If jQuery['fields'] <> Nil
// 		cFields:= jQuery["fields"]
// 	Endif
// 	If jQuery['take'] <> Nil
// 		nPageSize:= Val(jQuery["take"])
// 	Endif

// 	jResponse := np.framework.eairest.getData(aQueries=aQueries, cTable='F5L',cFields=cFields,nPageSize=nPageSize)

// 	If jResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(jResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20035_LogDOC()
//     Returns Queue detail REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20035_LogDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0101,MODEL_ENCODING) // EAI Log
//     oDoc["description"] := EncodeUTF8(STR0102,MODEL_ENCODING) // Returns list of all EAI Log messages present in the system
//     oDoc["params"][1]["name"] := "fields"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0088,MODEL_ENCODING) // Names of fields values of which to be returned in information
//     oDoc["params"][1]["in"] := "query"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .F.
//     Aadd(oDoc["params"],jsonObject():New())
//     oDoc["params"][2]["name"] := "take"
//     oDoc["params"][2]["description"] := EncodeUTF8(STR0089,MODEL_ENCODING) // Page size of information to be returned
//     oDoc["params"][2]["in"] := "query"
//     oDoc["params"][2]["type"] := "integer"
//     oDoc["params"][2]["required"] := .F.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20020_MA3EAILogClear
//     Clears EAI Log table from all records with date 
//     before input date Responses with number of deleted
//     messages and records result of clearing
//     @type function
//     @author idashkov
//     @since 22.02.2023
//     @return Logical
// /*/
// @Put(endpoint="/api/ma3eai/v1/clearlog/:lastdate",description="[np.framework.eairest.RU99W20036_ClearLogDOC]") 
// Function RU99W20020_MA3EAILogClear()

//     Local jPath := oRest:getPathParamsRequest() As Json
//     Local aQueries := {} as Array
// 	Local cLastDate := "" as Character
// 	Local oResponse := jsonObject():New() As Json
//     Local cAliasTMP := GetNextAlias() as Character
//     Local aArea := FwGetArea()
//     Local cOrder := "F5L_DTINS"

//     np.framework.eai.TrySetEnv()

// 	If jPath['lastdate'] <> Nil
// 		cLastDate := AllTrim(jPath['lastdate'])
// 	Endif

//     If Empty(cLastDate)
//         oResponse:FromJson(MA3EAIErrorResponse(cMessage=STR0103)) // Earliest date to be cleared to is empty.
//     ElseIf !(ValidDateFormat(cLastDate))
//         oResponse:FromJson(MA3EAIErrorResponse(cMessage=STR0104)) // Input date is not in required format: 'YYYY-MM-DD'.
//     Else
//         aQueries := np.framework.eairest.FormatQuery(cTable="F5L",lReqTotalCount=.F.,cSkip = "", cPageSize="",cFilterVars=cLastDate,; 
//                                                     cFilterExp=" SUBSTRING(F5L_DTINS,1,10) < ?",lDebug=.F.,cOrder=cOrder)
//         If !Empty(aQueries[2])
//             oResponse["recordsDeleted"] := 0
//             MPSysOpenQuery(aQueries[2], @cAliasTMP)
//             If Select("F5L") == 0
//                 DbSelectArea("F5L")
//             EndIf
//             While !(cAliasTMP)->(EOF())
//                 F5L->(DbGoTo((cAliasTMP)->RECNO))
//                 oResponse["recordsDeleted"]++
//                 Begin Transaction
//                     RecLock("F5L",.F.)
//                         F5L->(DbDelete())
//                     MsUnlock()
//                 End Transaction
//                 (cAliasTMP)->(DbSkip())
//             Enddo
//             If oResponse["recordsDeleted"] > 0
//                 np.framework.eai.RU99X20015_EAILogMsg(MSG_INFO,I18N(STR0105,{cLastDate,oResponse["recordsDeleted"]})) // Cleared EAI log up to #1. Cleared #2 records
//             Else
//                 np.framework.eai.RU99X20015_EAILogMsg(MSG_INFO,I18N(STR0106,{cLastDate})) // Tried to clear EAI log. There were no records before #1
//             EndIF
//         Endif
//     EndIf

//     FwRestArea(aArea)

// 	If oResponse <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(oResponse)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20036_ClearLogDOC()
//     Returns Queue detail REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20036_ClearLogDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0107,MODEL_ENCODING) // Clear EAI Log
//     oDoc["description"] := EncodeUTF8(STR0108,MODEL_ENCODING) // Deletes messages in EAI Log before the specified date
//     oDoc["params"][1]["name"] := "lastdate"
//     oDoc["params"][1]["description"] := EncodeUTF8(STR0109,MODEL_ENCODING) // Date in YYYY-MM-DD format. Log messages before it will be wiped out.
//     oDoc["params"][1]["in"] := "path"
//     oDoc["params"][1]["type"] := "character"
//     oDoc["params"][1]["required"] := .T.
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} ValidDateFormat()
//     Vlidates passed string with data to compliance with YYYY-MM-DD format
//     @type function
//     @author idashkov
//     @since 22.02.2024
//     @param cDate, Character, Data to be checked
//     @return Logical, Result of the check
// /*/
// Static Function ValidDateFormat(cDate as Character)

//     Local lRet := .F.

//     If (Len(cDate) == 10) .And. (AT("-", cDate) == 5) .And. (RAT("-", cDate) == 8)
//         If !(Val(SubStr(cDate,1,4)) == 0) .And. !(Val(SubStr(cDate,6,2)) == 0) .And. !(Val(SubStr(cDate,9,2)) == 0)
//             lRet := .T.
//         EndIf
//     EndIf

// Return lRet

// /*/{Protheus.doc} GetEAIQuery
//     Prepares oData parameters to call function to retrieve QUEUE or LOG data 
//     @type function
//     @author bsobieski
//     @since 15/12/2023
//     @param cTable, Character, QUEUE (F6Y) or LOG table (F5L) or Adapters "F6F"
//     @return Array,  Queries[1] = Total query,
//                     Queries[2] = Data query
// /*/
// Static Function GetEAIQuery(cTable as Character) as Array

// 	Local jQuery            := jsonObject():New() As Json
// 	Local cSkip             := "0" as Character
// 	Local cPageSize         := "20" as Character
// 	Local cReqTotalCount    := "" as Character
// 	Local cOrder            := "" as Character
// 	Local cFilterVars 	    := "" as Character
// 	Local cFilterExp 	    := "" as Character
// 	Local cDebug		    := "" as Character
// 	Local aQueries          := {"",""} as Array

// 	jQuery := oRest:GetQueryRequest()

//     If cTable == 'F6F'
// 		cOrder := "F6F_FILIAL,F6F_CODE,F6F_OPER,F6F_TYPE"
//     ElseIf cTable == 'F6G'
// 		cOrder := "F6G_FILIAL,F6G_ADAPTE,F6G_PATH"
// 	ElseIf cTable == 'F6Y'
// 		cOrder := "F6Y_FILIAL,F6Y_DTINS DESC,R_E_C_N_O_ DESC"
// 	ElseIf cTable == 'F6Z'
// 		cOrder := "F6Z_FILIAL,F6Z_DTINS DESC,R_E_C_N_O_ DESC"
// 	ElseIf cTable == 'F5L'
// 		cOrder := "F5L_FILIAL,F5L_DTINS DESC,R_E_C_N_O_ DESC"
// 	Endif
// 	If ( jQuery <> Nil )
// 		If jQuery['skip']<>Nil
// 			cSkip := jQuery['skip']
// 		Endif
// 		If jQuery['take']<>Nil
// 			cPageSize := jQuery['take']
// 		Endif
// 		If jQuery['requireTotalCount']<>Nil
// 			cReqTotalCount := jQuery['requireTotalCount']
// 		Endif
// 		If jQuery['filterVars' ]<>Nil
// 			cFilterVars := jQuery["filterVars"]
// 		Endif
// 		If jQuery['filter']<>Nil
// 			cFilterExp := jQuery["filter"]
// 		Endif
// 		If jQuery['debug']<>Nil
// 			cDebug := jQuery["debug"]
// 		Endif
// 		If jQuery['order']<>Nil
// 			cOrder := jQuery["order"]
// 		Endif
// 	EndIf

// 	//jPath := oRest:getPathParamsRequest()

// 	//If (jPath <> Nil)
// 	aQueries := np.framework.eairest.FormatQuery(  cTable=cTable,;
// 		cSkip=cSkip,;
// 		cPageSize=cPageSize,;
// 		lReqTotalCount= ( Empty(cReqTotalCount) .Or. Lower(cReqTotalCount) == "true" .Or. cReqTotalCount == "1"),;
// 		cFilterVars=cFilterVars, ;
// 		cFilterExp=cFilterExp,;
// 		lDebug= ((Lower(cDebug) == "true" .Or. cDebug == "1")),;
// 		cOrder=cOrder)

// Return aQueries

// /*/{Protheus.doc} getData()
//     Gets TOTAL records and paged data based on queries
//     @type function
//     @author bsobieski
//     @since 16/12/2023
//     @param aQueries, array, aQueries[1]=Total records query, aQueries[2]=data query
//     @param cTable, character, Table code to get the structrue 
//     @param cFields, character, Fields to be retrieved (all fields if empty)
//     @param nPage, numeric, Page number
//     @param nPageSize, numeric, Page Size
//     @return Character, Data as Json character
// /*/
// Static Function getData(aQueries as Array, cTable as Character,;
// cFields as Character, nPage as Numeric,nPageSize as Numeric) as Character

// 	Local cAliasTMP     :=  GetNextAlias() as Character
// 	Local nTotal    as Numeric
// 	Local oRet      :=jsonObject():New() as Json
// 	Local aStru as Array
// 	Local nX    as Numeric
// 	Local nPos
// 	Local xValue as Variant
//     //oRet["page"] := nPage

// 	If !Empty(aQueries[1])
// 		DbUseArea(.T., "TOPCONN", TCGenQry(,,aQueries[1]), cAliasTMP, .F., .T.)
// 		nTotal := (cAliasTMP)->TOTALCOUNT
// 		(cAliasTMP)->(DbCloseArea())
// 		oRet["total"] := nTotal
// 	Endif
// 	If !Empty(aQueries[2])
// 		oRet["records"]   :=  0
// 		MPSysOpenQuery(aQueries[2], @cAliasTMP)
// 		oRet['data'] := {}
// 		aStru := (cTable)->(DbStruct())
// 		While !(cAliasTMP)->(EOF())
// 			(cTable)->(DbGoTo((cAliasTMP)->RECNO))
// 			AAdd(oRet['data'], jsonObject():New())
// 			nPos := Len(oRet['data'])
// 			oRet["records"]++
// 			For nX:=1 To Len(aStru)
// 				If Empty(cFields) .Or. aStru[nX,1] $ cFields .Or. "_MSUID" $ Alltrim(aStru[nX,1])
// 					xValue := (cTable)->(FieldGet(FieldPos(aStru[nX,1])))
// 					if !Empty(xValue)
// 						If ValType(xValue) == "C"
// 							oRet['data'][nPos][aStru[nX,1]]  :=  Alltrim(xValue)
// 						Else
// 							oRet['data'][nPos][aStru[nX,1]]  :=  xValue
// 						Endif
// 					Endif
// 				Endif
// 			Next
// 			oRet['data'][nPos]['ID']  :=  (cTable)->(RECNO())

// 			//cJsonTMP:= oJsonResp:toJson()
// 			//Aadd(oRet['data'],(jsonObject():New()):FromJson(cJsonTMP))
// 			//FreeObj(oJsonResp)
// 			(cAliasTMP)->(DbSkip())
// 		Enddo
//         //    oRet["hasNext"]   :=  oRet["records"] < nPageSize
// 	Endif

// 	cRet := oRet:toJson()
// 	FreeObj(oRet)

// Return cRet

// /*/{Protheus.doc} getAdapterInfo()
//     Returns Json with all adapter's relevant info
//     @type function
//     @author idashkov
//     @since 09.02.2024
//     @param aQueries, Array, aQueries[1]=Total records query, 
//                             aQueries[2]=Query with all endpoints of this adapter
//     @param cAdapterCode, Character, Code of the adapter 
//     @param cFields, Character, Fields of endpoints table to be returned in Json's list
//     @return Json, Adapter info: code, type, format, etc + associated endpoints
// */
// Static Function getAdapterInfo(aQueries as Array, cAdapterCode as Character, cFields as Character) as Json

//     Local oRet := jsonObject():New() as Json
//     Local oEndPoints := jsonObject():New() as Json
//     Local cAliasTMP := GetNextAlias() as Character
// 	Local aStru as Array
// 	Local nX as Numeric
// 	Local nPos as Numeric 
// 	Local xValue as Variant
//     Local lRet := .T.
//     Local aArea := FwGetArea()
//     Local aOperAllowed := {}
//     Default cFields := ""
//     Default cAdapterOper := ""

//     cAdapterCode := AllTrim(cAdapterCode)
    
//     // Adds Swagger with Expected Input for receive / Output for send 
//     F6G->(DbSetOrder(1)) // F6G_filial+F6G_adapte+F6G_item
//     F6G->(MsSeek(xFilial("F6G")+cAdapterCode))
//     F6F->(DbSetOrder(1)) // F6F_filial+F6F_code+F6F_oper
// 	If F6F->(MsSeek(xFilial("F6F")+cAdapterCode))
//         oRet["code"] := cAdapterCode
//         oRet["type"] := np.framework.eai.getCboxTranslate(F6F->F6F_TYPE,"F6F_TYPE")
//         oRet["operation"] := F6F->F6F_OPER
//         oRet["operationDescription"] := np.framework.eai.getCboxTranslate(F6F->F6F_OPER,"F6F_OPER")
//         oRet["format"] := F6F->F6F_FORMAT
//         Iif(F6F->F6F_INSERT, Aadd(aOperAllowed,"INSERT"), Nil)
//         Iif(F6F->F6F_UPDATE, Aadd(aOperAllowed,"UPDATE"), Nil)
//         Iif(F6F->F6F_DELETE, Aadd(aOperAllowed,"DELETE"), Nil)
//         oRet["operationsAllowed"] := aOperAllowed
//         If Empty(F6F->F6F_SWAGG)
//             oRet["expectedSchema"] := AdapterFormatDOC(cAdapterCode,F6F->F6F_TYPE,F6F->F6F_FORMAT)
//         Else
//             oRet["expectedSchema"] := &(F6F->F6F_SWAGG)
//         EndIf
//     Else
//         lRet := .F.
//         oRet:FromJson(MA3EAIErrorResponse(cMessage=I18n(STR0012,{cAdapterCode}))) // Error: Could not find adapter with code '#1' in the database
//     EndIf

//     // Adds list with adapter Endpoints details
//     If !Empty(aQueries[2]) .And. lRet
// 		oEndPoints["records"] :=  0
// 		MPSysOpenQuery(aQueries[2], @cAliasTMP)
// 		oEndPoints['data'] := {}
//         If Select("F6G") == 0
//             DbSelectArea("F6G")
//         EndIf
// 		aStru := F6G->(DbStruct())
// 		While !(cAliasTMP)->(EOF())
// 			F6G->(DbGoTo((cAliasTMP)->RECNO))
// 			AAdd(oEndPoints['data'], jsonObject():New())
// 			nPos := Len(oEndPoints['data'])
// 			oEndPoints["records"]++
// 			For nX:=1 To Len(aStru)
// 				If Empty(cFields) .Or. aStru[nX,1] $ cFields .Or. "_MSUID" $ Alltrim(aStru[nX,1])
// 					xValue := F6G->(FieldGet(FieldPos(aStru[nX,1])))
// 					If !Empty(xValue)
// 						If ValType(xValue) == "C"
// 							oEndPoints['data'][nPos][CamelCase(GetSX3Cache(aStru[nX,1],"X3_TITENG"))] := Alltrim(xValue)
// 						Else
// 							oEndPoints['data'][nPos][CamelCase(GetSX3Cache(aStru[nX,1],"X3_TITENG"))] := xValue
// 						Endif
// 					EndIf
// 				EndIf
// 			Next
// 			oEndPoints['data'][nPos]['ID']  :=  F6G->(RECNO())
// 			(cAliasTMP)->(DbSkip())
// 		Enddo
//         //    oRet["hasNext"]   :=  oRet["records"] < nPageSize
//         oRet["endpoints"] := oEndPoints
// 	Endif

//     FWRestArea(aArea)

// Return oRet

// /*/{Protheus.doc} AdapterFormatDOC()
//     Returns Swagger json with adapter layout expected to be received or send 
//     @type function
//     @author idashkov
//     @since 12.02.2024
//     @param cAdapterCode, Character, Code of the adapter
//     @param cAdapterType, Character, Type of the adapter ('MVC', 'MILE' or 'CUSTOM')
//     @param cFormat, Character, Format of the adapter message ('JSON' or 'XML')
//     @return Json, Swagger json with adapter layout
// */
// Static Function AdapterFormatDOC(cAdapterCode as Character, cAdapterType as Character, cFormat as Character) as Json

//     Local oDoc := jsonObject():New() as Json
//     Local oMvcModel as Object
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     cFormat := AllTrim(cFormat)

//     oDoc := np.framework.eairest.GetGeneralSwagger()
//     oDoc:DelName("servers")
//     oDoc["components"]:DelName("responses")
//     oDoc["info"]["title"] := F6F->F6F_CODE
//     oDoc["info"]["description"] := I18N(STR0110,{F6F->F6F_CODE,np.framework.eai.getCboxTranslate(cAdapterType,"F6F_TYPE"),np.framework.eai.getCboxTranslate(cFormat,"F6F_FORMAT")}) // Schema for '#1' adapter data, type: '#2', format: '#3'
//     oDoc["components"]["schemas"] := jsonObject():New() 

//     Do Case
//         Case cAdapterType == MVC_TYPE // MVC
//             If !Empty(F6F->F6F_ADMVC)
//                 oMvcModel := FWLoadModel(F6F->F6F_ADMVC)
//                 If cFormat == "XML"
//                     oDoc["components"]["schemas"]["Data"] := MvcSwaggerXmlSchema(oMvcModel)
//                 ElseIf cFormat == "JSON"
//                     oDoc["components"]["schemas"]["Data"] := MvcSwaggerJsonSchema()
//                     oDoc["components"]["schemas"]["FieldComponent"] := MvcJsonSwaggerFieldComponentSchema()["FieldComponent"]
//                     oDoc["components"]["schemas"]["GridComponent"] := MvcJsonSwaggerGridComponentSchema()["GridComponent"]
//                 EndIf
//             EndIf
//         Case cAdapterType == MILE_TYPE // MILE
//             If cFormat == "XML"
//                 oDoc["components"]["schemas"]["Data"] := MileSwaggerXmlSchema(F6F->F6F_ADMILE)
//             ElseIf cFormat == "JSON"
//                 oDoc["components"]["schemas"]["Data"] := MileSwaggerJsonSchema(F6F->F6F_ADMILE)
//             EndIf
//         //Case cAdapterType == CUSTOM_TYPE // CUSTOM
//             //Nil // Layout for custom is undefined
//     EndCase

// Return oDoc

// /*/{Protheus.doc} GetEaiReceiveSchema()
//     Returns part of Swagger file - schema of input data for 
//     receive adapter in certain type and format 
//     @type function
//     @param cAdapterCode, Character, Adapter's code
//     @param cAdapterType, Character, Required adapter's type (MVC/MILE)
//     @param cFormat, Character, Required adapter's format (XML/JSON)
//     @author idashkov
//     @since 12.03.2024
//     @return Json, Part of Swagger file in json format
// */
// Static Function GetEaiReceiveSchema(cAdapterCode as Character, cAdapterType as Character, cFormat as Character) as Json

//     Local oDoc := jsonObject():New() as Json
//     Local oMvcModel as Object

//     cFormat := AllTrim(cFormat)

//     Do Case
//         Case cAdapterType == MVC_TYPE // MVC
//             If !Empty(F6F->F6F_ADMVC)
//                 oMvcModel := FWLoadModel(F6F->F6F_ADMVC)
//                 If cFormat == "XML"
//                     oDoc := MvcSwaggerXmlSchema(oMvcModel)["data"]
//                 ElseIf cFormat == "JSON"
//                     oDoc := MvcSwaggerJsonSchema()
//                 EndIf
//             EndIf
//         Case cAdapterType == MILE_TYPE
//             If cFormat == "XML"
//                 oDoc := MileSwaggerXmlSchema(F6F->F6F_ADMILE)["data"]
//             ElseIf cFormat == "JSON"
//                 oDoc := MileSwaggerJsonSchema(F6F->F6F_ADMILE)
//             EndIf
//         //Case cAdapterType == CUSTOM_TYPE
//             //Nil // Layout for custom is undefined
//     EndCase

// Return oDoc

// /*/{Protheus.doc} GetGeneralSwagger()
//     Returns "general" Swagger json to be specified further
//     @type function
//     @author idashkov
//     @since 14.02.2024
//     @return Json, General Swagger json
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function GetGeneralSwagger() as Json

//     Local oSwaggerJson := jsonObject():New() as Json
//     Local cJson as Character

//     BeginContent var cJson as Character
//     {
//         "openapi": "3.0.3", 
//         "info": {
//             "title": "",
//             "description": "",
//             "version": "1.0.0"
//         },
//         "paths": {

//         },
//         "servers": [
//             {
//                 "url": "#1://#2#3",
//                 "description": "REST server"
//             }
//         ],
//         "components": {
//             "schemas": {
                
//             },
//             "responses": {
                
//             }
//         }
//     }
//     EndContent

//     oSwaggerJson:FromJson(cJson)

//     oSwaggerJson["servers"][1]["url"] := i18n(oSwaggerJson["servers"][1]["url"],{oRest:getProtocolRequest(),oRest:getHeaderRequest()["Host"],oRest:getPathRequest()})

// Return oSwaggerJson

// /*/{Protheus.doc} MvcSwaggerJsonSchema()
//     Returns json with MVC adapter schema in json message case
//     @type function
//     @author idashkov
//     @since 14.02.2024
//     @return Json, Swagger json with schema for MVC model object
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function MvcSwaggerJsonSchema() as Json

//     Local oSwaggerLayout := jsonObject():New() as Json
//     Local cJson as Character
//     // TO DO: Add correct "required" values depending on operation type: pk is only for update or delete, etc

//     BeginContent var cJson as Character
//     {
//         "type": "object",
//         "required": [
//             "header",
//             "content"
//         ],
//         "properties": {
//             "header": {
//                 "type": "object",
//                 "required": [
//                     "adapter",
//                     "operation"
//                 ],
//                 "properties": {
//                     "adapter": {
//                         "type": "string"
//                     },
//                     "operation": {
//                         "type": "string"
//                     }
//                 }
//             },
//             "content": {
//                 "type": "object",
//                 "properties": {
//                     "id": {
//                         "type": "string"
//                     },
//                     "operation": {
//                         "type": "string"
//                     },
//                     "pk": {
//                         "type": "string"
//                     },
//                     "models": {
//                         "type": "array",
//                         "items": {
//                             "type": "object",
//                             "oneOf": [
//                                 {"$ref": "#/components/schemas/FieldComponent"},
//                                 {"$ref": "#/components/schemas/GridComponent"}
//                             ]
//                         }
//                     }
//                 }
//             }
//         }
//     }
//     EndContent

//     oSwaggerLayout:FromJson(cJson)

// Return oSwaggerLayout

// /*/{Protheus.doc} MvcJsonSwaggerFieldComponentSchema()
//     Returns "general" part of Swagger json file for 
//     schema of Field submodel MVC component
//     @type function
//     @author idashkov
//     @return Json, Swagger json with schema for part of 
//         MVC model object - field component
// */
// Static Function MvcJsonSwaggerFieldComponentSchema()

//     Local cJson
//     Local oJson := jsonObject():New() as Json

//     BeginContent var cJson as Character
//     {
//         "FieldComponent": {
//             "type": "object",
//             "required": [
//                 "id",
//                 "modeltype"
//             ],
//             "properties": {
//                 "id": {
//                     "type": "string"
//                 },
//                 "modeltype": {
//                     "type": "string"
//                 },
//                 "fields": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "properties": {
//                             "id": {
//                                 "type": "string"
//                             },
//                             "order": {
//                                 "type": "integer"
//                             },
//                             "len": {
//                                 "type": "string"
//                             },
//                             "datatype": {
//                                 "type": "string"
//                             },
//                             "info": {
//                                 "type": "string"
//                             },
//                             "obrigat": {
//                                 "type": "integer"
//                             },
//                             "value": {
//                                 "type": "string"
//                             }
//                         }
//                     }
//                 },
//                 "models": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "oneOf": [
//                             {"$ref": "#/components/schemas/FieldComponent"},
//                             {"$ref": "#/components/schemas/GridComponent"}
//                         ]
//                     }
//                 }
//             }
//         }
//     }
//     EndContent

//     oJson:FromJson(cJson)

// Return oJson

// /*/{Protheus.doc} MvcJsonSwaggerGridComponentSchema()
//     Returns "general" part of Swagger json file for 
//     schema of Grid submodel MVC component
//     @type function
//     @author idashkov
//     @return Json, Swagger json with schema for part of 
//         MVC model object -grid component
// */
// Static Function MvcJsonSwaggerGridComponentSchema()

//     Local cJson
//     Local oJson := jsonObject():New() as Json

//     BeginContent var cJson as Character
//     {
//         "GridComponent": {
//             "type": "object",
//             "required": [
//                 "id",
//                 "modeltype",
//                 "struct",
//                 "items"
//             ],
//             "properties": {
//                 "id": {
//                     "type": "string"
//                 },
//                 "modeltype": {
//                     "type": "string"
//                 },
//                 "struct": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "properties": {
//                             "id": {
//                                 "type": "string"
//                             },
//                             "order": {
//                                 "type": "integer"
//                             }
//                         }
//                     }
//                 },
//                 "items": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "properties": {
//                             "id": {
//                                 "type": "string"
//                             },
//                             "deleted": {
//                                 "type": "string"
//                             },
//                             "fields": {
//                                 "type": "array",
//                                 "items": {
//                                     "type": "object",
//                                     "required": [
//                                         "id",
//                                         "value"
//                                     ],
//                                     "properties": {
//                                         "id": {
//                                             "type": "string"
//                                         },
//                                         "value": {
//                                             "type": "string"
//                                         }
//                                     }
//                                 }
//                             }
//                         }
//                     }
//                 }
//             }
//         }
//     }
//     EndContent

//     oJson:FromJson(cJson)

// Return oJson

// /*/{Protheus.doc} MvcSwaggerXmlSchema()
//     Returns json with MVC adapter schema in xml message case
//     @type function
//     @author idashkov
//     @since 14.02.2024
//     @param oModel, Object, Model which data is used in the adapter
//     @return, oSwaggerJson, Json, Swagger json with schema
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function MvcSwaggerXmlSchema(oModel as Object) as Json

//     Local nI := 0 as Numeric
//     Local oSwaggerLayout := jsonObject():New() as Json
//     Local oSubModelLayouts := jsonObject():New() as Json
//     Local cJson as Character
//     Local cSubModel := ""
//     // TO DO: Add correct "required" values depending on operation type
//     BeginContent var cJson as Character
//     {
//         "data": {
//             "type": "object",
//             "required": [
//                 "header",
//                 "content"
//             ],
//             "properties": {
//                 "header": {
//                     "type": "object",
//                     "required": [
//                         "adapter",
//                         "operation"
//                     ],
//                     "properties": {
//                         "adapter": {
//                             "type": "string"
//                         },
//                         "operation": {
//                             "type": "string"
//                         }
//                     }
//                 },
//                 "content": {
//                     "type": "object",
//                     "properties": {
//                         "#1": {
//                             "type": "object", 
//                             "properties": {
//                                 "Operation": {
//                                     "type": "string",
//                                     "xml": {
//                                         "attribute": true
//                                     } 
//                                 },
//                                 "pk": {
//                                     "type": "string",
//                                     "xml": {
//                                         "attribute": true
//                                     } 
//                                 },
//                                 "version": {
//                                     "type": "string",
//                                     "xml": {
//                                         "attribute": true
//                                     } 
//                                 }
//                             }
//                         }
//                     }
//                 }
//             },
//             "xml": {
//                 "name": "data"
//             }
//         }
//     }
//     EndContent
//     cJson := I18N(cJson,{oModel:GetId()})

//     oSwaggerLayout:FromJson(cJson)
//     oSubModelLayouts := ModelXmlLayout(oModel)
//     For nI := 1 To Len(oModel:GetModelStruct())
//         cSubModel := oModel:GetModelStruct()[nI][2]
//         oSwaggerLayout["data"]["properties"]["content"]["properties"][oModel:GetId()]["properties"][cSubModel] := oSubModelLayouts[cSubModel]
//     Next nI

// Return oSwaggerLayout

// /*/{Protheus.doc} ModelXmlLayout()
//     Returns part of swagger file describing data model
//     @type  Static Function
//     @author idashkov
//     @since 15.02.2024
//     @version 1.0.0
//     @param oModel, Object, Model to be described in swagger
//     @param lIsSubModel, Logical, Control flag - is the model passed a component of other model
//     @param cSubModelType, Character, Type of passed model - GRID or FIELD
//     @return Json, Swagger sctructure with instructions for xml message of passed model
//     @link https://jiraproducao.totvs.com.br/browse/RULOC-5835
//     @see https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.3.md
// /*/
// Static Function ModelXmlLayout(oModel as Object, lIsSubModel as Logical, cSubModelType as Character) as Json
//     //TO DO: Fix limitation - cannot process model with more than 2 layesrs of components (Ru69To1->F5QMASTER->F5RDETAILS is max line)
//     //TO DO: Properties now for sending and receiveing are the same. Test and find out what properties are required in recieving.
//     Local nI := 0 as Numeric
//     Local nJ := 0 as Numeric
//     Local nK := 0 as Numeric
//     Local oModelLayouts:= jsonObject():New() as Json
//     Local cFieldSubModelJson := "" as Character
//     Local cGridSubModelJson := "" as Character
//     Local oSubModelJson := jsonObject():New() as Json
//     Local cFieldFieldJson := "" as Character
//     Local cGridFieldJson := "" as Character
//     Local oFieldJson := jsonObject():New() as Json // 
//     Local aModelStruct := {} // TO DO: Fix bug here, falls because of Nil
//     Local oSubModel as Object
//     Local aSubModelFields := {} as Array
//     Default lIsSubModel := .F.
//     Default cSubModelType := ""

//     BeginContent var cFieldSubModelJson as Character 
//     {
//         "type": "object",
//         "required": [
//             "modeltype"
//         ], 
//         "properties": {
//             "modeltype": {
//                 "type": "string",
//                 "enum": ["FIELD"],
//                 "xml": {
//                     "attribute": true
//                 } 
//             }   
//         }
//     }
//     EndContent

//     BeginContent var cGridSubModelJson as Character 
//     {
//         "type": "object",
//         "required": [
//             "modeltype",
//             "struct",
//             "items"
//         ], 
//         "properties": {
//             "modeltype": {
//                 "type": "string",
//                 "enum": ["GRID"],
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "struct": {
//                 "type": "object",
//                 "properties": {

//                 }
//             },
//             "items": {
//                 "type": "array",
//                 "items": {
//                     "type": "object",
//                     "required": [
//                         "id",
//                         "deleted"
//                     ],
//                     "properties": {
//                         "id": {
//                             "type": "string",
//                             "xml": {
//                                 "attribute": true
//                             } 
//                         },
//                         "deleted": {
//                             "type": "string",
//                             "xml": {
//                                 "attribute": true
//                             } 
//                         }
//                     }
//                 }
//             }
//         }
//     }
//     EndContent
    
//     BeginContent var cFieldFieldJson as Character
//     { 
//         "type": "object",
//         "required": [
//             "order",
//             "len",
//             "datatype",
//             "info",
//             "obrigat",
//             "value"
//         ],
//         "properties": {
//             "order": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "len": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "datatype": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "info": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "obrigat": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "value": {
//                 "type": "string"
//             }                                                                                
//         }
//     } 
//     EndContent

//     BeginContent var cGridFieldJson as Character
//     { 
//         "type": "object",
//         "required": [
//             "order",
//             "len",
//             "datatype",
//             "info",
//             "obrigat"
//         ],
//         "properties": {
//             "order": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "len": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "datatype": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "info": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 } 
//             },
//             "obrigat": {
//                 "type": "string",
//                 "xml": {
//                     "attribute": true
//                 }
//             }                                                                              
//         }
//     } 
//     EndContent

//     If lIsSubModel
//         aSubModelFields := oModel:OFORMMODELSTRUCT:aFields
//         If cSubModelType == "FIELD"
//             oSubModelJson:FromJson(cFieldSubModelJson)
//             For nJ := 1 To Len(aSubModelFields)
//                 oFieldJson:FromJson(cFieldFieldJson)
//                 oSubModelJson["properties"][aSubModelFields[nJ][3]] := oFieldJson
//             Next nJ
//         ElseIf cSubModelType == "GRID"
//             oSubModelJson:FromJson(cGridSubModelJson)
//             For nJ := 1 To Len(aSubModelFields)
//                 oFieldJson:FromJson(cGridFieldJson)
//                 oSubModelJson["properties"]["struct"]["properties"][aSubModelFields[nJ][3]] := oFieldJson
//                 oSubModelJson["properties"]["items"]["items"]["properties"][aSubModelFields[nJ][3]] := jsonObject():New()
//             Next nJ
//         EndIf
//         oModelLayouts := oSubModelJson
//     Else
//         aModelStruct := oModel:GetModelStruct()
//         For nI := 1 To Len(aModelStruct) // For every submodel in main model
//             oSubModel := aModelStruct[nI][3]
//             oSubModelJson := ModelXmlLayout(oSubModel,.T.,aModelStruct[nI][1])
//             For nK := 1 To Len(aModelStruct[nI][4]) // For every submodel in the submodel
//                 oSubModelJson["properties"][aModelStruct[nI][4][nK][2]] := ModelXmlLayout(oModel:GetModel(aModelStruct[nI][4][nK][2]),.T.,aModelStruct[nI][4][nK][1])
//             Next nK
//             oModelLayouts[aModelStruct[nI][2]] := oSubModelJson
//         Next nI
//     EndIf

// Return oModelLayouts

// /*/{Protheus.doc} MileSwaggerJsonSchema()
//     Returns swagger schema for MILE EAI adapter in case of json message
//     @type function
//     @author idashkov
//     @since 14.02.2024
//     @param cAdMile, Character, 
//     @return Json, Swagger layout for MILE adapter json message
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function MileSwaggerJsonSchema(cAdMile as Character) as Json

//     Local oSwaggerLayout := jsonObject():New() as Json
//     Local cJson as Character
//     Local cMileLayoutFields := "" as Character
//     Local nI := 1 as Numeric
//     Local aFieldsInfo := {} as Array
//     // TO DO: Add correct "required" values depending on operation type

//     BeginContent var cJson as Character
//     {
//         "type": "object",
//         "required": [
//             "header",
//             "content"
//         ],
//         "properties": {
//             "header": {
//                 "type": "object",
//                 "required": [
//                     "adapter",
//                     "operation"
//                 ],
//                 "properties": {
//                     "adapter": {
//                         "type": "string"
//                     },
//                     "operation": {
//                         "type": "string"
//                     }
//                 }
//             },
//             "content": {
//                 "type": "string",
//                 "description": "#1"
//             }
//         }
//     }
//     EndContent
//     aFieldsInfo := np.framework.eairest.GetMileLayoutFieldsInfo(cAdMile)
//     For nI := 1 To Len(aFieldsInfo[1])
//         cMileLayoutFields += aFieldsInfo[2][nI] + ';'
//     Next nI
//     cMileLayoutFields := SubStr(cMileLayoutFields,1,Len(cMileLayoutFields) - 1) + '\n'
//     cJson := I18N(cJson,{cMileLayoutFields})
    
//     oSwaggerLayout:FromJson(cJson)

// Return oSwaggerLayout

// /*/{Protheus.doc} MileSwaggerXMLSchema()
//     Returns swagger schema for MILE EAI adapter in case of xml message
//     @type function
//     @author idashkov
//     @since 14.02.2024
//     @param cAdMile, Character, 
//     @return Json, Swagger layout for MILE adapter xml message
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function MileSwaggerXMLSchema(cAdMile as Character) as Json
// // TO DO: Try to add examples to every schema (maybe we do not need separate "examples" in the Swagger)
//     Local oSwaggerLayout := jsonObject():New() as Json
//     Local cJson := "" as Character
//     Local cMileLayoutFields := "" as Character
//     Local nI := 1 as Numeric
//     Local aFieldsInfo := {} as Array
//     // TO DO: Add correct "required" values depending on operation type

//     BeginContent var cJson as Character
//     {
//         "data": {
//             "type": "object",
//             "required": [
//                 "header",
//                 "content"
//             ],
//             "properties": {
//                 "header": {
//                     "type": "object",
//                     "required": [
//                         "adapter",
//                         "operation"
//                     ],
//                     "properties": {
//                         "adapter": {
//                             "type": "string"
//                         },
//                         "operation": {
//                             "type": "string"
//                         }
//                     }
//                 },
//                 "content": {
//                     "type": "object",
//                     "required": [
//                         "value"
//                     ],
//                     "properties": {
//                         "value": {
//                             "type": "string",
//                             "description": "#1",
//                             "xml": {
//                                 "attribute": true
//                             }
//                         }
//                     }
//                 }
//             },
//                 "xml": {
//                 "name": "data"
//             }
//         }
//     }
//     EndContent
//     aFieldsInfo := np.framework.eairest.GetMileLayoutFieldsInfo(cAdMile)
//     For nI := 1 To Len(aFieldsInfo[1])
//         cMileLayoutFields += aFieldsInfo[2][nI] + ';'
//     Next nI
//     cMileLayoutFields := SubStr(cMileLayoutFields,1,Len(cMileLayoutFields) - 1) + '\n'
//     cJson := I18N(cJson,{cMileLayoutFields})

//     oSwaggerLayout:FromJson(cJson)

// Return oSwaggerLayout

// /*/{Protheus.doc} FormatQuery
//     Returns paged data from MA3 QUEUE, MA3 LOG or Adapters
//     @type function
//     @version 1
//     @author bsobieski
//     @since 15/12/2023
//     @param cTable, character, F6Y (Queue) or F5L (Log)
//     @param cSkip, character, Pages to skip 
//     @param cPageSize, character, Page Size
//     @param lReqTotalCount, logical, Defines if total count is required
//     @param cFilterVars, character, Filter variables content separated by ","
//     @param cFilterExp, character, SQL filter expression prepared for Parameters binding (?) to be replacesd by cFilterVars
//     @param lDebug, logical, To print debug messages on console
//     @param cOrder, character, SQL Order expression
//     @return Array, Array with totalquery and data query
// /*/
// Static Function FormatQuery(cTable as Character,;
// 		cSkip as Character,;
// 		cPageSize as Character,;
// 		lReqTotalCount as Logical,;
// 		cFilterVars as Character,;
// 		cFilterExp as Character,;
// 		lDebug as Logical,;
// 		cOrder as Character) as Array
        
// 	Local cQuery        :=  "" as Character
// 	Local aRet          := {"",""} as Array
// 	Local oStatement    as Object
// 	Local aFilterVars   := {} as Array
//     Default cSkip := "0"
//     Default cPageSize := "20"
//     Default lReqTotalCount := .T.
//     Default cFilterVars := ""

//     np.framework.eai.TrySetEnv()

//     //Prevent SQL Injection
// 	cOrder := StrTran(Alltrim(cOrder), "'", "")
// 	cOrder := StrTran(cOrder, ";", "")
// 	If !Empty(cFilterVars)
// 		cFilterVars := StrTran(cFilterVars, "'", "")
// 		cFilterVars := StrTran(cFilterVars, ";", "")
// 		aFilterVars := StrTokArr((cFilterVars), ",")
// 	Endif
//     //Check consistency between ? and variables
// 	If (!Empty(cFilterExp) .Or. !Empty(cFilterVars)) .And. charCount(cFilterExp, "?") <> charCount(cFilterVars, ",") + 1
// 		cResponse := '{"error": "Invalid Filter"}' // TO DO: Find out where cResponse variable is used
// 	Endif
// 	cQuery  := " FROM "+RetSqlName(cTable) +"  "+cTable
// 	cQuery  += " WHERE  "+cTable+"_FILIAL = '"+xFilial(cTable)+"'  "
// 	cQuery  += " AND D_E_L_E_T_= ''  "
// 	If !Empty(cFilterExp)
// 		cQuery  += "AND ("+ cFilterExp +")  "
// 	Endif
// 	If lReqTotalCount
// 		oStatement    := FWPreparedStatement():New()
// 		oStatement:SetQuery("SELECT COUNT(*) TOTALCOUNT "+cQuery)
// 		If Len(aFilterVars) > 0
// 			oStatement:SetParams(aFilterVars)
// 		Endif
// 		aRet[1] := oStatement:getFixQuery()
// 		oStatement:Destroy()
// 		FwFreeObj(oStatement)
// 	Endif

// 	oStatement    := FWPreparedStatement():New()
// 	If !Empty(cOrder)
// 		cQuery += "ORDER BY " + cOrder
// 	Endif

// 	If TCGETDB() == 'ORACLE'
//         If !(Empty(cSkip)) .And. !(Empty(cPageSize))
//             cQuery += ' ROWNUM BETWEEN ' + cSkip + " AND " + cValToChar(Val(cSkip) + Val(cPageSize))
// 		EndIf
//         //ROWNUM <= 10
// 	ElseIf 'MSSQL' $ TCGETDB()
//         If !(Empty(cSkip))
//             cQuery += ' OFFSET ' + cSkip + " ROWS "
//         EndIf
// 		If !(Empty(cPageSize))
//             cQuery += "FETCH FIRST " + cPageSize + " ROWS ONLY "
//         EndIf
//         //OFFSET 10 ROWS FETCH FIRST 20 ROWS ONLY
// 	Else //POtsgreSql and others
// 		If !(Empty(cPageSize))
//             cQuery += " LIMIT " + cPageSize
//         EndIf
//         If !(Empty(cSkip))
//             cQuery += " OFFSET " + cSkip
//         EndIf
// 		//LIMIT 3 OFFSET 2
// 	EndIf

// 	oStatement:SetQuery("SELECT R_E_C_N_O_ RECNO "+cQuery)

// 	If Len(aFilterVars) > 0
// 		oStatement:SetParams(aFilterVars)
// 	Endif

// 	cQuery := oStatement:getFixQuery()
// 	cQuery := ChangeQuery(cQuery)

// 	aRet[2] := cQuery
// 	oStatement:Destroy()
// 	FwFreeObj(oStatement)

// Return aRet

// /*/{Protheus.doc} RU99W20021_MessageDOC
//     Formatted text for standard REST-service documentation. Be advised it does not folow OpenAPI specification.
//     @type function
//     @author bsobieski
//     @since 15/12/2023
//     @return Character, Documentation format in JSON SWAGGER format
//     @see https://github.com/totvs/tlpp-sample-rest-documentation
// /*/
// Function RU99W20021_MessageDOC() as Character // Not Static Function because is Swagger description for REST-service

// 	Local cJson as Character
//     BeginContent var cJson as Character
//     {
//         "title" : "Standard summary",
//         "description" : "Standard description",
//         "params":[
//             {
//                 "name":"param1",
//                 "description":"desc_param_1",
//                 "in":"query",
//                 "type":"character",
//                 "required":true
//             }
//         ],
//         "requestBody" : {
//             "description" : "Data to be synchronized with Ma3",
//             "Content-Type" : [
//                 {
//                     "json": {
//                         "type" : "component",
//                         "component": ""
//                     }
//                 },
//                 {
//                     "xml": {
//                         "type" : "component",
//                         "component": ""
//                     }   
//                 }
//             ]
//         },
//         "responses" : [
//             {
//                 "statusCode" : 200,
//                 "description" : "200 Description",
//                 "Content-Type" : [
//                     {
//                         "json": {

//                         }
//                     }
//                 ]
//             },
//             {
//                 "statusCode" : 400,
//                 "description" : "400 Description",
//                 "Content-Type" : [
//                     {
//                         "json": {
                            
//                         }
//                     }
//                 ]
//             }
//         ]
//     }
//     EndContent 

// Return cJson

// /*/{Protheus.doc} RU99W20022_AdapterInfoDOC()
//     Formatted documentation for adapter info REST-service
//     @type function
//     @author idashkov 
//     @since 13.03.24
//     @return Character, Operation object, part of Swagger documentation for HTTP method in JSON format
// /*/
// Function RU99W20022_AdapterInfoDOC() as Character // Not Static Function because is Swagger description for REST-service

//     Local oOperation := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oOperation:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oOperation["title"] := EncodeUTF8(STR0111,MODEL_ENCODING) // Adapter's info
//     oOperation["description"] := EncodeUTF8(STR0112,MODEL_ENCODING) // Returns adapter's information by passed adapter code
//     oOperation["params"][1]["name"] := "code"
//     oOperation["params"][1]["description"] := EncodeUTF8(STR0113,MODEL_ENCODING) // Adapter code
//     oOperation["params"][1]["in"] := "path"
//     oOperation["params"][1]["type"] := "character"
//     oOperation["params"][1]["required"] := .T.

// Return oOperation:ToJson()

// /*/{Protheus.doc} RU99W20023_PutEaiReceiveDOC()
//     Formatted documentation for EaiReceive REST-service, PUT operation
//     @type function
//     @author idashkov 
//     @since 13.03.24
//     @return Character, part of specifically formatted swagger document
// /*/
// Function RU99W20023_PutEaiReceiveDOC()

//     Local oOperationInfo := jsonObject():New() as Json
    
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug

//     oOperationInfo:FromJson(np.framework.eairest.RU99W20021_MessageDOC())

//     oOperationInfo["title"] := EncodeUTF8(STR0114,MODEL_ENCODING) // Update via EAI queue
//     oOperationInfo["description"] := EncodeUTF8(STR0115,MODEL_ENCODING) // Records message into EAI queue to be processed for update operation.
//     oOperationInfo["params"][1]["name"] := "adapterCode"
//     oOperationInfo["params"][1]["description"] := EncodeUTF8(STR0113,MODEL_ENCODING) // Adapter code
//     oOperationInfo["params"][1]["in"] := "path"
//     oOperationInfo["params"][1]["type"] := "character"
//     oOperationInfo["params"][1]["required"] := .F.
//     // Generate two examples regardless of defined Adapter formats:
//     oOperationInfo["requestBody"]["description"] := EncodeUTF8(STR0116,MODEL_ENCODING) // Awaited input data for adapter
//     oOperationInfo["requestBody"]["Content-Type"][1]["json"]["component"] := "JSON_ADAPTER_DATA"
//     oOperationInfo["requestBody"]["Content-Type"][2]["xml"]["component"] := "data"

// Return oOperationInfo:ToJson() 

// /*/{Protheus.doc} RU99W20024_PostEaiReceiveDOC()
    
//     @type function
//     @author idashkov 
//     @since 13.03.24
// /*/
// Function RU99W20024_PostEaiReceiveDOC()

//     Local oOperationInfo := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oOperationInfo:FromJson(np.framework.eairest.RU99W20023_PutEaiReceiveDOC())

//     oOperationInfo["title"] := EncodeUTF8(STR0117,MODEL_ENCODING) // Insert via EAI queue
//     oOperationInfo["description"] := EncodeUTF8(STR0118,MODEL_ENCODING) // Records message into EAI queue to be processed for insert operation.

// Return oOperationInfo:ToJson()

// /*/{Protheus.doc} RU99W20025_DeleteEaiReceiveDOC()
    
//     @type function
//     @author idashkov 
//     @since 13.03.24
// /*/
// Function RU99W20025_DeleteEaiReceiveDOC()
    
//     Local oOperationInfo := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oOperationInfo:FromJson(np.framework.eairest.RU99W20023_PutEaiReceiveDOC())

//     oOperationInfo["title"] := EncodeUTF8(STR0119,MODEL_ENCODING) // Delete via EAI queue
//     oOperationInfo["description"] := EncodeUTF8(STR0120,MODEL_ENCODING) // Records message into EAI queue to be processed for delete operation.

// Return oOperationInfo:ToJson()

// /*/{Protheus.doc} RU99W20026_EaiReceiveInfoDOC()
//     Rest service to recieve documentation for specified adapter of EAI Receive service
//     This function creates Swagger for EAI Dashboard tab "Adapters Swagger"
//     @type function
//     @author idashkov 
//     @since 13.03.24
//     @return Character, Documentation format in JSON SWAGGER format
// /*/
// @Get(endpoint="/api/ma3eai/v1/EaiReceiveInfoDOC",description="[np.framework.eairest.RU99W20037_EaiReceiveInfoDOCDOC]")
// Function RU99W20026_EaiReceiveInfoDOC()

//     Local cPath as Character
//     Local cDoc as Character
//     Local cSchemas as Character
//     Local cResponses as Character
//     Local jJson := np.framework.eairest.GetGeneralSwagger() 
//     Local oPathInfo := jsonObject():New() as Json
//     Local jSchemasInfo := jsonObject():New() as Json
//     Local jResponsesInfo := jsonObject():New() as Json
//     Local aArea := FwGetArea()
//     Local cAdaptersList := ""
//     Local cFilter := ""
    
//     np.framework.eai.TrySetEnv() // TO DO: Delete after tests
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     // Prepare data for swagger:
//     jJson["security"] := {jsonObject():New()}
//     jJson["security"][1]["bearerAuth"] := {}
//     BeginContent var cPath as Character
//     {
//         "put":{
//             "description": "#1",
//             "requestBody": {
//                 "description": "#2",
//                 "required": true,
//                 "content": {
                    
//                 }
//             },
//             "responses": {
//                 "200": {
//                     "$ref": "#/components/responses/Success"
//                 },
//                 "400": {
//                     "$ref": "#/components/responses/400"
//                 },
//                 "default": {
//                     "$ref": "#/components/responses/GeneralError"
//                 }
//             }
//         },
//         "post":{
//             "description": "#3",
//             "requestBody": {
//                 "description": "#4",
//                 "required": true,
//                 "content": {
                    
//                 }
//             },
//             "responses": {
//                 "200": {
//                     "$ref": "#/components/responses/Success"
//                 },
//                 "400": {
//                     "$ref": "#/components/responses/400"
//                 },
//                 "default": {
//                     "$ref": "#/components/responses/GeneralError"
//                 }
//             }
//         },
//         "delete":{
//             "description": "#5",
//             "responses": {
//                 "200": {
//                     "$ref": "#/components/responses/Success"
//                 },
//                 "400": {
//                     "$ref": "#/components/responses/400"
//                 },
//                 "default": {
//                     "$ref": "#/components/responses/GeneralError"
//                 }
//             }
//         }
//     }
//     EndContent
    
//     cPath := I18N(cPath,{;
//         STR0129,; // Accepts message to the EAI Queue to update record in the Ma-3 database
//         STR0130,; // Data to be synchronized with Ma-3
//         STR0131,; // Accepts message to the EAI Queue to insert record in the Ma-3 database
//         STR0132,; // Data to be synchronized with Ma-3
//         STR0133; // Accepts message to the EAI Queue to delete record in the Ma-3 database
//     })

//     dbSelectArea("F6F")
//     DbSetOrder(1)
//     F6F->(DbGoTop())
//     While F6F->(!Eof()) 
//         If F6F->F6F_OPER == REC_OPER
//             cAdaptersList += "[" + AllTrim(F6F->F6F_CODE) + "](#1://#2#3/api/ma3eai/v1/adapterinfo/" + AllTrim(F6F->F6F_CODE) + ")<br>" // TO DO: Fix hardcode of rest-service adress (localhost) and port (8089)
//             // Generate all examples and schemas regardless of defined Adapter formats:
//             oPathInfo:FromJson(cPath)
//             If F6F->F6F_UPDATE == .T. .And. !Empty(F6F->F6F_FORMAT)
//                 cFilter := "F6F_FILIAL == '"+xFilial("F6F")+"'" + " .AND. F6F_OPER == '"+REC_OPER+"'" + " .AND. F6F_CODE == '"+F6F->F6F_CODE+"'" + " .AND. F6F_UPDATE == .T. " + ".AND. F6F_FORMAT == '"+F6F->F6F_FORMAT+"'"
//                 oPathInfo["put"]["requestBody"]["content"] := jsonObject():New()
//                 oPathInfo["put"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))] := jsonObject():New()
//                 oPathInfo["put"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))]["examples"] := GenerateAdapterExamples(cOperType="UPDATE",cFilter=cFilter)
//                 oPathInfo["put"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))]["schema"] := GetEaiReceiveSchema(F6F->F6F_CODE,F6F->F6F_TYPE,F6F->F6F_FORMAT) 
//             Else
//                 oPathInfo:DelName("put")
//             EndIf
//             If F6F->F6F_INSERT == .T. .And. !Empty(F6F->F6F_FORMAT)
//                 cFilter := "F6F_FILIAL == '"+xFilial("F6F")+"'" + " .AND. F6F_OPER == '"+REC_OPER+"'" + " .AND. F6F_CODE == '"+F6F->F6F_CODE+"'" + " .AND. F6F_INSERT == .T. " + ".AND. F6F_FORMAT == '"+F6F->F6F_FORMAT+"'"
//                 oPathInfo["post"]["requestBody"]["content"] := jsonObject():New()
//                 oPathInfo["post"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))] := jsonObject():New()
//                 oPathInfo["post"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))]["examples"] := GenerateAdapterExamples(cOperType="INSERT",cFilter=cFilter)
//                 oPathInfo["post"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))]["schema"] := GetEaiReceiveSchema(F6F->F6F_CODE,F6F->F6F_TYPE,F6F->F6F_FORMAT) 
//             Else
//                 oPathInfo:DelName("post")
//             EndIf
//             If F6F->F6F_DELETE == .T. .And. !Empty(F6F->F6F_FORMAT)
//                 //cFilter := "F6F_FILIAL == '"+xFilial("F6F")+"'" + " .AND. F6F_OPER == '"+REC_OPER+"'" + " .AND. F6F_CODE == '"+F6F->F6F_CODE+"'" + " .AND. F6F_DELETE == .T. " + ".AND. F6F_FORMAT == 'JSON'"
//                 //oPathInfo["delete"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))]["examples"] := GenerateAdapterExamples(cOperType="DELETE",cFilter=cFilter)
//                 //oPathInfo["delete"]["requestBody"]["content"]["application/"+Lower(AllTrim(F6F->F6F_FORMAT))]["schema"] := GetEaiReceiveSchema(F6F->F6F_CODE,F6F->F6F_TYPE,F6F->F6F_FORMAT) 
//             Else
//                 oPathInfo:DelName("delete")
//             EndIf
//             jJson["paths"]["/api/ma3eai/v1/eaireceive/"+AllTrim(F6F->F6F_CODE)] := jsonObject():New()
//             jJson["paths"]["/api/ma3eai/v1/eaireceive/"+AllTrim(F6F->F6F_CODE)]:FromJson(oPathInfo:ToJson())
//         EndIf
//         F6F->(DbSkip())
//     EndDo
    
//     FwRestArea(aArea)

//     jJson["info"]["title"] := STR0121 // EAI receive messages for Queue
//     cAdaptersList := i18n(cAdaptersList,{oRest:getProtocolRequest(),oRest:getHeaderRequest()["Host"],oRest:getPathRequest()}) // Dynamically insert protocol and REST-server adress
//     jJson["info"]["description"] := I18N(STR0122,{cAdaptersList})  // Service accepts new message for EAI to be recorded into Queue and processed eventually<br><br>List of adapters:<br>#1
//     // TO DO: Fix security in the generated Swagger to be fully operatable
//     BeginContent var cSecuritySchemes as Character // Defines security components to be referenced in swagger
//     {
//         "bearerAuth": {
//             "type": "oauth2",
//             "description": "#1",
//             "scheme": "bearer",
//             "bearerFormat": "JWT",
//             "flows": {
//                 "implicit": {
//                     "tokenUrl": "#2://#3#4/api/oauth2/v1/token"
//                 }
//             }
//         },
//         "basicAuth": {
//             "type": "http",
//             "description": "#5",
//             "scheme": "basic"
//         }
//     }
//     EndContent

//     cSecuritySchemes := i18n(cSecuritySchemes,{;
//         STR0134,; // Bearer token authentiction on Ma-3 REST services
//         oRest:getProtocolRequest(),;
//         oRest:getHeaderRequest()["Host"],;
//         oRest:getPathRequest(),;
//         STR0135; // Basic authentiction on Ma-3 REST services
//     })

//     BeginContent var cSchemas as Character // Defines repeating components to be referenced in swagger
//     {
//         "SuccessResponse": {
//             "type": "object",
//             "properties": {
//                 "success": {
//                     "type": "boolean",
//                     "enum": [
//                         true
//                     ]
//                 },
//                 "message": {
//                     "type": "string"
//                 },
//                 "data": {
//                     "type": "array",
//                     "items": {
//                         "$ref": "#/components/schemas/AdapterResponse"
//                     }
//                 }
//             }
//         },
//         "AdapterResponse": {
//             "type": "object",
//             "properties": {
//                 "header": {
//                     "type": "object",
//                     "properties": {

//                     }
//                 },
//                 "content": {
//                     "type": "object",
//                     "properties": {
                        
//                     }
//                 }
//             }
//         },
//         "GeneralError": {
//             "type": "object",
//             "properties": {
//                 "code": {
//                     "type": "integer",
//                     "format": "int32"
//                 },
//                 "message": {
//                     "type": "string"
//                 },
//                 "success": {
//                     "type": "boolean",
//                     "enum": [
//                         false
//                     ]
//                 },
//                 "error": {
//                     "type": "object",
//                     "properties": {
//                         "type": {
//                             "type": "string"
//                         },
//                         "message": {
//                             "type": "string"
//                         }
//                     }
//                 }
//             }
//         },
//         "500Error": {
//             "type": "object",
//             "required": [
//                 "code",
//                 "message"
//             ],
//             "properties": {
//                 "code": {
//                     "type": "integer",
//                     "format": "int32"
//                 },
//                 "message": {
//                     "type": "string"
//                 }
//             }
//         },
//         "FieldComponent": {
//             "type": "object",
//             "required": [
//                 "id",
//                 "modeltype"
//             ],
//             "properties": {
//                 "id": {
//                     "type": "string"
//                 },
//                 "modeltype": {
//                     "type": "string"
//                 },
//                 "fields": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "properties": {
//                             "id": {
//                                 "type": "string"
//                             },
//                             "order": {
//                                 "type": "integer"
//                             },
//                             "len": {
//                                 "type": "string"
//                             },
//                             "datatype": {
//                                 "type": "string"
//                             },
//                             "info": {
//                                 "type": "string"
//                             },
//                             "obrigat": {
//                                 "type": "integer"
//                             },
//                             "value": {
//                                 "type": "string"
//                             }
//                         }
//                     }
//                 },
//                 "models": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "oneOf": [
//                             {"$ref": "#/components/schemas/FieldComponent"},
//                             {"$ref": "#/components/schemas/GridComponent"}
//                         ]
//                     }
//                 }
//             }
//         },
//         "GridComponent": {
//             "type": "object",
//             "required": [
//                 "id",
//                 "modeltype",
//                 "struct",
//                 "items"
//             ],
//             "properties": {
//                 "id": {
//                     "type": "string"
//                 },
//                 "modeltype": {
//                     "type": "string"
//                 },
//                 "struct": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "properties": {
//                             "id": {
//                                 "type": "string"
//                             },
//                             "order": {
//                                 "type": "integer"
//                             }
//                         }
//                     }
//                 },
//                 "items": {
//                     "type": "array",
//                     "items": {
//                         "type": "object",
//                         "properties": {
//                             "id": {
//                                 "type": "string"
//                             },
//                             "deleted": {
//                                 "type": "string"
//                             },
//                             "fields": {
//                                 "type": "array",
//                                 "items": {
//                                     "type": "object",
//                                     "required": [
//                                         "id",
//                                         "value"
//                                     ],
//                                     "properties": {
//                                         "id": {
//                                             "type": "string"
//                                         },
//                                         "value": {
//                                             "type": "string"
//                                         }
//                                     }
//                                 }
//                             }
//                         }
//                     }
//                 }
//             }
//         }
//     }
//     EndContent

//     jSchemasInfo:FromJson(cSchemas)
//     jSchemasInfo["FieldComponent"] := MvcJsonSwaggerFieldComponentSchema()["FieldComponent"]
//     jSchemasInfo["GridComponent"] := MvcJsonSwaggerGridComponentSchema()["GridComponent"]
    
//     jJson["components"]["securitySchemes"] := jsonObject():New() 
//     jJson["components"]["securitySchemes"]:FromJson(cSecuritySchemes)
//     jJson["components"]["schemas"] := jSchemasInfo

//     BeginContent var cResponses as Character // Defines repeating responses to be referenced in swagger
//     {
//         "Success": {
//             "description": "",
//             "content": {
//                 "application/json": {
//                     "schema": {
//                         "$ref": "#/components/schemas/SuccessResponse"
//                     }
//                 }
//             }
//         },
//         "400": {
//             "description": "",
//             "content": {
//                 "application/json": {

//                 }
//             }
//         },
//         "500": {
//             "description": "",
//             "content": {
//                 "application/json": {
//                     "schema": {
//                         "$ref": "#/components/schemas/500Error"
//                     }   
//                 }
//             }
//         },
//         "GeneralError": {
//             "description": "",
//             "content": {
//                 "application/json": {
//                     "schema": {
//                         "$ref": "#/components/schemas/GeneralError"
//                     }
//                 }
//             }
//         }
//     }
//     EndContent

//     jResponsesInfo:FromJson(cResponses)
//     jResponsesInfo["Success"]["description"] := STR0123 // Message was recorded to EAI Queue sucessfully
//     jResponsesInfo["400"]["description"] := STR0124 // Parameter invalid
//     jResponsesInfo["500"]["description"] := STR0125 // General appserver error
//     jResponsesInfo["GeneralError"]["description"] := STR0126 // General error
//     jJson["components"]["responses"] := jResponsesInfo

//     cDoc := jJson:toJson()

//     If jJson <> Nil
// 		oRest:SetKeyHeaderResponse('Content-Type', 'application/json')
// 		oRest:setResponse(jJson)
// 	EndIf

// Return .T.

// /*/{Protheus.doc} RU99W20037_EaiReceiveInfoDOCDOC()
//     Returns Queue detail REST-service description
//     @type function
//     @version 1.0
//     @author idashkov
//     @since 05.04.2024
//     @return Character, Description for general Ma3 Swagger file
// /*/
// Function RU99W20037_EaiReceiveInfoDOCDOC()
    
//     Local oDoc := jsonObject():New() as Json
//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     oDoc:FromJson(np.framework.eairest.RU99W20021_MessageDOC())
//     oDoc["title"] := EncodeUTF8(STR0127,MODEL_ENCODING) // EAI Receive doc
//     oDoc["description"] := EncodeUTF8(STR0128,MODEL_ENCODING) // Returnes Swagger file with EAI Receive REST-service information
//     oDoc:DelName("params")
//     oDoc:DelName("requestBody")
//     oDoc:DelName("responses") // TO DO: Do not delete but fill awaited responses
    
// Return oDoc:ToJson()

// /*/{Protheus.doc} RU99W20027_GetStandardExample()
//     Returns text of example for part of standard Swagger file - eaireceive REST-service description
//     @type function
//     @author idashkov
//     @since 27.03.2024
//     @return Character, Example of adapter header or and content for standard Swagger info of EaiReceive REST-service
// /*/
// Function RU99W20027_GetStandardExample()

//     Local cExample := "" as Character

//     FwSetIdiom(FWRETIDIINI()) // Fix of incorrect idiom bug
//     cExample := EncodeUTF8(STR0022,MODEL_ENCODING) // Use api/ma3eai/v1/EaiReceiveInfoDOC service for info about input data

// Return cExample

// /*/{Protheus.doc} GenerateAdapterExamples(cAdapterOperType,cOperType,cFormat,cType,cFilter)
//     Returns part of Swagger document - list of generated examples 
//     for passed adapter with passed parameters 
//     @type function
//     @param cAdapterOperType, Character,
//     @param cOperType, Character,
//     @param cFormat, Character,
//     @param cType, Character,
//     @param cFilter, Character, Filter for adapters table to generate documentation for selected adapters only
//     @author idashkov
//     @since 04.03.2024
//     @return Json, List of generated examples for swagger documentation
// /*/
// Static Function GenerateAdapterExamples(cAdapterOperType,cOperType,cFormat,cType,cFilter)

//     Local oExamples := jsonObject():New() as Json
//     Local oJsonExample := jsonObject():New() as Json
//     Local oJsonHead := jsonObject():New() as Json
//     Local oJsonContent := jsonObject():New() as Json
//     Local oXmlExample := TXmlManager():New()
//     Local oXmlMvcContent := TXmlManager():New()
//     Local oMvcModel as Object
//     Local cXmlExample := ""
//     Local nI := 1 as Numeric
//     Local aArea := FwGetArea()
//     Local cError := ""
//     Local cFieldsExample := ""
//     Local nOper := 0 as Numeric
//     Local cCurrentType := ""
//     Local cCurrentFormat := ""
//     Default cAdapterOperType := REC_OPER
//     Default cOperType := ""
//     Default cType := ""
//     Default cFormat := ""
//     Default cFilter := "F6F_FILIAL == '"+xFilial("F6F")+"' "

//     cOperType := Upper(AllTrim(cOperType))
//     cCurrentType := AllTrim(cType)
//     cCurrentFormat := AllTrim(cFormat)

//     BeginContent var cXmlExample as Character
//     <?xml version="1.0" encoding="UTF-8"?>
//     <data>
//         <header>
//             <adapter> </adapter>
//             <date>2023-12-07T15:45:20Z</date>
//             <operation>INSERT</operation> 
//             <product>MA3</product> 
//             <company>99</company>
//             <branch>01</branch>
//         </header>
//         <content value="">
//         </content>
//     </data>
//     EndContent
    
//     Do Case
//         Case cOperType == "UPDATE"
//             nOper := MODEL_OPERATION_UPDATE
//         Case cOperType == "INSERT"
//             nOper := MODEL_OPERATION_INSERT
//         Case cOperType == "DELETE"
//             nOper := MODEL_OPERATION_DELETE
//     EndCase

//     DbSelectArea('F6F')
//     DBSetFilter({||&cFilter} ,cFilter)
//     dBGoTop()
//     WHILE !EOF()
//         If Empty(cType)
//             cCurrentType := AllTrim(F6F->F6F_TYPE)
//         EndIf
//         If Empty(cFormat)
//             cCurrentFormat := AllTrim(F6F->F6F_FORMAT)
//         EndIf
//         If cCurrentType == MVC_TYPE
//             oMvcModel := FwLoadModel(AllTrim(F6F->F6F_ADMVC))
//         ElseIf cCurrentType == MILE_TYPE
//             // Prepare string with MILE fileds examples
//             aFieldsInfo := GetMileLayoutFieldsInfo(AllTrim(F6F->F6F_ADMILE))
//             cFieldsExample := ""
//             For nI := 1 To Len(aFieldsInfo[1]) 
//                 cFieldsExample += GetFieldExample(cType=aFieldsInfo[3][nI], nLen=aFieldsInfo[4][nI], nDecimal=aFieldsInfo[5][nI]) + ";"
//             Next nI
//             cFieldsExample := SubStr(cFieldsExample,1,Len(cFieldsExample) - 1) + "\n" + SubStr(cFieldsExample,1,Len(cFieldsExample) - 1)
//         EndIf
//         If cCurrentFormat == "JSON"
//             oJsonHead := jsonObject():New()
//             oJsonHead["adapter"] := AllTrim(F6F->F6F_CODE)
//             oJsonHead["date"] := FWDateTo8601(Date())+"T"+Time()+"Z"
//             oJsonHead["operation"] := cOperType
//             oJsonHead["product"] := "MA3" // TO DO: other value?
//             oJsonHead["company"] := "99" // TO DO: other value?
//             oJsonHead["branch"] := "01" // TO DO: other value?
//             oJsonExample := jsonObject():New()
//             oJsonExample["header"] := jsonObject():New()
//             oJsonExample["header"]:FromJson(oJsonHead:ToJson())
//             If cCurrentType == MVC_TYPE
//                 oJsonContent := GetJsonMvcExample(oMvcModel,nOper)
//                 oJsonExample["content"] := oJsonContent
//                 oExamples[AllTrim(F6F->F6F_CODE)] := jsonObject():New()
//                 oExamples[AllTrim(F6F->F6F_CODE)]["value"] := jsonObject():New()
//                 oExamples[AllTrim(F6F->F6F_CODE)]["value"]:FromJson(oJsonExample:ToJson())
//             ElseIf cCurrentType == MILE_TYPE
//                 oJsonExample["content"] := ""
//                 oJsonExample["value"] := cFieldsExample
//                 oExamples[AllTrim(F6F->F6F_CODE)] := jsonObject():New()
//                 oExamples[AllTrim(F6F->F6F_CODE)]["value"] := jsonObject():New()
//                 oExamples[AllTrim(F6F->F6F_CODE)]["value"]:FromJson(oJsonExample:ToJson())
//             EndIf
//         ElseIf cCurrentFormat == "XML"
//             oXmlExample := TXmlManager():New()
//             If oXmlExample:Read(cXmlExample,/*cURL*/, /*cEncoding*/, /*nOptions*/)
//                 np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/header/adapter",AllTrim(F6F->F6F_CODE),@cError)
//                 np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/header/date",FWDateTo8601(Date())+"T"+Time()+"Z",@cError)
//                 np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/header/operation",cOperType,@cError)
//                 np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/header/product","MA3",@cError) // TO DO: other value?
//                 np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/header/company","99",@cError) // TO DO: other value?
//                 np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/header/branch","01",@cError) // TO DO: other value?
//                 If cCurrentType == MVC_TYPE
//                     oXmlMvcContent := GetXmlMvcExample(oMvcModel,nOper)
//                     //TO DO: Add removing of <?xml version="1.0" encoding="UTF-8"?>
//                     np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/content",oXmlMvcContent:Save2String(),@cError)
//                 ElseIf cCurrentType == MILE_TYPE
//                     np.framework.eai.RU99X20018_XPathSetInfo(oXmlExample,"/"+oXmlExample:cName+"/content/value",cFieldsExample,@cError)
//                 EndIf
//                 oExamples[AllTrim(F6F->F6F_CODE)] := jsonObject():New()
//                 //TO DO: Add removing of <?xml version="1.0" encoding="UTF-8"?>
//                 oExamples[AllTrim(F6F->F6F_CODE)]["value"] := oXmlExample:Save2String()
//             EndIf
//         EndIf
//         dbSkip()
//     EndDo
//     dbClearFilter()
//     FwRestArea(aArea)

// Return oExamples

// /*/{Protheus.doc} GetFieldExample(cName as Character, cType as Character, nLen as Numeric, nDecimal as Numeric, cBuf as Character)
    
//     @type function
//     @author idashkov
//     @since 
//     @param oModel, Object, Model which data is used in the adapter
//     @return, oSwaggerJson, Json, Swagger json with example
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function GetFieldExample(cName as Character, cType as Character, nLen as Numeric, nDecimal as Numeric, cBuf as Character)

//     Local cFieldsExample := "" as Character
//     Default cName := ""
//     Default cType := ""
//     Default nLen := 0
//     Default nDecimal := 0
//     Default cBuf := ""

//     If !Empty(cName)
//         np.framework.eai.TrySetEnv()
//         cType := GetSX3Cache(cName,"X3_TIPO")
//         nLen := GetSX3Cache(cName,"X3_TAMANHO")
//         nDecimal := GetSX3Cache(cName,"X3_DECIMAL")
//     EndIf

//     Do Case
//         Case cType == 'C' .Or. cType == 'M'
//             cBuf := "X"
//             cFieldsExample += Replicate(cBuf, nLen)
//         Case cType == 'N'
//             cBuf := "0"
//             If nDecimal > 0
//                 cFieldsExample += Padl("." + Replicate(cBuf, nDecimal), nLen+1, cBuf)
//             Else
//                 cFieldsExample += Replicate(cBuf, nLen)
//             EndIf
//         Case cType == 'L' 
//             cBuf := "T"
//             cFieldsExample += cBuf
//         Case cType == 'D' 
//             cFieldsExample += DTOS(Date())
//     EndCase

// Return cFieldsExample

// /*/{Protheus.doc} GetJsonMvcExample(oModel as Object)
    
//     @type function
//     @author idashkov
//     @since 
//     @param oModel, Object, Model which data is used in the adapter
//     @return, oSwaggerJson, Json, Swagger json with example
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function GetJsonMvcExample(oModel as Object, nOper as Numeric) as Json

//     Local oSwaggerExample := jsonObject():New() as Json
//     Local cSwaggerExample := "" as Character
//     Local nErrorPos := 0 as Numeric

//     cSwaggerExample := oModel:GetJSONData(.F.,nOper,.F.,.T.,.T.)
//     // Fix example, it violates json rules othwerwise:
//     While (nErrorPos := At(":[,",cSwaggerExample)) > 0
//         cSwaggerExample := STUFF(cSwaggerExample, nErrorPos+2, 1, "")
//     EndDo
//     cSwaggerExample := StrTran(cSwaggerExample, "}{", "},{")
//     // end of example fix
//     oSwaggerExample:FromJson(cSwaggerExample) // adding examples for fields
//     EnrichMvcWithExamples(oSwaggerExample)

// Return oSwaggerExample

// /*/{Protheus.doc} EnrichMvcWithExamples()
//     Filles standard MVC model JSON with 
//     an example values for every field
//     @type function
//     @author idashkov
//     @since 
//     @param oModel, Object, Model which data is used in the adapter
//     @return, oSwaggerJson, Json, Swagger json with example
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function EnrichMvcWithExamples(oExample,nOperation as Numeric)

//     Local nI := 1 as Numeric
//     Local nJ := 1 as Numeric
//     Local nK := 1 as Numeric
//     Local cFieldName as Character

//     If !Empty(oExample["models"])
//         For nI := 1 To Len(oExample["models"])
//             If oExample["models"][nI]["modeltype"] == "FIELDS"
//                 For nJ := 1 To Len(oExample["models"][nI]["fields"])
//                     cFieldName := oExample["models"][nI]["fields"][nJ]["id"]
//                     oExample["models"][nI]["fields"][nJ]["value"] := GetFieldExample(cName=cFieldName)
//                 Next nJ
//             ElseIf oExample["models"][nI]["modeltype"] == "GRID"
//                 For nJ := 1 To Len(oExample["models"][nI]["items"])
//                     For nK := 1 To Len(oExample["models"][nI]["items"][nJ]["fields"])
//                         cFieldName := oExample["models"][nI]["items"][nJ]["fields"][nK]["id"]
//                         oExample["models"][nI]["items"][nJ]["fields"][nK]["value"] := GetFieldExample(cName=cFieldName)
//                     Next nK
//                 Next nJ
//             EndIf
//             EnrichMvcWithExamples(oExample["models"][nI])
//         Next nI
//     Else    
//         oExample:DelName("models")
//     EndIf

// Return Nil

// /*/{Protheus.doc} GetXmlMvcExample()
//     Return xml with MVC model structure filled with 
//     examples of field values
//     @type function
//     @author idashkov
//     @since 
//     @param oModel, Object, Model which data is used in the adapter
//     @param nOperation, Numerical,
//     @see https://github.com/OAI/OpenAPI-Specification
// */
// Static Function GetXmlMvcExample(oModel,nOperation)
//     // TO DO: Add test for RU99X20018_XPathSetInfo correct return
//     Local oExample := TXmlManager():New()
//     Local nI := 1 as Numeric
//     Local nJ := 1 as Numeric
//     Local nK := 1 as Numeric
//     Local cError := ""
//     Local cFieldName := ""
//     Local cFieldExample := ""
//     Local cPath := ""
//     Default nOperation := 0

//     oExample:Read(oModel:GetXMLData(lDetail=.T.,nOperation=nOperation,lXSL=.F.,lVirtual=.F.,lDeleted=.T.,lEmpty=.F.,lDefinition=.F.),/*cURL*/, /*cEncoding*/, /*nOptions*/)
//     aModelStruct := oModel:GetModelStruct()
//     For nI := 1 To Len(aModelStruct) // For every submodel in main model
//         cSubModelType := aModelStruct[nI][1]
//         cSubModel := aModelStruct[nI][2]
//         oSubModel := aModelStruct[nI][3]
//         cPath := "/" + oExample:cName + "/"+ cSubModel
//         If cSubModelType == "FIELD"
//             For nJ := 1 To Len(oSubModel:OFORMMODELSTRUCT:aFields) // For every submodel in main model
//                 cFieldName := oSubModel:OFORMMODELSTRUCT:aFields[nJ][3]
//                 cFieldExample := GetFieldExample(cFieldName)
//                 np.framework.eai.RU99X20018_XPathSetInfo(oExample,cPath+"/"+cFieldName+"/value",cFieldExample,@cError)
//             Next nJ
//         ElseIf cSubModelType == "GRID"
//             For nJ := 1 To Len(oSubModel:OFORMMODELSTRUCT:aFields) // For every submodel in main model
//                 cFieldName := oSubModel:OFORMMODELSTRUCT:aFields[nJ][3]
//                 cFieldExample := GetFieldExample(cFieldName)
//                 np.framework.eai.RU99X20018_XPathSetInfo(oExample,cPath+"/items/item/"+cFieldName,cFieldExample,@cError)
//             Next nJ
//         EndIf
//         For nK := 1 To Len(aModelStruct[nI][4]) // For every submodel in the submodel
//             cSubModelType := aModelStruct[nI][4][nK][1]
//             cSubModel := aModelStruct[nI][4][nK][2]
//             oSubModel := aModelStruct[nI][4][nK][3]
//             If cSubModelType == "FIELD"
//                 For nJ := 1 To Len(oSubModel:OFORMMODELSTRUCT:aFields) // For every submodel in main model
//                     cFieldName := oSubModel:OFORMMODELSTRUCT:aFields[nJ][3]
//                     cFieldExample := GetFieldExample(cFieldName)
//                     np.framework.eai.RU99X20018_XPathSetInfo(oExample,cPath+"/"+cSubModel+"/"+cFieldName+"/value",cFieldExample,@cError)
//                 Next nJ
//             ElseIf cSubModelType == "GRID"
//                 For nJ := 1 To Len(oSubModel:OFORMMODELSTRUCT:aFields) // For every submodel in main model
//                     cFieldName := oSubModel:OFORMMODELSTRUCT:aFields[nJ][3]
//                     cFieldExample := GetFieldExample(cFieldName)
//                     np.framework.eai.RU99X20018_XPathSetInfo(oExample,cPath+"/"+cSubModel+"/items/item/"+cFieldName,cFieldExample,@cError)
//                 Next nJ
//             EndIf
//         Next nK
//     Next nI

// Return oExample

// /*/{Protheus.doc} charCount
//     Function responsible for counting the characters within a string
//     @type function
//     @author Fernando Nicolau
//     @since 13/09/2023
//     @param cString, Character, String principal
//     @param cCaracter, Character, Searched character
//     @return Numeric, Number of characters found
// /*/
// Static Function charCount(cString, cCaracter)

// 	Local nTotal      := 0
// 	Local nPos        := 0
// 	Default cString   := ""
// 	Default cCaracter := ""

// 	//Scroll through all the letters in the word
// 	For nPos := 1 To Len(cString)
// 		//If the current position is equal to the character sought, increment the value
// 		If SubStr(cString, nPos, 1) == cCaracter
// 			nTotal++
// 		EndIf
// 	Next

// Return nTotal

// /*/{Protheus.doc} MA3EAIErrorResponse(cCode as Character,cMessage as Character,cTarget as Character,aDetails as Array)
//     Returns formatted error response
//     @type function
//     @author idashkov
//     @since 24.01.24
//     @param cCode, Character, Error code
//     @param cMessage, Character, Error message
//     @param cTarget, Character, Where the error has happened
//     @param aDetails, Array, Additional data (can be in error formar), unspecified format
//     @return Character, Json in string format
// /*/
// Static Function MA3EAIErrorResponse(cCode as Character,cMessage as Character,cTarget as Character,aDetails as Array)
    
//     Local cError as Character
//     Local cJsonRet as Character
//     Local oError := jsonObject():New() as Json 
    
//     cError := RU99W20007_MA3EAIError(cCode,cMessage,cTarget,aDetails) // Formats error message
//     oError:FromJson(cError)
//     cJsonRet := RU99W20006_MA3EAIResponse(lSuccess=.F., cMessage='Failed', oError=oError) // Failed
//     FreeObj(oError)

// Return cJsonRet

// /*/{Protheus.doc} GetTextFormat(cText as Character) as Character
//     Returns format of passed text (JSON, XML)
//     @type function
//     @author idashkov
//     @since 24.01.24
//     @param cText, Character, Input text to be checked
//     @return Character, Format of the passed text (JSON,XML or empty if unknown)
// /*/
// Static Function GetTextFormat(cText as Character) as Character

//     Local cFormat := "JSON" as Character

//     If AT('<?xml', cText) == 1
//         cFormat := "XML"
//     ElseIf Empty(Alltrim(cText))
//         cFormat := ""
//     EndIf

// Return cFormat

// /*/{Protheus.doc} CamelCase(cText as Character) as Character
//     Returns formatted text in camel case - removes spaces, make symbols before spaces upper
//     @type function
//     @author idashkov
//     @since 19.02.24
//     @param cText, Character, Input text
//     @return Character, Formatted text 
// */
// Static Function CamelCase(cText as Character) as Character

//     Local cFormatted := "" as Character
//     Local nSpacePos := 0

//     cFormatted := Lower(AllTrim(cText))

//     While(AT(" ",cFormatted) > 0)
//         nSpacePos := AT(" ",cFormatted)
//         cFormatted := SUBSTR(cFormatted, 1, nSpacePos - 1) + Upper(SUBSTR(cFormatted, nSpacePos + 1, 1)) + SUBSTR(cFormatted, nSpacePos + 2, Len(cFormatted))
//     EndDo

// Return cFormatted

// /*/{Protheus.doc} getOptionsX3CBox
//     Returns the field options already formatted
//     @type  Function
//     @author alison.kaique
//     @since 22/06/2021
//     @version 12.1.33
//     @param cField, Character, Field id
//     @return Array, Field options
// /*/
// Static Function getOptionsX3CBox(cField As Character) As Array
//     Local aX3Cbox   As Array
//     Local aOptions  As Array
//     Local cContent  As Character
//     Local cX3Cbox   As Character
//     Local cFunction As Character
//     Local cIdiom    As Character
//     Local cBoxIdiom As Character
//     Local nIndex    As Numeric
//     Local nPosition As Numeric
//     Local jOption   As Json

//     cIdiom := FwRetIdiom()

//     If cIdiom == 'en' .Or. cIdiom == 'ru'
//         cBoxIdiom := 'X3_CBOXENG'
//     ElseIf cIdiom == 'es'
//         cBoxIdiom := 'X3_CBOXSPA'
//     Else
//         cBoxIdiom := 'X3_CBOX'
//     EndIf

//     cX3Cbox  := AllTrim(GetSX3Cache(cField, cBoxIdiom))

//     // checks if it has a function call and if the function exists
//     If (Left(cX3Cbox, 01) == '#')
//         cFunction := SubStr(cX3Cbox, 02)

//         If (FindFunction(cFunction))
//         cX3Cbox := &(cFunction)
//         Else
//         cX3Cbox := ''
//         EndIf
//     EndIf

//     aX3Cbox  := StrTokArr(cX3Cbox, ";")
//     aOptions := {}

//     For nIndex := 01 To Len(aX3Cbox)
//         cContent := AllTrim(aX3Cbox[nIndex])
//         nPosition := At('=', cContent)

//         If (nPosition > 0)
//         jOption := JsonObject():New()
//         jOption['value'] := Left(cContent, nPosition - 01)
//         jOption['label'] := SubStr(cContent, nPosition + 01)
//         AAdd(aOptions, jOption)
//         EndIf
//     Next nIndex
//     if ValType(jOption) <> "U"
//         FreeObj(jOption)
//     EndIf

// Return aOptions

// /*/{Protheus.doc} GetMileLayoutFieldsInfo()
//     Parses MILE layout to return fields' info awaited by it
//     @type  Function
//     @author idashkov
//     @since 19.02.2024
//     @version 1.0.0
//     @param cMILEAdapter, Character, Name of model to be changed by MILE layout
//     @return Array,  aFieldsInfo[1] = Array, Names of awaited fields in camel case 
//                     aFieldsInfo[2] = Array, Titles of awaited fields in camel case 
//                     aFieldsInfo[3] = Array, Types of awaited fields ('C', 'N' etc)
//                     aFieldsInfo[4] = Array, Lengths of awaited fields
//                     aFieldsInfo[5] = Array, Number of decimals of awaited fields
// /*/
// Static Function GetMileLayoutFieldsInfo(cMILEAdapter as Character) as Array

//     Local cLayout := "" as Character
//     Local cAliasTMP := GetNextAlias()
//     Local oXml 
//     Local aArea := FwGetArea()
//     Local cError := "" as Character
//     Local cWarning := "" as Character
//     Local cQuery := "" as Character
//     Local aFieldsInfo := {} as Array
//     Local aFields := {} as Array
//     Local aTitles := {} as Array
//     Local aTypes := {} as Array
//     Local aLen := {} as Array
//     Local aDecim := {} as Array
//     Local nI := 0
    
//     np.framework.eai.TrySetEnv()

//     // SQL-query is a clutch. Because cLayout := Posicione("XXJ",1,cMILEAdapter,"XXJ_LAYOUT") leads to critical fail 
//     cQuery := "SELECT XXJ_LAYOUT "
//     cQuery += "FROM "+RetSqlName('XXJ')+" "
//     cQuery += "WHERE XXJ_CODE = '"+cMILEAdapter+"' AND d_e_l_e_t_  = '' "
//     cQuery := ChangeQuery(cQuery)
//     DbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), cAliasTMP, .F., .T.)
//     (cAliasTMP)->(DbGoTop())
//     If !((cAliasTMP)->(Eof()))
//         cLayout := (cAliasTMP)->XXJ_LAYOUT
//         oXml := XmlParser(cLayout,"_",@cError,@cWarning) // Perhaps instead of parsing XXJ_LAYOUT MILE object (FWMile()) with the layout can be used
//         aFields := oXml:_CFGA600:_XZ1MASTER:_XZ2DETAIL:_items:_item:_XZ4DETAIL:_items:_item
//         For nI := 1 To Len(aFields)
//             aFields[nI] := aFields[nI]:_XZ4_FIELD:TEXT
//             Aadd(aTitles,CamelCase(RetTitle(aFields[nI])))
//             Aadd(aTypes,GetSX3Cache(aFields[nI],"X3_TIPO"))
//             Aadd(aLen,GetSX3Cache(aFields[nI],"X3_TAMANHO"))
//             Aadd(aDecim,GetSX3Cache(aFields[nI],"X3_DECIMAL"))
//         Next nI
//     EndIf
    
//     aFieldsInfo := {aFields,aTitles,aTypes,aLen,aDecim}

//     FwRestArea(aArea)

// Return aFieldsInfo
