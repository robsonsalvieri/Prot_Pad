#INCLUDE "APWEBSRV.CH"
#INCLUDE "PROTHEUS.CH"

///////////////////////////////////////////
/*------  ESTRUTURAS DO PORTAL PMS ------*/
///////////////////////////////////////////


/* aHeader com  X3_FOLDER e X3_ORDEM */
WSSTRUCT BrwHeaderPms
	WSDATA HeaderTitle   	As String	OPTIONAL
	WSDATA HeaderField   	As String	OPTIONAL
	WSDATA HeaderPicture 	As String	OPTIONAL
	WSDATA HeaderSize    	As Integer	OPTIONAL
	WSDATA HeaderDec     	As Integer	OPTIONAL
	WSDATA HeaderType    	As String	OPTIONAL
	WSDATA HeaderComboBox	As String	OPTIONAL
	WSDATA HeaderOblig   	As Boolean	OPTIONAL
	WSDATA HeaderF3      	As String	OPTIONAL
	WSDATA HeaderFolder		As String	OPTIONAL
	WSDATA HeaderOrder		As String	OPTIONAL
	WSDATA Editable			As String	OPTIONAL //(-1) - Nunca se Edita # 0 - Nao Pode Editar # 1 - Pode Editar
	WSDATA ProprietyName		As String	OPTIONAL
	WSDATA InitialValue		As String	OPTIONAL
	WSDATA HeaderType2		As String	OPTIONAL
	WSDATA UserField			As Boolean	OPTIONAL
ENDWSSTRUCT		

/* 
Mensagem Padrao do Sistema 
-1 - Erro
0  - Atencao
1  - Sucesso
*/
WSSTRUCT MessageView
	WSDATA MessageText 			As String 	
	WSDATA MessageType			As Float
ENDWSSTRUCT

/* PROJETO - AF8 */
WSSTRUCT ProjectListView
	WSDATA ProjectCode 			As String 	OPTIONAL
	WSDATA ProjectDate 			As Date		OPTIONAL
	WSDATA Description 			As String	OPTIONAL
	WSDATA ProjectRevision		As String	OPTIONAL
	WSDATA ProjectStage			As String	OPTIONAL
	WSDATA ProjectCliente		As String	OPTIONAL
	WSDATA ProjectUnit			As String	OPTIONAL
	WSDATA UserFields          As Array Of UserField OPTIONAL
ENDWSSTRUCT

/* Estruturas - AFC+AF9 */
WSSTRUCT ProjectStructView
	WSDATA WbsJobCode 				As String 	OPTIONAL
	WSDATA Description 				As String	OPTIONAL
	WSDATA WbsOrJob					As String	OPTIONAL              
	WSDATA TimeDuration 				As Integer	OPTIONAL // AF9_HDURAC  - AFC_HDURAC
	WSDATA EstimatedInitialDate	As Date		OPTIONAL // AF9_START   - AFC_START
	WSDATA EstimatedFinalDate 		As Date		OPTIONAL // AF9_FINISH  - AFC_FINISH
	WSDATA ExecutionInitialDate	As Date		OPTIONAL // AF9_DTATUI  - AFC_DTATUI
	WSDATA ExecutionFinalDate		As Date		OPTIONAL // AF9_DTATUF  - AFC_DTATUF
	WSDATA ExecutionPercentage		As Float		OPTIONAL // PmsPocAF9() - PmsPocAFC()
  
  WSDATA OrderList					As String	OPTIONAL // Ordem de exibicao
	WSDATA Level						As String	OPTIONAL // AF9_NIVEL   - AFC_NIVEL
	WSDATA WbsFather					As String	OPTIONAL // AF9_EDTPAI  - AFC_EDTPAI
	
	WSDATA UserFields          	As Array Of UserField OPTIONAL
ENDWSSTRUCT

/* Estruturas - AFC - EDTs acima da posicao atual */
WSSTRUCT ProjectHeaderView
	WSDATA WbsCode  				As String 	OPTIONAL
	WSDATA Description 			As String	OPTIONAL
	WSDATA ImageColor				As String	OPTIONAL
ENDWSSTRUCT

/* Lista de Tarefas - AF9  */
WSSTRUCT TaskListView
	WSDATA Task							As String	OPTIONAL // AF9_TAREFA
	WSDATA Level						As String	OPTIONAL // AF9_NIVEL
	WSDATA Description 				As String	OPTIONAL // AF9_DESCRI
	WSDATA MU  							As String	OPTIONAL // AF9_UM
	WSDATA Quantity    				As Integer	OPTIONAL // AF9_QUANT
	WSDATA TimeDuration 				As Integer	OPTIONAL // AF9_HDURAC
	WSDATA Calendar    				As String	OPTIONAL // AF9_CALEND
	WSDATA EstimatedInitialDate	As Date		OPTIONAL // AF9_START
	WSDATA EstimatedFinalDate 		As Date		OPTIONAL // AF9_FINISH
	WSDATA EstimatedInitialHour   As String	OPTIONAL // AF9_HORAI
	WSDATA EstimatedFinalHour   	As String	OPTIONAL // AF9_HORAF
	WSDATA MeasurementMethod		As String	OPTIONAL // AF9_TPMEDI
	WSDATA UsefulHours    			As Float		OPTIONAL // AF9_HUTEIS
	WSDATA ExecutionInitialDate	As Date		OPTIONAL // AF9_DTATUI
	WSDATA ExecutionFinalDate		As Date		OPTIONAL // AF9_DTATUF
	WSDATA CostCenter 				As String	OPTIONAL // AF9_CCUSTO
	WSDATA AccountingItem       	As String	OPTIONAL // AF9_ITEMCC
	WSDATA ValueClass 				As String	OPTIONAL // AF9_CLVL
	WSDATA Invoiced    				As String	OPTIONAL // AF9_FATURA
	WSDATA CurrentValue1   			As Float		OPTIONAL // AF9_VATU1
	WSDATA CurrentValue2 			As Float		OPTIONAL	// AF9_VATU2
	WSDATA CurrentValue3 			As Float		OPTIONAL	// AF9_VATU3
	WSDATA CurrentValue4 			As Float		OPTIONAL	// AF9_VATU4
	WSDATA CurrentValue5 			As Float		OPTIONAL	// AF9_VATU5
	WSDATA FinalValue1  				As Float		OPTIONAL // AF9_VFIM1
	WSDATA FinalValue2 				As Float		OPTIONAL // AF9_VFIM2
	WSDATA FinalValue3 				As Float		OPTIONAL // AF9_VFIM3
	WSDATA FinalValue4 				As Float		OPTIONAL // AF9_VFIM4
	WSDATA FinalValue5 				As Float		OPTIONAL // AF9_VFIM5
	WSDATA InitialValue1   			As Float		OPTIONAL // AF9_VINI1
	WSDATA InitialValue2 			As Float		OPTIONAL // AF9_VINI2
	WSDATA InitialValue3 			As Float		OPTIONAL // AF9_VINI3
	WSDATA InitialValue4 			As Float		OPTIONAL // AF9_VINI4
	WSDATA InitialValue5 			As Float		OPTIONAL // AF9_VINI5
	WSDATA MainWBS    				As String	OPTIONAL // AF9_EDTPAI
	WSDATA ExpenseValue1          As Float		OPTIONAL // AF9_VDSP1
	WSDATA ExpenseValue2 			As Float		OPTIONAL // AF9_VDSP2
	WSDATA ExpenseValue3 			As Float		OPTIONAL // AF9_VDSP3
	WSDATA ExpenseValue4 			As Float		OPTIONAL // AF9_VDSP4
	WSDATA ExpenseValue5 			As Float		OPTIONAL // AF9_VDSP5
	WSDATA CompositionCode 			As String	OPTIONAL // AF9_COMPOS     
	WSDATA CurrencyConversion  	As String	OPTIONAL // AF9_CNVPRV
	WSDATA SendEMail 					As String	OPTIONAL // AF9_EMAIL
	WSDATA Group						As String	OPTIONAL // AF9_GRPCOM
	WSDATA Priority					As Integer	OPTIONAL // AF9_PRIORI
	WSDATA ConversionDate 			As Date		OPTIONAL // AF9_DTCONV
	WSDATA CurrencyCost1 			As Float		OPTIONAL // AF9_CUSTO
	WSDATA CurrencyCost2 			As Float		OPTIONAL // AF9_CUSTO2
	WSDATA CurrencyCost3 			As Float		OPTIONAL // AF9_CUSTO3
	WSDATA CurrencyCost4 			As Float		OPTIONAL // AF9_CUSTO4
	WSDATA CurrencyCost5 			As Float		OPTIONAL // AF9_CUSTO5
	WSDATA StructureOrder   		As String	OPTIONAL // AF9_ORDEM
	WSDATA Restriction 				As String	OPTIONAL // AF9_RESTRI
	WSDATA RestrictDate 				As Date		OPTIONAL // AF9_DTREST
	WSDATA RestrictTime 				As String	OPTIONAL // AF9_HRREST
	WSDATA CurrencyRate2 			As Float		OPTIONAL // AF9_TXMO2
	WSDATA CurrencyRate3 			As Float		OPTIONAL // AF9_TXMO3
	WSDATA CurrencyRate4 			As Float		OPTIONAL // AF9_TXMO4
	WSDATA CurrencyRate5 			As Float		OPTIONAL // AF9_TXMO5
	WSDATA MarkupPercent 			As Float		OPTIONAL // AF9_BDI
	WSDATA MarkupValue 				As Float		OPTIONAL // AF9_VALBDI
	WSDATA GrandTotal 				As Float		OPTIONAL // AF9_TOTAL
	WSDATA InvoiceProductCode 		As String	OPTIONAL // AF9_PRODFA
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Lista de Eventos - AFP */
WSSTRUCT EventListView
	WSDATA TaskCode					As String	OPTIONAL // AFP_TAREFA
	WSDATA Item							As String	OPTIONAL // AFP_ITEM
	WSDATA UsageCode					As String	OPTIONAL // AFP_USO
	WSDATA EventDescription			As String	OPTIONAL // AFP_DESCRI
	WSDATA EventEstimatedDate		As Date		OPTIONAL // AFP_DTPREV
	WSDATA EstimatedDate				As Date		OPTIONAL // AFP_DTCALC
	WSDATA EventExecutionDate		As Date		OPTIONAL // AFP_DTATU
	WSDATA PercentageExecuted		As Float		OPTIONAL // AFP_PERC
	WSDATA SendEmail					As String	OPTIONAL // AFP_EMAIL
	WSDATA ExecuteUserFunction		As String	OPTIONAL // AFP_USRFUN
	WSDATA WbsCode						As String	OPTIONAL // AFP_EDT
	WSDATA CustomerCode				As String	OPTIONAL // AFP_CLIENT
	WSDATA CustomerBranch			As String	OPTIONAL // AFP_LOJA
	WSDATA BillValue					As Float		OPTIONAL // AFP_VALOR
	WSDATA BillCurrency				As Integer	OPTIONAL // AFP_MOEDA
	WSDATA GenerateTemporaryBill	As String	OPTIONAL // AFP_GERPRV
	WSDATA GenerateBillReceivable	As String	OPTIONAL // AFP_GERTIT
	WSDATA PaymentTerm				As String	OPTIONAL // AFP_COND
	WSDATA BillNumber					As String	OPTIONAL // AFP_NUM
	WSDATA BillPrefix					As String	OPTIONAL // AFP_PREFIX
	WSDATA ClassCode					As String	OPTIONAL // AFP_NATURE
	WSDATA SalesOrderNumber			As String	OPTIONAL // AFP_CTV
	WSDATA SalesOrderNumberItem	As String	OPTIONAL // AFP_CTVITE
	WSDATA SalesOrderRelease		As Float		OPTIONAL // AFP_CTVPER
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Lista de Despesas de uma Tarefa - AFB  */
WSSTRUCT ExpenseListView
	WSDATA Item							As String	OPTIONAL // AFB_ITEM
	WSDATA ExpensesType				As String	OPTIONAL // AFB_TIPOD
	WSDATA Description				As String	OPTIONAL // AFB_DESCRI
	WSDATA TaskCode					As String	OPTIONAL // AFB_TAREFA
	WSDATA Currency					As Integer	OPTIONAL // AFB_MOEDA
	WSDATA CurrencySymbol			As String	OPTIONAL // AFB_SIMBMO
	WSDATA ExpensesAmount			As Float		OPTIONAL // AFB_VALOR
	WSDATA ProjectCode 				As String	OPTIONAL // AFB_PROJET
	WSDATA ProjectVersion			As String	OPTIONAL // AFB_REVISA
	WSDATA AccumulateCosts			As String	OPTIONAL // AFB_ACUMUL
	WSDATA NecessityDate				As Date		OPTIONAL // AFB_DATPRF
	WSDATA ResourceCode				As String	OPTIONAL // AFB_RECURS
	WSDATA AllocatedPercentage		As Float		OPTIONAL // AFB_ALOC
	WSDATA InitialAllocationDate  As Date		OPTIONAL // AFB_START
	WSDATA AllocationInitialHour	As String	OPTIONAL // AFB_HORAI
	WSDATA FinalAllocationDate		As Date		OPTIONAL // AFB_FINISH
	WSDATA AllocationFinalHour		As String	OPTIONAL // AFB_HORAF
	WSDATA SubcompositionCode		As String	OPTIONAL // AFB_COMPOS
	WSDATA InvoiceProductCode		As String	OPTIONAL // AFB_PRODFA
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Lista de Relacionamento entre Tarefas do Projeto - AFD  */
WSSTRUCT RelationShipListView
	WSDATA PredecessorItem			As String	OPTIONAL // AFD_ITEM
	WSDATA PredecessorTaskCode		As String	OPTIONAL // AFD_PREDEC
	WSDATA TaskDescription			As String	OPTIONAL // AFD_DESCRI
	WSDATA RelationshipType			As String	OPTIONAL // AFD_TIPO
	WSDATA ProjectVersion			As String	OPTIONAL // AFD_REVISA
	WSDATA RelationshipDelay		As Float		OPTIONAL // AFD_HRETAR
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Lista de Produtos da Tarefa - AFA - folder produtos */
WSSTRUCT TaskProductsView
	WSDATA Item							As String	OPTIONAL // AFA_ITEM
	WSDATA ProductCode				As String	OPTIONAL // AFA_PRODUT
	WSDATA ProductType				As String	OPTIONAL // AFA_TIPO
	WSDATA Description				As String	OPTIONAL // AFA_DESCRI
	WSDATA Unit							As String	OPTIONAL // AFA_UM
	WSDATA Unit2						As String	OPTIONAL // AFA_SEGUM
	WSDATA Quantity					As Integer	OPTIONAL // AFA_QUANT
	WSDATA Quantity2					As Integer	OPTIONAL // AFA_QTSEGU
	WSDATA Currency					As Integer	OPTIONAL // AFA_MOEDA
	WSDATA CurrencySymbol			As String	OPTIONAL // AFA_SIMBMO
	WSDATA StandardCost				As Float		OPTIONAL // AFA_CUSTD
	WSDATA NecessityDate				As Date		OPTIONAL // AFA_DATPRF
	WSDATA CostCalculationMethod	As String	OPTIONAL // AFA_ACUMUL
	WSDATA SubcompostionCode		As String	OPTIONAL // AFA_COMPOS
	WSDATA PlanningCode				As String	OPTIONAL // AFA_PLANEJ
	WSDATA RecalculateCosts			As String	OPTIONAL // AFA_RECALC
	WSDATA InvoiceProductCode		As String	OPTIONAL // AFA_PRODFA
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Lista de Alocacao de Recursos - AFA - Folder Aloc. Recursos */
WSSTRUCT TaskAllocationView
	WSDATA Item							As String	OPTIONAL // AFA_ITEM
	WSDATA ResourceCode				As String	OPTIONAL // AFA_RECURS
	WSDATA Quantity					As Integer	OPTIONAL // AFA_QUANT
	WSDATA AllocatedPercentage		As Float		OPTIONAL // AFA_ALOC
	WSDATA Establish					As String	OPTIONAL // AFA_FIX
	WSDATA ProductCode				As String	OPTIONAL // AFA_PRODUT
	WSDATA Description				As String	OPTIONAL // AFA_DESCRI
	WSDATA Currency					As Integer	OPTIONAL // AFA_MOEDA
	WSDATA CurrencySymbol			As String	OPTIONAL // AFA_SIMBMO
	WSDATA StandardCost				As Float		OPTIONAL // AFA_CUSTD
	WSDATA Unit							As String	OPTIONAL // AFA_UM
   WSDATA Unit2						As String	OPTIONAL // AFA_SEGUM
	WSDATA Quantity2					As Integer	OPTIONAL // AFA_QTSEGU
	WSDATA NecessityDate				As Date	   OPTIONAL // AFA_DATPRF
	WSDATA CostCalculationMethod	As String	OPTIONAL // AFA_ACUMUL
	WSDATA RecalculateCosts			As String	OPTIONAL // AFA_RECALC
	WSDATA InvoiceProductCode		As String	OPTIONAL // AFA_PRODFA
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Detalhes Projeto - Cadastro */
WSSTRUCT ProjectDetailView
	WSDATA ProjectCode				As String	OPTIONAL
	WSDATA WBSCode						As String	OPTIONAL
	WSDATA Revision					As String	OPTIONAL
	WSDATA Level						As String	OPTIONAL
	WSDATA Description 				As String	OPTIONAL
	WSDATA WBSFather					As String	OPTIONAL
	WSDATA Unity						As String	OPTIONAL
	WSDATA Quantity					As Integer	OPTIONAL
	WSDATA TimeDuration				As String	OPTIONAL
	WSDATA Calendar					As String	OPTIONAL
	WSDATA EstimatedInitialDate	As Date		OPTIONAL
	WSDATA EstimatedFinalDate		As Date		OPTIONAL
	WSDATA EstimatedInitialHour	As String	OPTIONAL
	WSDATA EstimatedFinalHour		As String	OPTIONAL
	WSDATA TaskUsefulHours			As Float		OPTIONAL
	WSDATA ExecutedInitialDate		As Date		OPTIONAL
	WSDATA ExecutedFinalDate		As Date		OPTIONAL
	WSDATA CostCurrencyOne			As Float		OPTIONAL
	WSDATA CostCurrencyTwo			As Float		OPTIONAL
	WSDATA CostCurrencyThree		As Float		OPTIONAL
	WSDATA CostCurrencyFor			As Float		OPTIONAL
	WSDATA CostCurrencyFive			As Float		OPTIONAL
	WSDATA StructureOrder			As String	OPTIONAL
	WSDATA Invoiced					As String	OPTIONAL
	WSDATA MarkupValue				As Float		OPTIONAL
	WSDATA SalesGrandTotal			As Float		OPTIONAL
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Detalhes EDT - Cadastro(Detalhes) */
WSSTRUCT WbsDetailView
	WSDATA ProjectCode				As String	OPTIONAL
	WSDATA WBSCode						As String	OPTIONAL
	WSDATA Revision					As String	OPTIONAL
	WSDATA Level						As String	OPTIONAL
	WSDATA Description 				As String	OPTIONAL
	WSDATA WBSFather					As String	OPTIONAL
	WSDATA Unity						As String	OPTIONAL
	WSDATA Quantity					As Integer	OPTIONAL
	WSDATA TimeDuration				As Float		OPTIONAL
	WSDATA Calendar					As String	OPTIONAL
	WSDATA EstimatedInitialDate	As Date		OPTIONAL
	WSDATA EstimatedFinalDate		As Date		OPTIONAL
	WSDATA EstimatedInitialHour	As String	OPTIONAL
	WSDATA EstimatedFinalHour		As String	OPTIONAL
	WSDATA TaskUsefulHours        As Integer	OPTIONAL
	WSDATA ExecutedInitialDate		As Date		OPTIONAL
	WSDATA ExecutedFinalDate		As Date		OPTIONAL
	WSDATA CostCurrencyOne			As Float		OPTIONAL
	WSDATA CostCurrencyTwo			As Float		OPTIONAL
	WSDATA CostCurrencyThree		As Float		OPTIONAL
	WSDATA CostCurrencyFor			As Float		OPTIONAL
	WSDATA CostCurrencyFive			As Float		OPTIONAL
	WSDATA StructureOrder			As String	OPTIONAL
	WSDATA Invoiced					As String	OPTIONAL
	WSDATA MarkupValue				As Float		OPTIONAL
	WSDATA SalesGrandTotal			As Float		OPTIONAL
	WSDATA Obs							As String	OPTIONAL // Somente para handle na pagina APH dentro do iFrame
	WSDATA Notes						As Array of NotesView OPTIONAL
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Detalhes Tarefa - Cadastro - AF9 */
WSSTRUCT TaskDetailView
	WSDATA ProjectCode				As String	OPTIONAL // AF9_PROJET
	WSDATA Version						As String	OPTIONAL // AF9_REVISA
	WSDATA TaskCode					As String	OPTIONAL // AF9_TAREFA
	WSDATA TaskLevel					As String	OPTIONAL // AF9_NIVEL
	WSDATA Description         	As String	OPTIONAL // AF9_DESCRI
	WSDATA Unit         				As String	OPTIONAL // AF9_UM
	WSDATA Quantity            	As Integer	OPTIONAL // AF9_QUANT
	WSDATA TaskDurationHours   	As Float		OPTIONAL // AF9_HDURAC
	WSDATA Calendar  					As String	OPTIONAL // AF9_CALEND
	WSDATA EstimatedInitialDate   As Date		OPTIONAL // AF9_START
	WSDATA EstimatedFinalDate     As Date		OPTIONAL // AF9_FINISH
	WSDATA EstimatedInitialHour   As String	OPTIONAL // AF9_HORAI
	WSDATA EstimatedFinalHour     As String	OPTIONAL // AF9_HORAF
	WSDATA MeasurementMethod		As String	OPTIONAL // AF9_TPMEDI
	WSDATA TaskUsefulHours			As Float		OPTIONAL // AF9_HUTEIS
	WSDATA ExecutionInitialDate	As Date		OPTIONAL // AF9_DTATUI
	WSDATA ExecutionFinalDate		As Date		OPTIONAL // AF9_DTATUF
	WSDATA CostCenter					As String	OPTIONAL // AF9_CCUSTO
	WSDATA AccountingItem			As String	OPTIONAL // AF9_ITEMCC
	WSDATA ValueClass					As String	OPTIONAL // AF9_CLVL
	WSDATA Invoiced					As String	OPTIONAL // AF9_FATURA
	WSDATA CurrencyActualValue1	As Float		OPTIONAL // AF9_VATU1
	WSDATA CurrencyActualValue2	As Float		OPTIONAL // AF9_VATU2
	WSDATA CurrencyActualValue3	As Float		OPTIONAL // AF9_VATU3
	WSDATA CurrencyActualValue4	As Float		OPTIONAL // AF9_VATU4
	WSDATA CurrencyActualValue5	As Float		OPTIONAL // AF9_VATU5
	WSDATA FinalValue1				As Float		OPTIONAL // AF9_VFIM1
	WSDATA FinalValue2				As Float		OPTIONAL // AF9_VFIM2
	WSDATA FinalValue3				As Float		OPTIONAL // AF9_VFIM3
	WSDATA FinalValue4				As Float		OPTIONAL // AF9_VFIM4
	WSDATA FinalValue5				As Float		OPTIONAL // AF9_VFIM5
	WSDATA InitialValue1				As Float		OPTIONAL // AF9_VINI1
	WSDATA InitialValue2				As Float		OPTIONAL // AF9_VINI2
	WSDATA InitialValue3				As Float		OPTIONAL // AF9_VINI3
	WSDATA InitialValue4				As Float		OPTIONAL // AF9_VINI4
	WSDATA InitialValue5				As Float		OPTIONAL // AF9_VINI5
	WSDATA MainWBSCode            As String	OPTIONAL // AF9_EDTPAI
	WSDATA ExpenseValue1				As Float		OPTIONAL // AF9_VDSP1
	WSDATA ExpenseValue2				As Float		OPTIONAL // AF9_VDSP2
	WSDATA ExpenseValue3				As Float		OPTIONAL // AF9_VDSP3
	WSDATA ExpenseValue4				As Float		OPTIONAL // AF9_VDSP4
	WSDATA ExpenseValue5				As Float		OPTIONAL // AF9_VDSP5
	WSDATA CompositionCode			As String	OPTIONAL // AF9_COMPOS
	WSDATA CurrencyConversion		As String	OPTIONAL // AF9_CNVPRV
	WSDATA Sendemail					As String	OPTIONAL // AF9_EMAIL
	WSDATA TaskGroup					As String	OPTIONAL // AF9_GRPCOM
	WSDATA TaskPriority				As Integer	OPTIONAL // AF9_PRIORI
	WSDATA ConversionDate			As Date		OPTIONAL // AF9_DTCONV
	WSDATA TaksCost1 					As Float		OPTIONAL // AF9_CUSTO1
	WSDATA TaksCost2 					As Float		OPTIONAL // AF9_CUSTO2
	WSDATA TaksCost3 					As Float		OPTIONAL // AF9_CUSTO3
	WSDATA TaksCost4 					As Float		OPTIONAL // AF9_CUSTO4
	WSDATA TaksCost5 					As Float		OPTIONAL // AF9_CUSTO5
	WSDATA StructureOrder			As String	OPTIONAL // AF9_ORDEM
	WSDATA RestrictionType			As String	OPTIONAL // AF9_RESTRI
	WSDATA RestrictionDate			As Date		OPTIONAL // AF9_DTREST
	WSDATA RestrictionTime			As String	OPTIONAL // AF9_HRREST
	WSDATA RateEntered2				As Float		OPTIONAL // AF9_TXMO2
	WSDATA RateEntered3				As Float		OPTIONAL // AF9_TXMO3
	WSDATA RateEntered4				As Float		OPTIONAL // AF9_TXMO4
	WSDATA RateEntered5				As Float		OPTIONAL // AF9_TXMO5
	WSDATA MarkupCoust        		As Float		OPTIONAL // AF9_BDI
	WSDATA MarkupValue				As Float		OPTIONAL // AF9_VALBDI
	WSDATA SalesGrandTotal			As Float		OPTIONAL // AF9_TOTAL
	WSDATA InvoiceProductCode		As String	OPTIONAL // AF9_PRODFA
	WSDATA Obs							As String	OPTIONAL // AF9_OBS - Somente para handle na pagina APH dentro do iFrame
	WSDATA Notes						As Array of NotesView OPTIONAL
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT            

/* Lista de Apontamentos - AFU */
WSSTRUCT AnnotationsListView
	WSDATA ProjectCode				As String	OPTIONAL // AFU_PROJET
	WSDATA ProjectTask				As String	OPTIONAL // AFU_TAREFA
	WSDATA ResourceCode				As String	OPTIONAL // AFU_RECURS
	WSDATA Annotationdate			As Date		OPTIONAL // AFU_DATA
	WSDATA ExecutedInitialHour		As String	OPTIONAL // AFU_HORAI
	WSDATA FinalHourExecuted		As String	OPTIONAL // AFU_HORAF
	WSDATA NumberofHours				As Float		OPTIONAL // AFU_HQUANT
	WSDATA DocumentCode				As String	OPTIONAL // AFU_DOCUME
	WSDATA DocumentItem				As String	OPTIONAL // AFU_ITEM
	WSDATA DbRecord					As Integer	OPTIONAL // Recno()
ENDWSSTRUCT            

/* Apontamentos - AFU (Registro completo) */
WSSTRUCT AnnotationView
	WSDATA ProjectCode				As String	OPTIONAL // AFU_PROJET
	WSDATA ProjectVersion			As String	OPTIONAL // AFU_REVISA
	WSDATA ProjectTask				As String	OPTIONAL // AFU_TAREFA
	WSDATA ResourceCode				As String	OPTIONAL // AFU_RECURS
	WSDATA AnnotationDate			As Date		OPTIONAL // AFU_DATA
	WSDATA ExecutedInitialHour    As String	OPTIONAL // AFU_HORAI
	WSDATA FinalHourExecuted      As String	OPTIONAL // AFU_HORAF
	WSDATA NumberOfHours         	As Float		OPTIONAL // AFU_HQUANT
	WSDATA SequentialNumber       As String	OPTIONAL // AFU_NUMSEQ
	WSDATA ProductCode				As String	OPTIONAL // AFU_COD
	WSDATA WarehouseCode				As String	OPTIONAL // AFU_LOCAL
	WSDATA RevisionControl			As String	OPTIONAL // AFU_CTRRVS
	WSDATA AnnotationCost1       	As Float		OPTIONAL // AFU_CUSTO1
	WSDATA Obs							As String	OPTIONAL // Somente para handle na pagina APH dentro do iFrame
	WSDATA Notes						As Array of NotesView OPTIONAL // tabela SYP
	WSDATA DbRecord	 	 	    	As Integer OPTIONAL // Recno()
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT            

/* Lista de Confirmacoes - AFF */
WSSTRUCT ConfirmationsListView
	WSDATA ProjectCode					As String	OPTIONAL // AFF_PROJET
	WSDATA TaskCode						As String	OPTIONAL // AFF_TAREFA
	WSDATA ReferenceDate					As Date		OPTIONAL // AFF_DATA
	WSDATA QuantityExecuted				As Float		OPTIONAL // AFF_QUANT
	WSDATA PercentageExecuted			As Float		OPTIONAL // AFF_PERC
	WSDATA OcorrenceCode			  		As String	OPTIONAL // AFF_OCORRE
	WSDATA OcorrenceDescription		As String	OPTIONAL // AFF_OCDESC
	WSDATA DeliveryAuthorization		As String	OPTIONAL // AFF_CONFIR
	WSDATA DeliveryComboBoxText		As String	OPTIONAL // X3CBox()
	WSDATA DbRecord	 		 	    	As Integer OPTIONAL // Recno()
	WSDATA InitialHour             	As String	OPTIONAL // AFF_HORAI
	WSDATA FinalHour               	As String	OPTIONAL // AFF_HORAF
	WSDATA UserFields            As Array of UserField OPTIONAL

ENDWSSTRUCT

/* Confirmacao - AFF (Registro completo) */
WSSTRUCT ConfirmationView
	WSDATA ProjectCode             	As String	OPTIONAL // AFF_PROJET
	WSDATA ProjectVersion          	As String	OPTIONAL // AFF_REVISA
	WSDATA TaskDescription         	As String	OPTIONAL // AFF_DESCRI
	WSDATA ReferenceDate           	As Date		OPTIONAL // AFF_DATA
	WSDATA InitialHour             	As String	OPTIONAL // AFF_HORAI
	WSDATA FinalHour               	As String	OPTIONAL // AFF_HORAF
	WSDATA TaskCode                	As String	OPTIONAL // AFF_TAREFA
	WSDATA QuantityExecuted        	As Float		OPTIONAL // AFF_QUANT
	WSDATA PercentageExecuted      	As Float		OPTIONAL // AFF_PERC
	WSDATA OcorrenceCode          	As String	OPTIONAL // AFF_OCORRE
	WSDATA OcorrenceDescription   	As String	OPTIONAL // AFF_OCDESC
	WSDATA UserCode           		As String	OPTIONAL // AFF_USER
	WSDATA UserName                	As String	OPTIONAL // AFF_NOMUSE
	WSDATA DeliveryAuthorization	As String	OPTIONAL // AFF_CONFIR
	WSDATA Obs						As String	OPTIONAL // Somente para handle na pagina APH dentro do iFrame/TextArea
	WSDATA Notes					As Array of NotesView OPTIONAL // tabela SYP
	WSDATA TaskQtdTot				As String	OPTIONAL // AF9_QUANT
	WSDATA DbRecord	 	 	    	As Integer OPTIONAL // Recno()
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT


/* Alocacao de Recurso - AE8  */
WSSTRUCT ResourceView
	WSDATA ResourceCode					As String	OPTIONAL // AE8_RECURS
	WSDATA ResourceName					As String	OPTIONAL // AE8_DESCRI
	WSDATA Calendar						As String	OPTIONAL // AE8_CALEND
	WSDATA TeamCode						As String	OPTIONAL // AE8_EQUIP
	WSDATA TeamName						As String	OPTIONAL // AED_DESCRI
	WSDATA ProductCode					As String	OPTIONAL // AE8_RECURS
	WSDATA UserFields          		As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Equipes - AED */
WSSTRUCT TeamView
	WSDATA TeamCode					As String	OPTIONAL // AED_EQUIP 
	WSDATA TeamName					As String	OPTIONAL // AED_DESCRI
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT

/* Ocorrencias - AE7 */
WSSTRUCT OcorrenceView
	WSDATA OcorrenceCode					As String	OPTIONAL // AE7_CODIGO 
	WSDATA OcorrenceDescription		As String	OPTIONAL // AE7_DESCRI
	WSDATA UserFields            As Array of UserField OPTIONAL
ENDWSSTRUCT


/* Elemento do Gantt   */
WSSTRUCT GanttTaskView
	WSDATA TaskType                	As Integer  //1=Tarefa,2=Edt,3=Recurso,4=Equipe
	WSDATA ProjectCode             	As String	
	WSDATA TaskCode                	As String	
	WSDATA TaskDescription         	As String	
	WSDATA TimeDuration				As Float		OPTIONAL
	WSDATA EstimatedInitialDate		As Date		
	WSDATA EstimatedFinalDate		As Date		
	WSDATA EstimatedInitialHour		As String	
	WSDATA EstimatedFinalHour			As String	OPTIONAL
	WSDATA ExecutionInitialDate		As Date		OPTIONAL 
	WSDATA ExecutionFinalDate			As Date		OPTIONAL 
	WSDATA POC                			As Float		OPTIONAL 
	WSDATA CPM		           			As Integer  OPTIONAL
	WSDATA Level              			As STRING 
	WSDATA Resources          			As STRING 	OPTIONAL
	WSDATA Quantity           			As FLOAT 	OPTIONAL
	WSDATA DbRecord           			As Integer	OPTIONAL
	WSDATA Bitmap             			As STRING 	OPTIONAL	
ENDWSSTRUCT
/*/
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±⁄ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒø±±
±±≥FunáÑo    ≥PmsHeader ≥Autor  ≥ Cristiano Denardi     ≥ Data ≥11.08.2005 ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥          ≥Rotina de recuperacao do header das estruturas do PMS        ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥Parametros≥ExpC1: Informe qual a estrutura a ser requisitada            ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥Retorno   ≥ExpA1: Array a ser retornado utilizando a estrtura BrwHeader ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥Uso       ≥ Portal PMS                                                  ≥±± 
±±¿ƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ
/*/
Function PmsHeader(cStruct)

Local aArea   	:= GetArea()
Local aHeader 	:= {}
Local nX 		:= 0
Local aUserFields	:=	{}
cStruct := Upper(cStruct)

Do Case
	Case cStruct == "WBSDETAILVIEW"
		PmsHeaderM( @aHeader, , "AFC_PROJET", "ProjectCode"         , "0" )
		PmsHeaderM( @aHeader, , "AFC_EDT"   , "WBSCode"             , "0" )
		PmsHeaderM( @aHeader, , "AFC_REVISA", "Revision"            , "0" )
		PmsHeaderM( @aHeader, , "AFC_NIVEL" , "Level"               , "0" )
		PmsHeaderM( @aHeader, , "AFC_DESCRI", "Description"         , "0" )
		PmsHeaderM( @aHeader, , "AFC_EDTPAI", "WBSFather"           , "0" )
		PmsHeaderM( @aHeader, , "AFC_UM"    , "Unity"               , "0" )
		PmsHeaderM( @aHeader, , "AFC_QUANT" , "Quantity"            , "0" )
		PmsHeaderM( @aHeader, , "AFC_HDURAC", "TimeDuration"        , "0" )
		PmsHeaderM( @aHeader, , "AFC_CALEND", "Calendar"            , "0" )
		PmsHeaderM( @aHeader, , "AFC_START" , "EstimatedInitialDate", "0" )
		PmsHeaderM( @aHeader, , "AFC_FINISH", "EstimatedFinalDate"  , "0" )
		PmsHeaderM( @aHeader, , "AFC_HORAI" , "EstimatedInitialHour", "0" )
		PmsHeaderM( @aHeader, , "AFC_HORAF" , "EstimatedFinalHour"  , "0" )
		PmsHeaderM( @aHeader, , "AFC_HUTEIS", "TaskUsefulHours"     , "0" )
		PmsHeaderM( @aHeader, , "AFC_DTATUI", "ExecutedInitialDate" , "0" )
		PmsHeaderM( @aHeader, , "AFC_DTATUF", "ExecutedFinalDate"   , "0" )
		PmsHeaderM( @aHeader, , "AFC_CUSTO" , "CostCurrencyOne"     , "0" )
		PmsHeaderM( @aHeader, , "AFC_CUSTO2", "CostCurrencyTwo"     , "0" )
		PmsHeaderM( @aHeader, , "AFC_CUSTO3", "CostCurrencyThree"   , "0" )
		PmsHeaderM( @aHeader, , "AFC_CUSTO4", "CostCurrencyFor"     , "0" )
		PmsHeaderM( @aHeader, , "AFC_CUSTO5", "CostCurrencyFive"    , "0" )
		PmsHeaderM( @aHeader, , "AFC_ORDEM" , "StructureOrder"      , "0" )
		PmsHeaderM( @aHeader, , "AFC_FATURA", "Invoiced"            , "0" )
		PmsHeaderM( @aHeader, , "AFC_VALBDI", "MarkupValue"         , "0" )
		PmsHeaderM( @aHeader, , "AFC_TOTAL" , "SalesGrandTotal"     , "0" )
		PmsHeaderM( @aHeader, , "AFC_OBS"   , "Notes"               , "0" )

	Case cStruct == "PROJECTLISTVIEW"
		WsPutHead(aHeader,"AF8_PROJET","ProjectCode"       )
		WsPutHead(aHeader,"AF8_DATA"  ,"ProjectDate"       )
		WsPutHead(aHeader,"AF8_DESCRI","Description")
		WsPutHead(aHeader,"AF8_REVISA","ProjectRevision"   )
		WsPutHead(aHeader,"AF8_FASE"  ,"ProjectStage"      )
		WsPutHead(aHeader,"AF8_CLIENT","ProjectCliente"    )
		WsPutHead(aHeader,"AF8_LOJA"  ,"ProjectUnit"       )
	
	Case cStruct == "PROJECTSTRUCTVIEW"
		WsPutHead(aHeader,"AFC_PROJET","ProjectCode"       	)
		WsPutHead(aHeader,"AFC_DESCRI","Description"	)
		WsPutHead(aHeader,"AFF_PERC"  ,"ExecutionPercentage"	)
		WsPutHead(aHeader,"AFC_HDURAC","TimeDuration"			)
		WsPutHead(aHeader,"AFC_START" ,"EstimatedInitialDate"	)
		WsPutHead(aHeader,"AFC_FINISH","EstimatedFinalDate"	)
		WsPutHead(aHeader,"AFC_DTATUI","ExecutionInitialDate"	)
		WsPutHead(aHeader,"AFC_DTATUF","ExecutionFinalDate"	)

	Case cStruct == "TASKLISTVIEW"
		WsPutHead(aHeader,"AF9_TAREFA", "Task"						)
		WsPutHead(aHeader,"AF9_NIVEL" ,"Level"						)
		WsPutHead(aHeader,"AF9_DESCRI","Description"				)
		WsPutHead(aHeader,"AF9_UM"    ,"MU"							)
		WsPutHead(aHeader,"AF9_QUANT" ,"Quantity"					)
		WsPutHead(aHeader,"AF9_HDURAC","TimeDuration"			)
		WsPutHead(aHeader,"AF9_CALEND","Calendar"					)
		WsPutHead(aHeader,"AF9_START" ,"EstimatedInitialDate"	)
		WsPutHead(aHeader,"AF9_FINISH","EstimatedFinalDate"	)
		WsPutHead(aHeader,"AF9_HORAI" ,"EstimatedInitialHour"	)
		WsPutHead(aHeader,"AF9_HORAF" ,"EstimatedFinalHour"	)
		WsPutHead(aHeader,"AF9_TPMEDI","MeasurementMethod"		)
		WsPutHead(aHeader,"AF9_HUTEIS","UsefulHours"				)
		WsPutHead(aHeader,"AF9_DTATUI","ExecutionInitialDate"	)
		WsPutHead(aHeader,"AF9_DTATUF","ExecutionFinalDate"	)
		WsPutHead(aHeader,"AF9_CCUSTO","CostCenter"				)
		WsPutHead(aHeader,"AF9_ITEMCC","AccountingItem"			)
		WsPutHead(aHeader,"AF9_CLVL"  ,"ValueClass"				)
		WsPutHead(aHeader,"AF9_FATURA","Invoiced"					)
		WsPutHead(aHeader,"AF9_VATU1" ,"CurrentValue1"			)
		WsPutHead(aHeader,"AF9_VATU2" ,"CurrentValue2"			)
		WsPutHead(aHeader,"AF9_VATU3" ,"CurrentValue3"			)
		WsPutHead(aHeader,"AF9_VATU4" ,"CurrentValue4"			)
		WsPutHead(aHeader,"AF9_VATU5" ,"CurrentValue5"			)
		WsPutHead(aHeader,"AF9_VFIM1" ,"FinalValue1"				)
		WsPutHead(aHeader,"AF9_VFIM2" ,"FinalValue2"				)
		WsPutHead(aHeader,"AF9_VFIM3" ,"FinalValue3"				)
		WsPutHead(aHeader,"AF9_VFIM4" ,"FinalValue4"				)
		WsPutHead(aHeader,"AF9_VFIM5" ,"FinalValue5"				)
		WsPutHead(aHeader,"AF9_VINI1" ,"InitialValue1"			)
		WsPutHead(aHeader,"AF9_VINI2" ,"InitialValue2"			)
		WsPutHead(aHeader,"AF9_VINI3" ,"InitialValue3"			)
		WsPutHead(aHeader,"AF9_VINI4" ,"InitialValue4"			)
		WsPutHead(aHeader,"AF9_VINI5" ,"InitialValue5"			)
		WsPutHead(aHeader,"AF9_EDTPAI","MainWBS"					)
		WsPutHead(aHeader,"AF9_VDSP1" ,"ExpenseValue1"			)
		WsPutHead(aHeader,"AF9_VDSP2" ,"ExpenseValue2"			)
		WsPutHead(aHeader,"AF9_VDSP3" ,"ExpenseValue3"			)
		WsPutHead(aHeader,"AF9_VDSP4" ,"ExpenseValue4"			)
		WsPutHead(aHeader,"AF9_VDSP5" ,"ExpenseValue5"			)
		WsPutHead(aHeader,"AF9_COMPOS","CompositionCode"		)
		WsPutHead(aHeader,"AF9_CNVPRV","CurrencyConversion"	)
		WsPutHead(aHeader,"AF9_EMAIL" ,"SendEMail"				)
		WsPutHead(aHeader,"AF9_GRPCOM","Group"						)
		WsPutHead(aHeader,"AF9_PRIORI","Priority"					)
		WsPutHead(aHeader,"AF9_DTCONV","ConversionDate"			)
		WsPutHead(aHeader,"AF9_CUSTO" ,"CurrencyCost1"			)
		WsPutHead(aHeader,"AF9_CUSTO2","CurrencyCost2"			)
		WsPutHead(aHeader,"AF9_CUSTO3", "CurrencyCost3"			)
		WsPutHead(aHeader,"AF9_CUSTO4","CurrencyCost4"			)
		WsPutHead(aHeader,"AF9_CUSTO5","CurrencyCost5"			)
		WsPutHead(aHeader,"AF9_ORDEM" ,"StructureOrder"			)
		WsPutHead(aHeader,"AF9_RESTRI","Restriction"				)
		WsPutHead(aHeader,"AF9_DTREST","RestrictDate"			)
		WsPutHead(aHeader,"AF9_HRREST","RestrictTime"			)
		WsPutHead(aHeader,"AF9_TXMO2" ,"CurrencyRate2"			)
		WsPutHead(aHeader,"AF9_TXMO3" ,"CurrencyRate3"			)
		WsPutHead(aHeader,"AF9_TXMO4" ,"CurrencyRate4"			)
		WsPutHead(aHeader,"AF9_TXMO5" ,"CurrencyRate5"			)
		WsPutHead(aHeader,"AF9_BDI"   ,"MarkupPercent"			)
		WsPutHead(aHeader,"AF9_VALBDI", "MarkupValue"			)
		WsPutHead(aHeader,"AF9_TOTAL" ,"GrandTotal"				)
		WsPutHead(aHeader,"AF9_PRODFA","InvoiceProductCode"	)

	Case cStruct == "EVENTLISTVIEW"
		WsPutHead(aHeader,"AFP_TAREFA","TaskCode"						)
		WsPutHead(aHeader,"AFP_ITEM"  ,"Item"							)
		WsPutHead(aHeader,"AFP_USO"   ,"UsageCode"					)
		WsPutHead(aHeader,"AFP_DESCRI","EventDescription"			)
		WsPutHead(aHeader,"AFP_DTPREV","EventEstimatedDate"		)
		WsPutHead(aHeader,"AFP_DTCALC","EstimatedDate"				)
		WsPutHead(aHeader,"AFP_DTATU" ,"EventExecutionDate"		)
		WsPutHead(aHeader,"AFP_PERC"  ,"PercentageExecuted"		)
		WsPutHead(aHeader,"AFP_EMAIL" ,"SendEmail"					)
		WsPutHead(aHeader,"AFP_USRFUN","ExecuteUserFunction"		)
		WsPutHead(aHeader,"AFP_EDT"   ,"WbsCode"						)
		WsPutHead(aHeader,"AFP_CLIENT","CustomerCode"				)
		WsPutHead(aHeader,"AFP_LOJA"  ,"CustomerBranch"				)
		WsPutHead(aHeader,"AFP_VALOR" ,"BillValue"					)
		WsPutHead(aHeader,"AFP_MOEDA" ,"BillCurrency"				)
		WsPutHead(aHeader,"AFP_GERPRV","GenerateTemporaryBill"	)
		WsPutHead(aHeader,"AFP_GERTIT","GenerateBillReceivable"	)
		WsPutHead(aHeader,"AFP_COND"  ,"PaymentTerm"					)
		WsPutHead(aHeader,"AFP_NUM"   ,"BillNumber"					)
		WsPutHead(aHeader,"AFP_PREFIX","BillPrefix"					)
		WsPutHead(aHeader,"AFP_NATURE","ClassCode"					)
		WsPutHead(aHeader,"AFP_CTV"   ,"SalesOrderNumber"			)
		WsPutHead(aHeader,"AFP_CTVITE","SalesOrderNumberItem"		)
		WsPutHead(aHeader,"AFP_CTVPER","SalesOrderRelease"			)
		
	Case cStruct == "EXPENSELISTVIEW"
		WsPutHead(aHeader,"AFB_ITEM"  ,"Item"							)
		WsPutHead(aHeader,"AFB_TIPOD" ,"ExpensesType"				)
		WsPutHead(aHeader,"AFB_DESCRI","Description"					)
		WsPutHead(aHeader,"AFB_TAREFA","TaskCode"						)
		WsPutHead(aHeader,"AFB_MOEDA" ,"Currency"						)
		WsPutHead(aHeader,"AFB_SIMBMO","CurrencySymbol"				)
		WsPutHead(aHeader,"AFB_VALOR" , "ExpensesAmount"			)
		WsPutHead(aHeader,"AFB_PROJET","ProjectCode"					)
		WsPutHead(aHeader,"AFB_REVISA","ProjectVersion"				)
		WsPutHead(aHeader,"AFB_ACUMUL","AccumulateCosts"			)
		WsPutHead(aHeader,"AFB_DATPRF", "NecessityDate"				)
		WsPutHead(aHeader,"AFB_RECURS","ResourceCode"				)
		WsPutHead(aHeader,"AFB_ALOC"  ,"AllocatedPercentage"		)
		WsPutHead(aHeader,"AFB_START" ,"InitialAllocationDate"	)
		WsPutHead(aHeader,"AFB_HORAI" ,"AllocationInitialHour"	)
		WsPutHead(aHeader,"AFB_FINISH","FinalAllocationDate"		)
		WsPutHead(aHeader,"AFB_HORAF" ,"AllocationFinalHour"		)
		WsPutHead(aHeader,"AFB_COMPOS","SubcompositionCode"		)
		WsPutHead(aHeader,"AFB_PRODFA","InvoiceProductCode"		)

	Case cStruct == "RELATIONSHIPLISTVIEW"
		WsPutHead(aHeader,"AFD_ITEM"  ,"PredecessorItem"			)
		WsPutHead(aHeader,"AFD_PREDEC","PredecessorTaskCode"		)
		WsPutHead(aHeader,"AFD_DESCRI","TaskDescription"			)
		WsPutHead(aHeader,"AFD_TIPO"  ,"RelationshipType"			)
		WsPutHead(aHeader,"AFD_REVISA","ProjectVersion"				)
		WsPutHead(aHeader,"AFD_HRETAR","RelationshipDelay"			)

	Case cStruct == "TASKDETAILVIEW"
		PmsHeaderM( @aHeader, , "AF9_PROJET","ProjectCode"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_REVISA","Version"						, "0" )
		PmsHeaderM( @aHeader, , "AF9_TAREFA","TaskCode"						, "0" )
		PmsHeaderM( @aHeader, , "AF9_NIVEL" ,"TaskLevel"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_DESCRI","Description"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_UM"    ,"Unit"							, "0" )
		PmsHeaderM( @aHeader, , "AF9_QUANT" ,"Quantity"						, "0" )
		PmsHeaderM( @aHeader, , "AF9_HDURAC","TaskDurationHours"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_CALEND","Calendar"						, "0" )
		PmsHeaderM( @aHeader, , "AF9_START" ,"EstimatedInitialDate"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_FINISH","EstimatedFinalDate"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_HORAI" ,"EstimatedInitialHour"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_HORAF" ,"EstimatedFinalHour"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_TPMEDI","MeasurementMethod"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_HUTEIS","TaskUsefulHours"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_DTATUI","ExecutionInitialDate"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_DTATUF","ExecutionFinalDate"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_CCUSTO","CostCenter"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_ITEMCC","AccountingItem"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_CLVL"  ,"ValueClass"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_FATURA","Invoiced"						, "0" )
		PmsHeaderM( @aHeader, , "AF9_VATU1" ,"CurrencyActualValue1"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_VATU2" ,"CurrencyActualValue2"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_VATU3" ,"CurrencyActualValue3"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_VATU4" ,"CurrencyActualValue4"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_VATU5" ,"CurrencyActualValue5"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_VFIM1" ,"FinalValue1"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VFIM2" ,"FinalValue2"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VFIM3" ,"FinalValue3"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VFIM4" ,"FinalValue4"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VFIM5" ,"FinalValue5"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VINI1" ,"InitialValue1"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VINI2" ,"InitialValue2"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VINI3" ,"InitialValue3"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VINI4" ,"InitialValue4"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VINI5" ,"InitialValue5"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_EDTPAI","MainWBSCode"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VDSP1" ,"ExpenseValue1"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VDSP2" ,"ExpenseValue2"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VDSP3" ,"ExpenseValue3"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VDSP4" ,"ExpenseValue4"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_VDSP5" ,"ExpenseValue5"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_COMPOS","CompositionCode"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_CNVPRV","CurrencyConversion"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_EMAIL" ,"Sendemail"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_GRPCOM","TaskGroup"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_PRIORI","TaskPriority"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_DTCONV","ConversionDate"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_CUSTO1","TaksCost1"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_CUSTO2","TaksCost2"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_CUSTO3","TaksCost3"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_CUSTO4","TaksCost4"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_CUSTO5","TaksCost5"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_ORDEM" ,"StructureOrder"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_RESTRI","RestrictionType"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_DTREST","RestrictionDate"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_HRREST","RestrictionTime"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_TXMO2" ,"RateEntered2"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_TXMO3" ,"RateEntered3"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_TXMO4" ,"RateEntered4"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_TXMO5" ,"RateEntered5"				, "0" )
		PmsHeaderM( @aHeader, , "AF9_BDI"   ,"MarkupCoust"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_VALBDI","MarkupValue"					, "0" )
		PmsHeaderM( @aHeader, , "AF9_TOTAL" ,"SalesGrandTotal"			, "0" )
		PmsHeaderM( @aHeader, , "AF9_PRODFA","InvoiceProductCode"		, "0" )
		PmsHeaderM( @aHeader, , "AF9_OBS"   ,"Notes"							, "0" )

	Case cStruct == "TASKPRODUCTSVIEW"
      WsPutHead(aHeader,"AFA_ITEM"  ,"Item"                         )
      WsPutHead(aHeader,"AFA_PRODUT","ProductCode"                  )
      WsPutHead(aHeader,"AFA_TIPO"  ,"ProductType"                  )
      WsPutHead(aHeader,"AFA_DESCRI","Description"                  )
      WsPutHead(aHeader,"AFA_UM"    ,"Unit"                         )
      WsPutHead(aHeader,"AFA_SEGUM" ,"Unit2"                        )
      WsPutHead(aHeader,"AFA_QUANT" ,"Quantity"                     )
      WsPutHead(aHeader,"AFA_QTSEGU","Quantity2"                    )
      WsPutHead(aHeader,"AFA_MOEDA" ,"Currency"                     )
      WsPutHead(aHeader,"AFA_SIMBMO","CurrencySymbol"               )
      WsPutHead(aHeader,"AFA_CUSTD" ,"StandardCost"                 )
      WsPutHead(aHeader,"AFA_DATPRF","NecessityDate"                )
      WsPutHead(aHeader,"AFA_ACUMUL","CostCalculationMethod"        )
      WsPutHead(aHeader,"AFA_COMPOS","SubcompostionCode"            )
      WsPutHead(aHeader,"AFA_PLANEJ","PlanningCode"                 )
      WsPutHead(aHeader,"AFA_RECALC","RecalculateCosts"             )
      WsPutHead(aHeader,"AFA_PRODFA","InvoiceProductCode"           )   

	Case cStruct == "TASKALLOCATIONVIEW"
      WsPutHead(aHeader,"AFA_ITEM"  ,"Item"                         )
      WsPutHead(aHeader,"AFA_RECURS","ResourceCode"                 )
      WsPutHead(aHeader,"AFA_QUANT" ,"Quantity"                     )
      WsPutHead(aHeader,"AFA_ALOC"  ,"AllocatedPercentage"          )
      WsPutHead(aHeader,"AFA_FIX"   ,"Establish"                    )
      WsPutHead(aHeader,"AFA_PRODUT","ProductCode"                  )
      WsPutHead(aHeader,"AFA_DESCRI","Description"                  )
      WsPutHead(aHeader,"AFA_MOEDA" ,"Currency"                     )
      WsPutHead(aHeader,"AFA_SIMBMO","CurrencySymbol"               )
      WsPutHead(aHeader,"AFA_CUSTD" ,"StandardCost"                 )
      WsPutHead(aHeader,"AFA_UM"    ,"Unit"                         )
      WsPutHead(aHeader,"AFA_SEGUM" ,"Unit2"                        )
      WsPutHead(aHeader,"AFA_QTSEGU","Quantity2"                    )
      WsPutHead(aHeader,"AFA_DATPRF","NecessityDate"                )
      WsPutHead(aHeader,"AFA_ACUMUL","CostCalculationMethod"        )
      WsPutHead(aHeader,"AFA_RECALC","RecalculateCosts"             )
      WsPutHead(aHeader,"AFA_PRODFA","InvoiceProductCode"           )
      
	Case cStruct == "ANNOTATIONSLISTVIEW"
      WsPutHead(aHeader,"AFU_PROJET","ProjectCode"							)
      WsPutHead(aHeader,"AFU_TAREFA","ProjectTask"							)
      WsPutHead(aHeader,"AFU_RECURS","ResourceCode"						)
      WsPutHead(aHeader,"AFU_DATA"  ,"Annotationdate"						)
      WsPutHead(aHeader,"AFU_HORAI" ,"ExecutedInitialHour"				)
      WsPutHead(aHeader,"AFU_HORAF" ,"FinalHourExecuted"					)
      WsPutHead(aHeader,"AFU_HQUANT","NumberofHours"						)
      WsPutHead(aHeader,"AFU_DOCUME","DocumentCode"						)
      WsPutHead(aHeader,"AFU_ITEM"  ,"DocumentItem"						)
		PmsHeaderM( @aHeader, , "DBRECORD"  , "DBRECORD" 					, "-1"  			)

	Case cStruct == "ANNOTATIONVIEW"
		PmsHeaderM( @aHeader, , "AFU_PROJET", "ProjectCode" 				, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_REVISA", "ProjectVersion" 			, "-1"  			)
		PmsHeaderM( @aHeader, , "AFU_TAREFA", "ProjectTask" 				, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_RECURS", "ResourceCode" 				, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_DATA"  , "AnnotationDate" 			, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_HORAI" , "ExecutedInitialHour" 	, "1", "00:00"	)
		PmsHeaderM( @aHeader, , "AFU_HORAF" , "FinalHourExecuted" 		, "1", "00:00"	)
		PmsHeaderM( @aHeader, , "AFU_HQUANT", "NumberOfHours" 			, "1", "0.00"	)
		PmsHeaderM( @aHeader, , "AFU_NUMSEQ", "SequentialNumber" 		, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_COD"   , "ProductCode" 				, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_LOCAL" , "WarehouseCode" 			, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_CTRRVS", "RevisionControl" 			, "-1", "1"		)
		PmsHeaderM( @aHeader, , "AFU_CUSTO1", "AnnotationCost1" 			, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_OBS"   , "Notes" 						, "1"  			)
		PmsHeaderM( @aHeader, , "DBRECORD"  , "DBRECORD" 					, "-1"  			)

		UserFields('AFU',aUserFields)

		For nX := 1 To Len(aUserFields)                                                          
			PmsHeaderM( @aHeader,   , aUserFields[nX]:UserName    ,aUserFields[nX]:UserName	, "1",,.T.)
		Next nX

	Case cStruct == "INSERTANNOTATIONVIEW"
		PmsHeaderM( @aHeader, , "AFU_PROJET", "ProjectCode" 				, "-1"  			)
		PmsHeaderM( @aHeader, , "AFU_REVISA", "ProjectVersion" 			, "-1"  			)
		PmsHeaderM( @aHeader, , "AFU_TAREFA", "ProjectTask" 				, "-1"  			)
		PmsHeaderM( @aHeader, , "AFU_RECURS", "ResourceCode" 				, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_DATA"  , "AnnotationDate" 			, "1"				)
		PmsHeaderM( @aHeader, , "AFU_HORAI" , "ExecutedInitialHour" 	, "1", "00:00"	)
		PmsHeaderM( @aHeader, , "AFU_HORAF" , "FinalHourExecuted" 		, "1", "00:00"	)
		PmsHeaderM( @aHeader, , "AFU_HQUANT", "NumberOfHours" 			, "1", "0.00"	)
		PmsHeaderM( @aHeader, , "AFU_NUMSEQ", "SequentialNumber" 		, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_COD"   , "ProductCode" 				, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_LOCAL" , "WarehouseCode" 			, "1"  			)
		PmsHeaderM( @aHeader, , "AFU_CTRRVS", "RevisionControl" 			, "-1", "1"		)
		PmsHeaderM( @aHeader, , "AFU_CUSTO1", "AnnotationCost1" 			, "1" , ""		)
		PmsHeaderM( @aHeader, , "AFU_OBS"   , "Notes" 						, "1"  			)

		UserFields('AFU',aUserFields)

		For nX := 1 To Len(aUserFields)
			PmsHeaderM( @aHeader, , aUserFields[nX]:UserName    ,aUserFields[nX]:UserName	, "1",,.T.)
		Next nX

	Case cStruct == "CONFIRMATIONSLISTVIEW"
      WsPutHead(aHeader,"AFF_PROJET","ProjectCode"							)
      WsPutHead(aHeader,"AFF_TAREFA","TaskCode"								)
      WsPutHead(aHeader,"AFF_DATA"  ,"ReferenceDate"						)
      WsPutHead(aHeader,"AFF_QUANT" ,"QuantityExecuted"					)
      WsPutHead(aHeader,"AFF_PERC"  ,"PercentageExecuted"				)
      WsPutHead(aHeader,"AFF_OCORRE","OccurrenceCode"						)
      WsPutHead(aHeader,"AFF_OCDESC","OccurrenceDescription"			)
      WsPutHead(aHeader,"AFF_CONFIR","DeliveryAuthorization"			)
		PmsHeaderM( @aHeader, , "DBRECORD"  , "DBRECORD" 					, "-1"  			)
      
	Case cStruct == "RESOURCEVIEW"

      WsPutHead(aHeader,"AE8_RECURS","ResourceCode"						)
      WsPutHead(aHeader,"AE8_DESCRI","ResourceName"						)
      WsPutHead(aHeader,"AE8_CALEND","Calendar"								)
      WsPutHead(aHeader,"AE8_EQUIP" ,"TeamCode"								)
      WsPutHead(aHeader,"AED_DESCRI","TeamName"								)

	Case cStruct == "TEAMVIEW"
      WsPutHead(aHeader,"AED_EQUIP" ,"TeamCode"								)
      WsPutHead(aHeader,"AED_DESCRI","TeamName"								)

	Case cStruct == "OCORRENCEVIEW"
      WsPutHead(aHeader,"AE7_CODIGO","OcorrenceCode"						)
      WsPutHead(aHeader,"AE7_DESCRI","OcorrenceDescription"				)

	Case cStruct == "CONFIRMATIONVIEW"
		PmsHeaderM( @aHeader, , "AFF_PROJET", "ProjectCode" 					, "0"  	)
		PmsHeaderM( @aHeader, , "AFF_REVISA", "ProjectVersion" 				, "-1" 	)
		PmsHeaderM( @aHeader, , "AFF_TAREFA", "TaskCode" 						, "0"  	)
		PmsHeaderM( @aHeader, , "AFF_DESCRI", "TaskDescription" 				, "-1" 	)
		PmsHeaderM( @aHeader, , "AFF_DATA"  , "ReferenceDate" 				, "1"  	)
//		PmsHeaderM( @aHeader, , "AFF_HORAI" , "InitialHour"	 				, "1"  	)
//		PmsHeaderM( @aHeader, , "AFF_HORAF" , "FinalHour"	 					, "1"  	)
		PmsHeaderM( @aHeader, , "AFF_QUANT" , "QuantityExecuted" 			, "1"  	)
		PmsHeaderM( @aHeader, , "AFF_PERC"  , "PercentageExecuted" 			, "1"  	)
		PmsHeaderM( @aHeader, , "AFF_OCORRE", "OccurrenceCode" 				, "1"  	)
		PmsHeaderM( @aHeader, , "AFF_OCDESC", "OccurrenceDescription" 		, "-1" 	)
		PmsHeaderM( @aHeader, , "AFF_CONFIR", "DeliveryAuthorization"		, "1" 	)
		PmsHeaderM( @aHeader, , "AFF_OBS"   , "Notes" 							, "1"		)
		PmsHeaderM( @aHeader, , "AF9_QUANT" , "TaskQtdTot"		 				, "-1" 	)
		PmsHeaderM( @aHeader, , "DBRECORD"  , "DBRECORD" 						, "-1"  	)
		
	Case cStruct == "GANTTTASKVIEW"
      WsPutHead(aHeader, "AF9_PROJET","ProjectCode"					)
      WsPutHead(aHeader, "AF9_TAREFA","TaskCode"						 )
      WsPutHead(aHeader, "AF9_NIVEL" ,"Level"							 )
		WsPutHead(aHeader, "AF9_DESCRI","TaskDescription"			)
		WsPutHead(aHeader, "AF9_HDURAC","TimeDuration"				 )
		WsPutHead(aHeader, "AF9_CALEND","Calendar"					 )
		WsPutHead(aHeader, "AF9_START" ,"EstimatedInitialDate"	)
		WsPutHead(aHeader, "AF9_FINISH","EstimatedFinalDate"		 )
		WsPutHead(aHeader, "AF9_HORAI" ,"EstimatedInitialHour"	 )
		WsPutHead(aHeader, "AF9_HORAF" ,"EstimatedFinalHour"		 )
		WsPutHead(aHeader, "AF9_DTATUI","ExecutionInitialDate"	 )
		WsPutHead(aHeader, "AF9_DTATUF","ExecutionFinalDate"		 )
		WsPutHead(aHeader, "AF9_QUANT" ,"Quantity"		 )
		PmsHeaderM( @aHeader, , "DBRECORD"  , "DBRECORD" 					, "-1"  			)

/*	WSDATA POC                			As Float		OPTIONAL 
	WSDATA CPM		           			As Integer  OPTIONAL
	WSDATA Resources          			As STRING 	OPTIONAL
	WSDATA DbRecord           			As Integer	OPTIONAL
	WSDATA Bitmap             			As STRING 	OPTIONAL	
*/		      
EndCase

RestArea(aArea)
Return(aHeader)

/*
‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±																		   						±±
±±                            FUNCOES AUXILIARES                           ±±
±±																		   						±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ
*/
/*/
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±⁄ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒø±±
±±≥FunáÑo    ≥PmsHeaderM≥Autor  ≥ Cristiano Denardi     ≥ Data ≥11.08.2005 ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥          ≥Rotina de recuperacao do header das estruturas do PMS        ≥±±
±±≥          ≥Modelo 2, sem uso da funcao WsPutHead()					         ≥±±
±±≥          ≥Adiciona informacoes no aHeader conforme parametros. 		   ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥Parametros≥ExpA1: aHeader a ser modificado pela funcao                  ≥±±
±±≥          ≥ExpC2: Classe de WebService que possua a estrutura do Header ≥±±
±±≥          ≥ExpC3: Nome do campo a ser procurado no SX3                  ≥±±
±±≥          ≥ExpC4: Nome do campo para ser manipulado internamente no WS  ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥Retorno   ≥Nil                                                          ≥±±
±±√ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥±±
±±≥Uso       ≥ Portal PMS                                                  ≥±± 
±±¿ƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ
/*/
Static Function PmsHeaderM( aHdr, cClass, cCpo, cNameCpo, cEdita, cIniVlr,lUserField )

Local aArea			:= GetArea()
Local nX				:= 0

Default	cEdita	:= "1"
Default	aHdr		:= {}
Default	cCpo		:= ""
Default	cNameCpo	:= ""
Default	cIniVlr	:= ""
Default	cClass	:= "BrwHeaderPms"  
Default	lUserField	:= .F.

/*
 .: Padrao de cEdita :.
-1	- nunca edita (nem qdo for inclusao)
0	- nao edita (normal)
1	- edita
*/

nX := Len(aHdr)

If !( Empty(cCpo) .Or. Empty(cNameCpo) )
	aadd( aHdr, WSClassNew(cClass) )
	nX++
	If cCpo == "DBRECORD"
		aHdr[nX]:HeaderTitle  	:= cCpo
		aHdr[nX]:HeaderField   	:= cCpo
		aHdr[nX]:HeaderPicture	:= '@9'
		aHdr[nX]:HeaderSize    	:= 10
		aHdr[nX]:HeaderDec     	:= 0
		aHdr[nX]:HeaderType    	:= "H"
		aHdr[nX]:HeaderType2   	:= "N"
		aHdr[nX]:HeaderComboBox	:= ""
		aHdr[nX]:HeaderOblig   	:= .F.
		aHdr[nX]:HeaderF3      	:= ""
		aHdr[nX]:HeaderFolder  	:= ""
		aHdr[nX]:HeaderOrder  	:= "999"
		aHdr[nX]:Editable  		:= "-1"
		aHdr[nX]:ProprietyName	:= cNameCpo
		aHdr[nX]:InitialValue	:= cIniVlr
		aHdr[nX]:UserField		:=	.F.
	Else
		aHdr[nX]:HeaderTitle  	:= RetTitle(cCpo)
		aHdr[nX]:HeaderField   	:= cCpo
		aHdr[nX]:HeaderPicture	:= SX3->X3_PICTURE
		aHdr[nX]:HeaderSize    	:= SX3->X3_TAMANHO
		aHdr[nX]:HeaderDec     	:= SX3->X3_DECIMAL
		aHdr[nX]:HeaderType    	:= SX3->X3_TIPO
		aHdr[nX]:HeaderComboBox	:= X3CBox()
		aHdr[nX]:HeaderOblig   	:= X3Obrigat(cCpo)
		aHdr[nX]:HeaderF3      	:= SX3->X3_F3
		aHdr[nX]:HeaderFolder  	:= SX3->X3_FOLDER
		aHdr[nX]:HeaderOrder  	:= SX3->X3_ORDEM
		aHdr[nX]:Editable  		:= cEdita
		aHdr[nX]:ProprietyName	:= cNameCpo
		If !Empty(cIniVlr)
			aHdr[nX]:InitialValue	:= cIniVlr
		Else
//			aHdr[nX]:InitialValue	:= AllToChar(CriaVar(cCpo,.T.))
		Endif
		aHdr[nX]:UserField		:=	lUserField
		aHdr[nX]:HeaderType2   	:= Iif(SX3->X3_TIPO=="M","C",SX3->X3_TIPO)
	Endif
	
Endif
		
RestArea( aArea )
Return
