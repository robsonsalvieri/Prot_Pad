#INCLUDE "PROTHEUS.CH"

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณTipos de Questaoณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
#DEFINE UNICA_ESCOLHA 		"1"		//Unica Escolha
#DEFINE MULTIPLA_ESCOLHA 	"2"		//Multipla Escolha
#DEFINE DISSERTATIVA 		"3"		//Dissertativa

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณTipos de exibicao da alternativaณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
#DEFINE SEQUENCIAL 			"1"		//Sequencial
#DEFINE COLUNAS 			"2"		//Colunas
#DEFINE LINHAS 				"3"		//Linhas

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณWSGPRXFUN บAutor  ณLuiz Felipe Couto    บ Data ณ  02/03/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Este fonte possui as funcoes de apoio utilizadas pelos WS   บฑฑ
ฑฑบ          ณ do GPR.                                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ                                                             บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetResearcบAutor  ณLuiz Felipe Couto    บ Data ณ  23/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Pesquisa com os dados    บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetResearch( oObjeto, cAlias )

Local lRetorno 	:= .T.			//Retorno da Funcao
Local aArea 	:= GetArea()	//Area Atual
Local cAliasSKL	:= "SKL"		//Alias da tabela SKL

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Code 					:= ( cAlias )->KC_CODPQ
oObjeto:Description 			:= ( cAlias )->KC_DESC
oObjeto:LastInactivation 		:= ( cAlias )->KC_DATINAT
oObjeto:Status 					:= ( cAlias )->KC_STATUS
oObjeto:Media 					:= ( cAlias )->KC_MIDIA
oObjeto:InitialDate 			:= ( cAlias )->KC_DTDE
oObjeto:FinalDate 				:= ( cAlias )->KC_DTATE
oObjeto:InitialHour 			:= ( cAlias )->KC_INICIO
oObjeto:FinalHour 				:= ( cAlias )->KC_FINAL
oObjeto:TargetPublic 			:= ( cAlias )->KC_PUBLICO
oObjeto:Responsible 			:= ( cAlias )->KC_RESP
oObjeto:ObjectiveCode 			:= ( cAlias )->KC_CODOBJ
oObjeto:ObjectiveDescription 	:= MSMM( ( cAlias )->KC_CODOBJ )
oObjeto:ListCode 				:= ( cAlias )->KC_CODLST
oObjeto:ListDescription 		:= MSMM( ( cAlias )->KC_CODLST )

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณBusca dados da Regraณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
( cAliasSKL )->( DbSetOrder( 1 ) )

If ( cAliasSKL )->( DbSeek( xFilial( "SKL" ) + ( cAlias )->KC_CODPQ ) )
	oObjeto:ListOfRule := {}
	
	While !( cAliasSKL )->( EOF() ) .AND. ( cAliasSKL )->KL_FILIAL == xFilial( "SKL" ) .AND. ;
		( cAliasSKL )->KL_CODPQ == ( cAlias )->KC_CODPQ
		
		aAdd( oObjeto:ListOfRule, WsClassNew( "RuleView" ) )
		nLenRule := Len( oObjeto:ListOfRule )
		
		GetRule( @oObjeto:ListOfRule[nLenRule], cAliasSKL )
		
		( cAliasSKL )->( DbSkip() )
	EndDo
EndIf

RestArea( aArea )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetQuest  บAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Questionario com os dadosบฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetQuest( oObjeto, cAlias )

Local lRetorno 	:= .T.			//Retorno da Funcao
Local aArea 	:= GetArea()	//Area Atual

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejeto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Code 			:= ( cAlias )->KP_CODQUE
oObjeto:Description 	:= ( cAlias )->KP_DESC

RestArea( aArea )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetGroup  บAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Grupo com os dados       บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetGroup( oObjeto, cAlias, cAliasSKR )

Local lRetorno 		:= .T.			//Retorno da Funcao

Local aArea 		:= GetArea()	//Area Atual
Local aAreaSKR		:= {}			//Area atual da tabela SKR

DEFAULT cAliasSKR 	:= "SKR"

aAreaSKR 				:= ( cAliasSKR )->( GetArea() )

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejeto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Code 			:= ( cAlias )->KE_CODGRP
oObjeto:Description 	:= ( cAlias )->KE_DESC
oObjeto:Enumerate 		:= ( cAlias )->KE_ENUMERA
oObjeto:Item			:= ( cAliasSKR )->KR_ITEM

RestArea( aArea )
RestArea( aAreaSKR )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetSubGrouบAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto SubGrupo com os dados    บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑบ          ณ ExpC3 : Alias da tabela SKE para busca descricao do grupo   บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetSubGroup( oObjeto, cAlias, cAliasSKR )

Local lRetorno 	:= .T.								//Retorno da Funcao

Local aArea 		:= GetArea()						//Area Atual
Local aAreaSKR		:= {}								//Area atual da tabela SKR

DEFAULT cAliasSKR	:= "SKR"

aAreaSKR 					:= ( cAliasSKR )->( GetArea() )

oObjeto:Code 				:= ( cAlias )->KF_CODSUBG
oObjeto:Description 		:= ( cAlias )->KF_DESC
oObjeto:Item				:= ( cAliasSKR )->KR_ITEM

RestArea( aArea )
RestArea( aAreaSKR )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetQuestioบAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Questao com os dados     บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑบ          ณ ExpC3 : Alias da tabela SKE para preenchimento da descricao บฑฑ
ฑฑบ          ณ         do Grupo                                            บฑฑ
ฑฑบ          ณ ExpC4 : Alias da tabela SKF para preenchimento da descricao บฑฑ
ฑฑบ          ณ         do SubGrupo                                         บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetQuestion( oObjeto, cAlias, cAliasSKE, cAliasSKF, cAliasSKR )

Local lRetorno 	:= .T.      						//Retorno da Funcao

Local aArea 	:= GetArea()						//Area atual
Local aAreaSKE  := ( cAliasSKE )->( GetArea() )	//Area atual da tabela SKE
Local aAreaSKF  := ( cAliasSKF )->( GetArea() )	//Area atual da tabela SKF
Local aAreaSKR	:= {}								//Area atual da tabela SKR

DEFAULT cAliasSKR := "SKR"

aAreaSKR						:= ( cAliasSKR )->( GetArea() )

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejeto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Code 					:= ( cAlias )->KG_CODQST
oObjeto:Type 					:= ( cAlias )->KG_TIPOQST
oObjeto:ExhibitionType 			:= ( cAlias )->KG_TIPEXIB
oObjeto:Repeat 					:= ( cAlias )->KG_REPETE
oObjeto:DescriptionCode 		:= ( cAlias )->KG_CODCOMP
oObjeto:Description 			:= MSMM( ( cAlias )->KG_CODCOMP )
oObjeto:Resume 					:= ( cAlias )->KG_DESC
oObjeto:GroupCode 				:= ( cAlias )->KG_CODGRP

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณDescricao do Grupoณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
( cAliasSKE )->( DbSetOrder( 1 ) )

If ( cAliasSKE )->( MsSeek( xFilial( "SKE") + ( cAlias )->KG_CODGRP ) )
	oObjeto:GroupDescription 	:= ( cAliasSKE )->KE_DESC
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณDescricao do SubGrupoณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:SubGroupCode 		:= ( cAlias )->KG_CODSUBG

( cAliasSKF )->( DbSetOrder( 1 ) )

If ( cAliasSKF )->( MsSeek( xFilial( "SKF") + ( cAlias )->KG_CODGRP + ( cAlias )->KG_CODSUBG ) )
	oObjeto:SubGroupDescription := ( cAliasSKF )->KF_DESC
EndIf

oObjeto:Note 					:= ( cAlias )->KG_OBSERV
oObjeto:SelectionLimit 			:= ( cAlias )->KG_LIMSELE
oObjeto:ComplementMaxLength 	:= ( cAlias )->KG_LIMCOMP
oObjeto:MaxLength 				:= ( cAlias )->KG_LIMRESP
oObjeto:Rule 					:= ( cAlias )->KG_REGRA
oObjeto:Obligation 				:= ( cAlias )->KG_OBRIGAT
oObjeto:Grade		 			:= ( cAlias )->KG_PONTO
oObjeto:Item					:= ( cAliasSKR )->KR_ITEM
oObjeto:ObjectiveCode 			:= ( cAlias )->KG_CODOBJ
oObjeto:ObjectiveDescription 	:= MSMM( ( cAlias )->KG_CODOBJ )

RestArea( aArea )
RestArea( aAreaSKE )
RestArea( aAreaSKF )
RestArea( aAreaSKR )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetAlternaบAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Alternativa com os dados บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetAlternative( oObjeto, cAlias )

Local lRetorno 	:= .T.			//Retorno da Funcao
Local aArea 	:= GetArea()	//Area atual

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejeto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Code 			:= ( cAlias )->KH_CODALT
oObjeto:Description 	:= ( cAlias )->KH_DESC
oObjeto:Complement 		:= ( cAlias )->KH_POSCOMP
oObjeto:Grade	 		:= ( cAlias )->KH_PONTO

RestArea( aArea )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetOption บAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Opcao com os dados       บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetOption( oObjeto, cAlias )

Local lRetorno 	:= .T.			//Retorno da Funcao
Local aArea 	:= GetArea()	//Area atual

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejeto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Code 			:= ( cAlias )->KI_CODCOL
oObjeto:Description 	:= ( cAlias )->KI_DESC

RestArea( aArea )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGetRule   บAutor  ณLuiz Felipe Couto    บ Data ณ  25/02/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Preenche as propriedades do objeto Regra com os dados       บฑฑ
ฑฑบ          ณ do sistema.                                                 บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑบ          ณ ExpC2 : Alias da tabela                                     บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function GetRule( oObjeto, cAlias )

Local lRetorno 	:= .T.			//Retorno da Funcao
Local aArea 	:= GetArea()	//Area atual
Local cAliasSKM := "SKM"		//Alias da tabela SKM

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณSeta as propriedades do obejeto passado como parametroณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
oObjeto:Item 			:= ( cAlias )->KL_ITEM
oObjeto:WebText 		:= ( cAlias )->KL_TEXWEB
oObjeto:WebPicture 		:= ( cAlias )->KL_PICTURE
oObjeto:WebType 		:= ( cAlias )->KL_TIPO
oObjeto:ResearchedKey	:= ( cAlias )->KL_CHAVE

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณBusca dados da Validacaoณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
( cAliasSKM )->( DbSetOrder( 1 ) )

If ( cAliasSKM )->( DbSeek( xFilial( "SKM" ) + ( cAlias )->KL_REGERP ) )
	oObjeto:Validation := WsClassNew( "ValidationView" )	

	oObjeto:Validation:Code			:= ( cAliasSKM )->KM_CODVAL
	oObjeto:Validation:Description	:= ( cAliasSKM )->KM_DSCVAL
	oObjeto:Validation:ValFunction	:= ( cAliasSKM )->KM_FNCVAL
EndIf

RestArea( aArea )

Return lRetorno

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณPutResult บAutor  ณLuiz Felipe Couto    บ Data ณ  10/03/05   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Grava o resultado no sistema com os dados do objeto         บฑฑ
ฑฑบ          ณ Resultado.                                                  บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ ExpO1 : Objeto WS                                           บฑฑ
ฑฑฬออออออออออุอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณSIGAGPR     						                           บฑฑ
ฑฑศออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑบAnalista  ณ Data/Bops/Ver ณManutencao Efetuada                      	   บฑฑ
ฑฑฬออออออออออุออออออออัออออออุอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑศออออออออออฯออออออออฯออออออฯอออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Function PutResult( oPesquisa )

Local cAliasSKG	:= "SKG"				//Alias da Tabela SKG
Local cAliasSKS := "SKS"				//Alias da Tabela SKS
Local cAliasSKT := "SKT"				//Alias da Tabela SKT
Local cAliasSKU := "SKU"				//Alias da Tabela SKU
Local cDelete	:= ""

Local nI := 0							//Variavel de apoio
Local nJ := 0							//Variavel de apoio
Local nK := 0							//Variavel de apoio

Local lRetorno := .T.					//Retorno da Funcao
Local lInclui := .T.					//Append

Local aArea := GetArea()				//Area atual

Begin Transaction
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณTabelas:                    ณ
	//ณSKG - Questao               ณ
	//ณSKS - Cabecalho de Respostasณ
	//ณSKT - Questoes x Respondenteณ
	//ณSKU - Alternativa x Questao ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณDados do Resultadoณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	( cAliasSKS )->( DbSetOrder( 1 ) )
	
	If ( cAliasSKS )->( MsSeek( xFilial( "SKS" ) + ;
		PadR( oPesquisa:Code, 6 ) + ;
		PadR( oPesquisa:Result:ResearchedKey, 40 ) ) )
		
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณAtualiza Resultadoณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		lInclui := .F.
	Else
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณInclui Resultadoณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		lInclui := .T.
	EndIf

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณGrava os Dados do Resultadoณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If RecLock( "SKS", lInclui )
		( cAliasSKS )->KS_FILIAL	:= xFilial( "SKS" )
		( cAliasSKS )->KS_CODPESQ	:= oPesquisa:Code
		( cAliasSKS )->KS_CODRESP	:= oPesquisa:Result:ResearchedKey
		( cAliasSKS )->KS_DATINI 	:= oPesquisa:Result:InitialDate
		( cAliasSKS )->KS_DATFIM 	:= oPesquisa:Result:FinalDate
		( cAliasSKS )->KS_HORAINI	:= oPesquisa:Result:InitialHour
		( cAliasSKS )->KS_HORAFIM	:= oPesquisa:Result:FinalHour
	EndIf

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณQuestionariosณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤู
	For nI := 1 To Len( oPesquisa:ListOfQuestionary )
		cDelete := "DELETE FROM "
		cDelete += RetSQLName( "SKU" ) + " "
		cDelete += "WHERE "
		cDelete += "KU_FILIAL = '" + xFilial( "SKU" ) + "' AND "
		cDelete += "KU_CODPESQ = '" + oPesquisa:Code + "' AND "
		cDelete += "KU_CODQST = '" + oPesquisa:ListOfQuestionary[nI]:Code + "' AND "
		cDelete += "KU_CODRESP = '" + oPesquisa:Result:ResearchedKey + "'"
		
		TcSQLExec( cDelete )
		TcRefresh( cAliasSKU )

		cDelete := "DELETE FROM "
		cDelete += RetSQLName( "SKT" ) + " "
		cDelete += "WHERE "
		cDelete += "KT_FILIAL = '" + xFilial( "SKT" ) + "' AND "
		cDelete += "KT_CODPESQ = '" + oPesquisa:Code + "' AND "
		cDelete += "KT_CODQST = '" + oPesquisa:ListOfQuestionary[nI]:Code + "' AND "
		cDelete += "KT_CODRESP = '" + oPesquisa:Result:ResearchedKey + "'"

		TcSQLExec( cDelete )
		TcRefresh( cAliasSKT )

		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณDados da Respostaณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		For nJ := 1 To Len( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer )
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณCabecalho da Repostaณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			( cAliasSKT )->( DbSetOrder( 1 ) )
			
			If ( cAliasSKT )->( MsSeek( xFilial( "SKT" ) + ;
				PadR( oPesquisa:Code, 6 ) + ;
				PadR( oPesquisa:Result:ResearchedKey, 40 ) + ;
				PadR( oPesquisa:ListOfQuestionary[nI]:Code, 6 ) + ;
				PadR( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:AnswerHeader:QuestionCode, 6 ) ) )
				
				//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
				//ณAtualiza Cabecalho da Respostaณ
				//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
				lInclui := .F.
			Else
				//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
				//ณInclui Cabecalho da Respostaณ
				//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
				lInclui := .T.
			EndIf
	
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณGrava Dados do Cabecalho da Respostaณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If RecLock( "SKT", lInclui )
				( cAliasSKT )->KT_FILIAL	:= xFilial( "SKT" )
				( cAliasSKT )->KT_CODPESQ	:= oPesquisa:Code
				( cAliasSKT )->KT_CODQST	:= oPesquisa:ListOfQuestionary[nI]:Code
				( cAliasSKT )->KT_CODRESP	:= oPesquisa:Result:ResearchedKey
				( cAliasSKT )->KT_CODQUES	:= oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:AnswerHeader:QuestionCode
				
				//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
				//ณItens da Respostaณ
				//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
				For nK := 1 To Len( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem )
					( cAliasSKG )->( DbSetOrder( 1 ) )
					
					If ( cAliasSKG )->( MsSeek( xFilial( "SKG" ) + ;
						PadR( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:AnswerHeader:QuestionCode, 6 ) ) )
						
						If ( cAliasSKG )->KG_TIPOQST == UNICA_ESCOLHA .AND. ;
							( ( cAliasSKG )->KG_TIPEXIB == SEQUENCIAL .OR. ;
							( cAliasSKG )->KG_TIPEXIB == LINHAS )
							
							( cAliasSKU )->( DbSetOrder( 1 ) )
							
							If ( cAliasSKU )->( MsSeek( xFilial( "SKU" ) + ;
								PadR( oPesquisa:Code, 6 ) + ;
								PadR( oPesquisa:Result:ResearchedKey, 40 ) + ;
								PadR( oPesquisa:ListOfQuestionary[nI]:Code, 6 ) + ;
								PadR( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:AnswerHeader:QuestionCode, 6 ) ) )
								
								//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
								//ณAtualiza Item da Respostaณ
								//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
								lInclui := .F.
							Else
								//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
								//ณInclui Item da Respostaณ
								//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
								lInclui := .T.
							EndIf
						Else
							( cAliasSKU )->( DbSetOrder( 1 ) )
							
							If ( cAliasSKU )->( MsSeek( xFilial( "SKU" ) + ;
								PadR( oPesquisa:Code, 6 ) + ;
								PadR( oPesquisa:Result:ResearchedKey, 40 ) + ;
								PadR( oPesquisa:ListOfQuestionary[nI]:Code, 6 ) + ;
								PadR( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:AnswerHeader:QuestionCode, 6 ) + ;
								PadR( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:AlternativeCode, 2 ) ) )
								
								//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
								//ณAtualiza Item da Respostaณ
								//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
								lInclui := .F.
							Else
								//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
								//ณInclui Item da Respostaณ
								//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
								lInclui := .T.
							EndIf
						EndIf
					EndIf
				
					//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
					//ณGrava Item da Respostaณ
					//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
					If RecLock( "SKU", lInclui )
						( cAliasSKU )->KU_FILIAL	:= xFilial( "SKU" )
						( cAliasSKU )->KU_CODPESQ	:= oPesquisa:Code
						( cAliasSKU )->KU_CODQST	:= oPesquisa:ListOfQuestionary[nI]:Code
						( cAliasSKU )->KU_CODRESP	:= oPesquisa:Result:ResearchedKey
						( cAliasSKU )->KU_CODQUES	:= oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:AnswerHeader:QuestionCode
	
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณTipos:                    ณ
						//ณUnica Escolha Sequencial  ณ
						//ณUnica Escolha em Linha    ณ
						//ณMultipla Escoha Sequencialณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If !Empty( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:AlternativeCode )
							( cAliasSKU )->KU_CODALT 	:= oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:AlternativeCode
						EndIf
	
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณTipos:                     ณ
						//ณMultipla Escolha em Linhas ณ
						//ณMultipla Escolha em Colunasณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If !Empty( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:ColumnCode )
							( cAliasSKU )->KU_CODCOL 	:= oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:ColumnCode
						EndIf
						
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณComplemento de Questaoณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If !Empty( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:Complement )
							( cAliasSKU )->KU_COMPLEM	:= oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:Complement
						EndIf
						
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณDissertativaณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤู
						If !Empty( oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:OpenQuestion )
							MSMM( ,,, oPesquisa:ListOfQuestionary[nI]:ListOfAnswer[nJ]:ListOfAnswerItem[nK]:OpenQuestion, 1,,, "SKU", "KU_CODDISS" )
						EndIf
					EndIf
				Next nK
			EndIf
		Next nJ
	Next nI
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณGrava Registrosณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	DbCommit()
	MsUnlockAll()
End Transaction

RestArea( aArea )

Return lRetorno

