#include 'totvs.ch'

/*/{Protheus.doc} OFSoResponseBodyError
    Classe que representa o corpo da resposta de erro do SO JD
    
    @type class
    @author Vinicius Gati
    @since 01/07/2021
/*/
Class OFSoResponseBodyError
    Public Data oRequest
    Public Data jData
	Public Data nCode
    Public Method New()
    Public Method ToJson()
EndClass

/*/{Protheus.doc} New
    Construtor Simples

    @type method
    @author Vinicius Gati
    @since 01/07/2021
/*/
Method New(nCode, oRequest, jData) Class OFSoResponseBodyError
	::nCode := nCode
    ::oRequest := oRequest
    ::jData := jData
Return SELF

/*/{Protheus.doc} ToJson
    retorna o json no formato esperado nas respostas do SO JD

    @type method
    @author Vinicius Gati
    @since 01/07/2021
/*/
Method ToJson() Class OFSoResponseBodyError
    local jRet := JsonObject():New()
	if valtype(self:jData) == 'J'
    	jRet := self:jData
	else
		jRet["data"] := self:jData:toJSON()
	endif
    jRet["name"] := self:oRequest:toJson()["name"]
	jRet["code"] := self:nCode
Return jRet
