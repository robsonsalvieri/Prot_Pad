#include 'totvs.ch'
#include "tlpp-core.th"

/*/{Protheus.doc} OFSoRequestReceived
	Classe que representa uma request do DMS mas com os adicionais do service operations
	
	@type class
	@author Vinicius Gati
	@since 09/08/2021
/*/
Class OFSoRequestReceived from OFDMSRequest

	public method New() CONSTRUCTOR
EndClass

/*/{Protheus.doc} New
	Construtor Simples

	@type method
	@author Vinicius Gati
	@since 09/08/2021
/*/
Method New(cRequestName, cReqBody) Class OFSoRequestReceived
local cJson
local cErro := ""
	_Super:New()
	// ::oSoRequestBody := OFSoRequestBody():New(cReqBody)
	// ::oSoRequestBody:SetName(cRequestName)

	cMsgCode := FM_SQL("select VX5_CODIGO FROM "+RetSqlName("VX5")+" WHERE VX5_CHAVE = '083' AND UPPER(VX5_DESCRI) = upper('"+cRequestName+"') ")
	::Set("VK5_MESSAG", cMsgCode)
//	::Set("VK5_REQBOD", cReqBody)
	cJson := FGX_JSONform( cReqBody, .T., @cErro )
	::Set("VK5_REQBOD",  iif( empty( cErro ), cJson, cReqBody ) )
	::SetTypeServiceOperations()
	::SetOriginSO()
Return SELF
