// ͻ
//  Versao  02     
// ͼ
#Include "VEICA690.CH"

/*


Ŀ
Funcao     VEICA690  Autor  Andre Luis Almeida     Data  21/10/14 
Ĵ
Descricao  Cadastro de Metas de Interesses (Oport.Negocios)           
ٱ


*/
Function VEICA690()
PRIVATE cCadastro := STR0001 // Cadastro de Metas de Interesses (Oport.Negocios)
axCadastro("VDY",cCadastro,,"VCA690VLD()")
Return .T.

/*


Ŀ
Funcao     VCA690VLD Autor  Andre Luis Almeida     Data  21/10/14 
Ĵ
Descricao  Validacao do OK na janela                                  
ٱ


*/
Function VCA690VLD()
Local lRet := .t.
If ( Empty(M->VDY_CAMPOP) .and. Empty(M->VDY_MESMET) ) .or. ( Empty(M->VDY_CAMPOP) .and. Empty(M->VDY_ANOMET) )
	MsgStop(STR0002,STR0003) // Favor preencher corretamente os dados. / Atencao
	lRet := .f.
EndIf
Return(lRet)

/*


Ŀ
Funcao     VCA690MAR Autor  Andre Luis Almeida     Data  21/10/14 
Ĵ
Descricao  Validacao da Marca                                         
ٱ


*/
Function VCA690MAR()   
dbSelectArea("VE1")
dbSetOrder(1)
if !dbSeek(xFilial("VE1")+M->VDY_CODMAR)
	Return(.f.)
Endif
MV_PAR01 := M->VDY_CODMAR
M->VDY_MODVEI := space(TamSX3("VDY_MODVEI")[1])
Return(.t.)

/*


Ŀ
Funcao     VCA690MOD Autor  Andre Luis Almeida     Data  21/10/14 
Ĵ
Descricao  Validacao do Modelo                                        
ٱ


*/
Function VCA690MOD()   
dbSelectArea("VV2")
dbSetOrder(1)
if !dbSeek(xFilial("VV2")+M->VDY_CODMAR+M->VDY_MODVEI)
	Return(.f.)
Endif
Return(.t.)

/*


Ŀ
Funcao     MenuDef   Autor  Andre Luis Almeida     Data  21/10/14 
Ĵ
Descricao  MenuDef padrao                                             
ٱ


*/
Static Function MenuDef()
Local aRotina := {  { oemtoansi(STR0004),"AxPesqui", 0 , 1,,.F.},;  // "Pesquisar"
                    { oemtoansi(STR0005),"AxCadVis", 0 , 2},;       // "Visualizar"
                    { oemtoansi(STR0006),"AxCadInc", 0 , 3},;       // "Incluir"
                    { oemtoansi(STR0007),"AxCadAlt", 0 , 4},;       // "Alterar"
                    { oemtoansi(STR0008),"AxCadDel", 0 , 5}}        // "Excluir"
Return aRotina
