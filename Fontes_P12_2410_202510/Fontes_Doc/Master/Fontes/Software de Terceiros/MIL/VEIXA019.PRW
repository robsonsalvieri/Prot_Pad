#include "PROTHEUS.CH"

#define STR0001 "Atendimento de Veiculos"

/*


Ŀ
Funcao     VEIXA019  Autor  Andre Luis Almeida / Rubens        Data  04/07/10 
Ĵ
Descricao  Alteracao de Atendimento Aprovado / Faturado                           
Ĵ
Uso        Veiculos                                                               
ٱ


*/
Function VEIXA019()
//Local aRegs       := {}
Local aCoresUsr   := {}
Private cCadastro := STR0001
Private aRotina   := MenuDef()
Private aCores    := {{'VV9->VV9_STATUS == "A" .AND. VXA018VEIVD()','lbok_ocean'},;  // Em Aberto com Veiculo ja Vendido
{'VV9->VV9_STATUS == "A"','BR_VERDE'},;		// Em Aberto
{'VV9->VV9_STATUS == "P"','BR_AMARELO'},;	// Pendente de Aprovacao
{'VV9->VV9_STATUS == "O"','BR_BRANCO'},;	// Pre-Aprovado
{'VV9->VV9_STATUS == "L"','BR_AZUL'},;		// Aprovado
{'VV9->VV9_STATUS == "R"','BR_LARANJA'},;	// Reprovado
{'VV9->VV9_STATUS == "F"','BR_PRETO'},;		// Finalizado
{'VV9->VV9_STATUS == "C"','BR_VERMELHO'}}	// Cancelado

//////////////////////////////////////////////////////////////////////////////
// Ponto de Entrada para manipular o aCores ( VV9_STATUS )                  //
//////////////////////////////////////////////////////////////////////////////
If ( ExistBlock("VM011LEG") )			
	aCoresUsr := ExecBlock("VM011LEG",.F.,.F.,{aCores,"C"})
	If ( ValType(aCoresUsr) == "A" )
		aCores := aClone(aCoresUsr)
	EndIf
EndIf

//////////////////////////////////////////////////////////////////////////////
// Valida se a empresa tem autorizacao para utilizar os modulos de Veiculos //
//////////////////////////////////////////////////////////////////////////////
If !AMIIn(11)
	Return()
EndIf

DbSelectArea("VV9")
DbSetOrder(1)
FilBrowse("VV9",{},"VV9->VV9_FILIAL=='"+xFilial("VV9")+"' .and. VV9->VV9_STATUS $ 'O,L,F'" )
mBrowse( 6, 1,22,75,"VV9",,,,,,aCores)
DbSelectArea("VV9")
dbClearFilter()

Return
/*


Ŀ
Funcao     VXA019    Autor  Andre Luis Almeida / Rubens        Data  04/07/10 
Ĵ
Descricao  Montagem da Janela de Alteracao de Atendimento Aprovados/Faturados     
Ĵ
Uso        Veiculos                                                               
ٱ


*/
Function VXA019(cAlias,nReg,nOpc)
//
if nOpc == 2
	DBSelectArea("VV9")
	if !Softlock("VV9")
		return .f.
	endif
endif
//
VEIXX019(NIL,NIL,NIL,nOpc,"0")
//
MsUnlockAll()
//
Return .t.
/*


Ŀ
Funcao     MenuDef   Autor  Andre Luis Almeida / Rubens        Data  04/07/10 
Ĵ
Descricao  Menu (AROTINA) - Alteracao de Atendimento Aprovado/Faturado            
Ĵ
Uso        Veiculos                                                               
ٱ


*/
Static Function MenuDef()
Local aRotina := {	{"Pesquisar","AxPesqui",0,1},; 		//Pesquisar
					{"Alterar","VXA019",0,4},;  		// Alterar
					{"Legenda","VXA018LEG",0,3,2,.f.}} 	//Legenda

Return aRotina