#include 'totvs.ch'

/*/{Protheus.doc} OFSoInvalidBodyEntityResponse
	Classe que vai retornar uma resposta 404 com dados de erros vindos do padrao entidades (VeRegistroSql)

	@type class
	@author Vinicius Gati
	@since 05/10/2022
/*/
Class OFSoInvalidBodyEntityResponse
	Public Method New() CONSTRUCTOR
	Static Method GetResponse()
EndClass

/*/{Protheus.doc} New
	Construtor Simples

	@type method
	@author Vinicius Gati
	@since 05/10/2022
/*/
Method New() Class OFSoInvalidBodyEntityResponse
Return SELF


/*/{Protheus.doc} GetResponse
	@type method
	@author Vinicius Gati
	@since 05/10/2022
/*/
Method GetResponse(cName, oEntity) Class OFSoInvalidBodyEntityResponse

	local oResp := JsonObject():New()
	local aErrors := {}
	local nX, aErro

	oResp['name'] := cName
	if len(oEntity:GetErros()) > 0
		For nX := 1 to Len(oEntity:GetErros())
			aErro := oEntity:GetErros()[nX]
			oErro := JsonObject():New()
			oErro['code'] := 0
			oErro['message'] := aErro[2]
			oErro['details'] := aErro[1]
			oErro['trace'] := ""
			aAdd(aErrors, oErro)
		Next
	endif
	oResp['code'] := 400
	oResp['errors'] := aErrors
Return oResp
