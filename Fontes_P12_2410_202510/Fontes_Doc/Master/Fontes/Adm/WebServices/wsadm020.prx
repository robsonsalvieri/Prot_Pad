#INCLUDE "wsadm020.ch"
#INCLUDE "APWEBSRV.CH"
#INCLUDE "PROTHEUS.CH"
/*/


Ŀ
Funo    WSADM020   Autor Claudio D. de Souza     Data 19.05.2003  
Ĵ
Descrio  Web Service da ficha cadastral do cliente                    
                                                                        
Ĵ
Sintaxe                                                                 
Ĵ
Parametros                                                              
Ĵ
Uso        Web Service                                                  
Ĵ
 Atualizacoes sofridas desde a Construcao Inicial.                       
Ĵ
 Programador   Data    BOPS   Motivo da Alteracao                     
Ĵ
 Cleber M.    30/07/07129641-Nos metodos GetRegForm foi incluida a    
                            funcao UserFields para tratar os campos de
                            usuario no retorno do metodo.             
ٱ


/*/

WSSERVICE FinanceCustomerRegForm   DESCRIPTION STR0001 NAMESPACE "http://webservices.microsiga.com.br/financecustomerregform.apw" //"Servio de consulta a ficha financeira do cliente ( <b>Restrio de cliente</b> )"
   WSDATA UserCode                 AS String
   WSDATA CustomerID               AS String
   WSDATA Header                   AS Array Of BrwHeader
   WSDATA RegForm 				   AS RegFormStruct

   WSMETHOD GetHeader   DESCRIPTION STR0002 //"Mtodo que descreve as estruturas de retorno do Servio"
   WSMETHOD GetRegForm  DESCRIPTION STR0003 //"Mtodo de consulta a ficha financeira"
ENDWSSERVICE

/*/

Ŀ
Funo    GetRegForm   Autor   Claudio D. de Souza    Data 19.05.2003 
Ĵ
          Mtodo de recuperacao dos dados da ficha cadastral do cliente   
                                                                          
Ĵ
ParametrosExpC1: Codigo do usuario                                        
          ExpC2: Customer ID                                              
Ĵ
Retorno   ExpL1: Indica que o Mtodo foi avaliado com sucesso             
                                                                          
Ĵ
Descrio Este Mtodo recupera os dados da ficha cadastral do cliente     
Ĵ
Uso        CRM/Materiais/Portais                                          
ٱ


/*/
WSMETHOD GetRegForm WSRECEIVE UserCode,CustomerID WSSEND RegForm WSSERVICE FinanceCustomerRegForm
Local aArea     := GetArea()
Local lRetorno  := .F.
Local nX        := 0
Local cCliente  := SubStr(::CustomerID,1,Len(SA1->A1_COD))
Local cLoja     := SubStr(::CustomerID,Len(SA1->A1_COD)+1)
Local nMcusto   := Iif(SA1->A1_MOEDALC > 0, SA1->A1_MOEDALC, Val(GetMv("MV_MCUSTO")))         

// Valida Login
If PrtChkUser(::UserCode,"FINANCECUSTOMERREGFORM","GetRegForm","SA1",::CustomerID)
	// Valida Dados recebidos (identificacao do cliente a ser pesquisado)
	If !Empty(cCliente) .And. !Empty(cLoja)
		// Pesquisa cliente
		dbSelectArea("SA1")
		dbSetOrder(1)
		If MsSeek(xFilial("SA1")+cCliente+cLoja)
		
			lRetorno		:= .T.
			nX++
			
			::RegForm:MaturityOfCreditLimit			:= SA1->A1_VENCLC
			::RegForm:Seller		           	 	:= SA1->A1_VEND
			::RegForm:NumberOfChecksReturned		:= SA1->A1_CHQDEVO
			::RegForm:DateLastChecksReturned		:= SA1->A1_DTULCHQ
			::RegForm:BillsProtested				:= SA1->A1_TITPROT
			::RegForm:DateOfLastProtestedBill		:= SA1->A1_DTULTIT
			::RegForm:CreditLimit					:= xMoeda(SA1->A1_LC, nMcusto, 1,dDataBase,MsDecimais(1))
			::RegForm:FirstPurchase			 		:= SA1->A1_PRICOM
			::RegForm:BillBalance				 	:= SA1->A1_SALDUP
			::RegForm:LastPurchase				 	:= SA1->A1_ULTCOM
			::RegForm:SecondaryCreditLimit			:= SA1->A1_LCFIN
			::RegForm:MajorDelay					:= SA1->A1_MATR
			::RegForm:SecCreditLimitBalance 		:= SA1->A1_SALFIN
			::RegForm:AverageDelay					:= SA1->A1_METR
			::RegForm:BiggestPurchase			 	:= xMoeda(SA1->A1_MCOMPRA,nMcusto,1,dDataBase,MsDecimais(1))
			::RegForm:RiskRate					 	:= SA1->A1_RISCO
			::RegForm:BiggestBalance			 	:= xMoeda(SA1->A1_MSALDO,nMcusto,1,dDataBase,MsDecimais(1))
			//Carrega os campos de usuario
			UserFields("SA1",@::RegForm:UserFields,"SA1")			
		Else	
			SetSoapFault("FINGETREGFORM",STR0004)	 //"Cliente no encontrado"
		Endif
	Else
		SetSoapFault("FINGETREGFORM",STR0005) //"Cliente invalido"
	Endif
Endif
RestArea(aArea)
Return(lRetorno)

/*/

Ŀ
Funo    GetHeader Autor   Eduardo Riera          Data 21.03.2003 
Ĵ
          Mtodo de recuperacao do header de titulos financeiros       
                                                                       
Ĵ
Parametros                                                             
Ĵ
Retorno   ExpL1: Indica que o Mtodo foi avaliado com sucesso          
                                                                       
Ĵ
Descrio Este Mtodo devolve o header de uma estrutura                
                                                                       
                                                                       
Ĵ
Uso        CRM/Materiais/Portais                                       
ٱ


/*/
WSMETHOD GetHeader WSRECEIVE NULLPARAM WSSEND Header WSSERVICE FinanceCustomerRegForm

Local nX := 0
//Ŀ
//Montagem do Header da estrutura RegForm                                 
//
::Header := {}
aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle  := RetTitle("A1_VENCLC")
::Header[nX]:HeaderField   := "MATURITYOFCREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_VEND")
::Header[nX]:HeaderField   := "SELLER"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_CHQDEVO")
::Header[nX]:HeaderField   := "NUMBEROFCHECKSRETURNED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_DTULCHQ")
::Header[nX]:HeaderField   := "DATELASTCHECKSRETURNED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_TITPROT")
::Header[nX]:HeaderField   := "BILLSPROTESTED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_DTULTIT")
::Header[nX]:HeaderField   := "DATEOFLASTPROTESTEDBILL"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_LC")
::Header[nX]:HeaderField   := "CREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_PRICOM")
::Header[nX]:HeaderField   := "FIRSTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_SALDUP")
::Header[nX]:HeaderField   := "BILLBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_ULTCOM")
::Header[nX]:HeaderField   := "LASTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_LCFIN")
::Header[nX]:HeaderField   := "SECONDARYCREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MATR")
::Header[nX]:HeaderField   := "MAJORDELAY"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_SALFIN")
::Header[nX]:HeaderField   := "SECCREDITLIMITBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_METR")
::Header[nX]:HeaderField   := "AVERAGEDELAY"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MCOMPRA")
::Header[nX]:HeaderField   := "BIGGESTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_RISCO")
::Header[nX]:HeaderField   := "RISKRATE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MSALDO")
::Header[nX]:HeaderField   := "BIGGESTBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

Return(.T.)

/*/


Ŀ
Funo    WSADM020   Autor Claudio D. de Souza     Data 19.05.2003  
Ĵ
Descrio  Web Service da ficha cadastral do cliente                    
                                                                        
Ĵ
Sintaxe                                                                 
Ĵ
Parametros                                                              
Ĵ
Uso        Web Service                                                  
Ĵ
 Atualizacoes sofridas desde a Construcao Inicial.                       
Ĵ
 Programador   Data    BOPS   Motivo da Alteracao                     
Ĵ
                                                                      
ٱ


/*/

WSSERVICE FinanceSellerCustomerRegForm DESCRIPTION STR0006 NAMESPACE "http://webservices.microsiga.com.br/financesellercustomerregform.apw" //"Servio de consulta a ficha financeira do cliente ( <b>Restrio de representante comercial</b> )"
   WSDATA UserCode                 AS String
   WSDATA CustomerID               AS String
   WSDATA SellerCode               AS String   
   WSDATA Header                   AS Array Of BrwHeader
   WSDATA RegForm 				   AS RegFormStruct

   WSMETHOD GetHeader   DESCRIPTION STR0002 //"Mtodo que descreve as estruturas de retorno do Servio"
   WSMETHOD GetRegForm  DESCRIPTION STR0003 //"Mtodo de consulta a ficha financeira"
ENDWSSERVICE

/*/

Ŀ
Funo    GetRegForm   Autor   Claudio D. de Souza    Data 19.05.2003 
Ĵ
          Mtodo de recuperacao dos dados da ficha cadastral do cliente   
                                                                          
Ĵ
ParametrosExpC1: Codigo do usuario                                        
          ExpC3: Vendedor                                                 
          ExpC2: Customer ID                                              
Ĵ
Retorno   ExpL1: Indica que o Mtodo foi avaliado com sucesso             
                                                                          
Ĵ
Descrio Este Mtodo recupera os dados da ficha cadastral do cliente     
Ĵ
Uso        CRM/Materiais/Portais                                          
ٱ


/*/
WSMETHOD GetRegForm WSRECEIVE UserCode,SellerCode,CustomerID WSSEND RegForm WSSERVICE FinanceSellerCustomerRegForm

Local aArea     := GetArea()
Local lRetorno  := .F.
Local nX        := 0
Local cCliente  := SubStr(::CustomerID,1,Len(SA1->A1_COD))
Local cLoja     := SubStr(::CustomerID,Len(SA1->A1_COD)+1)
Local nMcusto   := Iif(SA1->A1_MOEDALC > 0, SA1->A1_MOEDALC, Val(GetMv("MV_MCUSTO")))         

If PrtChkUser(::UserCode,"FinanceSellerCustomerRegForm","GetRegForm","SA3",::SellerCode)
	// Valida Dados recebidos (identificacao do cliente a ser pesquisado)
	If !Empty(cCliente) .And. !Empty(cLoja)
		// Pesquisa cliente
		dbSelectArea("SA1")
		dbSetOrder(1)
		If MsSeek(xFilial("SA1")+cCliente+cLoja)
		
			lRetorno		:= .T.
			nX++
			
			::RegForm:MaturityOfCreditLimit			:= SA1->A1_VENCLC
			::RegForm:Seller		           	 	:= SA1->A1_VEND
			::RegForm:NumberOfChecksReturned		:= SA1->A1_CHQDEVO
			::RegForm:DateLastChecksReturned		:= SA1->A1_DTULCHQ
			::RegForm:BillsProtested				:= SA1->A1_TITPROT
			::RegForm:DateOfLastProtestedBill		:= SA1->A1_DTULTIT
			::RegForm:CreditLimit					:= xMoeda(SA1->A1_LC, nMcusto, 1,dDataBase,MsDecimais(1))
			::RegForm:FirstPurchase			 		:= SA1->A1_PRICOM
			::RegForm:BillBalance				 	:= SA1->A1_SALDUP
			::RegForm:LastPurchase				 	:= SA1->A1_ULTCOM
			::RegForm:SecondaryCreditLimit			:= SA1->A1_LCFIN
			::RegForm:MajorDelay					:= SA1->A1_MATR
			::RegForm:SecCreditLimitBalance 		:= SA1->A1_SALFIN
			::RegForm:AverageDelay					:= SA1->A1_METR
			::RegForm:BiggestPurchase			 	:= xMoeda(SA1->A1_MCOMPRA,nMcusto,1,dDataBase,MsDecimais(1))
			::RegForm:RiskRate					 	:= SA1->A1_RISCO
			::RegForm:BiggestBalance			 	:= xMoeda(SA1->A1_MSALDO,nMcusto,1,dDataBase,MsDecimais(1))
			//Carrega os campos de usuario
			UserFields("SA1",@::RegForm:UserFields,"SA1")
		Else	
			SetSoapFault("FINGETREGFORM",STR0004)	 //"Cliente no encontrado"
		Endif
	Else
		SetSoapFault("FINGETREGFORM",STR0005) //"Cliente invalido"
	Endif
Endif
RestArea(aArea)
Return(lRetorno)

/*/

Ŀ
Funo    GetHeader Autor   Eduardo Riera          Data 21.03.2003 
Ĵ
          Mtodo de recuperacao do header de titulos financeiros       
                                                                       
Ĵ
ParametrosNenhum                                                       
Ĵ
Retorno   ExpL1: Indica que o Mtodo foi avaliado com sucesso          
                                                                       
Ĵ
Descrio Este Mtodo devolve o header de uma estrutura                
                                                                       
                                                                       
Ĵ
Uso        CRM/Materiais/Portais                                       
ٱ


/*/
WSMETHOD GetHeader WSRECEIVE NULLPARAM WSSEND Header WSSERVICE FinanceSellerCustomerRegForm

Local nX := 0
//Ŀ
//Montagem do Header da estrutura RegForm                                 
//
::Header := {}
aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle  := RetTitle("A1_VENCLC")
::Header[nX]:HeaderField   := "MATURITYOFCREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_VEND")
::Header[nX]:HeaderField   := "SELLER"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO		
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_CHQDEVO")
::Header[nX]:HeaderField   := "NUMBEROFCHECKSRETURNED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_DTULCHQ")
::Header[nX]:HeaderField   := "DATELASTCHECKSRETURNED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_TITPROT")
::Header[nX]:HeaderField   := "BILLSPROTESTED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_DTULTIT")
::Header[nX]:HeaderField   := "DATEOFLASTPROTESTEDBILL"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_LC")
::Header[nX]:HeaderField   := "CREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_PRICOM")
::Header[nX]:HeaderField   := "FIRSTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_SALDUP")
::Header[nX]:HeaderField   := "BILLBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_ULTCOM")
::Header[nX]:HeaderField   := "LASTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_LCFIN")
::Header[nX]:HeaderField   := "SECONDARYCREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MATR")
::Header[nX]:HeaderField   := "MAJORDELAY"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_SALFIN")
::Header[nX]:HeaderField   := "SECCREDITLIMITBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_METR")
::Header[nX]:HeaderField   := "AVERAGEDELAY"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MCOMPRA")
::Header[nX]:HeaderField   := "BIGGESTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_RISCO")
::Header[nX]:HeaderField   := "RISKRATE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MSALDO")
::Header[nX]:HeaderField   := "BIGGESTBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

Return(.T.)

#INCLUDE "wsadm020.ch"
#INCLUDE "APWEBSRV.CH"
#INCLUDE "PROTHEUS.CH"
/*/


Ŀ
Funo    WSADM020   Autor Claudio D. de Souza     Data 19.05.2003  
Ĵ
Descrio  Web Service da ficha cadastral do cliente                    
                                                                        
Ĵ
Sintaxe                                                                 
Ĵ
Parametros                                                              
Ĵ
Uso        Web Service                                                  
Ĵ
 Atualizacoes sofridas desde a Construcao Inicial.                       
Ĵ
 Programador   Data    BOPS   Motivo da Alteracao                     
Ĵ
                                                                      
ٱ


/*/

WSSERVICE FinanceRegForm   DESCRIPTION "Servio de consulta a ficha financeira por CGC" NAMESPACE "http://webservices.microsiga.com.br/financeregform.apw"
   WSDATA UserCode			AS String
   WSDATA FederalID			AS String
   WSDATA Header			AS Array Of BrwHeader
   WSDATA RegForm			AS RegFormStruct

   WSMETHOD GetHeader   	DESCRIPTION STR0002 //"Mtodo que descreve as estruturas de retorno do Servio"
   WSMETHOD GetRegForm  	DESCRIPTION STR0003 //"Mtodo de consulta a ficha financeira"
ENDWSSERVICE

/*/

Ŀ
Funo    GetRegForm   Autor   Claudio D. de Souza    Data 19.05.2003 
Ĵ
          Mtodo de recuperacao dos dados da ficha cadastral do cliente   
                                                                          
Ĵ
ParametrosExpC1: Codigo do usuario                                        
          ExpC2: Customer ID                                              
Ĵ
Retorno   ExpL1: Indica que o Mtodo foi avaliado com sucesso             
                                                                          
Ĵ
Descrio Este Mtodo recupera os dados da ficha cadastral do cliente     
Ĵ
Uso        CRM/Materiais/Portais                                          
ٱ


/*/
WSMETHOD GetRegForm WSRECEIVE UserCode,FederalID WSSEND RegForm WSSERVICE FinanceRegForm
Local aArea     := GetArea()
Local lRetorno  := .F.
Local nX        := 0
Local nMcusto   := 0

// Valida Login
If PrtChkUser(::UserCode,"FINANCEREGFORM","GETREGFORM")
	// Pesquisa cliente
	SA1->( DbSetOrder( 3 ) )
	If SA1->( MsSeek( xFilial( "SA1" ) + PadR( ::FederalID, 14 ) ) )
		nMCusto := Iif(SA1->A1_MOEDALC > 0, SA1->A1_MOEDALC, Val(GetMv("MV_MCUSTO")))
		dbSelectArea("AI4")
		dbSetOrder(1)
		If DBSeek(xFilial("AI4") + ::UserCode + SA1->A1_COD + SA1->A1_LOJA)
				
			lRetorno		:= .T.
			nX++
			
			::RegForm:MaturityOfCreditLimit		:= SA1->A1_VENCLC
			::RegForm:Seller		           	:= SA1->A1_VEND
			::RegForm:NumberOfChecksReturned	:= SA1->A1_CHQDEVO
			::RegForm:DateLastChecksReturned	:= SA1->A1_DTULCHQ
			::RegForm:BillsProtested			:= SA1->A1_TITPROT
			::RegForm:DateOfLastProtestedBill	:= SA1->A1_DTULTIT
			::RegForm:CreditLimit				:= xMoeda(SA1->A1_LC, nMcusto, 1,dDataBase,MsDecimais(1))
			::RegForm:FirstPurchase			 	:= SA1->A1_PRICOM
			::RegForm:BillBalance				:= SA1->A1_SALDUP
			::RegForm:LastPurchase				:= SA1->A1_ULTCOM
			::RegForm:SecondaryCreditLimit		:= SA1->A1_LCFIN
			::RegForm:MajorDelay				:= SA1->A1_MATR
			::RegForm:SecCreditLimitBalance 	:= SA1->A1_SALFIN
			::RegForm:AverageDelay				:= SA1->A1_METR
			::RegForm:BiggestPurchase			:= xMoeda(SA1->A1_MCOMPRA,nMcusto,1,dDataBase,MsDecimais(1))
			::RegForm:RiskRate					:= SA1->A1_RISCO
			::RegForm:BiggestBalance			:= xMoeda(SA1->A1_MSALDO,nMcusto,1,dDataBase,MsDecimais(1))
			//Carrega os campos de usuario
			UserFields("SA1",@::RegForm:UserFields,"SA1")
		Else
			SetSoapFault( "GETREGFORM", "CGC no encontrado" )	 
		Endif
	Else
		SetSoapFault( "GETREGFORM", "CGC no encontrado" )
	EndIf
Endif
RestArea(aArea)
Return(lRetorno)

/*/

Ŀ
Funo    GetHeader Autor   Eduardo Riera          Data 21.03.2003 
Ĵ
          Mtodo de recuperacao do header de titulos financeiros       
                                                                       
Ĵ
Parametros                                                             
Ĵ
Retorno   ExpL1: Indica que o Mtodo foi avaliado com sucesso          
                                                                       
Ĵ
Descrio Este Mtodo devolve o header de uma estrutura                
                                                                       
                                                                       
Ĵ
Uso        CRM/Materiais/Portais                                       
ٱ


/*/
WSMETHOD GetHeader WSRECEIVE NULLPARAM WSSEND Header WSSERVICE FinanceRegForm

Local nX := 0
//Ŀ
//Montagem do Header da estrutura RegForm                                 
//
::Header := {}
aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle  := RetTitle("A1_VENCLC")
::Header[nX]:HeaderField   := "MATURITYOFCREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_VEND")
::Header[nX]:HeaderField   := "SELLER"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_CHQDEVO")
::Header[nX]:HeaderField   := "NUMBEROFCHECKSRETURNED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_DTULCHQ")
::Header[nX]:HeaderField   := "DATELASTCHECKSRETURNED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_TITPROT")
::Header[nX]:HeaderField   := "BILLSPROTESTED"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_DTULTIT")
::Header[nX]:HeaderField   := "DATEOFLASTPROTESTEDBILL"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_LC")
::Header[nX]:HeaderField   := "CREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_PRICOM")
::Header[nX]:HeaderField   := "FIRSTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_SALDUP")
::Header[nX]:HeaderField   := "BILLBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_ULTCOM")
::Header[nX]:HeaderField   := "LASTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_LCFIN")
::Header[nX]:HeaderField   := "SECONDARYCREDITLIMIT"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MATR")
::Header[nX]:HeaderField   := "MAJORDELAY"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_SALFIN")
::Header[nX]:HeaderField   := "SECCREDITLIMITBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_METR")
::Header[nX]:HeaderField   := "AVERAGEDELAY"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MCOMPRA")
::Header[nX]:HeaderField   := "BIGGESTPURCHASE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_RISCO")
::Header[nX]:HeaderField   := "RISKRATE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

aadd(::HEADER,WSClassNew("BrwHeader"))
nX++
::Header[nX]:HeaderTitle   := RetTitle("A1_MSALDO")
::Header[nX]:HeaderField   := "BIGGESTBALANCE"
::Header[nX]:HeaderPicture := SX3->X3_PICTURE
::Header[nX]:HeaderSize    := SX3->X3_TAMANHO
::Header[nX]:HeaderDec     := SX3->X3_DECIMAL
::Header[nX]:HeaderType    := SX3->X3_TIPO
::Header[nX]:HeaderComboBox:= X3Cbox()
::Header[nX]:HeaderOblig   := X3Obrigat(SX3->X3_CAMPO)

Return(.T.)
