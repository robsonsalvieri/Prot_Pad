<%LOCAL nI := 0
Local lPE := .F.
Local lPE2 := .F.

local cTexcli := ""
If ExistBlock("PPLSBTAT")
	aPEBotao := ExecBlock("PPLSBTAT",.F.,.F.,{})
	lPE := Len(aPEBotao) > 0
EndIf

If ExistBlock("PPLSTEXT")
	cTexcli := ExecBlock("PPLSTEXT",.F.,.F.,{})
	lPE2 := .T.
EndIf

%>             

<!DOCTYPE html>
<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="<%=GetPrtSkin()%>/estilo.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="pplanguage.js"></script>
<script type="text/javascript" src="criaobj.js"></script>
<script type="text/javascript" src="<%=GetPrtSkin()%>/jspls.js"></script>
<script language="JavaScript">
<!--    
//guarda o ultimo procedimento que foi validado para nЦo validar duas vezes
var cLastProcVld = "";
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё VINICIUS HELLENO - Aguarda a chamada do ajax para evitar requisicoes  Ё
//  desnecessarias no banco de dados									  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
var timerAjax = null;
var timerFlag = false;
var cString = '';
var lVld2 = false;
var LastkeyID = 0;
var cTpProfG = '';
var cTpPrestador = '';
function vwaitAjax(event,ctype){
	 if(timerFlag == false){
		  timerFlag = true;
		  timerAjax = setTimeout(function(){fProfSauClear(ctype); },400);
	 }else{
		  clearTimeout(timerAjax);
		  timerFlag = false ;
		  vwaitAjax(event,ctype);
	 }
}   

function manutString(e){
	var keyID 	= (window.event) ? e.keyCode : e.which;
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Tratamento quando for backspace ou delete desviado pela fProfSauClear
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	lVld2 = (keyID >=64 && keyID <=93 || keyID >=97 && keyID <=125 || keyID >=48 && keyID <=62 || keyID == 95 || keyID == 8 || keyID == 46 || keyID == 32);
    if (lVld2) {
		if (keyID == 8) {
	    	cString = cString.substr(0,cString.length-1);
		} else if (keyID == 46) {
	    	cString = "";         
		} else {
			cString = cString + String.fromCharCode(keyID);
		}                 
	}
	LastkeyID = keyID;
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Bloqueia o esc														  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
document.onkeydown = blockEsc;
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Abre popup
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
function fAbre(cHtml) {   
	janela = window.open(cHtml,"PopAjuda", "width=400, height=300, left=0, top=110, scrollbars=0");
}  
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Validacao da re-consulta - ponto de entrada no botao confirmar da guia Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fRegEsp(cCmpReg) {
    //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Valida re-consulta													   Ё
    //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (document.getElementById("cRegEsp").value == "1") {
        //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Variavel global para colocar em foco e variavel global para ativar o obrigatorio   Ё
        //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        setCtrErro('focus',cCmpReg)
        setCtrErro('obrigatorio',cCmpReg)
        setCtrErro('delete','cIteRegEsp')
        
        if (typeof cCpoRegCon == 'undefined') cCpoRegCon = '';
        //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Variavel local																	   Ё
        //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        var cCodRda = document.getElementById("cRda").value;
        var cMatric = document.getElementById("cNumeCart").value;
	    var cCodPad = document.getElementById("cCodPadSSol").value;
	    var cCodPro = document.getElementById("cCodProSSol").value;
	   	var dDatPro = document.getElementById("dDtSolicit").value;
 
        if (cCodPad != '' && cCodPro != '') {
            cCpoRegCon = cCodPad + cCodPro;
            //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Executa regra especifica do cliente									   Ё
            //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            Ajax.open("W_PPSVLDESP.APW?cCodRda=" + cCodRda + "&cMatric=" + cMatric + "&cCodPad=" + cCodPad + "&cCodPro=" + cCodPro + "&dDatPro=" + dDatPro, { 
            	error: ExibeErro 
            });
        }

    } else {
        return true;
    }
}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Validacao da re-consulta para quando excluir o item					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fRegEspExc(cCmpReg, cTable) {
    var i, x, z, chkbox;
    var cIteAux = '';
    var cIteEsp = document.getElementById('cIteRegEsp').value;
    var oTable  = document.getElementById(cTable);
    //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Vai em todas as linhas da tabela para ver qual esta marcado			   Ё
    //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    for (var i = 1; i < oTable.rows.length; i++) {
        chkbox = document.getElementById("chkbox" + cTable + i);

        if (chkbox) {
            if (chkbox.checked) {
                cIteAux = ''
                var cCodPad = getTC(oTable.rows[i].cells[2]);
                var cCodPro = getTC(oTable.rows[i].cells[3]);

                if (cIteEsp != '' && cIteEsp.indexOf(cCodPad + cCodPro) != -1 && cCodPad != '' && cCodPro != '') {

                    var aRegEspExc = document.getElementById('cIteRegEsp').value.split('|');

                    for (var x = 0; x < aRegEspExc.length; x++) {
                        if (aRegEspExc[x] != cCodPad + cCodPro && aRegEspExc[x] != '') {
                            cIteAux += aRegEspExc[x] + '|';
                        }
                    }
                    //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё Desativa a obrigatoriedade do campo									   Ё
                    //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    if (cIteAux != '') {
                        document.getElementById('cIteRegEsp').value = cIteAux;
                    } else {
                        for (var z = 0; z < oForm.campos.length; z++) {
                            if (oForm.campos[z].campo.id == cCmpReg) {
                                oForm.campos[z].branco = true;
                            }
                        }
                    }
                }
            }
        }
    }
}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Ajusta solicitacao para mais de uma rda								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fAjusForm(lHab) {
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Combo CBOS do executante na solicitacao								   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	var e = document.getElementById("cCbosExe");
   			e.options[0] = new Option("-- CBOS --", "");
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Solicitacao															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FDisElemen('TSSO|Tcs|Tdspo|BSolOpm|TabSolOpm|BSolSer|TabSolSer|Toth',!lHab);
	if(!lHab) MEObj('Tcs');
	if(!lHab) MEObj('Tdspo');
	if(!lHab) MEObj('Tsso');
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Execucao															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FDisElemen('TESOP|TESO|Tdce|Tda|BExeOpm|TabExeOpm|BExeSer|TabExeSer',lHab);
	if(lHab) MEObj('Tdce');
	if(lHab) MEObj('Tda');
	if(lHab) MEObj('Teso');
}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta matriz genericas												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fMontMatGer(cTp,cTable) {                                       
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Monta matriz genericas												   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		    switch (cTable)	{                                          
				case "TabSolSer":
					aMatCap 		 = ( (cTp=='I') ? 'Chk$NIL|' : "" ) + 'cCodPadSSol$cCodPad|cCodProSSol$cCodPro|cDesProSSol$cDesPro|cQtdSSol$nQtdSol|cQtdAutSSol$nQtdAut';
					aMatBut 		 = 'bISolSer|bASolSer|bESolSer';
					aMatRet 		 = 'cStatusAut~cQtdAutSSol';
					cChave 			 = 'cCodProSSol';
					cCampoDefault	 = 'cCodPadSSol;NIL|cQtdSSol;1';
					aValAlt			 = 'cCodPadSSol|cCodProSSol|cQtdSSol';
					aCalVal			 = '';
					aMatConv 		 = '';
					aMatNGet 		 = 'cDesPro';
					break;   
				case "TabSolOpm":
					aMatCap 		 = ( (cTp=='I') ? 'Chk$NIL|' : "" ) + 'cCodPadOSol$cCodPad|cCodProOSol$cCodPro|cDesProOSol$cDesPro|cQtdOSol$nQtdSol|cFabOSol$cFabric|nVlrUniOSol$nVlrApr';
					aMatBut 		 = 'bISolOpm|bASolOpm|bESolOpm';
					aMatRet 		 = 'cStatusAut';
					cChave 			 = 'cCodProOSol';
					cCampoDefault	 = 'cCodPadOSol;NIL|cQtdOSol;1';
					aValAlt			 = 'cCodPadOSol|cCodProOSol|cQtdOSol';
					aCalVal			 = '';
					aMatConv 		 = '';         
					aMatNGet 		 = 'cDesPro';
					break;
				case "TabExeSer":
					aMatCap 		 = ( (cTp=='I') ? 'Chk$NIL|' : "" ) + 'dDtExe$dDtExe|cHorIniSExe$cHorIExe|cHorFinSExe$cHorFExe|cCodPadSExe$cCodPad|cCodProSExe$cCodPro|cDesProSExe$cDesPro|cQtdSExe$nQtdSol|cViaSExe$cViaAc|cTecSExe$cTecUt|nRedAcreSExe$nRedAcre|nVlrUniSExe$nVlrApr|nVlrTotSExe$NIL';
					aMatBut 		 = 'bIExeSer|bAExeSer|bEExeSer';
					aMatRet 		 = 'cStatusAut~cQtdSExe';
					cChave 			 = 'cCodProSExe';
					cCampoDefault	 = 'cCodPadSExe;NIL|cQtdSExe;1|dDtExe;NIL';
					aValAlt			 = 'cCodPadSExe|cCodProSExe|cQtdSExe';
					aCalVal			 = '';
					aMatConv 		 = 'cCodPadSExe$cCodPadSSol|cCodProSExe$cCodProSSol|cDesProSExe$cDesProSSol';
					aMatNGet 		 = 'cDesPro';
					break;
				case "TabExeOpm":
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//Ё aMatCap campos que apareceram na tabela o Chk e um check box para utilizacao na exclusao Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					aMatCap 		 = ( (cTp=='I') ? 'Chk$NIL|' : "" ) + 'cCodPadOExe$cCodPad|cCodProOExe$cCodPro|cDesProOExe$cDesPro|cQtdOExe$nQtdSol|cCodBarOExe$cCodBar|nVlrUniOExe$nVlrApr|nVlrTotOExe$NIL';
					aMatBut 		 = 'bIExeOpm|bAExeOpm|bEExeOpm';		//Botoes que estao sendo usados (desabilita ou nao)
					aMatRet 		 = 'cStatusAut~cQtdOExe';				//O que vai ser retornado da funcao (se foi autorizado ou nao) 	
					cChave 			 = 'cCodProOExe';					  	//Chave da Tabela	
					cCampoDefault	 = 'cCodPadOExe;NIL|cQtdOExe;1'; 	  	//Nao deixar limpar os campos com valor NIL ou atribui o defaul inclusao/alteracao
					aValAlt			 = 'cCodPadOExe|cCodProOExe|cQtdOExe'; 	//Campos que sao checados se teve alteracao ou nao	
					aCalVal			 = 'nVlrTotOExeG$nVlrTotOExe|';		  	//Para calculo o segudo recebe a soma do primeiro	  
					aMatConv 		 = 'cCodPadOExe$cCodPadOSol|cCodProOExe$cCodProOSol|cDesProOExe$cDesProOSol|cCodBarOExe$cCodBar|nVlrUniOExe$nVlrUniOSol|nVlrTotOExe$nVlrUniOSol';//Matriz para converter campos
					aMatNGet 		 = 'cDesPro';
					break;
            }
}                              
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta matriz genericas carrega procedimento por procedimento		  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fCarregaTabela(aMatTabRel, aMatVal, cMostraSer) {
    var aMatTabAux = aMatTabRel.split('|')
    var cSeqCont = '0';
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Para as tabelas informadas											  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    for (var x = 0; x < aMatTabAux.length; x++) {
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Para habilitar o click ou nao na tabela e pegar o nome da tabela 	  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        var aMatTab  = aMatTabAux[x].split('$');
        var cTable 	 = aMatTab[0];
        var cTipoAcao= aMatTab[1];
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Carrega variaveis													  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        fMontMatGer('I', cTable);
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Se vai carregar na matriz original ou vai espelhar em outra matriz	  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (cTipoAcao == '0') {
            var aMatCampVal = '';
            var aMatCol 	= aMatCap.split("|");
		    var cTpAut 		= "1";
	        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	        //Ё Verifica toda a matriz com campos e valores							  Ё
	        //Ё associa o valor retornado ao campo do form							  Ё
	        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            for (var y = 0; y < aMatVal.length; y++) {
	            var aMatColVal 	= aMatVal[y].split("!");
	            var cCampo 		= aMatColVal[0]
	            var cConteudo 	= aMatColVal[1]    
		        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		        //Ё Conforme o tipo de autorizacao muda a cor da linha					  Ё
		        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	            if (cCampo == 'cStatus') {
	            	cTpAut = ( (cConteudo=='S') ? "1" : "0" );
	            }
		        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		        //Ё Procura o campo padrao no campo do form								  Ё
		        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	            for (var i = 0; i < aMatCol.length; i++) {
	                var aMatCampoForm = aMatCol[i].split("$");
	                if (aMatCampoForm[1]==cCampo) { 
	                	cCampo = aMatCampoForm[0];
	                	break;
	                }	
	            }
	            if (typeof cCampo != 'undefined' && document.getElementById(cCampo) != null) {

	                document.getElementById(cCampo).value = cConteudo;
                    //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё Matriz para compatibilizar tabelas exemplo. solicitacao com execucao.  Ё
                    //Ё Como a quantidade de campos e diferente deve dizer onde o valor da	   Ё
                    //Ё solicitacao vai ficar na execucao									   Ё
                    //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    aMatCampVal += cCampo + "$" + cConteudo + "|"
                }
				if (cCampo == 'cSeqMov') {
					cSeqCont = cConteudo;
				}
			}	
		  //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		  //Ё Para nao habilitar o 2 clicks na linha da tabela						 Ё
		  //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		  aMatBut = "";
        } else {
            if (cMostraSer == '0') break;
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Todos os campos da tabela											  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            var aMatCol 	= aMatConv.split("|");
            var aMatCampVal = aMatCampVal.split("|")
            
            for (var y = 0; y < aMatCol.length; y++) {
                var aMatColAux = aMatCol[y].split("$");
                if (aMatColAux[0] != 'Chk' && typeof aMatColAux[0] != 'undefined' && document.getElementById(aMatColAux[0]) != null && aMatColAux[1] != 'NIL') {
                    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё Para cada campo da tabela le a matriz de valores retornados 		  Ё
                    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    for (var h = 0; h < aMatCampVal.length; h++) {
                        var aMatCampValAux = aMatCampVal[h].split("$");
                        if (aMatColAux[1] == aMatCampValAux[0]) {
                            document.getElementById(aMatColAux[0]).value = aMatCampValAux[1];
                            break;
                        }
                    }
                }
            }
        }
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Insere e limpa a linha												  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		if (cTable == 'TabExeSer' || cTable == 'TabExeOpm')
	         IncLinhaTab(cTable, aMatCap, aMatBut, '', cCampoDefault, cTpAut, true);
	    else IncLinhaTab(cTable, aMatCap, aMatBut, '', cCampoDefault, cTpAut, false);    
    }
	oTable = document.getElementById(cTable);
	if (cSeqCont != '0')
		setTC(oTable.rows[oTable.rows.length-1].cells[0],parseInt(cSeqCont,10)+" ");
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verifica se o numero da liberacao existe e mostra os dados			  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fCalcVal(nVal, nQtd, cCampo) {
    cCampo.value = MaskMoeda((nQtd * nVal.replace(/\D/g, "")));
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verifica se o numero da liberacao existe e mostra os dados			  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fChamLibera(cNumeLib) {
    cCampoRefL = 'cNumAut';
    cString	= '';
    cProfAntG = '';
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Verifica se foi informado a chave									  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (cNumeLib == "") {
        alert("Informe o numero da Solicitacao");
        return;
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Retira a mascara													  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    cNumeLib = cNumeLib.replace(/\D/g, "");
    var cRda = document.getElementById("cRda").value;
    var cMatric = document.getElementById("cNumeCart").value;
    var cCodLoc = document.getElementById("cCodLoc").value;
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Executa o metodo													  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    Ajax.open("W_PPLSCHALIB.APW?cNumeAut=" + cNumeLib + "&cRda=" + cRda + "&cCodLoc=" + cCodLoc + "&cMatric=" + cMatric + "&cTp=2", { 
    	callback: CarregaLiberacao,
    	error: ExibeErro 
    });
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o retorno														  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaLiberacao(v) {   
    var cPSol 		= "";
    var cNSol 		= "";
    var aMatCabIte 	= v.split("<");
    var aMatCab 	= aMatCabIte[0].split("|");
    cCampoRefL 		= "";
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Verifico se a estrutura dos itens foram enviadas					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (typeof aMatCabIte[1] == "undefined") {
        alert("Estrutura indefinada");
        return;
    }
    var aMatIte = aMatCabIte[1].split("~");
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Exibi criticas de procedimentos que nao podem ser executados		  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (typeof aMatCab[aMatCab.length-1] != "undefined") {
        if (aMatCab[aMatCab.length-1] != "") alert(aMatCab[aMatCab.length-1]);
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Cabecalho e dados do executante caso for somente um					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    for (var i = 0; i < (aMatCab.length - 1); i++) {
        var aCamVal = aMatCab[i].split("!");
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Somente se foi passado o nome do campo								  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (aCamVal[0] != "") {
            var cCampo = document.getElementById(aCamVal[0]);
            if (cCampo != null) {
                //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                //Ё Se nao for o cCbos													  Ё
                //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                if (aCamVal[0] != "cCbosSol" && aCamVal[0] != "cNomeSol" && aCamVal[0] != "cProSol") {
                    cCampo.value = aCamVal[1];
                } else if (aCamVal[0] == "cProSol") {
                    cPSol = aCamVal[1];
                } else if (aCamVal[0] == "cNomeSol") {
                    cNSol = aCamVal[1];
                    document.getElementById("cNomeSol").value = cNSol;
                } else if (aCamVal[0] == "cCbosSol") {
                    setTC(document.getElementById("cCbosSol"),"");
                    var e = document.getElementById("cCbosSol");
                    var aIten = aCamVal[1].split("$");
                    e.options[0] = new Option(aIten[1], aIten[0]);
                }                  
                //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                //Ё Codigo e Nome do profissional de saude								  Ё
                //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                if (cNSol != "" && cPSol != "") {
                    setTC(document.getElementById("cProSol"),"");
                    var e = document.getElementById("cProSol");
                    e.options[0] = new Option(cNSol, cPSol);
                    cPSol = "";
                    cNSol = "";
                }
            }
        }
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Marca todas as linhas para delecao									  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	aTabDel = new Array("TabSolSer", "TabSolOpm", "TabExeSer", "TabExeOpm")
    for (var y = 0; y < aTabDel.length; y++) {
        setTC(document.getElementById(aTabDel[y]),"");
    }
    //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Alimenta os tabelas de servicos	matriz com linhas SOLICITACAO E EXECUCAO Ё
    //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    for (var i = 0; i < aMatIte.length; i++) {
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Matriz com os campos e valores SERVICO								  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (aMatIte[i] != "") {
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Aprimeira posicao da matriz aMatval e o tipo de servico a segunda      		Ё
            //Ё e se vai ser exibido ou nao da terceira em diante contem valores dos campos	Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            var aMatVal = aMatIte[i].split("@");
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё A segunda posicao [1] retorna se e possivel exibir para uma rda o procedimento  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            var cMostraSer = aMatVal[1].split("!")[1];
           //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		   //Ё SERVICO/OPM							  								  	  Ё
		   //Ё Relacionamento entre solicitacao e execucao Nome da tabela e tipo 0 nao    Ё
		   //Ё permite click na linha da tabela e matriz de base para espelho da execucao Ё
		   //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
 		   if (aMatVal[0].split("!")[1] == "S")        
			    fCarregaTabela('TabSolSer$0|TabExeSer$1',aMatVal,cMostraSer);
		   else fCarregaTabela('TabSolOpm$0|TabExeOpm$1',aMatVal,cMostraSer); 	  
		}
    }       
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Solicitacao															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FDisElemen('TSSO|Tcs|Tdspo|BSolOpm|BSolSer|Toth',true);
	MEObj('Tcs',true,'+');
	MEObj('Tdspo',true,'+');
	MEObj('Tsso',true,'+');
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Execucao															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FDisElemen('TESOP|TESO|Tdce|Tda|BExeOpm|TabExeOpm|BExeSer|TabExeSer',false);
	MEObj('Tdce',true,'-');
	MEObj('Tda',true,'-');
	MEObj('Teso',true,'-');
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Se e fisica ou juridica												   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if(document.getElementById("cTpPe").value.toUpperCase() == 'F') {
		setDisable("cProExe",true);
		setDisable('BIncExe',true);
	}else{
		setDisable("cProExe",false);
		setDisable('BIncExe',false);
	}
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Troca o tipo obrigatorio do campo									   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    for(var i=0; i<oForm.campos.length; i++) {                                       
	    switch (oForm.campos[i].campo.id) {
		case "cCarSolicit":
				oForm.campos[i].branco = true;
				break    
		case "cProSol":
				oForm.campos[i].branco = true;
				break
		}
	}	             
    if(document.getElementById("cTpPe").value.toUpperCase() == 'F') {
		oForm.add( document.forms[0].cProExe,"tudo", false, false );
	}	
	oForm.add( document.forms[0].cTpSai,"tudo", false, false );
	oForm.add( document.forms[0].cTpAteExe,"tudo", false, false );
	
	setDisable("bconfirma",false);
	setDisable("bcomplemento",true);
	setDisable("bimprimir",true);
	<%If lPE%>
		setDisable("bcustom",true);
	<%EndIf%>
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Dados da rda na execucao											   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if (document.getElementById("cRda").value != "" && document.getElementById("cCodLoc").value != "")
		fRda(document.getElementById("cRda").value,document.getElementById("cCodLoc").value)			
}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta tabela de procedimento e quantidades linha a linha (autorizacao) Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fMontItens(cTp, cTable) {
    cTpR 		 = cTp;
    cTableR 	 = cTable;
    cQueryString = "&cRda=" + document.getElementById('cRda').value + "&cCodLoc=" + document.getElementById('cCodLoc').value;
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Numero da liberacao													  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    var cChavSol = document.getElementById("cNumAut").value;
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Monta conteudo das tabelas solicitacao e execucao					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (cTable == "TabSolSer" || cTable == "TabSolOpm")
		 aMatAux = "TabSolSer|TabSolOpm";
	else aMatAux = "TabExeSer|TabExeOpm";
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Carrega as linhas das tabelas para processamento					   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    cStringEnvTab = "";
    aMat = aMatAux.split("|");
    for (var i = 0; i < aMat.length; i++) {
        oTable = document.getElementById(aMat[i]);
        
        fMontMatGer('A', aMat[i]);
        
        aMatCampAux = aMatCap.split("|");
        for (var y = 1; y < oTable.rows.length; y++) {
            nf = 0;                  
			cStringEnvTab += "cSeq@"+getTC(oTable.rows[y].cells[0])+"$";
			
            for (var x = 2; x < (oTable.rows[y].cells.length + nf); x++) {
            
                cCampo = aMatCampAux[x - 2].split("$")[1];
                if (cCampo != "NIL" && aMatNGet.indexOf(cCampo)==-1) {
                	celula = oTable.rows[y].cells[x - nf];
                	
                	if (typeof celula.value == 'undefined' || celula.value == '')
	                	 conteudo = getTC(celula);
	                else conteudo = celula.value;	
	                
                	cStringEnvTab += cCampo + "@" + conteudo + "$";
				}
                if (aMatCampAux[x - 2].split("$")[0] == 'cfixo') nf += 1;
          	}      
            cStringEnvTab += "|";
        }
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Define parametros para uso na funcao de resultado					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    fMontMatGer(cTp, cTable);
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Matriz de campos													  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    var aMatCol = aMatCap.split("|");
    var oTable  = document.getElementById(cTable);
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Tratamento inclusao ou alteracao									  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (cTp == 'I' || cTp == 'A') {
        switch (cTable) {
			case "TabSolSer":
				if (document.getElementById('cQtdSSol').value == "" || document.getElementById('cQtdSSol').value == "0" || parseInt(document.getElementById('cQtdSSol').value) <= 0) {
				    alert('Informe a quantidade de ServiГo');
				    document.getElementById('cQtdSSol').focus();
					return;
				}               
				if (cTp == 'I')
					document.getElementById('cQtdAutSSol').value = document.getElementById('cQtdSSol').value;
				break;   
			case "TabSolOpm":
				if (document.getElementById('cQtdOSol').value == "" || document.getElementById('cQtdOSol').value == "0" || parseInt(document.getElementById('cQtdOSol').value) <= 0) {
				    alert('Informe a quantidade de Opm');
				    document.getElementById('cQtdOSol').focus();
					return;
				}
				break;
			case "TabExeSer":
				if (document.getElementById('cQtdSExe').value == "" || document.getElementById('cQtdSExe').value == "0" || parseInt(document.getElementById('cQtdSExe').value) <= 0) {
				    alert('Informe a quantidade de ServiГo');   
				    document.getElementById('cQtdSExe').focus();
					return;
				}
				break;
			case "TabExeOpm":
				if (document.getElementById('cQtdOExe').value == "" || document.getElementById('cQtdOExe').value == "0" || parseInt(document.getElementById('cQtdOExe').value) <= 0) {
				    alert('Informe a quantidade de Opm'); 
				    document.getElementById('cQtdOExe').focus();
					return;
				}
				break;
            }
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica duplicidade												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		var nCol 		= 0;
		var nQtdLinTab  = oTable.rows.length;
	    var cString 	= '1'+"|";
		var cContChave  = document.getElementById(cChave).value;
	    if (cContChave == "") {
	       alert("ServiГo nЦo informado");
		   document.getElementById(cChave).focus();
	       return;
	    }
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta a sequencia e matriz de retorno								   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (typeof document.getElementById(cTable).length != 'undefined') {
            if (cTp == 'I') 
            	 cString = String(document.getElementById(cTable).length + 1) + "|";
            else cString = String(document.getElementById(cTable).length) + "|";
        }
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Cbos do executante ou solicitante									  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (cChavSol == '') {
            cCbos = document.getElementById("cCbosSol").value;
        } else {
            cCbos = document.getElementById("cCbosExe").value;
        }
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Monta envio das variaveis de sessao GET								  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cQueryString =	"&cRda="+document.getElementById('cRda').value+
						"&cCodLoc="+document.getElementById('cCodLoc').value+
						"&cProSol="+document.getElementById('cProSol').value+
						"&cProExe="+document.getElementById('cProExe').value+
						"&dDtSolicit="+document.getElementById('dDtSolicit').value+
						"&cHrSolicit="+document.getElementById('cHrSolicit').value+
						"&cCid="+document.getElementById('cCid').value+            
						"&cNumAut="+cChavSol+
						"&cCbos="+cCbos+
						"&cChvBD6="+document.getElementById('cChvBD6').value;
        cCamGer = "";
        for (var i = 0; i < aMatCol.length; i++) {
            var aMatColAux = aMatCol[i].split("$");
            cCampo = document.getElementById(aMatColAux[0]);
            if (typeof cCampo != 'undefined' && cCampo != null && aMatNGet.indexOf(aMatColAux[1])==-1) {
                cQueryString += "&" + aMatColAux[1] + "=" + cCampo.value;
            }
        }
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Verifica duplicidade												  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        for (var i = 1; i < nQtdLinTab; i++) {
            for (var y = 0; y < aMatCol.length; y++) {
                var aMatColAux = aMatCol[y].split("$");
                if (aMatColAux[0] == cChave) {
                	nCol = y;
                	break;
                }	
            }
            if (cTp == 'A') nCol++;
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Verfica se existe um registro igual na tabela						  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            var lResult = false;   
			if (getTC(oTable.rows[i].cells[nCol+1]) ==	cContChave) {
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё verifica se algum campo foi alterado			   					   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                if (oTable.rows[i].style.backgroundColor != "") {
                    cSt = "0";
                    //здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё Verifica se alguma campo que necessita de checar a regra novamente foi alteradoЁ
                    //юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    lResult = true;
                    for (var y = 2; y < oTable.rows[i].cells.length; y++) {
                        var aMatColAux = aMatCol[y - 2].split("$");
                        cCampo = document.getElementById(aMatColAux[0]);
                        if (getTC(oTable.rows[i].cells[y]) != cCampo.value) {
                            cSt = "1";
                            if (aValAlt.indexOf(aMatColAux[0]) != -1) lResult = false;
                        }
                    }

					//Se teve alguma alteraГЦo, verifica se o campo quantidade executada И maior que a quantidade autorizada
					if (cSt == "1" && cTable =="TabExeSer") {
						var cSeq		= getTC(oTable.rows[i].cells[0]); //sequencia do procedimento na tabela de execuГЦo
						var oTableSol	= document.getElementById("TabSolSer"); //tabela de solicitaГЦo de procedimentos, que И onde estА a informaГЦo das quantidades autorizadas

						if (oTableSol != null) {
							//percorre a tabela de solicitaГУes
							for (var x = 1; x < (oTableSol.rows.length); x++) {
								//posiciona no procedimento que foi selecionado na tabela de execuГЦo de acordo com a sequencia do procedimento
								if (getTC(oTableSol.rows[i].cells[0]) == cSeq) {
									//verifica se a quantidade executada И maior que a quantidade autorizada
									if (parseInt(document.getElementById("cQtdSExe").value) > parseInt(getTC(oTableSol.rows[i].cells[5]))){
										alert('Quantidade executada maior que a quantidade autorizada.');
										document.getElementById("cQtdSExe").focus();
										return;
									}
									break;
								}
							}
						}
					}

                    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё Altera a tabela sem checar a regra novamente								  Ё
                    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    if (lResult) {
                        AltLinhaTab(cTable, aMatCap, aMatBut, cSt, "", cCampoDefault);
                        return;
                    }
                } else {
                    alert('JА existe este registro');
                    return;
                }
            }                                                      
        }
		cString += aMatRet + "|" + cStringEnvTab + "|";            
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Executa o metodo													  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (!lResult) Ajax.open("W_PPLSAUTITE.APW?cString=" + cString + cQueryString, { 
        					callback: CarregaMontItens,
					        error: ExibeErro 
					   });
    } else {
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё Deletar linhas														  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        DelLinhaTab(cTable);
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Calculo de valores primeiro campo recebe segundo campo o valor do	  Ё
    //Ё campo e pego da tabela												  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (typeof aCalVal != 'undefined' && aCalVal != null) {
        var aCalValAux = aCalVal.split("|");
        for (var i = 0; i < aCalValAux.length; i++) {
            if (aCalValAux[i] != "") {
                var aMatCamp = aCalValAux[i].split("$");
                //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                //Ё Para pegar os campos de informacao e recebimento					  Ё
                //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                if (typeof aMatCamp[0] != 'undefined' && aMatCamp[0] != null && typeof aMatCamp[1] != 'undefined' && aMatCamp[1] != null) {
                    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё Descobrir a coluna na tabela										  Ё
                    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    for (var x = 0; x < aMatCol.length; x++) {
                        var aMatColAux = aMatCol[x].split("$");
                        if (aMatColAux[0] == aMatCamp[1]) {
                            nCol = x;
                            break;
                        }
                    }
                    if (cTp != 'I') nCol++;
                    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
                    //Ё atualiza os campos com base no valor da tabela						  Ё
                    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
                    var nValor = 0;
                    var cCampo = document.getElementById(aMatCamp[0]);
                    for (var x = 1; x < oTable.rows.length; x++) {
                        nValor += parseInt(getTC(oTable.rows[x].cells[nCol + 1]).replace(/\D/g, ""));
                    }
                    cCampo.value = MaskMoeda(nValor);
                }
            }
        }
    }
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o retorno do processamento										  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaMontItens(v) {                       
	var lAto 	= false;
    var aResult = v.split("|");
    var cTitulo = aResult[0]; 				//Titulo do resultado autorizado,negado ou autorizado parcial
    var aMatRet = aResult[1].split("~"); 	//Retorno para grid campos e resultado do campo
    var cTexto 	= aResult[5]; 				//Procedimento autorizados ou negados resultado
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Alimentar campos de retorno											  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    for (var i = 0; i < aMatRet.length; i++) {
        aRetAux = aMatRet[i].split(";");
        cCampo = document.getElementById(aRetAux[0]);

        if (typeof cCampo != 'undefined' && cCampo != null) 
        	cCampo.value = aRetAux[1];
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Se vai incluir ou alterar a linha campo alimentado pela aMatRet 	  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (typeof cTableR != 'undefined' && typeof aMatCap != 'undefined' && typeof aMatBut != 'undefined') {
        cCampo = document.getElementById("cStatusAut");
        if (typeof cCampo != 'undefined') {

		    if (cCampo.value == '5') {
		    	lAto = true;
		    	cCampo.value = '1';
		    }

            if (cTpR == 'I') {
                if (document.getElementById("cNumAut").value == "" || cTitulo == "1" || lHab) {
                    IncLinhaTab(cTableR, aMatCap, aMatBut, "", cCampoDefault, cCampo.value);
					if (cTableR == "TabSolSer")
						setDisable("bISolSer", true);
                }
            } else AltLinhaTab(cTableR, aMatCap, aMatBut, cCampo.value, "", cCampoDefault);
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Retorno o valor original											  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            cCampo.value == "0";
        }
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Mostra o resultado modal so mostra se for negado					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if ( cTitulo != "1" ) ShowModal(cTitulo, cTexto);
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Se for pagamento no ato												   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if ( lAto )	alert("Realizar o pagamento na Operadora.\nPara este procedimento deve ser efetuado o pagamento no ato.");
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Processa 															  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fProcForm(formulario) {
	document.forms[0].action = "W_PPLPROCGUI.APW";
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Varica indicacao clinica											   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if (document.getElementById("cIndCliSol").value == "") { 
		for (var z=0; z<oForm.campos.length; z++) {
		    if (oForm.campos[z].campo.id == "cIndCliSol") {
				oForm.campos[z].branco = true;
			}
		}   
		var aMatInd = document.getElementById("cCmpIndCli").value;
	    var aMat    = new Array("TabSolSer", "TabSolOpm");
	    var lachou  = false;
		for (var i=0;i<aMat.length;i++) {        
		    oTable = document.getElementById(aMat[i]);
			fMontMatGer('A',aMat[i]);
			aMatCampAux = aMatCap.split("|");
			for (var y=1;y<oTable.rows.length;y++) {        
				for (var x=2;x<oTable.rows[y].cells.length;x++) {        
					cCampo = aMatCampAux[x-2].split("$")[1];          
					if (cCampo == 'cCodPro') {
						cConteudo = getTC(oTable.rows[y].cells[x]);
						if ( aMatInd.indexOf(cConteudo.replace(" ","") ) != -1) {
							for (var z=0; z<oForm.campos.length; z++) {
							    if (oForm.campos[z].campo.id == "cIndCliSol") {
									oForm.campos[z].branco = false;
									lachou = true;
									break;
								}
							}   
						}
					}                   
				}	
			}
		}
	}
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Campos obrigatorios do ponto de entrada
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	var cCpsObr = document.getElementById("cCpsObr").value;
	
	if (document.getElementById("cNumAut").value != "" && cCpsObr != "") {
		oForm.add( document.getElementById(cCpsObr) ,"tudo", false, false );
	}                
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё VaLiDa formulario													   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if( !valida() ) return;
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Verfica se foi digitado algum procedimento							   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	lVld = false;
	if (document.getElementById("cNumAut").value=="") {
	    if (document.getElementById("TabSolSer").rows.length==0 && document.getElementById("TabSolOpm").rows.length==0) { 
	    	lVld = true;
	    	cMsg = 'SolicitaГЦo';
	    }	
	} else {
		if (document.getElementById("TabExeSer").rows.length==0 && document.getElementById("TabExeOpm").rows.length==0) {
		   lVld = true;
	       cMsg = 'ExecuГЦo';
		}   
	}	 	                                   
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё aviso																   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (lVld) {
        alert("Informe pelo menos um serviГo para a " + cMsg);
        return;
    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Monta conteudo das tabelas	solicitacao e execucao					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if (document.getElementById("cNumAut").value=="")
		 aMatAux = "TabSolSer|TabSolOpm";
	else aMatAux = "TabExeSer|TabExeOpm";
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Carrega as linhas das tabelas para processamento					   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    aMat   		  = aMatAux.split("|");
    cStringEnvTab = "";
    
    for (var i = 0; i < aMat.length; i++) {
        
        oTable = document.getElementById(aMat[i]);
        fMontMatGer('A', aMat[i]);
        aMatCampAux = aMatCap.split("|");    
        
        for (var y = 1; y < oTable.rows.length; y++) {
            nf 	 = 0;
								
			cStringEnvTab += "cSeq@" + getTC(oTable.rows[y].cells[0]) + "$";

            for (var x = 2; x < (oTable.rows[y].cells.length + nf); x++) {
                cCampo = aMatCampAux[x - 2].split("$")[1];
                if (cCampo != "NIL" && aMatNGet.indexOf(cCampo)==-1) {
                	celula = oTable.rows[y].cells[x - nf];
                	
                	if (typeof celula.value == 'undefined' || celula.value == '')
	                	conteudo = getTC(celula);
	                else  conteudo = celula.value;	
	                
                	cStringEnvTab += cCampo + "@" + conteudo + "$";
				}
                if (aMatCampAux[x - 2].split("$")[0] == 'cfixo') nf += 1;

            }
            cStringEnvTab += "|";
        }
    }
    document.getElementById("cMatTabES").value = cStringEnvTab + "|";
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё trata campos														  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	setDisable("cIndCliSol",false);
	setDisable("cCbosSol",false);
	setDisable("cCbosExe",false);
	setDisable("cProSol",false);
	setDisable("cProExe",false);
	setDisable("bconfirma",true);
	setDisable("bcomplemento",false);
	setDisable("bimprimir",false);
	setDisable("cCarSolicit",false);
	<%If lPE%>
		setDisable("bcustom",false);
	<%EndIf%>
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Metodo de envio de formulario pelo ajax								  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    Ajax.send(formulario, { 
    		callback: CarregaProcForm,
    		error: ExibeErro 
    });
	document.forms[0].action = "";
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Desabilita os campos												  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FDisElemen('TESOP|TESO|TSSO|Tcs|Tdspo|BSolOpm|TabSolOpm|BSolSer|TabSolSer|Tdce|Tda|BExeOpm|TabExeOpm|BExeSer|TabExeSer|Toth',true);
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Marca todas as linhas para delecao e retira da matriz de sessao		  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    aTabDel = new Array("TabExeSer")
    for (var y = 0; y < aTabDel.length; y++) {
        document.getElementById(aTabDel[y]).ondblclick = function(){};
    }
}       
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o retorno do processamento										  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaProcForm(v) {
    var aResult = v.split("|");
    var cSenha  = "";
    var cTexto  = aResult[10]; //Procedimento autorizados ou negados resultado
    var cTitulo = aResult[11]; //Titulo do resultado autorizado,negado ou autorizado parcial
    var cMostra = aResult[12];
    var cAutori = aResult[0];    
	var cTexcli1 = ""    
    
     if (cMostra == "SIM") {
	    if (confirm("A paciente И gestante?"))
	      { Ajax.open("W_PPLPROCBD5.APW?cNumAut=" + cAutori,  true) }
	      
      }  
     

    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Informacoes	da autorizacao											  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (aResult[0] != "") document.getElementById("cNumAut").value = aResult[0].substr(0, 4) + "." + aResult[0].substr(4, 4) + "." + aResult[0].substr(8, 2) + "-" + aResult[0].substr(10, 8); //Numero da autorizacao
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Implementa Senha na exibicao										  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (aResult[1] != "") cSenha = "<br/> Senha: " + aResult[1];
	<%If lPE2%>
		cTexcli1 = "<br/>" + '<%=cTexcli%>';
	<%EndIf%>
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Alimenta campos														  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    document.getElementById("cSenha").value = aResult[1];   //Senha
    document.getElementById("dDtAut").value = aResult[2];   //Data da Autorizacao
    document.getElementById("dDtValid").value = aResult[3]; //Validade da Senha
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Para mostrar o numero da autorizacao								  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (cTexto == "") {
        cTexto = "<center>" + document.getElementById("cNumAut").value + cSenha + cTexcli1 +"</center>";

    } else {
        cTexto = "<center>" + document.getElementById("cNumAut").value + cSenha + cTexcli1 + "</center><br>" + cTexto;

    }
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Mostra o resultado modal											  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    ShowModal(cTitulo, cTexto);//dennis
}  

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Imprime a guia														  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fImpGuia() {
    var cNumAut = document.getElementById("cNumAut").value;
	ChamaPoP('W_PPLRELGEN.APW?cFunName=PPRELST&cReimpr=0&Field_NUMAUT=' + cNumAut ,'bol','yes',0,925,605);
}
                                                        
<%If lPE%>
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Botao customizado atraves de PE										  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды	
	function fcustom() {
	    cWindow=window.open('<%=aPEBotao[2]%>'+ '?cNumAut='+document.getElementById("cNumAut").value, '_blank','<%=aPEBotao[3]%>');
		cWindow.focus();
	}
<%EndIf%>

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta as rdas														  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fRda(cRda, cCodLoc) {
    Ajax.open("W_PPLDADRDA.APW?cRda=" + cRda + "&cCodLoc=" + cCodLoc, { 
    	callback: CarregaRda, 
    	error: ExibeErro
    });
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta campos conforme processamento da rdas							  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaRda(v) {
    var aResult = v.split("|");
    var aResuEsp = (aResult[24].substring(1)).split("~");
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Prepara para desabilitar solicitacao ou execucao					  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    lHab = (document.getElementById("cNumAut").value == "");
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Local de atendimento												  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    document.getElementById("cCodLoc").value = aResult[22];
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Solicitacao															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (lHab) {
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Dados da Autorizacao de Solicitacao									   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    document.getElementById("dDtAut").value			= "";
	    document.getElementById("cSenha").value			= "";
	    document.getElementById("dDtValid").value		= "";
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Dados do Solicitante												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    document.getElementById("cRegAns").value		= aResult[1];
	    document.getElementById("cCnpjCpfSol").value	= aResult[2];
	    document.getElementById("cNomeRdaSol").value 	= aResult[3];
	    document.getElementById("cCnesSol").value 		= aResult[4];
	    document.getElementById("cTpPe").value 			= aResult[14]; 
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Carater da Solicitacao												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    if (aResult[23]!="") {
		    document.getElementById("cCarSolicit").value = aResult[23]; 
		}    
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Se e fisica ou juridica												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
   		document.getElementById("cNomeSol").value 	= aResult[19];
		document.getElementById("cCodSigSol").value	= aResult[16];
	    document.getElementById("cNumCrSol").value 	= aResult[17];
	    document.getElementById("cEstSigSol").value	= aResult[18];
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta especialidades												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		setTC(document.getElementById("cCbosSol"),"");
		var e = document.getElementById("cCbosSol");
		for (var i = 0; i < aResuEsp.length; i++) {
			var aIten = aResuEsp[i].split("$");
			e.options[i] = new Option(aIten[1], aIten[0]);
		}
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Ajusta o compo do executante e formata a tela para a solicitacao	   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    	fAjusForm(lHab);	
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Se e fisica ou juridica												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    if (aResult[14].toUpperCase() == 'F') {
			setDisable("cProSol",true);
			setDisable('BIncSol',true);
			setDisable('BHelp16',true);
			setDisable('BHelp41',true);
		} else {
			setDisable("cProSol",false);
			setDisable('BIncSol',false);
			setDisable('BHelp16',false);
			setDisable('BHelp41',false);
		}
    } else {	                                                                   
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Dados do Executante  												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    document.getElementById("cCnpjCpfExe").value	= aResult[2];
	    document.getElementById("cNomeRdaExe").value 	= aResult[3];
	    document.getElementById("cCnesExe").value 		= aResult[4];
	    document.getElementById("cTpPe").value 			= aResult[14]; 
	    document.getElementById("cTpLogradExe").value 	= aResult[5]; 
	    document.getElementById("cLogNumComExe").value 	= aResult[6]; 
	    document.getElementById("cDistrictExe").value 	= aResult[7]; 
	    document.getElementById("cEstadoExe").value 	= aResult[8]; 
	    document.getElementById("cIBGEExe").value 		= aResult[9]; 
	    document.getElementById("cCepExe").value 		= aResult[10];      
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Se e fisica ou juridica												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
   		document.getElementById("cNomeExe").value = aResult[19];
   		
	    if (aResult[14].toUpperCase() == 'F') {
			document.getElementById("cCodSigExe").value	= aResult[16];
		    document.getElementById("cNumCrExe").value 	= aResult[17];
		    document.getElementById("cEstSigExe").value	= aResult[18];
   		    document.getElementById("cCpfExe").value 	= aResult[20];
		}
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё CBOS																   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		setTC(document.getElementById("cCbosExe"),"");
		var e = document.getElementById("cCbosExe");
	    for(var i=0; i < aResuEsp.length; i++) {
		   var aIten = aResuEsp[i].split("$"); 
	   	   e.options[i] = new Option(aIten[1], aIten[0]);
    	}   
	}	
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta os Solicitantes/Executante									  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cTimeOut = 0;
cProfAntG= "";
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Limpa variavel BackSpace ou Delete - chamado no keydown
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
function fProfSauClear(cTpProf) {
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё BackSpace e Delete etc nao sao capturadas pelo keypress
    //Ё por isso o tratamento desta forma. quando for backspace tem que retornar
    //Ё false para nao retornar a pagina anterior.
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    if (lVld2)  {
		fProfSauFil(cTpProf);                         
		return (LastkeyID == 8) ? false : true;
	}
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Busca lookup (filtrado) - chamado no keypress
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
function fProfSauFil(cTpProf) {
	cTpProfG    = cTpProf;
    var cRda 	= document.getElementById("cRda").value;
	var cCodLoc = document.getElementById("cCodLoc").value;
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё Executa o metodo													  
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    Ajax.open("W_PPLATUPRO.APW?cBusca=" + cString + "&cRda=" + cRda + "&cCodLoc=" + cCodLoc, { 
    	callback: CarregaProSaudeFil, 
    	error: ExibeErro,
    	showProc: false  
    });
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё Se nao for digitado nada no tempo abaixo limpa a string 30 segundos
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    clearTimeout(cTimeOut);
    cTimeOut = setTimeout("fProfSauRestart()", 30000);
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Limpa a variavel de busca no tempo determinado
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
function fProfSauRestart() {
    clearTimeout(cTimeOut);
    cString = "";
    cProfAntG = '';
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Carrega campos conforme processamento Profissional de saude			  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaProSaudeFil(v) {
	var i = 0;
    var j = 0;
    var lEntrou = false;                    
    var aResult = v.split("|"); 
	var cTexto = ""; 
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё Verfiica se e solicitacao ou execucao
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    if (cTpProfG == "S") {
    
		setTC(document.getElementById("cProSol"),"");
		var e = document.getElementById("cProSol");
		cTexto = "Solicitante";
	} else {
	
		setTC(document.getElementById("cProExe"),"");
		var e = document.getElementById("cProExe");      
		cTexto = "Executante";
	}
    
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё Alimenta o combo
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	if (LastkeyID == 46){
		e.options[0] = new Option('-- Selecione um '+cTexto+' --', '');
		j = 1;
	} 
	for (i; i < aResult.length; i++) {
		var aProf = aResult[i].split("%");
		if (aProf.length>1 && aProf[1] != '')
			e.options[i+j] = new Option(aProf[1], aProf[0]);
			if (aProf[0]!=''){
				lEntrou = true;
			}
	} 	
	if (!lEntrou){
		e.options[0] = new Option('-- ['+cString+'] nao localizado --', '');
	}		                 
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё carrega campos do prestador
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    if (cProfAntG != e.value) {
		cProfAntG = e.value;
		fProfSau(e.value,cTpProfG);
	}
}
                        
function fProfSau(cProSaud, cTpProf) {
    cTpPrestador = cTpProf;   
    var cMatric = document.getElementById("cNumeCart").value;
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Executa o metodo													  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    Ajax.open("W_PPCBOSPSAU.APW?cProSaud=" + cProSaud+ "&cMatric="+cMatric, { 
    	callback: CarregaProSaude, 
    	error: ExibeErro,
    	showProc: false 
    });
}                 

function CarrEspAnt(v){
	var aResult = v.split("|");
	var aResuEsp = (aResult[24].substring(1)).split("~");
	lHab = (document.getElementById("cNumAut").value == ""); 
	if (lHab) {
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta especialidades												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		setTC(document.getElementById("cCbosSol"),"");
		var e = document.getElementById("cCbosSol");
		for (var i = 0; i < aResuEsp.length; i++) {
			var aIten = aResuEsp[i].split("$");
			e.options[i] = new Option(aIten[1], aIten[0]);
		}   
	}
	
}

function CarrEspAntExe(v){
	var aResult = v.split("|");
	var aResuEsp = (aResult[24].substring(1)).split("~");
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Monta especialidades												   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	setTC(document.getElementById("cCbosExe"),"");
	var e = document.getElementById("cCbosExe");
	for (var i = 0; i < aResuEsp.length; i++) {
		var aIten = aResuEsp[i].split("$");
		e.options[i] = new Option(aIten[1], aIten[0]);
	}   
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Carrega campos conforme processamento Profissional de saude			  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaProSaude(v) {
    var aResult = v.split("|");
    
    if ( typeof(cTpPrestador) != 'undefined' ) {
        //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
        //Ё alimenta variaveis													  Ё
        //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        if (cTpPrestador == "S") {
				document.getElementById("cCodSigSol").value	= aResult[0];
	            document.getElementById("cNumCrSol").value	= aResult[1];
	            document.getElementById("cEstSigSol").value	= aResult[2];
	            document.getElementById("cNomeSol").value	= aResult[3];        		
				if (aResult.length >= 6){			    
					if ( typeof(aResult[6]) != 'undefined' ) {
				 		setTC(document.getElementById("cCbosSol"),"");			
				    	var aEspeci = aResult[6].split('$');		
						var e = document.getElementById("cCbosSol");
						for (var i = 0; i < aEspeci.length; i++) {
							var aIten = aEspeci[i].split("#");
							if (aIten[0] != '') {                  
								e.options[i] = new Option(aIten[1], aIten[0]);
						 	}	
						}
			    	}else{        
			    		var cRda 	= document.getElementById("cRda").value;
						var cCodLoc = document.getElementById("cCodLoc").value;
			    		Ajax.open("W_PPLDADRDA.APW?cRda=" + cRda + "&cCodLoc=" + cCodLoc, { 
					    	callback: CarrEspAnt, 
					    	error: ExibeErro
					    });    
			    	}
			    }else{        
			    		var cRda 	= document.getElementById("cRda").value;
						var cCodLoc = document.getElementById("cCodLoc").value;
			    		Ajax.open("W_PPLDADRDA.APW?cRda=" + cRda + "&cCodLoc=" + cCodLoc, { 
					    	callback: CarrEspAnt, 
					    	error: ExibeErro
					    });    
			    }
			           		
        } else { 
				document.getElementById("cCodSigExe").value	= aResult[0];
			    document.getElementById("cNumCrExe").value	= aResult[1];
	            document.getElementById("cEstSigExe").value	= aResult[2];
	            document.getElementById("cNomeExe").value 	= aResult[3];
	   		    document.getElementById("cCpfExe").value	= aResult[4];
        		if (aResult.length >= 6){			    
					if ( typeof(aResult[6]) != 'undefined' ) {
				 		setTC(document.getElementById("cCbosExe"),"");			
				    	var aEspeci = aResult[6].split('$');		
						var e = document.getElementById("cCbosExe");
						for (var i = 0; i < aEspeci.length; i++) {
							var aIten = aEspeci[i].split("#");
							if (aIten[0] != '') {                  
								e.options[i] = new Option(aIten[1], aIten[0]);
						 	}	
						}
			    	}else{        
			    		var cRda 	= document.getElementById("cRda").value;
						var cCodLoc = document.getElementById("cCodLoc").value;
			    		Ajax.open("W_PPLDADRDA.APW?cRda=" + cRda + "&cCodLoc=" + cCodLoc, { 
					    	callback: CarrEspAntExe, 
					    	error: ExibeErro
					    });    
			    	}
			    }else{        
			    		var cRda 	= document.getElementById("cRda").value;
						var cCodLoc = document.getElementById("cCodLoc").value;
			    		Ajax.open("W_PPLDADRDA.APW?cRda=" + cRda + "&cCodLoc=" + cCodLoc, { 
					    	callback: CarrEspAntExe, 
					    	error: ExibeErro
					    });    
			    	}
        }                                   
    }       
       
}                       
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Checa se o procedimento e valido									  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fChkCodPro(cCmpPad, cCmpPro, cCmpDesc, cTpProc) {
    cCampoRef 	 = cCmpPro;
    cCampoRefDes = cCmpDesc;
	
    cCodPad = document.getElementById(cCmpPad).value;
    cCodPro = document.getElementById(cCmpPro).value;

    //este procedimento ja foi validado e estА ok, nЦo И necessАrio realizar outra validaГЦo
    //este cenАrio ocorre quando И inserido o procedimento pelo F3
    if (cLastProcVld != "" && cLastProcVld == cCodPad + " " + cCodPro) 
        return true;
    else
        cLastProcVld = cCodPad + " " + cCodPro;

    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
    //Ё Limpa descricao do procedimento										  Ё
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    document.getElementById(cCmpDesc).value = "";

    if (cCodPad == "") {
		setDisable("bISolSer", true);
        alert("Informe o cСdigo da tabela");
        document.getElementById(cCmpPad).focus();
        return false;
    }

    if (cCodPro == "") return true;	

    Ajax.open("W_PPLSCHKSER.APW?cCodPadPro=" + ( cCodPad + cCodPro ) + "&cTpProc=" + cTpProc, { 
    	callback: CarregaDeskPro, 
    	error: ExibeErro 
    });
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Mostra a descricao do procedimento									  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function CarregaDeskPro(v) {
    var aResult = v.split("|");
    
    if(typeof cCampoRefDes != 'undefined') document.getElementById(cCampoRefDes).value = aResult[0];
    document.getElementById(cCampoRefDes).value = document.getElementById(cCampoRefDes).value.replace( /\?/, "" );
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Tratamento para indicaГЦo clinica									   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    if (aResult[1]=='1') document.getElementById("cCmpIndCli").value += cCodPro+"~";
    
	if (aResult[5] == "forbla") {
		alert(aResult[6]);
	}

	setDisable("bISolSer", false);
}
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  Ё fChkQtdPro ╨Autor  ЁMicrosiga         ╨ Data Ё  01/10/13   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё Valida a exibiГЦo do lembrete do procedimento com base     ╨╠╠
╠╠╨          Ё na quantidade solicitada.                                  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё SEGMENTO SAUDE                                             ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
function fChkQtdPro() {
	var cCodPad = document.getElementById('cCodPadSSol').value;
	var cCodPro = document.getElementById('cCodProSSol').value;
	var cQtdPro = document.getElementById('cQtdSSol').value;

	Ajax.open("W_PPLSQTD.APW?cCodPad=" + cCodPad  + "&cCodPro=" + cCodPro + "&cQtdPro=" + cQtdPro, {  
    	callback: CarregaQTD, 
    	error: ExibeErro 
    });
} 

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Exibe a tela de lembrete do procedimento.							  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды  
function CarregaQTD(v) {  

var aResult = v.split("|");  
	alert(aResult[1]); 
}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Checa se o cid e valido												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fChkCid(ref) {           
	if (ref.value == "") return true;
    cCampoRef = ref.name;
	Ajax.open("W_PPLSCHKCID.APW?cChkCid="+ref.value, {error: ExibeErro} );
}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Exibe erros no processamento das funcoes						 	   Ё 
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function ExibeErro(v) {
    var aResult = v.split("|");

    cLastProcVld = "";
	setDisable("bISolSer", true);

    if (aResult[0] != "true" && aResult[0] != "false") alert("Erro: " + aResult[0])
    else {
        if (aResult[0] == "false") {
            alert(aResult[1]);
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Move o focu para o campo											  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            if (typeof cCampoRef != 'undefined' && !document.getElementById(cCampoRef).disabled) document.getElementById(cCampoRef).focus();
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Limpa campo															  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            if (typeof cCampoRefL != 'undefined' && cCampoRefL != '' && !document.getElementById(cCampoRefL).disabled) {
                document.getElementById(cCampoRefL).value = "";
                cCampoRefL = "";
            }
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Ativa campo como obrigatorio										  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            if (typeof cCampoRefObr != 'undefined') {
                oForm.add(document.getElementById(cCampoRefObr), "tudo", false, false);
            }
            //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
            //Ё Para controle de exclusao											  Ё
            //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
            if (typeof cCpoRegEsp != 'undefined' && typeof cCpoRegCon != 'undefined') {
                document.getElementById(cCpoRegEsp).value += cCpoRegCon + '|';
            }
        }
    }
}
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Botao complemento a ser implementado pelo usuario	 		    	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
function fComplemento() {
	var pRda    = document.getElementById("cRda").value;
	var pCodLoc = document.getElementById("cCodLoc").value;
	var pTp     = document.getElementById("cTp").value;
	var pNumAut = document.getElementById("cNumAut").value;

	setDisable("bcomplemento",true);
	ChamaPoP('W_PPLSCMPFP.APW?cFunName=PLSCMPFP&cNumAut='+pNumAut+'&cRda='+pRda+'&cCodLoc='+pCodLoc+'&cTp='+pTp,'bol','yes',0,925,605);
}   
//-->
</script>
</head>

<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" class="space">
<form name="form1" action="" method="post">
<% If Type("HttpSession->cCmpl") <> "U" %>
<input type="hidden" name="cCmpl" id="cCmpl" value="<%=HttpSession->cCmpl%>">
<% EndIf %>
<% If Type("HttpSession->cTp") <> "U" %>
<input type="hidden" name="cTp" id="cTp" value="<%=HttpSession->cTp%>">
<% EndIf %>
<input type="hidden" name="cRda" id="cRda" value="<%=HttpGet->cRda%>">
<input type="hidden" name="cCodLoc" id="cCodLoc" value="<%=HttpGet->cCodLoc%>">
<input type="hidden" name="cChvBD6" id="cChvBD6" value="">
<input type="hidden" name="cTpPe" id="cTpPe" value="">
<input type="hidden" name="cNomeSol" id="cNomeSol" value="">
<input type="hidden" name="cNomeExe" id="cNomeExe" value="">
<input type="hidden" name="cStatusAut" id="cStatusAut" value="0">
<input type="hidden" name="cMatTabES" id="cMatTabES" value="">
<input type="hidden" name="cCmpIndCli" id="cCmpIndCli" value="">
<input type="hidden" name="cRegEsp" id="cRegEsp" value="<%=HttpSession->ExisRegEsp%>">
<input type="hidden" name="cIteRegEsp" id="cIteRegEsp" value="">
<input type="hidden" name="cCpsObr" id="cCpsObr" value="<%=HttpSession->cObrCpGuia%>">

<div id="ModalPage">
    <div class="ModalBackground"></div>
    <div id="ModalContainer" class="ModalContainer"></div>
</div>

<table width="860" border="0"  cellpadding="0" cellspacing="0">
<tr>
<td>
<table width="860" border="0" align="center" cellpadding="0" cellspacing="0">
<tr><td height="40" class="TituloCab">&raquo; Autoriza&ccedil;&atilde;o - Guia de Servi&ccedil;o Profissional / Servi&ccedil;o Auxiliar de Diagn&oacute;stico e Terapia - SP/SADT</td></tr>


<tr valign="top">
<td>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td>
<table width="860" border="1" align="center" cellpadding="0" cellspacing="0" bordercolor="#EDEDED" bgcolor="#EDEDED">
<tr>
<td bordercolor="#FFFFFF">
<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table width="100%" height="83" border="0" cellpadding="0" cellspacing="0">
<tr>
	<td width="187" height="83"><img src="<%=GetPrtSkin()%>/logoinst.gif" type="img" alt="Logo Institucional" width="186" height="83" align="middle" ismap="ismap"/></td>
	<td width="355" align="center" class="Titulo">Guia de Servi&ccedil;o Profissional / Servico Auxiliar de Diagn&oacute;stico e Terapia - SP/SADT</td>
	<td align="left" width="215" class="TextoLabel"><span>&nbsp;2-N&ordm;</span>
		<input name="cNumAut" id="cNumAut" type="text" class="TextoInputOB" value="" size="27" maxlength="21" onKeyPress="return TxtBoxFormat(this, event,'9999.9999.99-99999999');"/>
		<img src="<%=GetPrtSkin()%>/chk.gif" name="BChaSol" id="BChaSol" title="Busca SolicitaГЦo" width="18" height="18" border="0" align="top" style="cursor:pointer" onClick="fChamLibera(cNumAut.value);"/>&nbsp;
	</td>
</tr>
</table>
</td>
<td width="3">&nbsp;</td>
</tr>
<tr>
<td height="40">&nbsp;</td>
<td>
<table border="0" align="left" cellpadding="0" cellspacing="0">
<tr valign="bottom">
<td class="TextoLabel"><span>1-Registro ANS</span><br />
<input id="cRegAns" name="cRegAns" type="text" class="TextoInputOB" value="" size="12" maxlength="6" readonly="Yes"/>&nbsp;</td>

<td class="TextoLabel"><span>3-N&ordm; Guia Principal</span><br />
	<input name="cGuiaPrincipal" id="cGuiaPrincipal" type="text" class="TextoInputOP" value="" size="25" maxlength="22" alt="Paciente Internado" onKeyPress="return TxtBoxFormat(this, event,'9.999.9999.99-99999999');"/>&nbsp;
</td>

<td class="TextoLabel"><span>4-Data de Autoriza&ccedil;&atilde;o</span><br />
	<input name="dDtAut" type="text" id="dDtAut" class="TextoInputOP" value="" size="19" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel"><span>5-Senha</span><br />
	<input name="cSenha" type="text" id="cSenha" class="TextoInputOP" value="" size="15" maxlength="6" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel"><span>6-Dt Validade Senha</span><br />
	<input name="dDtValid" type="text" id="dDtValid" class="TextoInputOP" value="" size="18" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel"><span>7-Dt Emiss&atilde;o Guia</span><br/>
	<input name="dDtEmissao" id="dDtEmissao" type="text" class="TextoInputOB" value="<%=Date()%>" size="17" readonly="Yes"/>
</td>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Dados do Beneficiario</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup" onClick="MEObj('Tdb')">
		<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITdb" type="img"></div>
	</td>
</tr>
</table>
</td>
</tr>

<tr id="Tdb" name="Tdb">
<td>
<table border="0" cellpadding="0" cellspacing="0">

<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel">8-N&uacute;mero da Carteira<br/>
<input name="cNumeCart" id="cNumeCart" type="text" class="TextoInputOB" value="<%=Iif( !HttpSession->aVldCartao[10], HttpSession->aVldCartao[2] , HttpSession->aVldCartao[11] )%>" size="30" maxlength="20" readonly="Yes"/>&nbsp;</td>
<td class="TextoLabel">9-Plano<br/>
<input name="cPlano" id="cPlano" type="text" class="TextoInputOB" value="<%=HttpSession->aVldCartao[6]%>" size="45" maxlength="40" readonly="Yes"/>&nbsp;</td>
<td class="TextoLabel">10-Validade da Carteira<br/>
<input name="cVldCarteira" id="cVldCarteira" type="text" class="TextoInputOP" value="<%=SToD(HttpSession->aVldCartao[4])%>" size="30" maxlength="10" readonly="Yes" />&nbsp;</td>
</tr>
</table>
</td>
</tr>

<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel">11-Nome<br/>
<input name="cNomeUsu" id="cNomeUsu" type="text" class="TextoInputOB" value="<%=HttpSession->aVldCartao[1]%>" size="65" maxlength="70" readonly="Yes" />&nbsp;</td>
<td class="TextoLabel">12-N&uacute;mero do Cart&atilde;o Nacional de Sa&uacute;de<br/>
<input name="cNumCarSau" id="cNumCarSau" type="text" class="TextoInputOP" value="<%=HttpSession->aVldCartao[9]%>" size="50" maxlength="15" readonly="Yes" />&nbsp;</td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table width="100%" border="0" cellpadding="0" cellspacing="0">

<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Dados do Contratado Solicitante</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup"  onClick="MEObj('Tcs')">
	<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITcs" type="img"></div>
	</td>
  </tr>
</table>
</td>
</tr>

<tr id="Tcs" name="Tcs">
<td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>13-C&oacute;digo na Operadora / CNPJ / CPF</span><br />
	<input name="cCnpjCpfSol" type="text" class="TextoInputOB" id="cCnpjCpfSol" value="" size="35" maxlength="14" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>14-Nome do Contratado </span><br />
	<input name="cNomeRdaSol" type="text" class="TextoInputOB" id="cNomeRdaSol" value="" size="60" maxlength="70" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>15-C&oacute;digo CNES</span><br />
	<input name="cCnesSol" type="text" class="TextoInputOP" id="cCnesSol" value="" size="16" maxlength="7" readonly="Yes" />&nbsp;
</td>
</tr>
</table></td>
</tr>

<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>

<td class="TextoLabel">
<span>16-Nome do Profissional Solicitante</span><br />
<select name="cProSol" id="cProSol" style="width: 245px" onkeydown="manutString(event); vwaitAjax(event,'S'); return false;" onchange="fProfSau(this.value,'S');" class="ComboSelectOP">
<% If Type("HttpSession->PROSAUD") <> "U" %>
	<% If Len( HttpSession->PROSAUD ) > 1 %>
		<option value="">-- Selecione um Solicitante --</option>
		<% For nI := 1 To Len( HttpSession->PROSAUD ) %>
			<option value="<%=HttpSession->PROSAUD[nI]:cCODE%>"<%=IIf( HttpPost->cProSol == HttpSession->PROSAUD[nI]:cCODE, "selected", "" )%>><%=HttpSession->PROSAUD[nI]:cNAME%></option>
		<% Next nI %>              
	<% ElseIf Empty( HttpSession->PROSAUD ) %>
		<option value="">-- Informe um Solicitante --</option>
	<% ElseIf Len( HttpSession->PROSAUD ) > 0 %>
		<option selected="selected" value="<%=HttpSession->PROSAUD[1]:cCODE%>"><%=HttpSession->PROSAUD[1]:cNAME%></option>
		<script>
		// <![CDATA[
			fProfSau(<%="'" + HttpSession->PROSAUD[1]:cCODE + "'"%>,'S');
		// ]]>
		</script>
	<% EndIf %>
<% EndIf %>
</select>                

<img src="<%=GetPrtSkin()%>/ico_incluir.gif"  name="BIncSol" id="BIncSol" title="Incluir" width="18" height="18" align="top"  	  style="cursor:pointer" border="0" onclick="ChamaPoP('W_PPLFINCPR.APW?cRda=<%=HttpGet->cRda%>&cCodLoc=<%=HttpGet->cCodLoc%>&cTp=2','_blank','no'); " />&nbsp;
<img src="<%=GetPrtSkin()%>/interrogacao.gif" name="BHelp16" id="BHelp16" title="Ajuda"  valign="middle" style="cursor:pointer" border="0" onClick="fAbre('W_PPLSHELP.APW')">&nbsp;
</td>  
       
<td class="TextoLabel"><span>17-Conselho Profissional</span><br />                                                                
	<input name="cCodSigSol" id="cCodSigSol" type="text" class="TextoInputOB"  value="" size="25" maxlength="7" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>18-N&uacute;mero no Conselho</span><br />
	<input name="cNumCrSol" id="cNumCrSol"  type="text"  class="TextoInputOB" value="" size="24" maxlength="15" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>19-UF</span><br />
	<input name="cEstSigSol" id="cEstSigSol"  type="text" class="TextoInputOB" value="" size="4" maxlength="2" readonly="Yes" />&nbsp;
</td>                                         
</tr>
</table>
</td>
</tr>

<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>20-C&oacute;digo CBO s</span><br />
	<select name="cCbosSol" id="cCbosSol" class="ComboSelectOP"  style="width: 130px"></select>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">

<tr>
<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Dados da Solicita&ccedil;&atilde;o / Procedimentos e Exames Solicitados /OPM</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup"  onClick="MEObj('Tdspo')">
	<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITdspo" type="img"></div>
	</td>
  </tr>
</table>
</td>
</tr>
<tr id="Tdspo" name="Tdspo" height="40">
<td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="40" class="TextoLabel">&nbsp;
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td class="TextoLabel"><span>21-Data/hora de Solicita&ccedil;&atilde;o</span><br />
<input name="dDtSolicit" type="text"  class="TextoInputOP" id="dDtSolicit" value="<%=Date()%>" size="20" maxlength="10" readonly="Yes"/>
<input name="cHrSolicit" type="text" class="TextoInputOP" id="cHrSolicit" value="<%=SubStr(Time(),1,5)%>" size="8" maxlength="5" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel">22-Car&aacute;ter da Solicita&ccedil;&atilde;o<br />
<select name="cCarSolicit" class="ComboSelectOB" id="cCarSolicit" style="width: 140px">
<option value="">-- Car. Solicita&ccedil;&atilde;o --</option>
<% If Type("HttpSession->aCarSolict") <> "U"
	For nI := 1 To Len(HttpSession->aCarSolict) %>
		<option value="<%=HttpSession->aCarSolict[nI]:cCode%>"><%=HttpSession->aCarSolict[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>&nbsp;
</td>
<td class="TextoLabel"><span>23-CID 10</span><br/>
	<input name="cCid" id="cCid" type="text" class="TextoInputOP" value="" size="11" maxlength="5" onblur="fChkCid(this)"/>
	<img src="<%=GetPrtSkin()%>/ico-lupa.gif" name="BCid" id="BCid" width="18" height="18" border="0" style="cursor:pointer" align="top" title="Pesquisa" onclick="if(!this.disabled)return ChamaPoP('W_PPLSXF3.APW?cFunName=PLSF3BA9&F3Nome=Cid&F3CmpDes=cCid','jF3','yes');">&nbsp;
</td>
</tr>
</table></td>
</tr>
<tr>
<td height="50" class="TextoLabel"><span>24-Indica&ccedil;&atilde;o Cl&iacute;nica</span><br/>
	<textarea name="cIndCliSol" id="cIndCliSol" cols="136" style='height:6em;width:97%;margin-bottom:0.2em' rows="2" class="TextoInputOP" onkeydown="if(this.value.length >= 500){ return false; }" alt="Obrigat&oacute;rio se pequena cirurgia, terapia, consulta referenciada e alto custo" width=""></textarea>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
<td>&nbsp;</td>
</tr>         
<tr>
<td>&nbsp;</td>
<td>
<table width="100%" border="0" cellpadding="0" cellspacing="0">

<tr>
<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Solicita&ccedil;&atilde;o de Servi&ccedil;os ou OPM</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup"  onClick="MEObj('Tsso')">
	<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITsso" type="img"></div>
	</td>
  </tr>
</table>
</td>
</tr>
<tr id="Tsso" name="Tsso" height="40">
<td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="100%">
<div class="MenuTab">
<ul class="MenuTabs">
	<li><a href="#Ser">Servi&ccedil;o</a></li>
	<li><a href="#Opm">Opm</a></li>
</ul>

<div class="divMT">
<a name="Ser" id="Ser"></a>

<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td>

<table class="tableMT" height="171" border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="65" colspan="5">

<table class="subTableMT" border="0" cellspacing="0" cellpadding="0">
<tr>
	<td colspan="5">
	<table border="0" cellpadding="0" cellspacing="0">
	<tr><td>
		<div id="BSolSer" name="BSolSer" class="posicaoLeft">
			<input name="*" id="bISolSer" type="button" value="Incluir" disabled class="Botoes" onclick="fRegEsp('cObs') ; fMontItens('I','TabSolSer')"/>
			<input name="*" id="bASolSer" type="button" value="Alterar" class="Botoes" onclick="fMontItens('A','TabSolSer')"/>
			<input name="bESolSer" id="bESolSer" type="button" value="Excluir" class="Botoes" onclick="fRegEspExc('cObs','TabSolSer'); fMontItens('E','TabSolSer')"/>
		</div>
	</td></tr>
	</table>
	</td>
</tr>            

<tr id='TSSO' name='TSSO'>
<td height="40" class="TextoLabel"><span>25-Tabela</span><br />
	<input name="Tabela" id="cCodPadSSol" type="text" class="TextoInputOP" value="<%=HttpSession->cCodPad%>" size="10" maxlength="2" width=""/>&nbsp;
</td>
	
<td height="40" class="TextoLabel"><span>26-C&oacute;digo Procedimento&nbsp;</span><br />
	<input name="Servi&ccedil;o" id="cCodProSSol" type="text" class="TextoInputOP" value="" size="20" maxlength="10" onblur="fChkCodPro('cCodPadSSol','cCodProSSol','cDesProSSol','0,1,2,3,4,6,7,8')"/>
	<img src="<%=GetPrtSkin()%>/ico-lupa.gif" name="BCodProSSol" id="BCodProSSol" width="18" height="18" border="0" style="cursor:pointer" align="top" title="Pesquisa" onclick="if(!this.disabled)return ChamaPoP('W_PPLSXF3.APW?cFunName=PLF3BR8P&F3Nome=cCodProSSol&F3CmpDes=cCodProSSol,cDesProSSol&cVldGen='+cCodPadSSol.value+'&lOnBlur=T','jF3','yes');">&nbsp;&nbsp;
</td>
<td height="40" class="TextoLabel"><span>27-Descri&ccedil;&atilde;o</span><br />
<input name="Descri&ccedil;&atilde;o" type="text" class="TextoInputOB" id="cDesProSSol" value="" size="60" maxlength="60" readonly="Yes"/>&nbsp;</td>
<td height="40" class="TextoLabel"><span>28-Qt.Solic.</span><br />
<input name="Qtd. Sol." type="text" class="TextoInputOB" id="cQtdSSol" value="1" size="11" maxlength="3" width="" onblur="fChkQtdPro()"/>&nbsp;</td>
<td height="40" class="TextoLabel"><span>29-Qt.Autoriz</span><br />
<input name="Qtd. Aut." type="text" class="TextoInputOB" id="cQtdAutSSol" value="" size="12" maxlength="3" readonly="Yes" width=""/></td>
</tr>
</table>
</td>
</tr>

<tr>
<td height="106">
	<div style="overflow: auto; height: 100px; width: 800px" class="FundoClaro divGridMT">
		<table id="TabSolSer" border="0" cellpadding="0" cellspacing="0">
		</table>
	</div>
</td>
</tr>

</table>
</td>
</tr>
</table>
</div>

<div class="divMT">
<a name="Opm" id="Opm"></a>

<table class="tableMT" height="171" border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="65" colspan="6">

<table class="subTableMT" border="0" cellspacing="0" cellpadding="0">

<tr>
<td colspan="6">
	<table border="0" cellpadding="0" cellspacing="0">
	<tr><td>
		<div id="BSolOpm" name="BSolOpm" class="posicaoLeft">
			<input name="bISolOpm" id="bISolOpm" type="button" value="Incluir" class="Botoes" onclick="fMontItens('I','TabSolOpm')"/>
			<input name="*" id="bASolOpm" type="button" value="Alterar" class="Botoes" onclick="fMontItens('A','TabSolOpm')"/>
			<input name="bESolOpm" id="bESolOpm" type="button" value="Excluir" class="Botoes" onclick="fMontItens('E','TabSolOpm')"/>
		</div>
	</td></tr>
	</table>
</td>
</tr>
<tr>

<td height="40" class="TextoLabel"><span>72-Tabela</span><br />
	<input name="Tabela" id="cCodPadOSol" type="text" class="TextoInputOP" value="<%=HttpSession->cCodPad%>" size="8" maxlength="2" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>73-C&oacute;digo do OPM</span><br />
	<input name="Servi&ccedil;o" id="cCodProOSol" type="text" class="TextoInputOP" size="20" maxlength="10" onblur="fChkCodPro('cCodPadOSol','cCodProOSol','cDesProOSol','5')"/>
	<img src="<%=GetPrtSkin()%>/ico-lupa.gif" name="BCodProOSol" id="BCodProOSol" width="18" height="18" border="0" style="cursor:pointer" align="top" title="Pesquisa" onclick="if(!this.disabled)return ChamaPoP('W_PPLSXF3.APW?cFunName=PLF3BR8O&F3Nome=cCodProOSol&F3CmpDes=cCodProOSol,cDesProOSol&cVldGen='+cCodPadOSol.value,'jF3','yes');">&nbsp;
</td>
<td height="40" class="TextoLabel"><span>74-Descri&ccedil;&atilde;o OPM</span><br />
	<input name="Descri&ccedil;&atilde;o" type="text" class="TextoInputOP" id="cDesProOSol" value="" size="80" maxlength="60" readonly="Yes"/>&nbsp;
</td>
</tr>

<tr>
<td height="40" class="TextoLabel"><span>75-Qtde.</span><br />
	<input name="Qtd. Sol." type="text" class="TextoInputOP" id="cQtdOSol" value="1" size="8" maxlength="2" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>76-Fabricante</span><br />
	<input name="Fabricante" type="text" class="TextoInputOP" id="cFabOSol" value="" size="23" maxlength="40" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>77-Vlr Unit&aacute;rio R$</span><br />
	<input name="Vlr. Unit." type="text" class="TextoInputOP" id="nVlrUniOSol" value="" size="17" maxlength="10" onKeyPress="return FormatMoeda(this, event, ',', '.');"/>
</td>
</tr>
</table>
</td>
</tr>

<tr>
<td height="106">
	<div style="overflow: auto; height: 100px; width: 800px" class="FundoClaro divGridMT">
		<table id="TabSolOpm" border="0" cellpadding="0" cellspacing="0">
		</table>
	</div>
</td>
</tr>

</table>
</div>

</div></td>
</tr>
</table></td>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><table width="100%" border="0" cellspacing="0" cellpadding="0">

<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Dados do Contratado Executante</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup"  onClick="MEObj('Tdce')">
	<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITdce" type="img"></div>
	</td>
  </tr>
</table>
</td>
</tr>

<tr id="Tdce" name="Tdce">
<td>
<table height="160" border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>30-C&oacute;digo na Operadora / CNPJ / CPF</span><br />
<input name="cCnpjCpfExe" type="text" class="TextoInputOB" id="cCnpjCpfExe" value="" size="40" maxlength="14" readonly="Yes" />
&nbsp;</td>
<td class="TextoLabel"><span>31-Nome do Contratado</span><br />
<input name="cNomeRdaExe" type="text" class="TextoInputOB" id="cNomeRdaExe" value="" size="65" maxlength="70" readonly="Yes" />
&nbsp;</td>
<td class="TextoLabel"><span>32-T.Log</span><br />
<input name="cTpLogradExe" id="cTpLogradExe"type="text" class="TextoInputOP" value="" size="8" maxlength="3" readonly="Yes" />
&nbsp;</td>
</tr>
</table></td>
</tr>
<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>33-34-35-Logradouro - N&uacute;mero - Complemento</span><br />
	<input name="cLogNumComExe" type="text" class="TextoInputOP" id="cLogNumComExe" value="" size="50" maxlength="60" readonly="yes" />&nbsp;
</td>
<td class="TextoLabel"><span>36-Munic&iacute;pio</span><br />
	<input name="cDistrictExe" type="text" class="TextoInputOP" id="cDistrictExe" value="" size="25" maxlength="40" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>37-UF</span><br />
	<input name="cEstadoExe" type="text" class="TextoInputOP" id="cEstadoExe" value="" size="7" maxlength="2" readonly="Yes" />&nbsp;
</td>

</tr>
</table>
</td>
</tr>

<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>38-C&oacute;digo IBGE</span><br />
	<input name="cIBGEExe" type="text" class="TextoInputOP" id="cIBGEExe" value="" size="15" maxlength="7" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>39-CEP</span><br />
	<input name="cCepExe" type="text" class="TextoInputOP" id="cCepExe" value="" size="10" maxlength="9" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>40-C&oacute;digo CNES</span><br />
	<input name="cCnesExe" type="text" class="TextoInputOP" id="cCnesExe" value="" size="15" maxlength="7" />&nbsp;
</td>
</tr>
</table></td>
</tr>
<tr>
<td height="40"><table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>40a-C&oacute;digo na Operadora /CPF</span> do exec. complem.&nbsp;<br />
	<input name="cCpfExe" type="text" class="TextoInputOP" id="cCpfExe" value="" size="50" maxlength="14" readonly="Yes" />&nbsp;
</td>

<td class="TextoLabel">
	<span>41-Nome do Profissional Executante/Complem.</span><br />
	<select name="cProExe" id="cProExe" onkeydown="manutString(event); vwaitAjax(event,'E'); return false;" onchange="fProfSau(this.value,'E');" style="width: 249px" class="ComboSelectOP">
	
	<% If Type("HttpSession->PROSAUD") <> "U" %>
		<% If Len( HttpSession->PROSAUD ) > 1 %>
			<option value="">-- Selecione um Executante --</option>
			<% For nI := 1 To Len( HttpSession->PROSAUD ) %>
				<option value="<%=HttpSession->PROSAUD[nI]:cCODE%>"<%=IIf( HttpPost->cProExe == HttpSession->PROSAUD[nI]:cCODE, "selected", "" )%>><%=HttpSession->PROSAUD[nI]:cNAME%></option>
			<% Next nI %>
		<% ElseIf Empty( HttpSession->PROSAUD ) %>
			<option value="">-- Informe um Solicitante --</option>
		<% ElseIf Len( HttpSession->PROSAUD ) > 0 %>
			<option selected="selected" value="<%=HttpSession->PROSAUD[1]:cCODE%>"><%=HttpSession->PROSAUD[1]:cNAME%></option>
			<script>
			// <![CDATA[
				fProfSau(<%="'"+HttpSession->PROSAUD[1]:cCODE+"'"%>,'E');
			// ]]>
			</script>
		<% EndIf %>
	<% EndIf %>
	
	</select>
	<img src="<%=GetPrtSkin()%>/ico_incluir.gif" name="BIncExe" id="BIncExe" title="Incluir" width="18" height="18" border="0" align="top" style="cursor:pointer" onclick="ChamaPoP('W_PPLFINCPR.APW','_blank','no');" />&nbsp;
	<img src="<%=GetPrtSkin()%>/interrogacao.gif" name="BHelp41" id="BHelp41" title="Ajuda" valign="middle" style="cursor:pointer" border="0" onClick="fAbre('W_PPLSHELP.APW')">&nbsp;
</td>

<td class="TextoLabel"><span>42-Conselho Profissional</span><br />
<input name="cCodSigExe" type="text" class="TextoInputOP" id="cCodSigExe" value="" size="22" maxlength="7" readonly="Yes" />
</td>
</tr>
</table></td>
</tr>
<tr>
<td height="40">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>43-N&uacute;mero no Conselho</span><br />
<input name="cNumCrExe" type="text" class="TextoInputOP" id="cNumCrExe" value="" size="25" maxlength="15" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>44-UF</span><br />
<input name="cEstSigExe" type="text" class="TextoInputOP" id="cEstSigExe" value="" size="6" maxlength="2" readonly="Yes" />&nbsp;
</td>
<td class="TextoLabel"><span>45-C&oacute;digo CBO s</span><br />
<select name="cCbosExe" class="ComboSelectOP" id="cCbosExe" style="width: 200px"></select>&nbsp;
</td>

<td class="TextoLabel"><span>45a-Grau de Participa&ccedil;&atilde;o</span><br />
<select name="cGraPartExe" class="ComboSelectOP" id="cGraPartExe" style="width: 140px">
<option value="">-- Grau Particip. --</option>
<% If Type("HttpSession->aGraPart") <> "U"
	For nI := 1 To Len(HttpSession->aGraPart) %>
		<option value="<%=HttpSession->aGraPart[nI]:cCode%>"><%=HttpSession->aGraPart[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>
</td>

</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><table width="100%" border="0" cellspacing="0" cellpadding="0">

<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Dados do Atendimento</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup"  onClick="MEObj('Tda')">
	<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITda" type="img"></div>
	</td>
  </tr>
</table>
</td>
</tr>

<tr id="Tda" name="Tda" height="40">
<td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel">46-Tipo de Atendimento<br />
<select name="cTpAteExe" class="ComboSelectOB" id="cTpAteExe" style="width: 135px" >
<option value="">-- Tipo Atendimen. --</option>
<% If Type("HttpSession->aTpAtend") <> "U"
	For nI := 1 To Len(HttpSession->aTpAtend) %>
		<option value="<%=HttpSession->aTpAtend[nI]:cCode%>"><%=HttpSession->aTpAtend[nI]:cDescription%></option>
	<% Next nI
EndIf %>
</select>&nbsp;
</td>

<td class="TextoLabel">47-Indica&ccedil;&atilde;o de Acidente<br />
<select name="cIndAcid" id="cIndAcid" class="ComboSelectOP" style="width: 140px" >
<option value="">-- Ind Acidente --</option>
<% If Type("HttpSession->aIndAcid") <> "U"
	For nI := 1 To Len(HttpSession->aIndAcid) %>
		<option value="<%=HttpSession->aIndAcid[nI]:cCode%>"><%=HttpSession->aIndAcid[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>&nbsp;
</td>
<td class="TextoLabel">48-Tipo de Sa&iacute;da<br />
<select name="cTpSai" id="cTpSai" class="ComboSelectOB" style="width: 115px">
<option value="">-- Tipo Sa&iacute;da --</option>
<% If Type("HttpSession->aTpSai") <> "U"
	For nI := 1 To Len(HttpSession->aTpSai) %>
		<option value="<%=HttpSession->aTpSai[nI]:cCode%>"><%=HttpSession->aTpSai[nI]:cDescription%></option>
	<% Next nI                         
EndIf%>
</select>&nbsp;
</td>
<td class="TextoLabel">49-T&iacute;po de Doen&ccedil;a<br />
<select name="cTpDoe" id="cTpDoe" class="ComboSelectOP" style="width: 120px">
<option value="">-- Tipo Doen&ccedil;a --</option>
<% If Type("HttpSession->aTpDoe") <> "U"
	For nI := 1 To Len(HttpSession->aTpDoe) %>
		<option value="<%=HttpSession->aTpDoe[nI]:cCode%>"><%=HttpSession->aTpDoe[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>&nbsp;
</td>
<td class="TextoLabel">50-Tempo de Doen&ccedil;a<br />
<input name="cTmpDoe" id="cTmpDoe" type="text" class="TextoInputOP" value="<%=HttpSession->cTmpDoe%>" size="6" maxlength="2" width=""/>
<select name="cTmpDoeC" id="cTmpDoeC" class="ComboSelectOP" style="width: 135px">
<option value="">-- Tempo Doen&ccedil;a --</option>
<% If Type("HttpSession->aTmpDoe") <> "U"
	For nI := 1 To Len(HttpSession->aTmpDoe) %>
		<option value="<%=HttpSession->aTmpDoe[nI]:cCode%>"><%=HttpSession->aTmpDoe[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table width="100%" border="0" cellpadding="0" cellspacing="0">

<tr>
<td width="100%" bgcolor="#999999">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr class="trGroup">
    <td width="98%"><span class="TituloSubItens">Execu&ccedil;&atilde;o de Servi&ccedil;os ou OPM ( Procedimentos e Procedimentos em S&eacute;rie / OPM Utilizados )</span></td>
    <td bgcolor="#FFFFFF" class="tdGroup"  onClick="MEObj('Teso')">
	<div align="center"><img src="<%=GetPrtSkin()%>/menos.bmp" id="ITeso" type="img"></div>
	</td>
  </tr>
</table>
</td>
</tr>

<tr id="Teso" name="Teso">

<td>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td>

<div class="MenuTab">
<ul class="MenuTabs">
	<li><a href="#SerE">Servi&ccedil;o</a></li>
	<li><a href="#OpmE">Opm</a></li>
</ul>

<div class="divMT">
<a name="SerE" id="SerE"></a>

<table class="tableMT" height="203" border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="103">

<table class="subTableMT" border="0" cellspacing="0" cellpadding="0">
<tr>
<td>

	<table border="0" cellpadding="0" cellspacing="0">
	<tr><td>
		<div id="BExeSer" name="BExeSer" class="posicaoLeft">
			<input name="bIExeSer" id="bIExeSer" type="button" value="Incluir" class="Botoes" onclick="fMontItens('I','TabExeSer')"/>
			<input name="*" id="bAExeSer" type="button" value="Alterar" class="Botoes" onclick="fMontItens('A','TabExeSer')"/>
			<input name="bEExeSer" id="bEExeSer" type="button" value="Excluir" class="Botoes" onclick="fMontItens('E','TabExeSer')"/>
		</div>	
	</td></tr>
	</table>
</td>
</tr>
<tr id="TESO" name="TESO">
<td height="40">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td height="40" class="TextoLabel"><span>51-Data</span><br />
	<input name="Data" type="text" class="TextoInputOB" id="dDtExe" value="<%=Date()%>" size="14" maxlength="4" readonly="Yes" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>52-Hora In&iacute;cial</span><br />
	<input name="Hora Ini." id="cHorIniSExe" type="text" class="TextoInputOP" value="" size="14" maxlength="5" onKeyPress="return TxtBoxFormat(this, event,'99:99');" onBlur="validaCmp(this, 'hora','HorАrio invalido');"/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>53-Hora Final</span><br />
	<input name="Hora Fin." id="cHorFinSExe" type="text" class="TextoInputOP" value="" size="13" maxlength="5" onKeyPress="return TxtBoxFormat(this, event,'99:99');" onBlur="validaCmp(this, 'hora','HorАrio invalido');"/>&nbsp;
</td>
</tr>
</table>
</td>
</tr>

<tr id="TESOP" name="TESOP">
<td height="40">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td height="40" class="TextoLabel"><span>54-Tabela</span><br />
	<input name="Tabela" id="cCodPadSExe" type="text" class="TextoInputOB" value="<%=HttpSession->cCodPad%>" size="8" maxlength="2" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>55-C&oacute;digo Procedimento</span><br />
	<input name="Servi&ccedil;o" id="cCodProSExe" type="text" class="TextoInputOB" value="" size="21" maxlength="10" onblur="fChkCodPro('cCodPadSExe','cCodProSExe','cDesProSExe','0,1,2,3,4,6,7,8')"/>
	<img src="<%=GetPrtSkin()%>/ico-lupa.gif" name="BCodProSExe" id="BCodProSExe" width="18" height="18" border="0" style="cursor:pointer" align="top" title="Pesquisa" onclick="if(!this.disabled)return ChamaPoP('W_PPLSXF3.APW?cFunName=PLF3BR8P&F3Nome=cCodProSExe&F3CmpDes=cCodProSExe,cDesProSExe&cVldGen='+cCodPadSExe.value,'jF3','yes');">&nbsp;
</td>
<td height="40" class="TextoLabel"><span>56-Descri&ccedil;&atilde;o</span><br />
	<input name="Descri&ccedil;&atilde;o" type="text" class="TextoInputOB" id="cDesProSExe" value="" size="80" maxlength="60" readonly="yes" width=""/></td>
</tr>
</table></td>
</tr>
<tr>
<td height="40">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td class="TextoLabel">57-Qtde<br />
<input name="Qtd. Exe." type="text" class="TextoInputOB" id="cQtdSExe" value="1" size="8" maxlength="3" width=""/>&nbsp;</td>
<td class="TextoLabel">58-Via<br />
<select name="Via Acesso" class="ComboSelectOP" id="cViaSExe" style="width: 110px" >
<option value="">-- Via Acesso--</option>
<% If Type("HttpSession->aViaAce") <> "U"
	For nI := 1 To Len(HttpSession->aViaAce) %>
		<option value="<%=HttpSession->aViaAce[nI]:cCode%>"><%=HttpSession->aViaAce[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>&nbsp;
</td>
<td class="TextoLabel">59-Tec<br />
<select name="Tec. Utilizada" class="ComboSelectOP" id="cTecSExe" style="width: 115px" >
<option value="">-- Tec. Utilizada --</option>
<% If Type("HttpSession->aTecUti") <> "U"
	For nI := 1 To Len(HttpSession->aTecUti) %>
		<option value="<%=HttpSession->aTecUti[nI]:cCode%>"><%=HttpSession->aTecUti[nI]:cDescription%></option>
	<% Next nI 
EndIf %>
</select>&nbsp;
</td>
<td class="TextoLabel">60-%Red./Acresc<br />
<input name="Red./Acresc" id="nRedAcreSExe" type="text" class="TextoInputOP" value="" size="18" maxlength="6" onKeyPress="return FormatMoeda(this, event, ',', '.');"/>&nbsp;
</td>
<td class="TextoLabel">61-Valor Unit&aacute;rio - R$<br />
<input name="Vlr. Unit." id="nVlrUniSExe" type="text" class="TextoInputOP" value="" size="22" maxlength="9" onBlur="fCalcVal(this.value,cQtdSExe.value,nVlrTotSExe); fCalcVal(this.value,1,nVlrUniSExe)" onKeyPress="return FormatMoeda(this, event, ',', '.');"/>&nbsp;
</td>
<td class="TextoLabel">62-Valor Total - R$<br />
<input name="Vlr. Total" id="nVlrTotSExe" type="text" class="TextoInputOP" value="" size="19" maxlength="9" onKeyPress="return FormatMoeda(this, event, ',', '.');"/>&nbsp;
</td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
<tr>
	<td height="100">
	<div style="overflow: auto; height: 100px; width: 800px" class="FundoClaro divGridMT">
		<table id="TabExeSer" border="0" cellpadding="0" cellspacing="0">
		</table>
	</div>
	</td>
</tr>
</table>
</div>

<div class="divMT">
<a name="OpmE" id="OpmE"></a>

<table class="tableMT" height="203" border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="69">

<table class="subTableMT" border="0" cellpadding="0" cellspacing="0">
<tr>
<td>

	<table border="0" cellpadding="0" cellspacing="0">
	<tr><td>
		<div id="BExeOpm" name="BExeOpm" class="posicaoLeft">
			<input name="bIExeOpm" id="bIExeOpm" type="button" value="Incluir" class="Botoes" onclick="fMontItens('I','TabExeOpm')"/>
			<input name="*" id="bAExeOpm" type="button" value="Alterar" class="Botoes" onclick="fMontItens('A','TabExeOpm')"/>
			<input name="bEExeOpm" id="bEExeOpm" type="button" value="Excluir" class="Botoes" onclick="fMontItens('E','TabExeOpm')"/>
		</div>	
	</td></tr>
	</table>
</td>
</tr>
<tr>
<td height="40" colspan="2">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td height="40" class="TextoLabel"><span>78-Tabela</span><br />
	<input name="Tabela" id="cCodPadOExe" type="text" class="TextoInputOP" value="<%=HttpSession->cCodPad%>" size="15" maxlength="2" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>79-C&oacute;dig do OPM</span><br />
	<input name="Servi&ccedil;o" id="cCodProOExe" type="text" class="TextoInputOP" value="" size="15" maxlength="10" onblur="fChkCodPro('cCodPadOExe','cCodProOExe','cDesProOExe','5')"/>
	<img src="<%=GetPrtSkin()%>/ico-lupa.gif" name="BCodProOExe" id="BCodProOExe" width="18" height="18" border="0" style="cursor:pointer" align="top" title="Pesquisa" onclick="if(!this.disabled)return ChamaPoP('W_PPLSXF3.APW?cFunName=PLF3BR8O&F3Nome=cCodProOExe&F3CmpDes=cCodProOExe,cDesProOExe&cVldGen='+cCodPadOExe.value,'jF3','yes');">&nbsp;
</td>
<td height="40" class="TextoLabel"><span>80-Descri&ccedil;&atilde;o OPM</span><br />
	<input name="Descri&ccedil;&atilde;o" type="text" class="TextoInputOP" id="cDesProOExe" value="" size="80" maxlength="60" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>81-Qtde</span><br />
	<input name="Qtd. Exe" type="text" class="TextoInputOP" id="cQtdOExe" value="1" size="6" maxlength="3" width=""/>&nbsp;
</td>
</tr>
<tr>
<td height="40" class="TextoLabel"><span>82-C&oacute;d Barras</span><br />
	<input name="Cod. Barras" type="text" class="TextoInputOP" id="cCodBarOExe" value="" size="13" maxlength="20" width=""/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>83-Vlr Unit&aacute;rio R$</span><br />
	<input name="Vlr. Unit." id="nVlrUniOExe" type="text" class="TextoInputOP" value="" size="17" maxlength="10" onBlur="fCalcVal(this.value,cQtdOExe.value,nVlrTotOExe)" onKeyPress="return FormatMoeda(this, event, ',', '.');"/>&nbsp;
</td>
<td height="40" class="TextoLabel"><span>84-Vlr Total R$</span><br />
	<input name="Vlr. Total" id="nVlrTotOExe" type="text" class="TextoInputOP" value="" size="14" maxlength="10" readonly="Yes"/>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
<tr>
	<td height="100">
		<div style="overflow: auto; height: 100px; width: 811px" class="FundoClaro divGridMT">
			<table id="TabExeOpm" border="0" cellpadding="0" cellspacing="0">
			</table>
		</div>
	</td>
</tr>
<tr>
<td height="34" align="right" class="TextoLabel"><span>85-Total OPM R$</span><br />
<input name="nVlrTotOExeG" type="text" class="TextoInputOP" id="nVlrTotOExeG" value="" size="17" maxlength="9" readonly="Yes"/>
</td>
</tr>
</table>
</div>
</div>


</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="100%" class="TextoLabel">63-Data e Assinatura de Procedimentos em S&eacute;rie</td>
</tr>
<tr>
<td>
<table width="97%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" class="TextoInputOB">
<tr>
<td width="150" height="25" class="TextoLabel">__/__/_____ ___________</td>
<td width="150" height="25" class="TextoLabel">__/__/_____ ___________</td>
<td width="150" height="25" class="TextoLabel">__/__/_____ ___________</td>
<td width="150" height="25" class="TextoLabel">__/__/_____ ___________</td>
<td width="151" height="25" class="TextoLabel">__/__/_____ ___________</td>
</tr>
<tr>
<td height="25" class="TextoLabel">__/__/_____ ___________</td>
<td height="25" class="TextoLabel">__/__/_____ ___________</td>
<td height="25" class="TextoLabel">__/__/_____ ___________</td>
<td height="25" class="TextoLabel">__/__/_____ ___________</td>
<td height="25" class="TextoLabel">__/__/_____ ___________</td>
</tr>
</table></td>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table width="97%" border="0" cellpadding="0" cellspacing="0">
<tr valign="top">
<td height="70" class="TextoLabel"><span>64-Observa&ccedil;&atilde;o</span>
	<textarea name="cObs" id="cObs" cols="140" style='height:6em;width:99%' rows="4" class="TextoInputOP" onkeydown="if(this.value.length >= 120 && event.keyCode > 46){ return false; }"></textarea>&nbsp;
</td>
</tr>
</table>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td height="50">&nbsp;</td>
<td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel">65-Total<br />Procedimentos R$<br />
	<input name="nTotPro" type="text" class="TextoInputOP" id="nTotPro" value="" size="18" maxlength="2" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel">66-Total Taxas<br />e Alugu&eacute;is R$<br />
	<input name="nTotTax" type="text" class="TextoInputOP" id="nTotTax" value="" size="15" maxlength="2" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel">67-Total<br />Materiais R$<br />
	<input name="nTotMat" type="text" id="nTotMat" class="TextoInputOP" value="" size="18" maxlength="6" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel">68-Total<br />Medicamentos R$<br />
	<input name="nTotMed" type="text" class="TextoInputOP" id="nTotMed" value="" size="17" maxlength="2" readonly="Yes"/>&nbsp;
</td>
</tr>
</table>
</td>
</tr>

<tr>
<td height="50">&nbsp;</td>
<td><table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel">69-Total<br />Di&aacute;rias R$<br />
	<input name="nTotDia" type="text" id="nTotDia" class="TextoInputOP" value="" size="19" maxlength="6" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel">70-Total Gases<br />Medicinais R$<br />
	<input name="nTotGas" type="text" class="TextoInputOP" id="nTotGas" value="" size="17" maxlength="2" readonly="Yes"/>&nbsp;
</td>
<td class="TextoLabel">71-Total Geral<br />da Guia R$<br />
	<input name="nTotGerGui" type="text" id="nTotGerGui" class="TextoInputOP" value="" size="15" maxlength="6" readonly="Yes"/>
</td>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>

<tr>
<td height="55">&nbsp;</td>
<td><table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="TextoLabel"><span>86-Data e Assinatura do<br />
	Solicitante </span>
</td>
<td class="TextoLabel"><span>87-Data e Assinatura do<br />
	Resons&aacute;vel pela Autoriza&ccedil;&atilde;o</span>
</td>
<td class="TextoLabel"><span>88-Data e Assinatura do<br />
	Benefici&aacute;rio ou Respons&aacute;vel</span>
</td>
<td class="TextoLabel"><span>89-Data e Assinatura do<br />
	Prestador Executante </span>
</td>
</tr>
<tr>
<td height="35" class="TextoLabel"><span><%=Date()%>____________________</span></td>
<td height="35" class="TextoLabel"><span><%=Date()%>____________________</span></td>
<td height="35" class="TextoLabel"><span><%=Date()%>____________________</span></td>
<td height="35" class="TextoLabel"><span><%=Date()%>____________________</span></td>
</tr>
<tr id="Toth">
<% If HttpSession->cAprNImp = "1"  %>
	<td class="TextoLabel"><span>N&ordm; Impresso</span><br />
	<input name="cFormNumber" id="cFormNumber" type="text" class="TextoInputOP" value="" size="27" maxlength="20" alt="Numero Impresso" />&nbsp;
	</td>
<% EndIF %>
</tr>
</table></td>
<td>&nbsp;</td>
</tr>
<tr align="center">
<td>&nbsp;</td>
<td>
<table width="100%" height="40" border="0" cellpadding="0" cellspacing="0">
<tr>
<td>
	<div class="posicaoRight" style='padding-top:0.5em'>
		<% If Type("HttpSession->cCmpl") <> "U" %>
			<input name="bcomplemento" id="bcomplemento" type="button" value="complemento" class="Botoes" onclick="fComplemento()"/>
		<% EndIf %>
		<input name="bconfirma" id="bconfirma" type="button" value="confirmar" class="button Botoes" onclick="fProcForm(form1); return false;"/>
		<input name="bimprimir" id="bimprimir" type="button" value="imprimir" class="button Botoes" onclick="fImpGuia()"/>
		<%If lPE%>
			<input name="bcustom" id="bcustom" type="button" value="<%=aPEBotao[1]%>" class="button Botoes" onclick="fcustom()"/>
		<%EndIf%>
		<input name="bvoltar" id="bvoltar" type="button" value="voltar" class="button Botoes" onclick="window.location='W_PPLCHAPRE.APW?cP=2'" />
	</div>	
</td>
</tr>
</table>
</td>
<td>&nbsp;</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
<tr>&nbsp;</tr>
</table>
</td>    
<td><img src="<%=GetPrtSkin()%>/transparente.gif" width="6" height="6"></td>
</tr>
</table>
</form>  
</body>
</html>  
<script language="JavaScript">
<!-- 
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё disabled
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
setDisable("bASolSer",true);
setDisable("bISolSer",true);
setDisable("bASolOpm",true);
setDisable("bAExeSer",true);
setDisable("bAExeOpm",true);
<% If Type("HttpSession->cCmpl") <> "U" %>
setDisable("bcomplemento",true);
<% EndIf %>
setDisable("bimprimir",true);
setDisable("bcustom",true);
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Carrega dados da rda												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
fRda(document.getElementById("cRda").value,document.getElementById("cCodLoc").value);
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Tratamento dos campos												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
var oForm = new xform( document.forms[0] );
	oForm.add( document.forms[0].cCodPadSSol	,"numero", false, true );
	oForm.add( document.forms[0].cCodProSSol	,"numero", false, true );
	oForm.add( document.forms[0].cQtdSSol		,"numero", false, true );
	oForm.add( document.forms[0].cCodPadOSol	,"numero", false, true );
	oForm.add( document.forms[0].cCodProOSol	,"numero", false, true );
	oForm.add( document.forms[0].cQtdOSol		,"numero", false, true );
	oForm.add( document.forms[0].cCodPadSExe	,"numero", false, true );
	oForm.add( document.forms[0].cCodProSExe	,"numero", false, true );
	oForm.add( document.forms[0].cQtdSExe		,"numero", false, true );
	oForm.add( document.forms[0].cCodPadOExe	,"numero", false, true );
	oForm.add( document.forms[0].cCodProOExe	,"numero", false, true );
	oForm.add( document.forms[0].cQtdOExe		,"numero", false, true );
	oForm.add( document.forms[0].cTmpDoe		,"numero", false, true );
	oForm.add( document.forms[0].cCarSolicit	,"tudo"	 , false, false );
	oForm.add( document.forms[0].cProSol		,"tudo"	 , false, false );
	oForm.add( document.forms[0].cIndCliSol		,"tudo"	 , false, true );
//-->
</script>
