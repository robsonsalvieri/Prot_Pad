#INCLUDE "PROTHEUS.CH"
#INCLUDE "FWLIBVERSION.CH"
#include "totvs.ch"
#include "msobject.ch"
#include "totvs.framework.treports.integratedprovider.th"
#include "tlpp-rest.th"
#include "tlpp-core.th"

namespace totvs.protheus.backoffice.sv.fat.realinvoicing.treportsintegratedprovider
using namespace totvs.framework.treports.integratedprovider

@totvsFrameworkTReportsIntegratedProvider(active=.F., team="SIGAFAT", tables="SF1,SD1,SF2,SD2,SA1,SB1,SBM,SF4", name="Faturamento Real", country="BRA")

//-----------------------------------------------------------------------------------
/*/{Protheus.doc} realinvoicingSmartViewBusinessObjectBRA
Classe para criação do Objeto de Negócio para Relacao de Pedidos de Vendas Brasil.

@author FAT/CRM
@since 31/07/2023
@version 1.0
*/
//-----------------------------------------------------------------------------------  
class realinvoicingSmartViewBusinessObjectBRA from totvs.protheus.backoffice.sv.fat.realinvoicing.treportsintegratedprovider.realinvoicingSmartViewBusinessObject
    
    public method new() as object
    public method preData() as object
    public method processData() as object
    public method preSchema() as object

    protected data aFields as array
    protected data aStruct as array

endclass
 
//-------------------------------------------------------------------
/*{Protheus.doc} new
Método de instância da classe
 
@return object: self
 
@author FAT/CRM
@since 31/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method new() class realinvoicingSmartViewBusinessObjectBRA 
	
    _Super:new()

return self

//-------------------------------------------------------------------
/*{Protheus.doc} preData
Método chamado antes do getData do objeto principal
 
@return object: self:oData
 
@author FAT/CRM
@since 31/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method preData() as object class realinvoicingSmartViewBusinessObjectBRA 

    self:cLocSelect1 := " ,SD1.D1_VALCPB INSS, SD1.D1_VALIMP6 PIS, SD1.D1_VALIMP5 COF, SD1.D1_VALISS ISS "
    self:cLocSelect2 := " ,SD2.D2_VALCPB INSS, SD2.D2_VALIMP6 PIS, SD2.D2_VALIMP5 COF, SD2.D2_VALISS ISS "
    self:cLocWhere1  := ""
    self:cLocWhere2  := ""

Return self:oData

//-------------------------------------------------------------------
/*{Protheus.doc} processData
Deverá ser chamado no momento do processamento da query
 
@return object: self:oData
 
@author FAT/CRM
@since 31/07/2023
@version 1.0
*/
//-------------------------------------------------------------------    
method processData(nOperLoc as numeric) as object class realinvoicingSmartViewBusinessObjectBRA

    Do Case
        //-----------------------------------------------------------
        //Operação 1 será utilizado somente para commit dos 
        //campos antes do appendData 
        //Case (nOperLoc == 1)
        //-----------------------------------------------------------
        Case nOperLoc == 1
            self:ojItems["INSS"]  	:= (self:cAliasSD1)->INSS
            self:ojItems["PIS"]   	:= (self:cAliasSD1)->PIS
            self:ojItems["COFINS"]	:= (self:cAliasSD1)->COF
            self:ojItems["ISS"]   	:= (self:cAliasSD1)->ISS
        Case nOperLoc == 2
            self:ojItems["INSS"]  	:= (self:cAliasSD2)->INSS
            self:ojItems["PIS"]   	:= (self:cAliasSD2)->PIS
            self:ojItems["COFINS"]	:= (self:cAliasSD2)->COF
            self:ojItems["ISS"]   	:= (self:cAliasSD2)->ISS
    EndCase

return

//-------------------------------------------------------------------
/*{Protheus.doc} preSchema
Método chamada antes do getSchema do objeto principal
 
@return object: self:oSchema
 
@author FAT/CRM
@since 31/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method preSchema() as object class realinvoicingSmartViewBusinessObjectBRA

    self:oSchema:addProperty("INSS",	"INSS",		"number",	"INSS",     "INSS"  )   //INSS
	self:oSchema:addProperty("PIS",		"PIS",		"number",	"PIS",      "PIS"   )   //PIS
	self:oSchema:addProperty("COFINS",	"COFINS",	"number",	"COFINS",   "COFINS")   //COFINS
	self:oSchema:addProperty("ISS",		"ISS",		"number",	"ISS",		"ISS"  	)   //ISS

return self:oSchema
