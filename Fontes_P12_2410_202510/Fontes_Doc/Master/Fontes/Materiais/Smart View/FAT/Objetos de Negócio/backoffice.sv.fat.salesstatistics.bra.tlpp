#INCLUDE "PROTHEUS.CH"
#INCLUDE "FWLIBVERSION.CH"
#include "totvs.ch"
#include "msobject.ch"
#include "totvs.framework.treports.integratedprovider.th"
#include "tlpp-rest.th"
#include "tlpp-core.th"

namespace totvs.protheus.backoffice.sv.fat.salesstatistics.treportsintegratedprovider

@totvsFrameworkTReportsIntegratedProvider(active=.F., team="SIGAFAT", tables="SA1,SD1,SD2", name="Faturamento por Cliente X Quantidade de Produtos", country="BRA")

//-------------------------------------------------------------------
/*/{Protheus.doc} salesstatisticsSmartViewBusinessObjectBRA
Classe para criação do Objeto de Negócio para "Faturamento por Cliente
 X Quantidade de Produtos" Brasil.

@author FAT/CRM
@since 04/07/2023
@version 1.0
*/
//-------------------------------------------------------------------  
class salesstatisticsSmartViewBusinessObjectBRA from totvs.protheus.backoffice.sv.fat.salesstatistics.treportsintegratedprovider.salesstatisticsSmartViewBusinessObject
    
    public method new() as object
    public method preData() as object
    public method processData() as object
    public method preSchema() as object
 
    protected data aFields as array
    protected data aStruct as array

endclass
 
//-------------------------------------------------------------------
/*{Protheus.doc} new
Método de instância da classe
 
@return object: self
 
@author FAT/CRM
@since 04/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method new() class salesstatisticsSmartViewBusinessObjectBRA 
	
    _Super:new()

return self

//-------------------------------------------------------------------
/*{Protheus.doc} preData
Método chamado antes do getData do objeto principal
 
@return object: self:oData
 
@author FAT/CRM
@since 04/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method preData() as object class salesstatisticsSmartViewBusinessObjectBRA 
	
    //Aqui é adicionada uma condição no where que será utilizado na query do objeto padrão

Return self:oData

//-------------------------------------------------------------------
/*{Protheus.doc} processData
Deverá ser chamado no momento do processamento da query
 
@return object: self:oData
 
@author FAT/CRM
@since 04/07/2023
@version 1.0
*/
//-------------------------------------------------------------------    
method processData(nOperLoc as numeric) as object class salesstatisticsSmartViewBusinessObjectBRA

    Do Case

        Case ( nOperLoc == 2 ) //Operação e/ou tratamento específico para localizado

        //Complemento de Quantidade            
        self:nVlrRetornLoc := IIf( (self:cSD2Loc)->D2_TIPO $ "C" .And. SF2->F2_TPCOMPL == "2", self:nTotQuantLoc * self:nVlrUnitLoc, self:nVlrUnitLoc )

    EndCase

return 

//-------------------------------------------------------------------
/*{Protheus.doc} preSchema
Método chamada antes do getSchema do objeto principal
 
@return object: self:oSchema
 
@author FAT/CRM
@since 04/07/2023
@version 1.0
*/
//-------------------------------------------------------------------   
method preSchema() as object class salesstatisticsSmartViewBusinessObjectBRA

    //Adição de novos campos personalizados (não existem na tabela)

return self:oSchema
