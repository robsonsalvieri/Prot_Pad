#INCLUDE "BADEFINITION.CH"


NEW ENTITY CENTROCUSTO

//-------------------------------------------------------------------
/*/{Protheus.doc} BACentroCusto
Visualiza as informacoes de Centro de Custo.

@author  Helio Leal
@since   26/10/2017
/*/
//-------------------------------------------------------------------
Class BACentroCusto from BAEntity
	Method Setup( ) CONSTRUCTOR
	Method BuildQuery( )
EndClass

//-------------------------------------------------------------------
/*/{Protheus.doc} New
Construtor padrao.

@author  Helio Leal
@since   26/10/2017
/*/
//-------------------------------------------------------------------
Method Setup( ) Class BACentroCusto
	_Super:Setup("CentroCusto", DIMENSION, "CTT")
Return

//-------------------------------------------------------------------
/*/{Protheus.doc} BuildQuery
Constroi a query da entidade.
@return cQuery, string, query a ser processada.

@author  Helio Leal
@since   26/10/2017
/*/
//-------------------------------------------------------------------
Method BuildQuery() Class BACentroCusto

   	
	Local cQuery := ""
	cQuery += " SELECT  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT11.CTT_CUSTO,CTT10.CTT_CUSTO,CTT9.CTT_CUSTO,CTT8.CTT_CUSTO,CTT7.CTT_CUSTO,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO11,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT10.CTT_CUSTO,CTT9.CTT_CUSTO ,CTT8.CTT_CUSTO,CTT7.CTT_CUSTO,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO10,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT9.CTT_CUSTO ,CTT8.CTT_CUSTO ,CTT7.CTT_CUSTO,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO9,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT8.CTT_CUSTO ,CTT7.CTT_CUSTO ,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO8,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT7.CTT_CUSTO ,CTT6.CTT_CUSTO ,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO7,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT6.CTT_CUSTO ,CTT5.CTT_CUSTO ,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') ) AS BK_CENTRO_CUSTO6,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT5.CTT_CUSTO ,CTT4.CTT_CUSTO ,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') ) AS BK_CENTRO_CUSTO5,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT4.CTT_CUSTO ,CTT3.CTT_CUSTO ,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO4,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT3.CTT_CUSTO ,CTT2.CTT_CUSTO ,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO3,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT2.CTT_CUSTO ,CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO2,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT1.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO1,  " +;
		" COALESCE(CTT11.CTT_DESC01,CTT10.CTT_DESC01,CTT9.CTT_DESC01,CTT8.CTT_DESC01,CTT7.CTT_DESC01,CTT6.CTT_DESC01,CTT5.CTT_DESC01,CTT4.CTT_DESC01,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_11,  " +;
		" COALESCE(CTT10.CTT_DESC01,CTT9.CTT_DESC01 ,CTT8.CTT_DESC01,CTT7.CTT_DESC01,CTT6.CTT_DESC01,CTT5.CTT_DESC01,CTT4.CTT_DESC01,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_10,  " +;
		" COALESCE(CTT9.CTT_DESC01 ,CTT8.CTT_DESC01 ,CTT7.CTT_DESC01,CTT6.CTT_DESC01,CTT5.CTT_DESC01,CTT4.CTT_DESC01,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_9,  " +;
		" COALESCE(CTT8.CTT_DESC01 ,CTT7.CTT_DESC01 ,CTT6.CTT_DESC01,CTT5.CTT_DESC01,CTT4.CTT_DESC01,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_8,  " +;
		" COALESCE(CTT7.CTT_DESC01 ,CTT6.CTT_DESC01 ,CTT5.CTT_DESC01,CTT4.CTT_DESC01,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_7,  " +;
		" COALESCE(CTT6.CTT_DESC01 ,CTT5.CTT_DESC01 ,CTT4.CTT_DESC01,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_6,  " +;
		" COALESCE(CTT5.CTT_DESC01 ,CTT4.CTT_DESC01 ,CTT3.CTT_DESC01,CTT2.CTT_DESC01,CTT1.CTT_DESC01)  AS CTT_DESC01_5,   " +;
		" COALESCE(CTT4.CTT_DESC01 ,CTT3.CTT_DESC01 ,CTT2.CTT_DESC01,CTT1.CTT_DESC01) AS CTT_DESC01_4,  " +;
		" COALESCE(CTT3.CTT_DESC01 ,CTT2.CTT_DESC01 ,CTT1.CTT_DESC01) AS CTT_DESC01_3,  " +;
		" COALESCE(CTT2.CTT_DESC01 ,CTT1.CTT_DESC01) AS CTT_DESC01_2,  " +;
		" CTT1.CTT_DESC01 AS CTT_DESC01_1,  " +;
		" COALESCE(CTT11.CTT_CUSTO,CTT10.CTT_CUSTO,CTT9.CTT_CUSTO,CTT8.CTT_CUSTO,CTT7.CTT_CUSTO,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_11,  " +;
		" COALESCE(CTT10.CTT_CUSTO,CTT9.CTT_CUSTO ,CTT8.CTT_CUSTO,CTT7.CTT_CUSTO,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_10,  " +;
		" COALESCE(CTT9.CTT_CUSTO ,CTT8.CTT_CUSTO ,CTT7.CTT_CUSTO,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_9,  " +;
		" COALESCE(CTT8.CTT_CUSTO ,CTT7.CTT_CUSTO ,CTT6.CTT_CUSTO,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_8,  " +;
		" COALESCE(CTT7.CTT_CUSTO ,CTT6.CTT_CUSTO ,CTT5.CTT_CUSTO,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_7,  " +;
		" COALESCE(CTT6.CTT_CUSTO ,CTT5.CTT_CUSTO ,CTT4.CTT_CUSTO,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_6,  " +;
		" COALESCE(CTT5.CTT_CUSTO ,CTT4.CTT_CUSTO ,CTT3.CTT_CUSTO,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ')  AS CTT_CUSTO_5,   " +;
		" COALESCE(CTT4.CTT_CUSTO ,CTT3.CTT_CUSTO ,CTT2.CTT_CUSTO,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_4,  " +;
		" COALESCE(CTT3.CTT_CUSTO ,CTT2.CTT_CUSTO ,CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_3,  " +;
		" COALESCE(CTT2.CTT_CUSTO ,CTT1.CTT_CUSTO , ' ') AS CTT_CUSTO_2,  " +;
		" COALESCE(CTT1.CTT_CUSTO, ' ') AS CTT_CUSTO_1, " +;
		" coalesce(CTT11.CTT_NORMAL,CTT10.CTT_NORMAL,CTT9.CTT_NORMAL,CTT8.CTT_NORMAL,CTT7.CTT_NORMAL,CTT6.CTT_NORMAL,CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL11," +;
		" coalesce(CTT10.CTT_NORMAL,CTT9.CTT_NORMAL,CTT8.CTT_NORMAL,CTT7.CTT_NORMAL,CTT6.CTT_NORMAL,CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL10," +;
		" coalesce(CTT9.CTT_NORMAL,CTT8.CTT_NORMAL,CTT7.CTT_NORMAL,CTT6.CTT_NORMAL,CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL9," +;
		" coalesce(CTT8.CTT_NORMAL,CTT7.CTT_NORMAL,CTT6.CTT_NORMAL,CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL8," +;
		" coalesce(CTT7.CTT_NORMAL,CTT6.CTT_NORMAL,CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL7," +;
		" coalesce(CTT6.CTT_NORMAL,CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL6," +;
		" coalesce(CTT5.CTT_NORMAL,CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL5," +;
		" coalesce(CTT4.CTT_NORMAL,CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL4," +;
		" coalesce(CTT3.CTT_NORMAL,CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL3," +;
		" coalesce(CTT2.CTT_NORMAL,CTT1.CTT_NORMAL,'') AS NORMAL2," +;
		" coalesce(CTT1.CTT_NORMAL,'') AS NORMAL1," +;
		" coalesce(CTT11.CTT_RES,CTT10.CTT_RES,CTT9.CTT_RES,CTT8.CTT_RES,CTT7.CTT_RES,CTT6.CTT_RES,CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES11," +;
		" coalesce(CTT10.CTT_RES,CTT9.CTT_RES,CTT8.CTT_RES,CTT7.CTT_RES,CTT6.CTT_RES,CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES10," +;
		" coalesce(CTT9.CTT_RES,CTT8.CTT_RES,CTT7.CTT_RES,CTT6.CTT_RES,CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES9," +;
		" coalesce(CTT8.CTT_RES,CTT7.CTT_RES,CTT6.CTT_RES,CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES8," +;
		" coalesce(CTT7.CTT_RES,CTT6.CTT_RES,CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES7," +;
		" coalesce(CTT6.CTT_RES,CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES6," +;
		" coalesce(CTT5.CTT_RES,CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES5," +;
		" coalesce(CTT4.CTT_RES,CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES4," +;
		" coalesce(CTT3.CTT_RES,CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES3," +;
		" coalesce(CTT2.CTT_RES,CTT1.CTT_RES,'') AS CTARES2," +;
		" coalesce(CTT1.CTT_RES,'') AS CTARES1," +;
		" coalesce(CTT11.CTT_CLASSE,CTT10.CTT_CLASSE,CTT9.CTT_CLASSE,CTT8.CTT_CLASSE,CTT7.CTT_CLASSE,CTT6.CTT_CLASSE,CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA11," +;
		" coalesce(CTT10.CTT_CLASSE,CTT9.CTT_CLASSE,CTT8.CTT_CLASSE,CTT7.CTT_CLASSE,CTT6.CTT_CLASSE,CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA10," +;
		" coalesce(CTT9.CTT_CLASSE,CTT8.CTT_CLASSE,CTT7.CTT_CLASSE,CTT6.CTT_CLASSE,CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA9," +;
		" coalesce(CTT8.CTT_CLASSE,CTT7.CTT_CLASSE,CTT6.CTT_CLASSE,CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA8," +;
		" coalesce(CTT7.CTT_CLASSE,CTT6.CTT_CLASSE,CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA7," +;
		" coalesce(CTT6.CTT_CLASSE,CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA6," +;
		" coalesce(CTT5.CTT_CLASSE,CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA5," +;
		" coalesce(CTT4.CTT_CLASSE,CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA4," +;
		" coalesce(CTT3.CTT_CLASSE,CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA3," +;
		" coalesce(CTT2.CTT_CLASSE,CTT1.CTT_CLASSE,'') AS TIPOCONTA2," +;
		" coalesce(CTT1.CTT_CLASSE,'') AS TIPOCONTA1," +;
		" coalesce(CTT11.CTT_DTEXSF,CTT10.CTT_DTEXSF,CTT9.CTT_DTEXSF,CTT8.CTT_DTEXSF,CTT7.CTT_DTEXSF,CTT6.CTT_DTEXSF,CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF11," +;
		" coalesce(CTT10.CTT_DTEXSF,CTT9.CTT_DTEXSF,CTT8.CTT_DTEXSF,CTT7.CTT_DTEXSF,CTT6.CTT_DTEXSF,CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF10," +;
		" coalesce(CTT9.CTT_DTEXSF,CTT8.CTT_DTEXSF,CTT7.CTT_DTEXSF,CTT6.CTT_DTEXSF,CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF9," +;
		" coalesce(CTT8.CTT_DTEXSF,CTT7.CTT_DTEXSF,CTT6.CTT_DTEXSF,CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF8," +;
		" coalesce(CTT7.CTT_DTEXSF,CTT6.CTT_DTEXSF,CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF7," +;
		" coalesce(CTT6.CTT_DTEXSF,CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF6," +;
		" coalesce(CTT5.CTT_DTEXSF,CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF5," +;
		" coalesce(CTT4.CTT_DTEXSF,CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF4," +;
		" coalesce(CTT3.CTT_DTEXSF,CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF3," +;
		" coalesce(CTT2.CTT_DTEXSF,CTT1.CTT_DTEXSF,'') AS DTEXSF2," +;
		" coalesce(CTT1.CTT_DTEXSF,'') AS DTEXSF1," +;
		" <<CODE_INSTANCE>> AS INSTANCIA  " +;
	" FROM <<CTT_COMPANY>>  CTT99  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT1 " +;
				" ON  CTT1.CTT_FILIAL = CTT99.CTT_FILIAL  " +;
				" AND CTT1.CTT_CCSUP  = '         '   " +;
				" AND CTT1.CTT_CUSTO  = CTT99.CTT_CCSUP  " +;
				" AND CTT1.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT2	" +;
				" ON  CTT2.CTT_FILIAL = CTT1.CTT_FILIAL  " +;
				" AND CTT2.CTT_CCSUP  = CTT1.CTT_CUSTO  " +;
				" AND CTT2.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT3 " +;
				" ON  CTT3.CTT_FILIAL = CTT2.CTT_FILIAL  " +;
				" AND CTT3.CTT_CCSUP  = CTT2.CTT_CUSTO  " +;
				" AND CTT3.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT4 " +;
				" ON  CTT4.CTT_FILIAL = CTT3.CTT_FILIAL  " +;
				" AND CTT4.CTT_CCSUP  = CTT3.CTT_CUSTO  " +;
				" AND CTT4.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT5 " +;
				" ON  CTT5.CTT_FILIAL = CTT4.CTT_FILIAL  " +;
				" AND CTT5.CTT_CCSUP  = CTT4.CTT_CUSTO  " +;
				" AND CTT5.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT6 " +;
				" ON  CTT6.CTT_FILIAL = CTT5.CTT_FILIAL  " +;
				" AND CTT6.CTT_CCSUP  = CTT5.CTT_CUSTO  " +;
				" AND CTT6.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT7 " +;
				" ON  CTT7.CTT_FILIAL = CTT6.CTT_FILIAL  " +;
				" AND CTT7.CTT_CCSUP  = CTT6.CTT_CUSTO  " +;
				" AND CTT7.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT8 " +;
				" ON  CTT8.CTT_FILIAL = CTT7.CTT_FILIAL  " +;
				" AND CTT8.CTT_CCSUP  = CTT7.CTT_CUSTO  " +;
				" AND CTT8.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT9 " +;
				" ON  CTT9.CTT_FILIAL = CTT8.CTT_FILIAL  " +;
				" AND CTT9.CTT_CCSUP  = CTT8.CTT_CUSTO  " +;
				" AND CTT9.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT10 " +;
				" ON  CTT10.CTT_FILIAL = CTT9.CTT_FILIAL  " +;
				" AND CTT10.CTT_CCSUP  = CTT9.CTT_CUSTO  " +;
				" AND CTT10.D_E_L_E_T_ = ' '  " +;
			" LEFT JOIN <<CTT_COMPANY>>  CTT11 " +;
				" ON  CTT11.CTT_FILIAL = CTT10.CTT_FILIAL  " +;
				" AND CTT11.CTT_CCSUP  = CTT10.CTT_CUSTO  " +;
				" AND CTT11.D_E_L_E_T_ = ' '  " +;
			" WHERE CTT99.D_E_L_E_T_ = ' '  " +;
				" AND CTT1.CTT_CUSTO  IS NOT NULL   " +;
				" <<AND_XFILIAL_CTT1.CTT_FILIAL>>" +;
	" UNION  " +;
	" SELECT  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO11,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO10,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO9,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO8,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO7,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO6,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO5,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO4,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO3,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO2,  " +;
		" <<KEY_CTT_CTT99.CTT_FILIAL>> + RTRIM(COALESCE(CTT99.CTT_CUSTO, ' ')) AS BK_CENTRO_CUSTO1,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_11,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_10,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_9,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_8,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_7,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_6,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_5,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_4,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_3,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_2,  " +;
		" COALESCE(CTT99.CTT_DESC01, ' ') AS CTT_DESC01_1,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_11,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_10,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_9,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_8,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_7,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_6,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_5,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_4,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_3,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_2,  " +;
		" COALESCE(CTT99.CTT_CUSTO, ' ') AS CTT_CUSTO_1," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL11," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL10," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL9," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL8," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL7," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL6," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL5," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL4," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL3," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL2," +;
		" coalesce(CTT99.CTT_NORMAL,'') AS NORMAL1," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES11," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES10," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES9," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES8," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES7," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES6," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES5," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES4," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES3," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES2," +;
		" coalesce(CTT99.CTT_RES,'') AS CTARES1," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA11," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA10," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA9," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA8," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA7," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA6," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA5," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA4," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA3," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA2," +;
		" coalesce(CTT99.CTT_CLASSE,'') AS TIPOCONTA1," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF11," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF10," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF9," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF8," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF7," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF6," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF5," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF4," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF3," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF2," +;
		" coalesce(CTT99.CTT_DTEXSF,'') AS DTEXSF1," +;
		" <<CODE_INSTANCE>> AS INSTANCIA  " +;
	" FROM <<CTT_COMPANY>>  CTT99  " +;
		" WHERE CTT99.D_E_L_E_T_ = ' '  " +;
			" AND CTT99.CTT_CCSUP = '         '    " +;
			" <<AND_XFILIAL_CTT99.CTT_FILIAL>>"  +;
			" AND EXISTS (" +;
					" select NULL from <<CTT_COMPANY>>  CTT1 where CTT1.CTT_FILIAL = CTT99.CTT_FILIAL AND CTT1.CTT_CCSUP <> CTT99.CTT_CUSTO " +;
				" )	"
				

Return cQuery

