#include "tlpp-core.th"

namespace pgc.generateQuotationService
using namespace pgc.generateQuotationRepository

/*/{Protheus.doc} pgcGenerateQuotationService
	Classe service para o serviço de cotações
@author juan.felipe
@since 26/04/2022
/*/
CLASS pgcGenerateQuotationService
    public Data oJsonResponse As Object
    public Data lOk   As Logical
    public Data nCode As Numeric
    public Data cMessage As Character

    public Method New()
    public Method postAgglutinateQuotation()
    public Method postGenerateQuotation()
    public Method postCentralizedRequestMigration()
    public Method postExecAuto()
EndClass

/*/{Protheus.doc} New
	Método construtor
@author juan.felipe
@since 26/04/2022
/*/
Method New() CLASS pgcGenerateQuotationService
    Self:oJsonResponse := JsonObject():new()
    Self:lOk := .F.
    Self:nCode := 0
    Self:cMessage := ""
Return Nil

/*/{Protheus.doc} postAgglutinateQuotation
	Aglutina itens da cotação.
@author juan.felipe
@since 19/08/2022
@param oJsonRequest, object, json da requisição.
@param cSelfor, character, indica se seleciona fornecedores.
@return oJsonResponse, object, resposta no formato json.
/*/
Method postAgglutinateQuotation(oJsonRequest, cSelfor) Class pgcGenerateQuotationService
    Local oQuotationRepository As Object
	Default oJsonRequest := JsonObject():New()
    Default cSelfor := ''

    oQuotationRepository := pgcGenerateQuotationRepository():New("POST")
    oQuotationRepository:oJsonRequest := oJsonRequest

    Self:oJsonResponse := oQuotationRepository:postAgglutinateQuotation(,cSelfor)
    Self:lOk := oQuotationRepository:lOk

    FreeObj(oQuotationRepository)
Return Self:oJsonResponse 

/*/{Protheus.doc} postGenerateQuotation
	Geração da cotação.
@author juan.felipe
@since 26/04/2022
@param oJsonRequest, object, json da requisição.
@return oJsonResponse, object, resposta no formato json.
/*/
Method postGenerateQuotation(oJsonRequest) Class pgcGenerateQuotationService
    Local oQuotationRepository As Object

    oQuotationRepository := pgcGenerateQuotationRepository():New("POST")
    oQuotationRepository:oJsonRequest := oJsonRequest

    Self:oJsonResponse := oQuotationRepository:postGenerateQuotation()
    Self:lOk := oQuotationRepository:lOk

    FreeObj(oQuotationRepository)
Return Self:oJsonResponse 


/*/{Protheus.doc} postCentralizedRequestMigration
	Compra centralizada.
@author renan.martins
@since 04/2024
@param oJsonRequest, object, json da requisição.
@return oJsonResponse, object, resposta no formato json.
/*/
Method postCentralizedRequestMigration(oJsonRequest) Class pgcGenerateQuotationService
    Local oQuotationRepository As Object

    oQuotationRepository := pgcGenerateQuotationRepository():New("POST")
    oQuotationRepository:oJsonRequest := oJsonRequest

    Self:oJsonResponse := oQuotationRepository:postCentralizedRequestMigration()
    Self:lOk := oQuotationRepository:lOk

    FreeObj(oQuotationRepository)
Return Self:oJsonResponse 

/*/{Protheus.doc} postExecAuto
	Realiza geração da cotação via postExecAuto
@author juan.felipe
@since 01/2025
@param oJsonRequest, object, json da requisição.
@return oJsonResponse, object, resposta no formato json.
/*/
Method postExecAuto(oJsonRequest) Class pgcGenerateQuotationService
    Local oQuotationRepository As Object
	Default oJsonRequest := JsonObject():New()

    oQuotationRepository := pgcGenerateQuotationRepository():New("POST")
    oQuotationRepository:oJsonRequest := oJsonRequest

    Self:oJsonResponse := oQuotationRepository:postExecAuto(oJsonRequest)
    Self:lOk := oQuotationRepository:lOk

    FreeObj(oQuotationRepository)
Return Self:oJsonResponse 
