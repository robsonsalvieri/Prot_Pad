#INCLUDE 'protheus.ch'
#INCLUDE 'restful.ch'

//-------------------------------------------------------------------
/*/{Protheus.doc} PLSAuthorizationsDaoBEG
.
@author  sakai
@version P12
@since   06/09/22
/*/
//------------------------------------------------------------------- 
class PLSAuthorizationsDaoBEG from PLSAuthorizationsDao

    Public Method New()
    Public Method buscaCrit(cSequen, lIntern)

EndClass


Method New(cGuia) class PLSAuthorizationsDaoBEG
    
    _Super:New(cGuia)

Return self


Method buscaCrit(cSequen, lIntern) class PLSAuthorizationsDaoBEG

    Local cQuery := ""
    Local lFound := .F.
    Default lIntern := .F.

    if !lIntern
        cQuery += " SELECT BEG_SEQUEN AS SEQUEN, BEG_CODGLO AS CODGLO, BEG_SEQCRI AS SEQCRI, " 
        cQuery += " BEG_DESGLO AS DESGLO"
        cQuery += " FROM " + RetSqlName("BEG")+" BEG "
        cQuery += " WHERE BEG_FILIAL = '" + xFilial("BEG") +"' "	
        cQuery += " AND BEG_OPEMOV = '" + Substr(self:cGuia,01,04) + "' "
        cQuery += " AND BEG_ANOAUT = '" + Substr(self:cGuia,05,04) + "' "
        cQuery += " AND BEG_MESAUT = '" + Substr(self:cGuia,09,02) + "' "
        cQuery += " AND BEG_NUMAUT = '" + Substr(self:cGuia,11,08) + "' "
        cQuery += " AND BEG_SEQUEN = '" + cSequen + "' "
        cQuery += " AND BEG.D_E_L_E_T_ = ' ' "
        cQuery += " ORDER BY R_E_C_N_O_   "
    else 
        cQuery += " SELECT BEL_SEQUEN AS SEQUEN, BEL_CODGLO AS CODGLO, BEL_SEQCRI AS SEQCRI, " 
        cQuery += " BEL_DESGLO AS DESGLO"
        cQuery += " FROM " + RetSqlName("BEL")+" BEL "
        cQuery += " WHERE BEL_FILIAL = '" + xFilial("BEL") +"' "	
        cQuery += " AND BEL_CODOPE = '" + Substr(self:cGuia,01,04) + "' "
        cQuery += " AND BEL_ANOINT = '" + Substr(self:cGuia,05,04) + "' "
        cQuery += " AND BEL_MESINT = '" + Substr(self:cGuia,09,02) + "' "
        cQuery += " AND BEL_NUMINT = '" + Substr(self:cGuia,11,08) + "' "
        cQuery += " AND BEL_SEQUEN = '" + cSequen + "' "
        cQuery += " AND BEL.D_E_L_E_T_ = ' ' "
        cQuery += " ORDER BY R_E_C_N_O_  "
    endif

    self:setQuery(cQuery)
	lFound := self:executaQuery()

Return lFound
