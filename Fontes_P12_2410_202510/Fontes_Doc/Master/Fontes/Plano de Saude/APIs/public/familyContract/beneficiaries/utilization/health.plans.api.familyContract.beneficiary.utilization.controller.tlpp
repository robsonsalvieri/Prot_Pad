#Include "tlpp-core.th"
#Include "tlpp-rest.th"

Namespace totvs.protheus.health.plans.api.familyContract.beneficiary.utilization

/*/{Protheus.doc} UtilizationController
Classe controladora da API de Extrato de Utilização

@type class
@author Cesar Almeida
@since 27/04/2023
@version Protheus 12
/*/
Class UtilizationController

    Private Data oService As Object

    Public Method new() Constructor

    @GET("/totvsHealthPlans/familyContract/v1/beneficiaries/:subscriberId/utilizationStatement/base64")
    Public Method apiUtilizationStatementBase64()

EndClass

/*/{Protheus.doc} new
Método construtor da classe

@type method
@author Cesar Almeida
@since 27/04/2023
@version Protheus 12
/*/
Method new() Class UtilizationController
Return Self

/*/{Protheus.doc} apiUtilizationStatementBase64
Método responsável por retornar o Extatro de Utilização em base64
Url: /totvsHealthPlans/familyContract/v1/beneficiaries/:subscriberId/utilizationStatement
Verbo: GET

@type method
@author Cesar Almeida
@since 27/04/2023
@version Protheus 12
/*/
Method apiUtilizationStatementBase64() Class UtilizationController

    Local jPath := oRest:getPathParamsRequest() As Json
    Local jQueryParams := oRest:getQueryRequest() As Json    

    Self:oService := UtilizationService():new()
    Self:oService:setPathParams(jPath)
    Self:oService:setQueryParams(jQueryParams)    

    If Self:oService:getUtilizationStatementBase64()
        oRest:setResponse(Self:oService:getJsonResult())
        oRest:setStatusCode(Self:oService:getStatusCode())
    Else
        oRest:setFault(Self:oService:getJsonResult())
        oRest:setStatusCode(Self:oService:getStatusCode())       
    EndIf

    oRest:setKeyHeaderResponse("Content-Type", "application/json")

Return
