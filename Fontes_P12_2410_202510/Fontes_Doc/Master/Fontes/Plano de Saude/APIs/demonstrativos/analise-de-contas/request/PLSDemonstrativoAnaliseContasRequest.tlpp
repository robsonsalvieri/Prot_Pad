#INCLUDE 'protheus.ch'
#INCLUDE 'restful.ch'

//-------------------------------------------------------------------
/*/{Protheus.doc} PLSDemonstrativoAnaliseContasRequest

@author    Daniel Silva
@version   V12
@since     14/04/2021
/*/
class PLSDemonstrativoAnaliseContasRequest from CenRequest 

    public data cError 
    public data oRest as object
    public data oJson as object

    public method New(oRest) constructor
    public method get()
    public method valida()
    public method setGetError()

endclass

//-------------------------------------------------------------------
/*/{Protheus.doc} New

@author    Daniel Silva
@version   V12
@since     14/04/2021
/*/
method New(oRest) class PLSDemonstrativoAnaliseContasRequest 
::oRest     := oRest
::cError    := ""
::oJson     := jsonObject():new()
_Super:New(oRest,'')
return self

//-------------------------------------------------------------------
/*/{Protheus.doc} get

@author    Daniel Silva
@version   V12
@since     14/04/2021
/*/
method get() class PLSDemonstrativoAnaliseContasRequest
local oAppService   := nil
local cJson as Character

oAppService := PLSDemonstrativoAnaliseContasService():new(::oRest)
cBlob := oAppService:get()

cJson := '{"hasError": '+iif(empty(cBlob),'true','false')+','
cJson += '"file": "'+cBlob+'"}

::oRest:setResponse(cJson)

return .t.

//-------------------------------------------------------------------
/*/{Protheus.doc} valida

@author    Daniel Silva
@version   V12
@since     08/03/2021
/*/

method valida() class PLSDemonstrativoAnaliseContasRequest
local lRet      := .t.

if empty(::oRest:healthProviderCode)
    ::cError := "Campo 'healthProviderCode' deve ser informado no QueryParm."
    lRet := .f.
endif

if lRet .and. empty(::oRest:protocol)
    ::cError := "Campo 'protocol' deve ser informado no QueryParm."
    lRet := .f.
endif

return lRet


method setGetError() class PLSDemonstrativoAnaliseContasRequest

local cJson := ""

    cJson := '{"hasError": true,'
    cJson += '"errorMessage":"' + ::cError + '"}'
    ::oRest:setResponse(cJson)

return 



