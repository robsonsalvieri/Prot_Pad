#include "PLSA996.CH"
#include "PLSMGER.CH"
#include "PROTHEUS.CH"

/*/


Ŀ
Programa   PLSA996  Autor  Microsiga             Data  02/12/2011 
Ĵ
Descrio  Ordem de Servio Tran. Online                              
Ĵ
Uso        Microsiga                                                  
Ĵ
Parametros Nenhum                                                     
Ĵ


/*/
Function PLSA996

//Ŀ
// Define o cabecalho da tela de atualizacoes                               
//
Private aRotina   := MenuDef()
Private cFilter	  := ""
//Ŀ
// Endereca a funcao de BROWSE                                              
//
B0U->(DbSetOrder(1))
B0U->(DbGoTop())
B0U->(mBrowse(006,001,022,075,"B0U",,,,,, ))
//Ŀ
// Fim da Rotina Principal                                                  
//
Return  

/*/


Ŀ
Funcao     PL996Mov  Autor  Renan Sakai            Data  02/12/11 
Ĵ
Descricao  Movimentacao do Ordem de Servio Tran. Online              
ٱ


/*/  
Function PL996Mov(cAlias,nReg,nOpc)  
Local aPosObj   := {}     
Local aObjects  := {}
Local aSize     := {}
Local aInfo     := {}    
Local aVetB0V   := {}          
Local aVetBVG   := {} 
Local aVetBVK   := {}  

//Ŀ
// Define Variaveis para Enchoice...                                        
//
Private oEnchoice
Private aTELA[0][0]
Private aGETS[0]
//Ŀ
// Define Variaveis para montagem da tela                                   
//
Private aHeaderB0V
Private aColsB0V    
Private aColsB0VGrv := {}
Private aHeaderBVG
Private aColsBVG   
Private aColsBVGGrv := {} 
Private aHeaderBVK
Private aColsBVK     
Private aColsBVKGrv := {} 

//Ŀ
// Monta aCols e aHeader...                                                 
//
Store Header "B0V" TO aHeaderB0V For .T.      
                     
//Ŀ
// Carrega aCols B0V                                                        
//
B0V->(dbSetOrder(1)) //B0V_FILIAL+B0V_OPESOL+B0V_NUMSEQ+B0V_CODPAD+B0V_CODPRO
If B0V->(MsSeek(xFilial("B0V")+B0U->(B0U_OPESOL+B0U_NUMSEQ)))
	Store COLS "B0V" TO aColsB0V FROM aHeaderB0V VETTRAB aVetB0V While B0V->(B0V_FILIAL+B0V_OPESOL+B0V_NUMSEQ) == B0U->(B0U_FILIAL+B0U_OPESOL+B0U_NUMSEQ)
Else
	Store COLS Blank "B0V" TO aColsB0V FROM aHeaderB0V
EndIf

//Ŀ
// Define Dialogo...                                                        
//
aSize := MsAdvSize()
aObjects := {}       
AAdd( aObjects, { 001, 100, .T., .F., .F. } )
AAdd( aObjects, { 001, 130, .T., .F., .F. } )     

aInfo := { aSize[ 1 ], aSize[ 2 ], aSize[ 3 ], aSize[ 4 ], 3, 3 }
aPosObj := MsObjSize( aInfo, aObjects,.T. )

DEFINE MSDIALOG oDlg TITLE STR0001 FROM aSize[7],0 To aSize[6],aSize[5] Pixel //"Ordem de Servio Tran. Online"
//Ŀ
// Monta Enchoice...                                                        
//
Zero();oEnchoice := MsMGet():New("B0U",nReg,nOpc,,,,,aPosObj[1],,,,,,oDlg,,,.F.)

//Ŀ
// Define Folders                                                           
// 
oFolder1 := TFolder():New(aPosObj[2][1],aPosObj[2][2],{STR0002},{""}, oDlg,,,, .T., , aPosObj[2][4]-010, aPosObj[2][3] - aPosObj[1][3]) //"Procedimentos"

//Ŀ
// Monta GetDados...                                                        
//
oGetB0V := MsNewGetDados():New(005,005,(aPosObj[2][3] - aPosObj[1][3]) - 015,aPosObj[2][4]-010,,,,,,,9999,,,,oFolder1:aDialogs[1],aHeaderB0V,aColsB0V) 

//Ŀ
// Ativa o Dialogo...                                                       
//
ACTIVATE MSDIALOG oDlg ON INIT Eval({ || EnchoiceBar(oDlg,{|| .T.,oDlg:End() },{||oDlg:End()},.F.,{})  })

Return
/*/


Ŀ
Programa  MenuDef    Autor  Microsiga              Data 02/12/2011
Ĵ
Descrio  Utilizacao de menu Funcional                               
                                                                      
                                                                      
Ĵ
Retorno   Array com opcoes da rotina.                                 
Ĵ
ParametrosParametros do array a Rotina:                               
          1. Nome a aparecer no cabecalho                             
          2. Nome da Rotina associada                                 
          3. Reservado                                                
          4. Tipo de Transao a ser efetuada:                        
          		1 - Pesquisa e Posiciona em um Banco de Dados         
              2 - Simplesmente Mostra os Campos                       
              3 - Inclui registros no Bancos de Dados                 
              4 - Altera o registro corrente                          
              5 - Remove o registro corrente do Banco de Dados        
          5. Nivel de acesso                                          
          6. Habilita Menu Funcional                                  
Ĵ
   DATA    Programador   Manutencao efetuada                         
Ĵ
                                                                     
ٱ


/*/
Static Function MenuDef() 

Private aRotina  := {	{ STR0003 , 'AxPesqui' , 0, K_Pesquisar  	, 0, .F.},; //"Pesquisar"
						{ STR0004 , 'PL996Mov' , 0, K_Visualizar 	, 0, Nil}}  //"Visualizar"
Return(aRotina)     
