#INCLUDE "APDA090.CH"
#INCLUDE "PROTHEUS.CH"
/*/
зддддддддддбддддддддддбдддддбддддддддддддддддддддддддддддбддддддбдддддддддд©
ЁFunГЦo    ЁAPDA260   ЁAutorЁEmerson Campos              Ё Data Ё02/01/2013Ё
цддддддддддеддддддддддадддддадддддддддддддддддддддддддаддддддаддддддддддддд╢
ЁDescriГЦo ЁResposta, refinamento e resultados de AvaliaГУes               Ё
Ё          Ёpor Participantes                                              Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico                                                       Ё
цддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё            ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL              Ё
цддддддддддддбддддддддддбддддддддддддддбддддддддддддддддддддддддддддддддддд╢
ЁProgramador ЁData      ЁBOPS          ЁMotivo da Alteracao                Ё
цддддддддддддеддддддддддеддддддддддддддеддддддддддддддддддддддддддддддддддд╢
ЁCecilia Car.Ё03/07/2014ЁTPZWBQ        ЁIncluido o fonte da 11 para a 12 e Ё
Ё            Ё          Ё              Ёefetuada a limpeza.                Ё
ЁFlavio Corr.Ё21/01/2015ЁTRHPUT        ЁFunГЦo RdbGdDelOk transformada em  Ё
Ё            Ё          Ё              Ёfunction pois utiliza no APDA250   Ё
ЁRenan BorgesЁ04/11/2015ЁTTPSZK        ЁAjustes p/ permitir a inclusao     Ё
Ё            Ё          Ё              Ёmanual das respostas.              Ё
ЁRenan BorgesЁ12/02/2016ЁTULWGV        ЁAjuste para remover os campos      Ё
Ё            Ё          Ё              ЁRDB_CODMEM e RDB_CODJUS da visua-  Ё
Ё            Ё          Ё              ЁlizaГЦo na getDados, pois sЦo de   Ё
Ё            Ё          Ё              Ёuso interno.                       Ё
ЁIsabel N.   Ё12/12/2016ЁTWMCF6        ЁAjuste no array aRddRecnos para queЁ
Ё            Ё          Ё              Ёsua ordenaГЦo coincida com a do    Ё
Ё            Ё          Ё              ЁaRddCols e nЦo gere erro de chave  Ё
Ё            Ё          Ё              Ёduplicada quando houver mais de um Ё
Ё            Ё          Ё              Ёregistro do participante por rede. Ё
ЁWillian U.  Ё25/08/2017ЁDRHPONTP-1417 ЁAjuste na funГЦo utilizada pelo    Ё
Ё            Ё          Ё              Ёinicializador padrЦo dos campos    Ё
Ё            Ё          Ё              Ёmemo de juustificava e resposta    Ё
Ё            Ё          Ё              Ёdissertativa.                      Ё
юддддддддддддаддддддддддаддддддддддддддадддддддддддддддддддддддддддддддды/*/
Function APDA260( cAlias , nReg , nOpc , lExecAuto )

Local aArea		:= GetArea()
Local aAreaRd6	:= RD6->( GetArea() )
Local aAreaRdd	:= RDD->( GetArea() )
Local aAreaRd0	:= RD0->( GetArea() )
Local lExistOpc	:= ( ValType( nOpc ) == "N" )
Local bBlock
Local nPos

//Controle de recno a serem excluidos ou retomados antes de confirmar , de acordo com RD6 ao ser excluido ou retomado
Private aRd7DelRecno	:= {}
Private aRdbDelRecno	:= {}
Private aRddDelRecno	:= {}

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSo Executa se o Modo de Acesso dos Arquivos do Modulo APD estiЁ
	Ёverem OK													   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( ApdRelationFile() )
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁRedefine o Alias                                              Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	cAlias	:= "RD0"

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array contendo as Rotinas a executar do programa      Ё
	Ё ----------- Elementos contidos por dimensao ------------     Ё
	Ё 1. Nome a aparecer no cabecalho                              Ё
	Ё 2. Nome da Rotina associada                                  Ё
	Ё 3. Usado pela rotina                                         Ё
	Ё 4. Tipo de Transa┤└o a ser efetuada                          Ё
	Ё    1 - Pesquisa e Posiciona em um Banco de Dados             Ё
	Ё    2 - Simplesmente Mostra os Campos                         Ё
	Ё    3 - Inclui registros no Bancos de Dados                   Ё
	Ё    4 - Altera o registro corrente                            Ё
	Ё    5 - Remove o registro corrente do Banco de Dados          Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	Private aRotina := MenuDef("APDA260") // ajuste para versao 9.12 - chamada da funcao MenuDef() que contem aRotina

	Private cCadastro	:= OemToAnsi( STR0006 )	//"Resultados de AvaliaГУes por Participantes"

	IF ( lExistOpc )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁGarante o Posicinamento do Recno                              Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		DEFAULT nReg	:= ( cAlias )->( Recno() )
		IF !Empty( nReg )
			( cAlias )->( MsGoto( nReg ) )
		EndIF

		DEFAULT lExecAuto := .F.
		IF ( lExecAuto )

			nPos := aScan( aRotina , { |x| x[4] == nOpc } )
			IF ( nPos == 0 )
				Break
			EndIF
			bBlock := &( "{ |a,b,c,d| " + aRotina[ nPos , 2 ] + "(a,b,c,d) }" )
			Eval( bBlock , cAlias , nReg , nPos )

		Else

			Apda260Mnt( cAlias , nReg , nOpc , .T. )

		EndIF

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Chama a Funcao de Montagem do Browse                                   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RD0->( dbSetOrder( RetOrdem( cAlias , "RD0_FILIAL+RD0_CODIGO" ) ) )
		mBrowse( 6 , 1 , 22 , 75 , cAlias , NIL , NIL , NIL , "RD0->RD0_MSBLQL=='2'")
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁColoca o Ponteiro do Mouse em Estado de Espera			   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

RestArea( aAreaRdd )
RestArea( aAreaRd6 )
RestArea( aAreaRd0 )
RestArea( aArea    )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Cursor do Mouse                				   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda260MntЁ Autor ЁEmerson Campos         Ё Data Ё04/01/2013Ё
цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁVisualizaГЦo das respostas, refinamentos e Resultados    	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁApda260Mnt( cAlias , nReg , nOpc , lDlgPadSiga )			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁcAlias 		= Alias do arquivo                              Ё
Ё          ЁnReg   		= Numero do registro                            Ё
Ё          ЁnOpc   		= Numero da opcao selecionada                   Ё
Ё          ЁlDlgPadSiga = Numero da opcao selecionada                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda260()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Apda260Mnt( cAlias , nReg , nOpc , lDlgPadSiga )

Local aArea				:= GetArea(Alias())
Local aSvKeys			:= GetKeys()
Local aAdvSize			:= {}
Local aInfoAdvSize		:= {}
Local aObjSize			:= {}
Local aObjCoords		:= {}
Local aInfo2AdvSize		:= {}
Local aObj2Size			:= {}
Local aObj2Coords		:= {}
Local aObj3Size			:= {}
Local aObj3Coords		:= {}

Local aInfo4AdvSize		:= {}
Local aObj4Size			:= {}
Local aObj4Coords		:= {}

Local aRd0Header		:= {}
Local aRd0Cols			:= {}
Local aRd0Fields		:= {}
Local aRd0Altera		:= {}
Local aRd0NaoAlt		:= {}
Local aRd0VirtEn		:= {}
Local aRd0NotFields		:= {}
Local aRd0Keys			:= {}
Local aRd0VisuEn		:= {}
Local aRd6Recnos		:= {}
Local aRd6NotFields		:= {}
Local aRd6Header		:= {}
Local aRd6Cols			:= {}
Local aRddGdAltera  	:= {}
Local aRddGdNaoAlt		:= {}
Local aRddRecnos		:= {}
Local aRddKeys			:= {}
Local aRddNotFields		:= {}
Local aRddVirtGd		:= {}
Local aRddVisuGd		:= {}
Local aRddFldsAux		:= {}
Local aSvRDDCols		:= {}
Local aRddQuery			:= {}
Local aFolders			:= Array( 03 )
Local aPages			:= Array( 03 )
Local aObjFolder		:= Array( 03 )
Local aSvSetModulo		:= {}
Local aButtons			:= {}
Local aFreeLocks		:= {}
Local aGdObjects		:= {}
Local bRddGdDelOk		:= { |lDelOk| CursorWait() , lDelOk := RddGdDelOk( nOpc ) , CursorArrow() , lDelOk }
Local bRDDSort			:= { || NIL }
Local bSet15			:= { || NIL }
Local bSet24			:= { || NIL }
Local bDialogInit		:= { || NIL }
Local bGdSeek			:= { || NIL }
Local bGetRd0			:= { || NIL }
Local bGetRDD			:= { || NIL }
Local cRd0Filial		:= ""
Local cRd6Filial		:= ""
Local cRd0Codigo		:= ""
Local cKeySeek			:= ""
Local cRd9Filial		:= ""
Local lLocks			:= .F.
Local lExecLock			:= ( ( nOpc <> 2 ) .and. ( nOpc <> 3 ) )
Local nRd6Order			:= RetOrdem( "RD6" , "RD6_FILIAL+RD6_CODPAR+RD6_CODOBJ+RD6_CODPER" )
Local nRddOrder			:= RetOrdem( "RDD" , "RDD_FILIAL+RDD_CODADO" )
Local nRd9Order			:= RetOrdem( "RD9" , "RD9_FILIAL+RD9_CODADO" )
Local nRd9Bytes			:= ( GetSx3Cache( "RD9_CODADO" , "X3_TAMANHO" ) + GetSx3Cache( "RD9_CODAVA" , "X3_TAMANHO" ) )
Local nActFolder		:= 0
Local nOpcAlt			:= 0
Local nRd0Usado			:= 0
Local nRddUsado			:= 0
Local nLoop				:= 0
Local nOpcNewGd			:= IF( ( ( nOpc == 2 ) .or. ( nOpc == 5 ) ) , 0 , GD_INSERT + GD_UPDATE + GD_DELETE	)
Local nRddMaxLocks		:= 5
Local nRddGhostCol		:= 0
Local oDlg				:= NIL
Local oEndRd0			:= NIL
Local oFont

Local aRd7GdAltera  	:= {}
Local aRd7GdNaoAlt		:= {}
Local aRd7Recnos		:= {}
Local aRd7Keys			:= {}
Local aRd7NotFields		:= {}
Local aRd7VirtGd		:= {}
Local aRd7VisuGd		:= {}
Local aRd7FldsAux		:= {}
Local aSvRd7Cols		:= {}
Local aRd7Query			:= {}
Local aFreeRd7Locks		:= {}
Local bRd7GdDelOk		:= { |lDelOk| CursorWait() , lDelOk := Rd7GdDelOk( nOpc ) , CursorArrow() , lDelOk }
Local bRd7Sort			:= { || NIL }
Local bGetRd7			:= { || NIL }
Local nRd7Order			:= RetOrdem( "RD7" , "RD7_FILIAL+RD7_CODADO" )
Local nRd7Usado			:= 0
Local nRd7MaxLocks		:= 5
Local nRd7GhostCol		:= 0


Local aRdbGdAltera  	:= {}
Local aRdbGdNaoAlt		:= {}
Local aRdbRecnos		:= {}
Local aRdbKeys			:= {}
Local aRdbNotFields		:= {}
Local aRdbVirtGd		:= {}
Local aRdbVisuGd		:= {}
Local aRdbMemoGd		:= {}
Local aRdbFldsAux		:= {}
Local aSvRDBCols		:= {}
Local aRdbQuery			:= {}
Local aRdyRecnos		:= {}
Local aRdyKeys			:= {}
Local aFreeRDBLocks		:= {}
Local bRdbGdDelOk		:= { |lDelOk| CursorWait() , lDelOk := RdbGdDelOk( nOpc ) , CursorArrow() , lDelOk }
Local bRDBSort			:= { || NIL }
Local bGetRDB			:= { || NIL }
Local cRdBFilial		:= ""
Local nRdbOrder			:= RetOrdem( "RDB" , "RDB_FILIAL+RDB_CODADO" )
Local nRdbUsado			:= 0
Local nRdbMaxLocks		:= 5
Local nRdbGhostCol		:= 0
Local aRdbaCols			:= {}
Local aRd7aCols			:= {}
Local aRddaCols			:= {}
Local nNewFolder		:= 1
Local bDelSons			:= { || GdDelSons(@oGdRd6, @oGdRd7, @oGdRdb, @oGdRdd ) }

Private nGetSX8Len		:= GetSX8Len()
Private __nRddRd6AtAnt	:= 0
Private __nRd7Rd6AtAnt	:= 0
Private __nRdbRd6AtAnt	:= 0
Private aGets
Private aTela
Private aRddHeader
Private aRddCols
Private cRDDNumGhostCol
Private oGdRd6
Private oGdRdd
Private aRd7Header
Private aRd7Cols
Private cRd7NumGhostCol
Private oGdRd7
Private aRdbHeader
Private aRdbCols
Private cRDBNumGhostCol
Private oGdRdb

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁPoe o cursor do Mouse em Estado de Espera					   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCheca a Opcao Selecionada									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRotSetOpc( cAlias , NIL , nOpc , .F. )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a Enchoice							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd0NotFields	:= { "RD0_FILIAL" }
	aRd0Cols := RD0->(;
						GdBuildCols(	@aRd0Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
										@nRd0Usado		,;	//02 -> Numero de Campos em Uso
										@aRd0VirtEn		,;	//03 -> [@]Array com os Campos Virtuais
										@aRd0VisuEn		,;	//04 -> [@]Array com os Campos Visuais
										"RD0"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
										aRd0NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
										NIL         	,;	//07 -> [@]Array unidimensional contendo os Recnos
										"RD0"		   	,;	//08 -> Alias do Arquivo Pai
										NIL				,;	//09 -> Chave para o Posicionamento no Alias Filho
										NIL				,;	//10 -> Bloco para condicao de Loop While
										NIL				,;	//11 -> Bloco para Skip no Loop While
										NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
										NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
										NIL				,;	//14 -> Opcional, Carregar Todos os Campos
										NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
										NIL				,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
										NIL				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
										NIL				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
										NIL				,;	//19 -> Carregar Coluna Fantasma
										NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
										NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
										NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
										NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
										@aRd0Keys		,;	//24 -> [@]Array que contera as chaves conforme recnos
										NIL   			,;	//25 -> [@]Se devera efetuar o Lock dos Registros
										NIL				 ;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
								    );
					  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto o Posicionamento do Recno no RD0					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	CursorWait()
	cRd0Filial		:= RD0->RD0_FILIAL
	cRd0Codigo		:= RD0->RD0_CODIGO
	cKeySeek		:= ( xFilial( "RDD" ,cRd6Filial ) + cRd0Codigo )
	cRd6Filial		:= xFilial( "RD6" )
	cRd9Filial		:= xFilial( "RD9" , cRd6Filial )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Cria as Variaveis de Memoria e Carrega os Dados Conforme o arЁ
	Ё quivo														   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1 To nRd0Usado
		aAdd( aRd0Fields , aRd0Header[ nLoop , 02 ] )
		SetMemVar( aRd0Header[ nLoop , 02 ] , aRd0Cols[ 01 , nLoop ] , .T. )
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRd6NotFields , "RD6_FILIAL"  )
	RD6->( dbSetOrder( nRd6Order ) )
	bRd6Skip	:= { || ( fDesc( "RD9" , ( cRd0Codigo + RD6->RD6_CODIGO ) , "RD9_CODADO+RD9_CODAVA" , nRd9Bytes , cRd9Filial , nRd9Order , .F. ) <> ( cRd0Codigo + RD6->RD6_CODIGO ) ) }
	cKeySeek	:= xFilial( "RD6" )
	aRd6Cols	:= RD6->(;
							GdBuildCols(	@aRd6Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											NIL       		,;	//02 -> Numero de Campos em Uso
											NIL				,;	//03 -> [@]Array com os Campos Virtuais
											NIL         	,;	//04 -> [@]Array com os Campos Visuais
											"RD6"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRd6NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRd6Recnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD6"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											bRd6Skip		 ;	//11 -> Bloco para Skip no Loop While
									    );
						  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Nao Existem Avaliacoes para Este Participante 			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF Empty( aRd6Recnos )
		MsgInfo( STR0007 )	//"NЦo Existem AvaliaГУes para este Participante"
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos que nao serao carregados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRdbNotFields , "RDB_FILIAL"  )
	aAdd( aRdbNotFields , "RDB_CODJUS"  )
	aAdd( aRdbNotFields , "RDB_CODMEM"  )


	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array com os Campos Auxiliares    					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( Altera )
		aRdbFldsAux := { { "GHOSTCOL" , "RDBNumGhostCol()" } }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRdbQuery		:= Array( 05 )
	aRdbQuery[01]	:= "RDB_FILIAL='"+cRd6Filial+"'"
	aRdbQuery[02]	:= " AND "
	aRdbQuery[03]	:= "RDB_CODADO='"+cRd0Codigo+"'"
	aRdbQuery[04]	:= " AND "
	aRdbQuery[05]	:= "D_E_L_E_T_=' ' "

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega Informacoes do RDB									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDB->( dbSetOrder( nRdbOrder ) )
		cKeySeek	:= ( xFilial( "RDB" , cRd6Filial ) + cRd0Codigo )
		aRdbCols := RDB->(;
					GdBuildCols(	@aRdbHeader		,;	//01 -> Array com os Campos do Cabecalho da GetDados
									@nRdbUsado		,;	//02 -> Numero de Campos em Uso
									@aRdbVirtGd		,;	//03 -> [@]Array com os Campos Virtuais
									@aRdbVisuGd		,;	//04 -> [@]Array com os Campos Visuais
									"RDB"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
									aRdbNotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
									@aRdbRecnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
									"RD0"		   	,;	//08 -> Alias do Arquivo Pai
									cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
									NIL				,;	//10 -> Bloco para condicao de Loop While
									NIL				,;	//11 -> Bloco para Skip no Loop While
									NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
									NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
									NIL				,;	//14 -> Opcional, Carregar Todos os Campos
									NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
									aRdbQuery		,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
									.F.				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
									.F.				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
									aRdbFldsAux		,;	//19 -> Carregar Coluna Fantasma
									NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
									NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
									NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
									NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
									@aRdbKeys		,;	//24 -> [@]Array que contera as chaves conforme recnos
									NIL				,;	//25 -> [@]Se devera efetuar o Lock dos Registros
									NIL				,;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
									nRdbMaxLocks	,;	//27 -> Numero maximo de Locks a ser efetuado
									Altera			 ;	//28 -> Utiliza Numeracao na GhostCol
							    );
							)
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos que nao serao carregados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRd7NotFields , "RD7_FILIAL"  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array com os Campos Auxiliares    					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( Altera )
		aRd7FldsAux := { { "GHOSTCOL" , "Rd7NumGhostCol()" } }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd7Query		:= Array( 05 )
	aRd7Query[01]	:= "RD7_FILIAL='"+cRd6Filial+"'"
	aRd7Query[02]	:= " AND "
	aRd7Query[03]	:= "RD7_CODADO='"+cRd0Codigo+"'"
	aRd7Query[04]	:= " AND "
	aRd7Query[05]	:= "D_E_L_E_T_=' ' "

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega Informacoes do RD7									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RD7->( dbSetOrder( nRd7Order ) )
		cKeySeek	:= ( xFilial( "RD7" , cRd6Filial ) + cRd0Codigo )
		aRd7Cols := RD7->(;
							GdBuildCols(	@aRd7Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											@nRd7Usado		,;	//02 -> Numero de Campos em Uso
											@aRd7VirtGd		,;	//03 -> [@]Array com os Campos Virtuais
											@aRd7VisuGd		,;	//04 -> [@]Array com os Campos Visuais
											"RD7"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRd7NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRd7Recnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD0"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											NIL				,;	//11 -> Bloco para Skip no Loop While
											NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
											NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
											NIL				,;	//14 -> Opcional, Carregar Todos os Campos
											NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
											aRd7Query		,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
											.F.				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
											.F.				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
											aRd7FldsAux		,;	//19 -> Carregar Coluna Fantasma
											NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
											NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
											NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
											NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
											@aRd7Keys		,;	//24 -> [@]Array que contera as chaves conforme recnos
											NIL				,;	//25 -> [@]Se devera efetuar o Lock dos Registros
											NIL				,;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
											nRd7MaxLocks	,;	//27 -> Numero maximo de Locks a ser efetuado
											Altera			 ;	//28 -> Utiliza Numeracao na GhostCol
									    );
				  		)
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos que nao serao carregados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRddNotFields , "RDD_FILIAL"  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array com os Campos Auxiliares    					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( Altera )
		aRddFldsAux := { { "GHOSTCOL" , "RDDNumGhostCol()" } }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRddQuery		:= Array( 05 )
	aRddQuery[01]	:= "RDD_FILIAL='"+cRd6Filial+"'"
	aRddQuery[02]	:= " AND "
	aRddQuery[03]	:= "RDD_CODADO='"+cRd0Codigo+"'"
	aRddQuery[04]	:= " AND "
	aRddQuery[05]	:= "D_E_L_E_T_=' ' "

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega Informacoes do RDD									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDD->( dbSetOrder( nRddOrder ) )
		cKeySeek	:= ( xFilial( "RDD" , cRd6Filial ) + cRd0Codigo )
		aRddCols := RDD->(;
							GdBuildCols(	@aRddHeader		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											@nRddUsado		,;	//02 -> Numero de Campos em Uso
											@aRddVirtGd		,;	//03 -> [@]Array com os Campos Virtuais
											@aRddVisuGd		,;	//04 -> [@]Array com os Campos Visuais
											"RDD"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRddNotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRddRecnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD0"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											NIL				,;	//11 -> Bloco para Skip no Loop While
											NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
											NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
											NIL				,;	//14 -> Opcional, Carregar Todos os Campos
											NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
											aRddQuery		,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
											.F.				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
											.F.				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
											aRddFldsAux		,;	//19 -> Carregar Coluna Fantasma
											NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
											NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
											NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
											NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
											@aRddKeys		,;	//24 -> [@]Array que contera as chaves conforme recnos
											NIL				,;	//25 -> [@]Se devera efetuar o Lock dos Registros
											NIL				,;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
											nRddMaxLocks	,;	//27 -> Numero maximo de Locks a ser efetuado
											Altera			 ;	//28 -> Utiliza Numeracao na GhostCol
									    );
				  		)

	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁObtem o Pocisionamento no GHOSTCOL							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	nRddGhostCol	:= GdFieldPos( "GHOSTCOL" , aRddHeader )
	IF ( nRddGhostCol > 0 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem a ultima numeracao Gerada							   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cRDDNumGhostCol	:= aRddCols[ Len( aRddCols ) , nRddGhostCol ]
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define Bloco para Sorteio das Informacoes Antes da Gravacao  Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		bRDDSort := { || CursorWait() , aSort( aRddCols , NIL , NIL , { |x,y| ( x[ nRddGhostCol ] < y[ nRddGhostCol ] ) } ) , CursorArrow() }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁEfetuo Copia para Comparacao na Saida						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvRDDCols	:= aClone( aRddCols )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDD" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos nao Editaveis na GetDados 				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRddGdNaoAlt := { "RDD_CODAVA" , "RDD_CODADO" , "RDD_CODCOM" }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Campos Editaveis para a GetDados				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1	To nRddUsado
		SetMemVar( aRddHeader[ nLoop , 02 ] , GetValType( aRddHeader[ nLoop , 08 ] , aRddHeader[ nLoop , 04 ] ) , .T. )
		IF (;
				( aScan( aRddVirtGd		, aRddHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRddVisuGd		, aRddHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRddNotFields	, aRddHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRddGdNaoAlt	, aRddHeader[ nLoop , 02 ] ) == 0 )			;
		  	)
			aAdd( aRddGdAltera , aRddHeader[ nLoop , 02 ] )
		EndIF
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁObtem o Pocisionamento no GHOSTCOL							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	nRd7GhostCol	:= GdFieldPos( "GHOSTCOL" , aRd7Header )
	IF ( nRd7GhostCol > 0 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem a ultima numeracao Gerada							   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cRd7NumGhostCol	:= aRd7Cols[ Len( aRd7Cols ) , nRd7GhostCol ]
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define Bloco para Sorteio das Informacoes Antes da Gravacao  Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		bRd7Sort := { || CursorWait() , aSort( aRd7Cols , NIL , NIL , { |x,y| ( x[ nRd7GhostCol ] < y[ nRd7GhostCol ] ) } ) , CursorArrow() }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁEfetuo Copia para Comparacao na Saida						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvRd7Cols	:= aClone( aRd7Cols )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RD7" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos nao Editaveis na GetDados 				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd7GdNaoAlt := { "RD7_CODAVA" , "RD7_CODADO" , "RD7_CODCOM" }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Campos Editaveis para a GetDados				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1	To nRd7Usado
		SetMemVar( aRd7Header[ nLoop , 02 ] , GetValType( aRd7Header[ nLoop , 08 ] , aRd7Header[ nLoop , 04 ] ) , .T. )
		SetMemVar( aRd0Header[ nLoop , 02 ] , aRd0Cols[ 01 , nLoop ] , .T. )
		SetMemVar( aRd7Header[ nLoop , 02 ] , aRd7Cols[ 01 , nLoop ] , .T. )
		IF (;
				( aScan( aRd7VirtGd		, aRd7Header[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRd7VisuGd		, aRd7Header[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRd7NotFields	, aRd7Header[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRd7GdNaoAlt	, aRd7Header[ nLoop , 02 ] ) == 0 )			;
		  	)
			aAdd( aRd7GdAltera , aRd7Header[ nLoop , 02 ] )
		EndIF
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para o TudoOk da GetDados do RD7			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bRd7GdTudOk		:= { || oGdRd7:TudoOk() }						//Valida as Informacoes da GetDados RD7

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁObtem o Pocisionamento no GHOSTCOL							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	nRdbGhostCol	:= GdFieldPos( "GHOSTCOL" , aRdbHeader )
	IF ( nRdbGhostCol > 0 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem a ultima numeracao Gerada							   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cRDBNumGhostCol	:= aRdbCols[ Len( aRdbCols ) , nRdbGhostCol ]
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define Bloco para Sorteio das Informacoes Antes da Gravacao  Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		bRDBSort := { || CursorWait() , aSort( aRdbCols , NIL , NIL , { |x,y| ( x[ nRdbGhostCol ] < y[ nRdbGhostCol ] ) } ) , CursorArrow() }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁEfetuo Copia para Comparacao na Saida						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvRDBCols	:= aClone( aRdbCols )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDB" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos nao Editaveis na GetDados 				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRdbGdNaoAlt := { "RDB_CODAVA" , "RDB_CODADO" , "RDB_CODCOM",  "RDB_CODMEM", "RDB_CODJUS", "RDB_ID" }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos Memos                     				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRdbMemoGd , { "RDB_MEMO" 	, "RDB_CODMEM" } )
	aAdd( aRdbMemoGd , { "RDB_JUSMEM" 	, "RDB_CODJUS" } )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Campos Editaveis para a GetDados				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1	To nRdbUsado
		SetMemVar( aRdbHeader[ nLoop , 02 ] , GetValType( aRdbHeader[ nLoop , 08 ] , aRdbHeader[ nLoop , 04 ] ) , .T. )
		IF (;
				( aScan( aRdbVirtGd		, aRdbHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRdbVisuGd		, aRdbHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRdbNotFields	, aRdbHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRdbGdNaoAlt	, aRdbHeader[ nLoop , 02 ] ) == 0 )			;
		  	)
			aAdd( aRdbGdAltera , aRdbHeader[ nLoop , 02 ] )
		EndIF
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega os Recnos e as Chaves correspondentes dos campos MemosЁ
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( ( nOpc <> 2 ) .and. ( nOpc <> 3 ) )
		IF !( lLocks := ApdMemRec( "RDB" , aRdbRecnos , aRdbMemoGd , @aRdyRecnos , @aRdyKeys , .T. ) )
			Break
		EndIF
    EndIF


	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para o TudoOk da GetDados do RDB			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bRdbGdTudOk		:= { || oGdRdb:TudoOk() }						//Valida as Informacoes da GetDados RDB

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta as Dimensoes dos Objetos         					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	DEFAULT lDlgPadSiga	:= .F.

	aAdvSize		:= MsAdvSize()
	aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 5 , 5 }
	aAdd( aObjCoords , { 000 , 000 , .T. , .T. , .T. } )
	aObjSize 		:= MsObjSize( aInfoAdvSize , aObjCoords )

	aAdvSize		:= MsAdvSize(.f.)
    aAdvSize[4]		-=	25 // ALTURA
    aAdvSize[3]		-=	3 // Largura

	aInfo2AdvSize	:= { aAdvSize[1] , 1 , aAdvSize[3] , aAdvSize[4] , 5 , 5 }
	aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )
	aObj2Size 		:= MsObjSize( aInfo2AdvSize , aObj2Coords )

	aAdd( aObj3Coords , { 000 , 020 , .T. , .F. } )
	aAdd( aObj3Coords , { 000 , 100 , .T. , .F. } )
	aAdd( aObj3Coords , { 000 , 000 , .T. , .T., .T. } )
	aObj3Size 		:= MsObjSize( aInfo2AdvSize , aObj3Coords )

	aAdv4Size		:= aClone(aObj3Size[3])
	aInfo4AdvSize	:= { 1 , 1 , aAdv4Size[3]-5 , aAdv4Size[4]-15 , 5 , 5 }
	aAdd( aObj4Coords , { 000 , 000 , .T. , .T. } )
	aObj4Size 		:= MsObjSize( aInfo4AdvSize , aObj4Coords )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para o TudoOk da GetDados do RDD			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bRddGdTudOk		:= { || oGdRdd:TudoOk() }						//Valida as Informacoes da GetDados RDD

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-O>						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet15		:= { || IF(;
								(;
									( nOpc == 3 );	//Inclusao
									.or.;
									( nOpc == 4 );	//Alteracao
								);
								.and.;
								Eval( bRd7GdTudOk ) ;							//Valida as Informacoes da GetDados RD7
								.and.;
								Eval( bRdbGdTudOk ) ;							//Valida as Informacoes da GetDados RDB
								.and.;
								Eval( bRddGdTudOk ),;							//Valida as Informacoes da GetDados RDD
								(;
									Eval( oGdRd6:bChange , .T. ),;				//Transere as informacoes Atuais para o aRddCols
									nOpcAlt := 1 ,;
									RestKeys( aSvKeys , .T. ),;
									oDlg:End();
							 	),;
							 	IF(;
							 		(;
							 			( nOpc == 3 );	//Inclusao
							 			.or.;
							 			( nOpc == 4 );	//Alteracao
							 		),;
							 			(;
							 				nOpcAlt := 0 ,;
							 				.F.;
							 			 ),;
									(;
										nOpcAlt := IF( nOpc == 2 , 0 , 1 ) ,;	//Visualizacao ou Exclusao
										RestKeys( aSvKeys , .T. ),;
										oDlg:End();
							 		);
							 	  );
						   );
					 }
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-X>     	   				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet24		:= { || ( nOpcAlt := 0 , RestKeys( aSvKeys , .T. ) , oDlg:End() ) }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Botao de Pesquisa na GetDados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
   	bGdSeek := { ||	Apda090GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )	,;
					SetKey( VK_F4 , bGdSeek ) ;
			   }

	aAdd(;
			aButtons	,;
							{;
								"pesquisa",;
	   							bGdSeek,;
	       	   					OemToAnsi( STR0001 + "...<F4>"  ),;	//"Pesquisar"
	       	   					OemToAnsi( STR0001 );				//"Pesquisar"
	           				};
	     )

	bDialogInit		:= { ||;
								aObjFolder[01,01,01] := oGdRd6							,;
								aObjFolder[01,01,02] := { || .T. }						,;
								aObjFolder[01,01,03] := NIL								,;
								aObjFolder[01,02,01] := oGdRdb							,;
								aObjFolder[01,02,02] := bRdbGdTudOk						,;
								aObjFolder[01,02,03] := NIL								,;
								aObjFolder[02,01,01] := oGdRd6							,;
								aObjFolder[02,01,02] := { || .T. }						,;
								aObjFolder[02,01,03] := NIL								,;
								aObjFolder[02,02,01] := oGdRd7							,;
								aObjFolder[02,02,02] := bRd7GdTudOk						,;
								aObjFolder[02,02,03] := NIL								,;
								aObjFolder[03,01,01] := oGdRd6							,;
								aObjFolder[03,01,02] := { || .T. }						,;
								aObjFolder[03,01,03] := NIL								,;
								aObjFolder[03,02,01] := oGdRdd							,;
								aObjFolder[03,02,02] := bRddGdTudOk						,;
								aObjFolder[03,02,03] := NIL								,;
								EnchoiceBar( oDlg , bSet15 , bSet24 , NIL , aButtons )	,;
								aGdObjects := {}										,;
								FolderSetOption( nNewFolder , oFolders:nOption , aObjFolder , @aGdObjects , @nActFolder ),;
								aRotSetOpc( cAlias , NIL , nOpc , .F. )					 ;
					   }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aPages								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aPages[ 01 ]		:= OemToAnsi( STR0026 /*"Resposta"*/ )
	aPages[ 02 ]		:= OemToAnsi( STR0027 /*"Refinamento"*/ )
	aPages[ 03 ]		:= OemToAnsi( STR0028 /*"Resultado"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Elementos para o Array do Objeto Folder        	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aObjFolder[ 01 ]	:= Array( 02 , 03 )
	aObjFolder[ 02 ]	:= Array( 02 , 03 )
	aObjFolder[ 03 ]	:= Array( 02 , 03 )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aFolders								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
   	aFolders[ 01 ] 		:= OemToAnsi( "&"+STR0026 /*"Resposta"*/ )
	aFolders[ 02 ] 		:= OemToAnsi( "&"+STR0027 /*"Refinamento"*/ )
	aFolders[ 03 ] 		:= OemToAnsi( "&"+STR0028 /*"Resultado"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta o Dialogo Principal para a Manutencao das Formulas	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	DEFINE MSDIALOG oDlg TITLE cCadastro From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF GetWndDefault() PIXEL

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega o Objeto Folder               					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
        oFolders := TFolder():New( aObj3Size[3,1],aObj3Size[3,2],aFolders,,oDlg,,,,.T.,.F.,aObj3Size[3,3],aObj3Size[3,4] )
        oFolders:bSetOption := { |nNewFolder| FolderSetOption( nNewFolder , oFolders:nOption , aObjFolder , @aGdObjects , @nActFolder ) }

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDD						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRd6	:= MsNewGetDados():New(	aObj3Size[2,1]	,;
										aObj3Size[2,2]	,;
										aObj3Size[2,3]	,;
										aObj3Size[2,4]	,;
										GD_DELETE		,;
										NIL				,;
										NIL				,;
										""				,;
										{}				,;
										0				,;
										9999			,;
										NIL				,;
										NIL				,;
										bDelSons		,;
										Nil				,;
										aRd6Header		,;
										aRd6Cols		 ;
									 )
		oGdRd6:oBrowse:bGotFocus := { || Rd6GotFocus( oGdRd6 ) }
		oGdRd6:bChange := { |lColsToAll| Rd62RDDChg( oGdRd6 , @oGdRdd , @aRddCols , lColsToAll ),;
		                                 Rd62Rd7Chg( oGdRd6 , @oGdRd7 , @aRd7Cols , lColsToAll ),;
		                                 Rd62RDBChg( oGdRd6 , @oGdRdb , @aRdbCols , lColsToAll ) ;
		                  }
		oGdRd6:oBrowse:cToolTip := OemToAnsi( STR0014 ) //"Avalia┤oes"

        aRdbaCols 	:= GdRmkaCols( aRdbHeader , .F. , .T. , .T. , NIL , .F. )
		aRd7aCols	:= GdRmkaCols( aRd7Header , .F. , .T. , .F. , NIL , .F. )
		aRddaCols 	:= GdRmkaCols( aRddHeader , .F. , .T. , .T. , NIL , .F. )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDB						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/

		oGdRdb	:= MsNewGetDados():New(	aObj4Size[1,1]											,;
										aObj4Size[1,2]											,;
										aObj4Size[1,3]											,;
										aObj4Size[1,4]											,;
										nOpcNewGd												,;
										"RdbGdLinOk"											,;
										"RdbGdTudOk"											,;
										""														,;
										aRdbGdAltera											,;
										0														,;
										999999													,;
										NIL														,;
										NIL														,;
									   	bRdbGdDelOk												,;
										oFolders:aDialogs[ 01 ]									,;
										aRdbHeader												,;
										aRdbaCols												 ;
									 )
		oGdRdb:oBrowse:cToolTip := OemToAnsi( STR0031 )	//"Respostas"
	    oGdRdb:oBrowse:bGotFocus	:={||	ChangeF3()	}
	    oGdRdb:bChange				:={||	ChangeF3()	}
	    oGdRdb:oBrowse:bMoved		:={||	ChangeF3()	}
		bSvblDblClick := oGdRdb:oBrowse:blDblClick
		//-- somente permite a modificacao se for inclusao ou alteracao e a questao for dissertativa
		oGdRdb:oBrowse:blDblClick := { || Apda190EdtMem( oGdRdb , bSvblDblClick ,;
																 ( ( ( nOpc == 3 ) .or. ( nOpc == 4 ) ) .and. ;
																      RdbMemoWhen()  ;
																 ) ;
																 ) }

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RD7						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRd7	:= MsNewGetDados():New(	aObj4Size[1,1]											,;
										aObj4Size[1,2]											,;
										aObj4Size[1,3]											,;
										aObj4Size[1,4]											,;
										nOpcNewGd												,;
										"Rd7GdLinOk"											,;
										"Rd7GdTudOk"											,;
										""														,;
										aRd7GdAltera											,;
										0														,;
										999999													,;
										NIL														,;
										NIL														,;
										bRd7GdDelOk												,;
										oFolders:aDialogs[ 02 ]									,;
										aRd7Header												,;
										aRd7aCols												 ;
									 )
		oGdRd7:oBrowse:cToolTip := OemToAnsi( STR0027 )	//"Refinamentos"

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDD						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRdd	:= MsNewGetDados():New(	aObj4Size[1,1]											,;
										aObj4Size[1,2]											,;
										aObj4Size[1,3]											,;
										aObj4Size[1,4]											,;
										nOpcNewGd												,;
										"RddGdLinOk"											,;
										"RddGdTudOk"											,;
										""														,;
										aRddGdAltera											,;
										0														,;
										999999													,;
										NIL														,;
										NIL														,;
										bRddGdDelOk												,;
										oFolders:aDialogs[ 03 ]									,;
										aRddHeader												,;
										aRddaCols  												 ;
									 )

		oGdRdd:oBrowse:cToolTip := OemToAnsi( STR0012 )	//"Resultados"

	ACTIVATE MSDIALOG oDlg ON INIT Eval( bDialogInit ) CENTERED

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁQuando Confirmada a Opcao e Nao for Visualizacao Grava ou   ExЁ
	Ёclui as Informacoes do RD0 e RDD							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF( nOpcAlt == 1 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Apenas se nao For Visualizacao              				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
 		IF ( nOpc != 2 )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Gravando/Incluido ou Excluindo Informacoes do SRY/RDD        Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		   	MsAguarde(;
							{ ||;
								   	Eval( bRDDSort  ),;				//Sorteia o aRddCols para Comparacao na Gravacao
									Apda090Grava(;
													nOpc		,;	//Opcao de Acordo com aRotina
							 						nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 						aRddHeader	,;	//Campos do Arquivo de Sub-Itens ( RDD )
							 						aRddCols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RDD )
							 						aSvRDDCols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RDD )
							 						aRddVirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RDD )
							 						aRddRecnos	 ;	//Recnos do Arquivo de Sub-Itens ( RDD )
							 					),;
							 		Eval( bRd7Sort  ),;				//Sorteia o aRd7Cols para Comparacao na Gravacao
									Apda180Grava(;
													nOpc		,;	//Opcao de Acordo com aRotina
							 						nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 						aRd7Header	,;	//Campos do Arquivo de Sub-Itens ( RD7 )
							 						aRd7Cols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RD7 )
							 						aSvRd7Cols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RD7 )
							 						aRd7VirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RD7 )
							 						aRd7Recnos	 ;	//Recnos do Arquivo de Sub-Itens ( RD7 )
							 					),;
							 		Eval( bRDBSort  ),;				//Sorteia o aRdbCols para Comparacao na Gravacao
									Apda190Grava(;
													nOpc		,;	//Opcao de Acordo com aRotina
							 						nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 						aRdbHeader	,;	//Campos do Arquivo de Sub-Itens ( RDB )
							 						aRdbCols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RDB )
							 						aSvRDBCols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RDB )
							 						aRdbVirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RDB )
							 						aRdbRecnos	,;	//Recnos do Arquivo de Sub-Itens ( RDB )
							 						aRdbMemoGd	 ;	//Campos Memo na de Sub-Itens ( RDB )
							 					),;
							 		Apda260Grava();
		 					 };
						)
		EndIF
	Else
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё RollBack da Numeracao Automatica            				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			RollBackSX8()
		End While
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura os Dados de Entrada								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestArea( aArea )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura as Teclas de Atalho											 Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestKeys( aSvKeys , .T. )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Estado do Ponteiro do Mouse						   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( MbrChgLoop( .F. ) )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁAp090Ant    ЁAutorЁEmerson Campos         Ё Data Ё07/01/2013Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o Ё                                                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda260()	                                                Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObservaГЦoЁDevido ao desenvolvimento da nova tela contendo as manuten- Ё
Ё          ЁГУes de Resposta, Refinamento e Resultados em uma Зnica telaЁ
Ё          Ёo conteudo do fonte APDA090 foi anexado ao fonte APDA260 comЁ
Ё          Ёo intuito de auxiliar o analista nas manutenГУes futuras,   Ё
Ё          ЁjА que ao estar tudo junto, reduz o nro de funГУes repetidasЁ
Ё          ЁApenas ficar atento ao fato que as telas agora utilizam as  Ё
Ё          Ёmesmas funГУes em comum.                                    Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Ap090Ant( cAlias , nReg , nOpc , lExecAuto )
Local aArea		:= GetArea()
Local aAreaRd6	:= RD6->( GetArea() )
Local aAreaRdd	:= RDD->( GetArea() )
Local aAreaRd0	:= RD0->( GetArea() )
Local lExistOpc	:= ( ValType( nOpc ) == "N" )

Local bBlock
Local nPos

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSo Executa se o Modo de Acesso dos Arquivos do Modulo APD estiЁ
	Ёverem OK													   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( ApdRelationFile() )
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁRedefine o Alias                                              Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	cAlias	:= "RD0"

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array contendo as Rotinas a executar do programa      Ё
	Ё ----------- Elementos contidos por dimensao ------------     Ё
	Ё 1. Nome a aparecer no cabecalho                              Ё
	Ё 2. Nome da Rotina associada                                  Ё
	Ё 3. Usado pela rotina                                         Ё
	Ё 4. Tipo de Transa┤└o a ser efetuada                          Ё
	Ё    1 - Pesquisa e Posiciona em um Banco de Dados             Ё
	Ё    2 - Simplesmente Mostra os Campos                         Ё
	Ё    3 - Inclui registros no Bancos de Dados                   Ё
	Ё    4 - Altera o registro corrente                            Ё
	Ё    5 - Remove o registro corrente do Banco de Dados          Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	Private aRotina := MenuDef("APDA090") // ajuste para versao 9.12 - chamada da funcao MenuDef() que contem aRotina

	Private cCadastro	:= OemToAnsi( STR0006 )	//"Resultados de AvaliaГУes por Participantes"

	IF ( lExistOpc )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁGarante o Posicinamento do Recno                              Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		DEFAULT nReg	:= ( cAlias )->( Recno() )
		IF !Empty( nReg )
			( cAlias )->( MsGoto( nReg ) )
		EndIF

		DEFAULT lExecAuto := .F.
		IF ( lExecAuto )

			nPos := aScan( aRotina , { |x| x[4] == nOpc } )
			IF ( nPos == 0 )
				Break
			EndIF
			bBlock := &( "{ |a,b,c,d| " + aRotina[ nPos , 2 ] + "(a,b,c,d) }" )
			Eval( bBlock , cAlias , nReg , nPos )

		Else

			Apda090Mnt( cAlias , nReg , nOpc , .T. )

		EndIF

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Chama a Funcao de Montagem do Browse                                   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RD0->( dbSetOrder( RetOrdem( cAlias , "RD0_FILIAL+RD0_CODIGO" ) ) )
		mBrowse( 6 , 1 , 22 , 75 , cAlias , NIL , NIL , NIL , "RD0->RD0_MSBLQL=='2'")
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁColoca o Ponteiro do Mouse em Estado de Espera			   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

RestArea( aAreaRdd )
RestArea( aAreaRd6 )
RestArea( aAreaRd0 )
RestArea( aArea    )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Cursor do Mouse                				   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбддддддддддддддбддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁInApda090Exec ЁAutor ЁMarinaldo de Jesus   Ё Data Ё24/08/2004Ё
цддддддддддеддддддддддддддаддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁExecutar Funcoes Dentro de APDA090                           Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁInApda090Exec( cExecIn , aFormParam )						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁuRet                                                 	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico 													 Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function InApda090Exec( cExecIn , aFormParam )

Local uRet

DEFAULT cExecIn		:= ""
DEFAULT aFormParam	:= {}

IF !Empty( cExecIn )
	cExecIn	:= BldcExecInFun( cExecIn , aFormParam )
	uRet	:= &( cExecIn )
EndIF

Return( uRet )

/*/
зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda090MntЁ Autor ЁMarinaldo de Jesus     Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁCadastro de Participantes/Pessoas (Manutencao)				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁApda090Mnt( cAlias , nReg , nOpc , lDlgPadSiga )			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁcAlias 		= Alias do arquivo                              Ё
Ё          ЁnReg   		= Numero do registro                            Ё
Ё          ЁnOpc   		= Numero da opcao selecionada                   Ё
Ё          ЁlDlgPadSiga = Numero da opcao selecionada                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda090()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Apda090Mnt( cAlias , nReg , nOpc , lDlgPadSiga )

Local aArea				:= GetArea(Alias())
Local aSvKeys			:= GetKeys()
Local aAdvSize			:= {}
Local aInfoAdvSize		:= {}
Local aObjSize			:= {}
Local aObjCoords		:= {}
Local aInfo2AdvSize		:= {}
Local aObj2Size			:= {}
Local aObj2Coords		:= {}
Local aObj3Size			:= {}
Local aObj3Coords		:= {}
Local aRd0Header		:= {}
Local aRd0Cols			:= {}
Local aRd0Fields		:= {}
Local aRd0Altera		:= {}
Local aRd0NaoAlt		:= {}
Local aRd0VirtEn		:= {}
Local aRd0NotFields		:= {}
Local aRd0Keys			:= {}
Local aRd0VisuEn		:= {}
Local aRd6Recnos		:= {}
Local aRd6NotFields		:= {}
Local aRd6Header		:= {}
Local aRd6Cols			:= {}
Local aRddGdAltera  	:= {}
Local aRddGdNaoAlt		:= {}
Local aRddRecnos		:= {}
Local aRddKeys			:= {}
Local aRddNotFields		:= {}
Local aRddVirtGd		:= {}
Local aRddVisuGd		:= {}
Local aRddFldsAux		:= {}
Local aSvRDDCols		:= {}
Local aRddQuery			:= {}
Local aFolders			:= Array( 02 )
Local aPages			:= Array( 02 )
Local aObjFolder		:= Array( 02 )
Local aSvSetModulo		:= {}
Local aButtons			:= {}
Local aFreeLocks		:= {}
Local aGdObjects		:= {}
Local bRddGdDelOk		:= { |lDelOk| CursorWait() , lDelOk := RddGdDelOk( nOpc ) , CursorArrow() , lDelOk }
Local bRDDSort			:= { || NIL }
Local bSet15			:= { || NIL }
Local bSet24			:= { || NIL }
Local bDialogInit		:= { || NIL }
Local bGdSeek			:= { || NIL }
Local bGetRd0			:= { || NIL }
Local bGetRDD			:= { || NIL }
Local cRd0Filial		:= ""
Local cRd6Filial		:= ""
Local cRd0Codigo		:= ""
Local cKeySeek			:= ""
Local cRd9Filial		:= ""
Local lLocks			:= .F.
Local lExecLock			:= ( ( nOpc <> 2 ) .and. ( nOpc <> 3 ) )
Local nRd6Order			:= RetOrdem( "RD6" , "RD6_FILIAL+RD6_CODPAR+RD6_CODOBJ+RD6_CODPER" )
Local nRddOrder			:= RetOrdem( "RDD" , "RDD_FILIAL+RDD_CODADO" )
Local nRd9Order			:= RetOrdem( "RD9" , "RD9_FILIAL+RD9_CODADO" )
Local nRd9Bytes			:= ( GetSx3Cache( "RD9_CODADO" , "X3_TAMANHO" ) + GetSx3Cache( "RD9_CODAVA" , "X3_TAMANHO" ) )
Local nActFolder		:= 0
Local nOpcAlt			:= 0
Local nRd0Usado			:= 0
Local nRddUsado			:= 0
Local nLoop				:= 0
Local nOpcNewGd			:= IF( ( ( nOpc == 2 ) .or. ( nOpc == 5 ) ) , 0 , GD_INSERT + GD_UPDATE + GD_DELETE	)
Local nRddMaxLocks		:= 5
Local nRddGhostCol		:= 0
Local oDlg				:= NIL
Local oEndRd0			:= NIL
Local oFolders			:= NIL
Local cMsgYesNo			:= STR0032 //"EstА operaГЦo excluirА todas as avaliaГУes deste participante. Confirma a exclusЦo de todas as avaliaГУes?"
Private nGetSX8Len		:= GetSX8Len()
Private __nRddRd6AtAnt	:= 0
Private __nRd7Rd6AtAnt	:= 0
Private __nRdbRd6AtAnt	:= 0

Private aGets
Private aTela
Private aRddHeader
Private aRddCols
Private cRDDNumGhostCol
Private oGdRd6
Private oGdRdd

CursorArrow()
If nOpc == 5
	IF !(MsgYesNo( OemToAnsi( cMsgYesNo ) , cCadastro ))
		CursorWait()
		Return
	EndIf
EndIf

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁPoe o cursor do Mouse em Estado de Espera					   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCheca a Opcao Selecionada									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRotSetOpc( cAlias , NIL , nOpc , .F. )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a Enchoice							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd0NotFields	:= { "RD0_FILIAL" }
	aRd0Cols := RD0->(;
						GdBuildCols(	@aRd0Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
										@nRd0Usado		,;	//02 -> Numero de Campos em Uso
										@aRd0VirtEn		,;	//03 -> [@]Array com os Campos Virtuais
										@aRd0VisuEn		,;	//04 -> [@]Array com os Campos Visuais
										"RD0"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
										aRd0NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
										NIL         	,;	//07 -> [@]Array unidimensional contendo os Recnos
										"RD0"		   	,;	//08 -> Alias do Arquivo Pai
										NIL				,;	//09 -> Chave para o Posicionamento no Alias Filho
										NIL				,;	//10 -> Bloco para condicao de Loop While
										NIL				,;	//11 -> Bloco para Skip no Loop While
										NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
										NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
										NIL				,;	//14 -> Opcional, Carregar Todos os Campos
										NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
										NIL				,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
										NIL				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
										NIL				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
										NIL				,;	//19 -> Carregar Coluna Fantasma
										NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
										NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
										NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
										NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
										@aRd0Keys		,;	//24 -> [@]Array que contera as chaves conforme recnos
										NIL   			,;	//25 -> [@]Se devera efetuar o Lock dos Registros
										NIL			 ;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
								    );
					  )
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto o Posicionamento do Recno no RD0					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	CursorWait()
	cRd0Filial		:= RD0->RD0_FILIAL
	cRd0Codigo		:= RD0->RD0_CODIGO
	cRd6Filial		:= xFilial( "RD6" )
	cKeySeek		:= ( xFilial( "RDD" ,cRd6Filial ) + cRd0Codigo )
	cRd9Filial		:= xFilial( "RD9" , cRd6Filial )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Cria as Variaveis de Memoria e Carrega os Dados Conforme o arЁ
	Ё quivo														   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1 To nRd0Usado
		aAdd( aRd0Fields , aRd0Header[ nLoop , 02 ] )
		SetMemVar( aRd0Header[ nLoop , 02 ] , aRd0Cols[ 01 , nLoop ] , .T. )
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRd6NotFields , "RD6_FILIAL"  )
	RD6->( dbSetOrder( nRd6Order ) )
	bRd6Skip	:= { || ( fDesc( "RD9" , ( cRd0Codigo + RD6->RD6_CODIGO ) , "RD9_CODADO+RD9_CODAVA" , nRd9Bytes , cRd9Filial , nRd9Order , .F. ) <> ( cRd0Codigo + RD6->RD6_CODIGO ) ) }
	cKeySeek	:= xFilial( "RD6" , cRd6Filial )
	aRd6Cols	:= RD6->(;
							GdBuildCols(	@aRd6Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											NIL       		,;	//02 -> Numero de Campos em Uso
											NIL				,;	//03 -> [@]Array com os Campos Virtuais
											NIL         	,;	//04 -> [@]Array com os Campos Visuais
											"RD6"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRd6NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRd6Recnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD6"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											bRd6Skip		 ;	//11 -> Bloco para Skip no Loop While
									    );
						  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Nao Existem Avaliacoes para Este Participante 			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF Empty( aRd6Recnos )
		MsgInfo( STR0007 )	//"NЦo Existem AvaliaГУes para este Participante"
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos que nao serao carregados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRddNotFields , "RDD_FILIAL"  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array com os Campos Auxiliares    					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( Altera )
		aRddFldsAux := { { "GHOSTCOL" , "RDDNumGhostCol()" } }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRddQuery		:= Array( 05 )
	aRddQuery[01]	:= "RDD_FILIAL='"+cRd6Filial+"'"
	aRddQuery[02]	:= " AND "
	aRddQuery[03]	:= "RDD_CODADO='"+cRd0Codigo+"'"
	aRddQuery[04]	:= " AND "
	aRddQuery[05]	:= "D_E_L_E_T_=' ' "

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega Informacoes do RDD									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDD->( dbSetOrder( nRddOrder ) )
		cKeySeek	:= ( xFilial( "RDD" , cRd6Filial ) + cRd0Codigo )
		aRddCols := RDD->(;
							GdBuildCols(	@aRddHeader		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											@nRddUsado		,;	//02 -> Numero de Campos em Uso
											@aRddVirtGd		,;	//03 -> [@]Array com os Campos Virtuais
											@aRddVisuGd		,;	//04 -> [@]Array com os Campos Visuais
											"RDD"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRddNotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRddRecnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD0"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											NIL				,;	//11 -> Bloco para Skip no Loop While
											NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
											NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
											NIL				,;	//14 -> Opcional, Carregar Todos os Campos
											NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
											aRddQuery		,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
											.F.				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
											.F.				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
											aRddFldsAux		,;	//19 -> Carregar Coluna Fantasma
											NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
											NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
											NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
											NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
											@aRddKeys		,;	//24 -> [@]Array que contera as chaves conforme recnos
											NIL				,;	//25 -> [@]Se devera efetuar o Lock dos Registros
											NIL				,;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
											nRddMaxLocks	,;	//27 -> Numero maximo de Locks a ser efetuado
											Altera			 ;	//28 -> Utiliza Numeracao na GhostCol
									    );
				  		)

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSe ja houver informacoes no RDD nao Permite a Inclusao, apenasЁ
	Ёalteracao ou Exclusao										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( ( nOpc <> 3 ) .and. ( Len( aRddRecnos ) == 0 ) )
		//"NЦo existem resultados cadastrados para este participante. Selecione a op┤└o de InclusЦo"
		MsgInfo(  OemToAnsi( STR0008 ) , cCadastro )
		Break
	ElseIF ( ( nOpc == 3 ) .and. ( Len( aRddRecnos ) > 0 ) )
		//"JА═ Existem resultados cadastrados para este participante. Selecione a op┤└o de Altera┤└o"
		MsgInfo(  OemToAnsi( STR0009 ) , cCadastro )
		Break
	ElseIF ( nOpc == 5 )
    	//Verificar aqui se pode haver exclusao
	EndIF

	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁObtem o Pocisionamento no GHOSTCOL							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	nRddGhostCol	:= GdFieldPos( "GHOSTCOL" , aRddHeader )
	IF ( nRddGhostCol > 0 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem a ultima numeracao Gerada							   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cRDDNumGhostCol	:= aRddCols[ Len( aRddCols ) , nRddGhostCol ]
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define Bloco para Sorteio das Informacoes Antes da Gravacao  Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		bRDDSort := { || CursorWait() , aSort( aRddCols , NIL , NIL , { |x,y| ( x[ nRddGhostCol ] < y[ nRddGhostCol ] ) } ) , CursorArrow() }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁEfetuo Copia para Comparacao na Saida						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvRDDCols	:= aClone( aRddCols )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDD" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos nao Editaveis na GetDados 				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRddGdNaoAlt := { "RDD_CODAVA" , "RDD_CODADO" , "RDD_CODCOM" }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Campos Editaveis para a GetDados				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1	To nRddUsado
		SetMemVar( aRddHeader[ nLoop , 02 ] , GetValType( aRddHeader[ nLoop , 08 ] , aRddHeader[ nLoop , 04 ] ) , .T. )
		IF (;
				( aScan( aRddVirtGd		, aRddHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRddVisuGd		, aRddHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRddNotFields	, aRddHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRddGdNaoAlt	, aRddHeader[ nLoop , 02 ] ) == 0 )			;
		  	)
			aAdd( aRddGdAltera , aRddHeader[ nLoop , 02 ] )
		EndIF
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta as Dimensoes dos Objetos         					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	DEFAULT lDlgPadSiga	:= .F.

	aAdvSize		:= MsAdvSize()
	aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 0 , 0 }
	aAdd( aObjCoords , { 000 , 000 , .T. , .T. , .T. } )
	aObjSize 		:= MsObjSize( aInfoAdvSize , aObjCoords )

	aAdvSize		:= MsAdvSize(.f.)
    aAdvSize[4]		-=	25 // ALTURA
    aAdvSize[3]		-=	3 // Largura

	aInfo2AdvSize	:= { aAdvSize[1] , 1 , aAdvSize[3] , aAdvSize[4] , 1 , 1 }
	aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )
	aObj2Size 		:= MsObjSize( aInfo2AdvSize , aObj2Coords )

	aAdd( aObj3Coords , { 000 , 000 , .T. , .T. } )
	aAdd( aObj3Coords , { 000 , 000 , .T. , .T. } )
	aObj3Size 		:= MsObjSize( aInfo2AdvSize , aObj3Coords )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para o TudoOk da GetDados do RDD			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bRddGdTudOk		:= { || oGdRdd:TudoOk() }						//Valida as Informacoes da GetDados RDD

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-O>						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet15		:= { || IF(;
								(;
									( nOpc == 3 );	//Inclusao
									.or.;
									( nOpc == 4 );	//Alteracao
								);
								.and.;
								Eval( bRddGdTudOk ),;							//Valida as Informacoes da GetDados
								(;
									Eval( oGdRd6:bChange , .T. ),;				//Transere as informacoes Atuais para o aRddCols
									nOpcAlt := 1 ,;
									RestKeys( aSvKeys , .T. ),;
									oDlg:End();
							 	),;
							 	IF(;
							 		(;
							 			( nOpc == 3 );	//Inclusao
							 			.or.;
							 			( nOpc == 4 );	//Alteracao
							 		),;
							 			(;
							 				nOpcAlt := 0 ,;
							 				.F.;
							 			 ),;
									(;
										nOpcAlt := IF( nOpc == 2 , 0 , 1 ) ,;	//Visualizacao ou Exclusao
										RestKeys( aSvKeys , .T. ),;
										oDlg:End();
							 		);
							 	  );
						   );
					 }
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-X>     	   				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet24		:= { || ( nOpcAlt := 0 , RestKeys( aSvKeys , .T. ) , oDlg:End() ) }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Botao de Pesquisa na GetDados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bGdSeek := { ||	Apda090GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )	,;
					SetKey( VK_F4 , bGdSeek ) ;
			   }
	aAdd(;
			aButtons	,;
							{;
								"pesquisa",;
	   							bGdSeek,;
	       	   					OemToAnsi( STR0001 + "...<F4>"  ),;	//"Pesquisar"
	       	   					OemToAnsi( STR0001 );				//"Pesquisar"
	           				};
	     )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Inicializacao do Dialog            	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bDialogInit		:= { ||;
								oGdRd6:Hide()											,;
								oGdRdd:Hide()											,;
								aObjFolder[01,01,01] := oEndRd0							,;
								aObjFolder[01,01,02] := { || .T. }						,;
								aObjFolder[01,01,03] := NIL								,;
								aObjFolder[02,01,01] := oGdRd6							,;
								aObjFolder[02,01,02] := { || .T. }						,;
								aObjFolder[02,01,03] := NIL								,;
								aObjFolder[02,02,01] := oGdRdd							,;
								aObjFolder[02,02,02] := bRddGdTudOk						,;
								aObjFolder[02,02,03] := NIL								,;
								EnchoiceBar( oDlg , bSet15 , bSet24 , NIL , aButtons )	,;
								SetKey( VK_F4 , bGdSeek )								,;
								aGdObjects := {}										,;
								aRotSetOpc( cAlias , NIL , nOpc , .F. )					 ;
					   }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aPages								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aPages[ 01 ]   		:= OemToAnsi( IF( cModulo == "APD" , STR0010 /*"Participante"*/ , STR0011 /*"Pessoa"*/ ) )
	aPages[ 02 ]		:= OemToAnsi( STR0012 /*"Resultados"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aFolders								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aFolders[ 01 ] 		:= OemToAnsi( "&"+IF( cModulo == "APD" , STR0010 /*"Participante"*/ , STR0011 /*"Pessoa"*/ ) )
	aFolders[ 02 ] 		:= OemToAnsi( "&"+STR0012 /*"Resultados"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Elementos para o Array do Objeto Folder        	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aObjFolder[ 01 ]	:= Array( 01 , 03 )
	aObjFolder[ 02 ]	:= Array( 02 , 03 )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta o Dialogo Principal para a Manutencao das Formulas	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	DEFINE MSDIALOG oDlg TITLE cCadastro From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF GetWndDefault() PIXEL

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega o Objeto Folder               					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oFolders := TFolder():New(	aObjSize[ 1 , 1 ]		,;
									aObjSize[ 1 , 2 ]		,;
									aFolders				,;
									aPages					,;
									oDlg					,;
									NIL						,;
									NIL						,;
									NIL						,;
									.T.						,;
									.F.						,;
									aObjSize[ 1 , 3 ]		,;
									aObjSize[ 1 , 4 ]		 ;
								 )
		oFolders:bSetOption := { |nNewFolder| FolderSetOption( nNewFolder , oFolders:nOption , aObjFolder , @aGdObjects , @nActFolder ) }

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto Enchoice para o RD0                      	   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oEndRd0	:= MsmGet():New(	cAlias					,;
									nReg					,;
									2						,;
									NIL						,;
									NIL						,;
									NIL						,;
									aRd0Fields				,;
									aObj2Size[1]			,;
									aRd0Altera				,;
									NIL						,;
									NIL						,;
									NIL						,;
									NIL						,;
									oFolders:aDialogs[ 01 ]	,;
									.F.						,;
									NIL						,;
									.F.			 			 ;
								)


		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDD						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRd6	:= MsNewGetDados():New(	aObj3Size[1,1]	,;
										aObj3Size[1,2]	,;
										aObj3Size[1,3]	,;
										aObj3Size[1,4]	,;
										0				,;
										NIL				,;
										NIL				,;
										""				,;
										{}				,;
										0				,;
										9999			,;
										NIL				,;
										NIL				,;
										NIL				,;
										oFolders:aDialogs[ 02 ],;
										aRd6Header		,;
										aRd6Cols		 ;
									 )
		oGdRd6:oBrowse:bGotFocus := { || Rd6GotFocus( oGdRd6 ) }
		oGdRd6:bChange := { |lColsToAll| Rd62RDDChg( oGdRd6 , @oGdRdd , @aRddCols , lColsToAll ) }
		oGdRd6:oBrowse:cToolTip := OemToAnsi( STR0014 ) //"Avalia┤oes"

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDD						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRdd	:= MsNewGetDados():New(	aObj3Size[2,1]											,;
										aObj3Size[2,2]											,;
										aObj3Size[2,3]											,;
										aObj3Size[2,4]											,;
										nOpcNewGd												,;
										"RddGdLinOk"											,;
										"RddGdTudOk"											,;
										""														,;
										aRddGdAltera											,;
										0														,;
										999999													,;
										NIL														,;
										NIL														,;
										bRddGdDelOk												,;
										oFolders:aDialogs[ 02 ]									,;
										aRddHeader												,;
										GdRmkaCols( aRddHeader , .F. , .T. , .T. , NIL , .F. )	 ;
									 )

		oGdRdd:oBrowse:cToolTip := OemToAnsi( STR0012 )	//"Resultados"

	ACTIVATE MSDIALOG oDlg ON INIT Eval( bDialogInit ) CENTERED

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁQuando Confirmada a Opcao e Nao for Visualizacao Grava ou   ExЁ
	Ёclui as Informacoes do RD0 e RDD							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF( nOpcAlt == 1 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Apenas se nao For Visualizacao              				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
 		IF ( nOpc != 2 )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Gravando/Incluido ou Excluindo Informacoes do SRY/RDD        Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			MsAguarde(;
							{ ||;
									Eval( bRDDSort  ),;				//Sorteia o aRddCols para Comparacao na Gravacao
									Apda090Grava(;
													nOpc		,;	//Opcao de Acordo com aRotina
							 						nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 						aRddHeader	,;	//Campos do Arquivo de Sub-Itens ( RDD )
							 						aRddCols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RDD )
							 						aSvRDDCols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RDD )
							 						aRddVirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RDD )
							 						aRddRecnos	 ;	//Recnos do Arquivo de Sub-Itens ( RDD )
							 					);
		 					 };
						)
		EndIF
	Else
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё RollBack da Numeracao Automatica            				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			RollBackSX8()
		End While
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura os Dados de Entrada								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestArea( aArea )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura as Teclas de Atalho											 Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestKeys( aSvKeys , .T. )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Estado do Ponteiro do Mouse						   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( MbrChgLoop( .F. ) )


/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda090GdSeekЁAutorЁMarinaldo de Jesus    Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁEfetuar Pesquisa na GetDados                               	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA260                                                		Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda090GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )

Local aSvKeys 		:= GetKeys()
Local cProcName3	:= Upper( AllTrim( ProcName( 3 ) ) )
Local cProcName5	:= Upper( AllTrim( ProcName( 5 ) ) )

Local cMsgInfo
Local cTitle
Local nPosGdObj

DEFAULT aGdObjects	:= {}

Begin Sequence

	IF !( "APDA090MNT" $ ( cProcName3 + cProcName5 ) )
		IF !( "APDA260MNT" $ ( cProcName3 + cProcName5 ) )
			Break
		EndIf
	EndIF

   	IF (;
			Empty( aGdObjects );
			.or.;
			( ( nPosGdObj := aScan( aGdObjects[ nActFolder ] , .T. ) ) == 0 );
		)
		cMsgInfo := STR0013	//"OpГЦo disponМvel apenas para pesquisa na(s) Pasta(s):"
		cMsgInfo += CRLF
		cMsgInfo += aPages[ 02 ]
		MsgInfo( OemToAnsi( cMsgInfo ) , cCadastro )
		Break
	EndIF

	nObj := GetObjGdSeek( aGdObjects , nActFolder , aObjFolder , @cTitle )
	IF ( nObj == 0 )
		Break
	EndIF
	GdSeek( aObjFolder[ nActFolder , nObj , 01 ] , OemToAnsi( cTitle ) )

End Sequence

RestKeys( aSvKeys , .T. )

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd62RDDChg	 	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁChange da GetDados Avaliados/Rede no Folder Avaliadores  	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Rd62RDDChg( oGdRd6 , oGdRdd , aRddCols , lColsToAll )

Local aRddCposPes
Local aRddCposSrt

Local bColsToAll

Local nRd6SvAt

DEFAULT lColsToAll	:= .F.

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDD" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁVerifica se Deve Transferir para do aCols para o aColsAll     Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF (;
			(;
				( Inclui );
				.or.;
				( Altera );
			);
		)

		nRd6SvAt	:= oGdRd6:oBrowse:nAt

		IF (;
				!Empty( __nRddRd6AtAnt );
				.and.;
				( __nRddRd6AtAnt <> nRd6SvAt );
			)

			oGdRd6:Goto( __nRddRd6AtAnt )

			IF !( oGdRdd:TudoOk() )
				oGdRdd:oBrowse:SetFocus()
				oGdRd6:Refresh()
				Break
			EndIF

			lColsToAll	:= .T.

		EndIF

		IF ( lColsToAll )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			ЁObtem as Informacoes para o GdColsExChange para o RDD         Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			RDDInfTrf(	oGdRd6			,;
						oGdRdd			,;
						@aRddCposPes	,;
						@aRddCposSrt	,;
						@bColsToAll		 ;
				  )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			ЁTransfiro os Dados do aCols para o aColsAll				   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			GdColsExChange(	@aRddCols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
							@oGdRdd:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
							oGdRdd:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
							NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
							NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
							aRddCposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
							aRddCposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
							NIL				,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
							.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
							.T.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
							.F.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
							.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
							.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
							bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
						 )

		EndIF

		IF ( __nRddRd6AtAnt <> nRd6SvAt )

			oGdRd6:Goto( nRd6SvAt )

			__nRddRd6AtAnt := nRd6SvAt

		EndIF

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem as Informacoes para o GdColsExChange para o RDD         Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDDInfTrf(	oGdRd6			,;
					oGdRdd			,;
					@aRddCposPes	,;
					@aRddCposSrt	,;
					@bColsToAll		 ;
			 	 )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁTransfiro os Dados do aColsAll para o aCols				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdColsExChange(	@aRddCols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
						@oGdRdd:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
						oGdRdd:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
						NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
						NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
						aRddCposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
						aRddCposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
						NIL				,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
						.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
						.F.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
						.T.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
						.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
						.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
						bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
					 )

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem as Informacoes para o GdColsExChange para o RDD         Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDDInfTrf(	oGdRd6			,;
					oGdRdd			,;
					@aRddCposPes	,;
					@aRddCposSrt	,;
					@bColsToAll		 ;
			 	 )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁTransfiro os Dados do aColsAll para o aCols				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdColsExChange(	@aRddCols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
						@oGdRdd:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
						oGdRdd:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
						NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
						NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
						aRddCposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
						aRddCposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
						oGdRdd:aHeader	,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
						.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
						.F.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
						.T.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
						.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
						.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
						bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
					 )
	EndIF

	oGdRdd:Goto( 1 )
	oGdRdd:Refresh()

End Sequence

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddInfTrf		 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁMonta as informacoes que serao utilizadas para a  transferenЁ
Ё          Ёcia de informacoes no GdColsExChange do RDD                 Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function RddInfTrf(	oGdRd6		,;
							oGdRdd		,;
							aRddCposPes	,;
							aRddCposSrt	,;
							bColsToAll	 ;
				  		)

Local cRd0Codigo		:= GetMemVar( "RD0_CODIGO" )
Local cRd6Codigo		:= GdFieldGet( "RD6_CODIGO" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Local cRd6CodCom		:= GdFieldGet( "RD6_CODCOM" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )

Local nRddCodAva		:= GdFieldPos( "RDD_CODAVA"	, oGdRdd:aHeader )
Local nRddCodAdo		:= GdFieldPos( "RDD_CODADO"	, oGdRdd:aHeader )
Local nRddCodPro		:= GdFieldPos( "RDD_CODPRO"	, oGdRdd:aHeader )
Local nRddDtiAva		:= GdFieldPos( "RDD_DTIAVA"	, oGdRdd:aHeader )
Local nRddDtfAva		:= GdFieldPos( "RDD_DTFAVA"	, oGdRdd:aHeader )
Local nRddCodCom		:= GdFieldPos( "RDD_CODCOM"	, oGdRdd:aHeader )
Local nRddIteCom		:= GdFieldPos( "RDD_ITECOM"	, oGdRdd:aHeader )
Local nRddCodTip		:= GdFieldPos( "RDD_CODTIP"	, oGdRdd:aHeader )
Local nRddCodNet		:= GdFieldPos( "RDD_CODNET"	, oGdRdd:aHeader )
Local nRddGhostCol		:= GdFieldPos( "GHOSTCOL"	, oGdRdd:aHeader )

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCarrega Array a Posicao dos Campos para o "Sort"			  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
aRddCposSrt := {}
aAdd( aRddCposSrt	, nRddCodAva 	)
aAdd( aRddCposSrt	, nRddCodAdo 	)
aAdd( aRddCposSrt	, nRddCodCom 	)
IF ( nRddGhostCol > 0 )
	aAdd( aRddCposSrt	, nRddGhostCol	)
EndIF

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCarrega Array com a Posicao dos Campos e as Chaves  CorresponЁ
Ёdentes														  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
aRddCposPes := {}
aAdd( aRddCposPes  	, { nRddCodAva	, cRd6Codigo } )
aAdd( aRddCposPes  	, { nRddCodAdo	, cRd0Codigo } )
aAdd( aRddCposPes  	, { nRddCodCom	, cRd6CodCom } )

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁDefine os Blocos para Validacao da Transferencia do aCols  paЁ
Ёra o aColsAll												  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
bColsToAll	:= bColsToAll	:= { | aCols , aHeader , nItem |;
												!Empty( aCols[ nItem , nRddCodAva ] );
												.and.;
												!Empty( aCols[ nItem , nRddCodAdo ] );
												.and.;
												!Empty( aCols[ nItem , nRddDtiAva ] );
												.and.;
												!Empty( aCols[ nItem , nRddDtfAva ] );
												.and.;
												!Empty( aCols[ nItem , nRddCodCom ] );
												.and.;
												!Empty( aCols[ nItem , nRddIteCom ] );
												.and.;
												!Empty( aCols[ nItem , nRddCodTip ] );
												.and.;
												!Empty( aCols[ nItem , nRddCodNet ] );
				}

Return( NIL )

/*/
зддддддддддбддддддддддддбдддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddGdLinOk	ЁAutorЁMarinaldo de Jesus     Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддддадддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁLinha Ok do RDD                                             Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRddGdLinOk( oBrowse )									    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda090()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddGdLinOk( oBrowse )

Local lLinOk		:= .T.

Local aCposKey

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDD" )

	Begin Sequence

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Se a Linha da GetDados Nao Estiver Deletada				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		IF !( GdDeleted() )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Verifica Itens Duplicados na GetDados						   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			aCposKey := GetArrUniqe( "RDD" )
			IF !( lLinOk := GdCheckKey( aCposKey , 4 ) )
				Break
			EndIF

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Verifica Se o Campos Estao Devidamente Preenchidos		   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			aCposKey := GdObrigat( aHeader )
			IF !( lLinOk := GdNoEmpty( aCposKey ) )
		    	Break
			EndIF

		EndIF

	End Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSe Houver Alguma Inconsistencia na GetDados, Seta-lhe o Foco  Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( lLinOk )
		IF ( ValType( "oBrowse" ) == "O" )
			oBrowse:SetFocus()
		EndIF
	EndIF

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( lLinOk )

/*/
зддддддддддбддддддддддддбдддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddGdTudOk	ЁAutorЁMarinaldo de Jesus     Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддддадддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁTudo Ok do RDD                                              Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRddGdTudOk( oBrowse )									    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda090()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddGdTudOk( oBrowse )

Local lTudoOk := .T.

Local nLoop

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	Begin Sequence

	    /*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Percorre Todas as Linhas para verificar se Esta Tudo OK      Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		For nLoop := 1 To Len( aCols )
			n := nLoop
			IF !( lTudoOk := RddGdLinOk( oBrowse ) )
				IF ( ValType( "oBrowse" ) == "O" )
					oBrowse:Refresh()
				EndIF
				Break
			EndIF
		Next nLoop

	End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( lTudoOk  )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddGdDelOk   ЁAutorЁMarinaldo de Jesus    Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar a Delecao na GetDados RDD                           Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRddGdDelOk( nOpc , oGdRd6 )									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda090()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddGdDelOk( nOpc )

Local lDelOk 		:= .T.
Local lStatusDel	:= .F.

Static lFirstDelOk
Static lLstDelOk

DEFAULT lFirstDelOk	:= .T.
DEFAULT lLstDelOk	:= .T.

Begin Sequence

	//Quando for Visualizacao ou Exclusao Abandona
	IF (;
			( nOpc == 2 ) .or. ;	//Visualizacao
			( nOpc == 5 );			//Exclusao
		)
		Break
	EndIF

	//Apenas se for a primeira vez
	IF !( lFirstDelOk )
		lFirstDelOk	:= .T.
		lDelOk 		:= lLstDelOk
		lLstDelOk	:= .T.
		Break
	EndIF

	lStatusDel	:= !( GdDeleted() ) //Inverte o Estado

	IF ( lStatusDel )	//Deletar
   		lDelOk	  := .T.
   		lLstDelOk := lDelOk
		//Ja Passou pela funcao
		lFirstDelOk := .F.
   		Break
	Else				//Restaurar
    	lDelOk := .T.
    	IF !( lDelOk )
    	EndIF
   		lLstDelOk := lDelOk
		//Ja Passou pela funcao
		lFirstDelOk := .F.
   		Break
	EndIF

	//Ja Passou pela funcao
	lFirstDelOk := .F.

End Sequence

Return( lDelOk )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddNumGhostCol	ЁAutorЁMarinaldo de Jesus Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁFuncao de Inicializacao da Numeracao Automatica do GHOSTCOL Ё
Ё          Ёdo RDD														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080  	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddNumGhostCol()

Local cNumGhostCol	:= ""

IF (;
		( Type( "aRddHeader" ) == "A" );
		.and.;
		( Type( "aRddCols" ) == "A" );
		.and.;
		( GdFieldPos( "GHOSTCOL" , aRddHeader ) > 0 );
	)
	IF ( Type( "cRDDNumGhostCol" ) == "U" )
		Private cRDDNumGhostCol := ""
	EndIF
	cNumGhostCol	:= GdNumItem( "GHOSTCOL" , @cRDDNumGhostCol , NIL , aRddHeader , aRddCols )
EndIF

Return( cNumGhostCol )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda090Grava ЁAutorЁMarinaldo de Jesus    Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o Ё                                                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda090()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda090Grava(	nOpc		,;	//Opcao de Acordo com aRotina
							 	nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 	aRddHeader	,;	//Campos do Arquivo de Sub-Itens ( RDD )
							 	aRddCols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RDD )
							 	aSvRDDCols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RDD )
							 	aRddVirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RDD )
							 	aRddRecnos	 ;	//Recnos do Arquivo de Sub-Itens ( RDD )
							  )

/*/
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Variaveis de Inicializacao Obrigatoria					  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Local aMestre	:= GdPutIStrMestre( 01 )
Local aItens	:= {}
Local cOpcao	:= IF( ( nOpc == 5 ) , "DELETE" , IF( ( ( nOpc == 3 ) .or. ( nOpc == 4 ) ) , "PUT" , NIL ) )
Local lModItens	:= .F.
Local lRDDModif	:= .F.
Local lRDDDelet	:= .F.
Local lSuperDel	:= .T.
Local nPosRec	:= Ascan(aRddHeader,{ |x| x[2] = "RDD_REC_WT"})
Local aRddColDel
Local aRddRecDel
Local nItens

//Certifica-se que o array estarА ordenado pelo Recno
aSort( aRddCols , NIL , NIL , { |x,y| ( x[nPosRec] < y[ nPosRec] ) } )
//Certifica-se que o array de recnos esteja ordenado
aSort(aRddRecnos)

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	IF ( cOpcao == "DELETE" )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁSimulo aqui uma Alteracao onde Todos os Itens Foram Deletados Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cOpcao 		:= "PUT"
		lSuperDel	:= .F.
		GdSuperDel( aRddHeader , @aRddCols , NIL , .T. )
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Verifica se Houveram Modificacoes no RDD					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( lRDDModif := !ArrayCompare( aRddCols , aSvRDDCols ) )
		IF ( lSuperDel )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Deleto todos os Itens que nao Estao OK					   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			GdSuperDel( aRddHeader , @aRddCols , NIL , .T. , GdGetBlock( "RDD" , aRddHeader , .F. ) )
		EndIF
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Separa os Itens que foram Deletados     					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		lRDDDelet := GdSplitDel( aRddHeader , @aRddCols , @aRddRecnos , @aRddColDel , @aRddRecDel  )
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Verifica se eh Delecao ou se Houveram Modificacoes       	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	lModItens := ( lRDDModif )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Itens Apenas se Houveram Alteracoes ou na ExclusaoЁ
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( lModItens )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega as Informacoes deletadas RDD                   	   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		IF ( lRDDDelet )

			aAdd( aItens , GdPutIStrItens() )
			nItens := Len( aItens )

			aItens[ nItens , 01 ] := "RDD"
			aItens[ nItens , 02 ] := NIL
			aItens[ nItens , 03 ] := aClone( aRddHeader )
			aItens[ nItens , 04 ] := aClone( aRddColDel )
			aItens[ nItens , 05 ] := aClone( aRddVirtGd )
			aItens[ nItens , 06 ] := aClone( aRddRecDel )

		EndIF

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega as Informacoes do RDD                   			   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		aAdd( aItens , GdPutIStrItens() )
		nItens := Len( aItens )

		aItens[ nItens , 01 ] := "RDD"
		aItens[ nItens , 02 ] := {;
									{ "FILIAL" , xFilial( "RDD" , RD6->RD6_FILIAL ) },;
									{ "CODPAR" , GetMemVar( "RD0_CODIGO" ) };
					 		 	 }
		aItens[ nItens , 03 ] := aClone( aRddHeader )
		aItens[ nItens , 04 ] := aClone( aRddCols   )
		aItens[ nItens , 05 ] := aClone( aRddVirtGd )
		aItens[ nItens , 06 ] := aClone( aRddRecnos )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define as Informacoes para o Arquivo Mestre RD0			   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		aMestre[ 01 , 01 ]	:= "RD0"
		aMestre[ 01 , 02 ]	:= nReg
		aMestre[ 01 , 03 ]	:= .F.
		aMestre[ 01 , 04 ]	:= {}
		aMestre[ 01 , 05 ]	:= {}
		aMestre[ 01 , 06 ]	:= {}
		aMestre[ 01 , 07 ]	:= aClone( aItens )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Grava as Informacoes                        				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdPutInfoData( aMestre , cOpcao , .T. , .F.  )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Confirmando a Numeracao Automatica          				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			ConfirmSX8()
		End While

	EndIF

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodAvaVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDD_CODAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDD_CODAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodAvaVld()

Local lRddCodAvaOk := .T.

Begin Sequence

	IF !( lRddCodAvaOk := NaoVazio() )
		Break
	EndIF

	IF !( lRddCodAvaOk := ExistCpo( "RD6" ) )
		Break
	EndIF

End Sequence

Return( lRddCodAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodAvaInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDD_CODAVA					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDD_CODAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodAvaInit()

Local cRddCodAvaInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODIGO" , oGdRd6:aHeader ) > 0 );
	)
	cRddCodAvaInit := GdFieldGet( "RD6_CODIGO" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRddCodAvaInit := Space( GetSx3Cache( "RDD_CODAVA" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDD_CODAVA" , cRddCodAvaInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodAdoVld 	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDD_CODADO									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDD_CODADO									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodAdoVld()

Local lRddCodAdoOk	:= .T.

	IF !( lRddCodAdoOk := NaoVazio() )
		Break
	EndIF

	IF !( lRddCodAdoOk := ExistCpo( "RD0" ) )
		Break
	EndIF

Return( lRddCodAdoOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodAdoInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDD_CODADO					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDD_CODADO								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodAdoInit()
Return( GetMemVar( "RD0_CODIGO" ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodProVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid para o Campo RDD_CODPRO            					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDD_CODPRO   								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodProVld()

Local lRddCodProOk := .T.

Begin Sequence

	IF ( Vazio() )
		Break
	EndIF

	IF !( lRddCodProOk := ExistCpo( "RDN" ) )
		Break
	EndIF

End Sequence

Return( lRddCodProOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodProInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializador padrao para o campo RDD_CODPRO				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO DO campo RDD_CODPRO   							Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodProInit()

Local cRddCodProIni

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODPRO" , oGdRd6:aHeader ) > 0 );
	)
	cRddCodProIni := GdFieldGet( "RD6_CODPRO" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRddCodProIni := Space( GetSx3Cache( "RDD_CODPRO" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDD_CODPRO" , cRddCodProIni ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddDtiAvaVld     ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDD_DTIAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDD_DTIAVA									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddDtiAvaVld()

Local lRddDtiAvaOk := .T.

Begin Sequence

	IF !( lRddDtiAvaOk := NaoVazio() )
		Break
	EndIF

End Sequence

Return( lRddDtiAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddDtiAvaInit    ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInit do Campo RDD_DTIAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do Campo RDD_DTIAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddDtiAvaInit()

Local dRddDtiAvaInit := Ctod( "//" )
Return( dRddDtiAvaInit )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddDtfAvaVld     ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDD_DTFAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDD_DTFAVA									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddDtfAvaVld()

Local lRddDtfAvaOk := .T.

Begin Sequence

	IF !( lRddDtfAvaOk := NaoVazio() )
		Break
	EndIF

End Sequence

Return( lRddDtfAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddDtfAvaInit    ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInit do Campo RDD_DTFAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do Campo RDD_DTFAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddDtfAvaInit()

Local dRddDtfAvaInit := Ctod( "//" )
Return( dRddDtfAvaInit )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodComVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDD_CODCOM									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDD_CODCOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodComVld()

Local lRDDCodComOk := .T.

Begin Sequence
	IF !( lRddCodComOk := NaoVazio() )
		Break
	EndIF
	IF !( lRddCodComOk := ExistCpo( "RDM" ) )
		Break
	EndIF
End Sequence

Return( lRddCodComOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodComInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDD_CODCOM					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDD_CODCOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodComInit()

Local cRddCodComInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODCOM" , oGdRd6:aHeader ) > 0 );
	)
	cRddCodComInit := GdFieldGet( "RD6_CODCOM" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRddCodComInit := Space( GetSx3Cache( "RDD_CODCOM" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDD_CODCOM" , cRddCodComInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddIteComVld     ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDD_CODCOM									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDD_CODCOM									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddIteComVld()

Local lRddIteComOk := .T.

Begin Sequence

	IF !( lRddIteComOk := NaoVazio() )
		Break
	EndIF

	IF !( lRddIteComOk := ExistCpo( "RD2" , ( GetMemVar( "RDD_CODCOM" ) + GetMemVar( "RDD_ITECOM" ) ) ) )
		Break
	EndIF

End Sequence

Return( lRddIteComOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddIteComInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDD_ITECOM					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDD_ITECOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddIteComInit()
Return( SetMemVar( "RDD_ITECOM" , Space( GetSx3Cache( "RDD_ITECOM" , "X3_TAMANHO" ) ) ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodTipVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDD_CODTIP									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDD_CODTIP								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodTipVld()

Local lRddCodTipOk := .T.

Begin Sequence

	IF !( lRddCodTipOk := NaoVazio() )
		Break
	EndIF

	IF !( lRddCodTipOk := ExistCpo( "RD5" ) )
		Break
	EndIF

End Sequence

Return( lRddCodTipOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodTipInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDD_CODTIP					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDD_CODTIP								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodTipInit()
Return( GetMemVar( "RD6_CODTIP" ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodNetVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDD_CODNET									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDD_CODNET								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodNetVld()

Local lRddCodNetOk := .T.

Begin Sequence

	IF !( lRddCodNetOk := NaoVazio() )
		Break
	EndIF

	IF ( IsInGetDados( { "RDD_CODTIP" } ) )
		cRddCodTip := GdFieldGet( "RDD_CODTIP" )
	Else
		cRddCodTip := GetMemVar( "RDD_CODTIP" )
	EndIF
	cRddCodNet := GetMemVar( ReadVar() )

	nRdhOrder := RetOrdem( "RDH" , "RDH_FILIAL+RDH_CODTIP+RDH_CODNET" )
	IF !( lRddCodNetOk := ExistCpo( "RDH" , cRddCodTip + cRddCodNet , nRdhOrder ) )
		Break
	EndIF

End Sequence

Return( lRddCodNetOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddCodNetInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDD_CODNET					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDD_CODNET								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddCodNetInit()

Local cRddCodNetInit := cRddCodNetInit := Space( GetSx3Cache( "RDD_CODNET" , "X3_TAMANHO" ) )

Return( SetMemVar( "RDD_CODNET" , cRddCodNetInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRddResObtVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDD_RESOBT									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDD_RESOBT								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RddResObtVld()

Local lRddResObtOk := .T.

Begin Sequence

	IF !( lRddResObtOk := Positivo() )
		Break
	EndIF

End Sequence

Return( lRddResObtOk )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁAp180Ant    ЁAutorЁEmerson Campos         Ё Data Ё07/01/2013Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o Ё                                                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda260()	                                                Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObservaГЦoЁDevido ao desenvolvimento da nova tela contendo as manuten- Ё
Ё          ЁГУes de Resposta, Refinamento e Resultados em uma Зnica telaЁ
Ё          Ёo conteudo do fonte APDA190 foi anexado ao fonte APDA260 comЁ
Ё          Ёo intuito de auxiliar o analista nas manutenГУes futuras,   Ё
Ё          ЁjА que ao estar tudo junto, reduz o nro de funГУes repetidasЁ
Ё          ЁApenas ficar atento ao fato que as telas agora utilizam as  Ё
Ё          Ёmesmas funГУes em comum.                                    Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Ap180Ant( cAlias , nReg , nOpc , lExecAuto )
Local aArea		:= GetArea()
Local aAreaRd6	:= RD6->( GetArea() )
Local aAreaRd7	:= RD7->( GetArea() )
Local aAreaRd0	:= RD0->( GetArea() )
Local lExistOpc	:= ( ValType( nOpc ) == "N" )

Local bBlock
Local nPos

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSo Executa se o Modo de Acesso dos Arquivos do Modulo APD estiЁ
	Ёverem OK													   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( ApdRelationFile() )
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁRedefine o Alias                                              Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	cAlias	:= "RD0"

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array contendo as Rotinas a executar do programa      Ё
	Ё ----------- Elementos contidos por dimensao ------------     Ё
	Ё 1. Nome a aparecer no cabecalho                              Ё
	Ё 2. Nome da Rotina associada                                  Ё
	Ё 3. Usado pela rotina                                         Ё
	Ё 4. Tipo de Transa┤└o a ser efetuada                          Ё
	Ё    1 - Pesquisa e Posiciona em um Banco de Dados             Ё
	Ё    2 - Simplesmente Mostra os Campos                         Ё
	Ё    3 - Inclui registros no Bancos de Dados                   Ё
	Ё    4 - Altera o registro corrente                            Ё
	Ё    5 - Remove o registro corrente do Banco de Dados          Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	Private aRotina := MenuDef("APDA180") // ajuste para versao 9.12 - chamada da funcao MenuDef() que contem aRotina

	Private cCadastro	:= OemToAnsi( STR0022 )	//"Cadastro Refinamento de AvaliaГУes"

	IF ( lExistOpc )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁGarante o Posicinamento do Recno                              Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		DEFAULT nReg	:= ( cAlias )->( Recno() )
		IF !Empty( nReg )
			( cAlias )->( MsGoto( nReg ) )
		EndIF

		DEFAULT lExecAuto := .F.
		IF ( lExecAuto )

			nPos := aScan( aRotina , { |x| x[4] == nOpc } )
			IF ( nPos == 0 )
				Break
			EndIF
			bBlock := &( "{ |a,b,c,d| " + aRotina[ nPos , 2 ] + "(a,b,c,d) }" )
			Eval( bBlock , cAlias , nReg , nPos )

		Else

			Apda180Mnt( cAlias , nReg , nOpc , .T. )

		EndIF

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Chama a Funcao de Montagem do Browse                                   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RD0->( dbSetOrder( RetOrdem( cAlias , "RD0_FILIAL+RD0_CODIGO" ) ) )
		mBrowse( 6 , 1 , 22 , 75 , cAlias , NIL , NIL , NIL , "RD0->RD0_MSBLQL=='2'")
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁColoca o Ponteiro do Mouse em Estado de Espera			   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

RestArea( aAreaRd7 )
RestArea( aAreaRd6 )
RestArea( aAreaRd0 )
RestArea( aArea    )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Cursor do Mouse                				   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбддддддддддддддбддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁInApda180Exec ЁAutor ЁMarinaldo de Jesus   Ё Data Ё24/08/2004Ё
цддддддддддеддддддддддддддаддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁExecutar Funcoes Dentro de APDA180                           Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁInApda180Exec( cExecIn , aFormParam )						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁuRet                                                 	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico 													 Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function InApda180Exec( cExecIn , aFormParam )

Local uRet

DEFAULT cExecIn		:= ""
DEFAULT aFormParam	:= {}

IF !Empty( cExecIn )
	cExecIn	:= BldcExecInFun( cExecIn , aFormParam )
	uRet	:= &( cExecIn )
EndIF

Return( uRet )

/*/
зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda180MntЁ Autor ЁMarinaldo de Jesus     Ё Data Ё11/08/2004Ё
цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁCadastro de Participantes/Pessoas (Manutencao)				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁApda180Mnt( cAlias , nReg , nOpc , lDlgPadSiga )			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁcAlias 		= Alias do arquivo                              Ё
Ё          ЁnReg   		= Numero do registro                            Ё
Ё          ЁnOpc   		= Numero da opcao selecionada                   Ё
Ё          ЁlDlgPadSiga = Numero da opcao selecionada                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda180()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Apda180Mnt( cAlias , nReg , nOpc , lDlgPadSiga )

Local aArea				:= GetArea(Alias())
Local aSvKeys			:= GetKeys()

Local aAdvSize			:= {}
Local aInfoAdvSize		:= {}
Local aObjSize			:= {}
Local aObjCoords		:= {}

Local aAdv1Size			:= {}
Local aInfo1AdvSize		:= {}
Local aObj1Size			:= {}
Local aObj1Coords		:= {}

Local aAdv2Size			:= {}
Local aInfo2AdvSize		:= {}
Local aObj2Size			:= {}
Local aObj2Coords		:= {}

Local aRd0Header		:= {}
Local aRd0Cols			:= {}
Local aRd0Fields		:= {}
Local aRd0Altera		:= {}
Local aRd0NaoAlt		:= {}
Local aRd0VirtEn		:= {}
Local aRd0NotFields		:= {}
Local aRd0Keys			:= {}
Local aRd0VisuEn		:= {}
Local aRd6Recnos		:= {}
Local aRd6NotFields		:= {}
Local aRd6Header		:= {}
Local aRd6Cols			:= {}
Local aRd7GdAltera  	:= {}
Local aRd7GdNaoAlt		:= {}
Local aRd7Recnos		:= {}
Local aRd7Keys			:= {}
Local aRd7NotFields		:= {}
Local aRd7VirtGd		:= {}
Local aRd7VisuGd		:= {}
Local aRd7FldsAux		:= {}
Local aSvRd7Cols		:= {}
Local aRd7Query			:= {}
Local aFolders			:= Array( 02 )
Local aPages			:= Array( 02 )
Local aObjFolder		:= Array( 02 )
Local aSvSetModulo		:= {}
Local aButtons			:= {}
Local aFreeLocks		:= {}
Local aGdObjects		:= {}
Local bRd7GdDelOk		:= { |lDelOk| CursorWait() , lDelOk := Rd7GdDelOk( nOpc ) , CursorArrow() , lDelOk }
Local bRd7Sort			:= { || NIL }
Local bSet15			:= { || NIL }
Local bSet24			:= { || NIL }
Local bDialogInit		:= { || NIL }
Local bGdSeek			:= { || NIL }
Local bGetRd0			:= { || NIL }
Local bGetRd7			:= { || NIL }
Local cRd0Filial		:= ""
Local cRd6Filial		:= ""
Local cRd0Codigo		:= ""
Local cKeySeek			:= ""
Local cRd9Filial		:= ""
Local lLocks			:= .F.
Local lExecLock			:= ( ( nOpc <> 2 ) .and. ( nOpc <> 3 ) )
Local nRd6Order			:= RetOrdem( "RD6" , "RD6_FILIAL+RD6_CODPAR+RD6_CODOBJ+RD6_CODPER" )
Local nRd7Order			:= RetOrdem( "RD7" , "RD7_FILIAL+RD7_CODADO" )
Local nRd9Order			:= RetOrdem( "RD9" , "RD9_FILIAL+RD9_CODADO" )
Local nRd9Bytes			:= ( GetSx3Cache( "RD9_CODADO" , "X3_TAMANHO" ) + GetSx3Cache( "RD9_CODAVA" , "X3_TAMANHO" ) )
Local nActFolder		:= 0
Local nOpcAlt			:= 0
Local nRd0Usado			:= 0
Local nRd7Usado			:= 0
Local nLoop				:= 0
Local nOpcNewGd			:= IF( ( ( nOpc == 2 ) .or. ( nOpc == 5 ) ) , 0 , GD_INSERT + GD_UPDATE + GD_DELETE	)
Local nRd7MaxLocks		:= 5
Local nRd7GhostCol		:= 0
Local oDlg				:= NIL
Local oEndRd0			:= NIL
Local oFolders			:= NIL
Local cMsgYesNo			:= STR0032 //"EstА operaГЦo excluirА todas as avaliaГУes deste participante. Confirma a exclusЦo de todas as avaliaГУes?"

Private nGetSX8Len		:= GetSX8Len()
Private __nRddRd6AtAnt	:= 0
Private __nRd7Rd6AtAnt	:= 0
Private __nRdbRd6AtAnt	:= 0

Private aGets
Private aTela
Private aRd7Header
Private aRd7Cols
Private cRd7NumGhostCol
Private oGdRd6
Private oGdRd7

CursorArrow()
If nOpc == 5
	IF !(MsgYesNo( OemToAnsi( cMsgYesNo ) , cCadastro ))
		CursorWait()
		Return
	EndIf
EndIf

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁPoe o cursor do Mouse em Estado de Espera					   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCheca a Opcao Selecionada									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRotSetOpc( cAlias , NIL , nOpc , .F. )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a Enchoice							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd0NotFields	:= { "RD0_FILIAL" }
	aRd0Cols := RD0->(;
						GdBuildCols(	@aRd0Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
										@nRd0Usado		,;	//02 -> Numero de Campos em Uso
										@aRd0VirtEn		,;	//03 -> [@]Array com os Campos Virtuais
										@aRd0VisuEn		,;	//04 -> [@]Array com os Campos Visuais
										"RD0"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
										aRd0NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
										NIL         	,;	//07 -> [@]Array unidimensional contendo os Recnos
										"RD0"		   	,;	//08 -> Alias do Arquivo Pai
										NIL				,;	//09 -> Chave para o Posicionamento no Alias Filho
										NIL				,;	//10 -> Bloco para condicao de Loop While
										NIL				,;	//11 -> Bloco para Skip no Loop While
										NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
										NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
										NIL				,;	//14 -> Opcional, Carregar Todos os Campos
										NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
										NIL				,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
										NIL				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
										NIL				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
										NIL				,;	//19 -> Carregar Coluna Fantasma
										NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
										NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
										NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
										NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
										@aRd0Keys		,;	//24 -> [@]Array que contera as chaves conforme recnos
										NIL   			,;	//25 -> [@]Se devera efetuar o Lock dos Registros
										NIL				 ;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
								    );
					  )
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto o Posicionamento do Recno no RD0					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	CursorWait()
	cRd0Filial		:= RD0->RD0_FILIAL
	cRd0Codigo		:= RD0->RD0_CODIGO
	cRd6Filial		:= xFilial( "RD6" )
	cKeySeek		:= ( xFilial( "RD7" ,cRd6Filial ) + cRd0Codigo )
	cRd9Filial		:= xFilial( "RD9" , cRd6Filial )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Cria as Variaveis de Memoria e Carrega os Dados Conforme o arЁ
	Ё quivo														   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1 To nRd0Usado
		aAdd( aRd0Fields , aRd0Header[ nLoop , 02 ] )
		SetMemVar( aRd0Header[ nLoop , 02 ] , aRd0Cols[ 01 , nLoop ] , .T. )
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRd6NotFields , "RD6_FILIAL"  )
	RD6->( dbSetOrder( nRd6Order ) )
	bRd6Skip	:= { || ( fDesc( "RD9" , ( cRd0Codigo + RD6->RD6_CODIGO ) , "RD9_CODADO+RD9_CODAVA" , nRd9Bytes , cRd9Filial , nRd9Order , .F. ) <> ( cRd0Codigo + RD6->RD6_CODIGO ) ) }
	cKeySeek	:= xFilial( "RD6" , cRd6Filial )
	aRd6Cols	:= RD6->(;
							GdBuildCols(	@aRd6Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											NIL       		,;	//02 -> Numero de Campos em Uso
											NIL				,;	//03 -> [@]Array com os Campos Virtuais
											NIL         	,;	//04 -> [@]Array com os Campos Visuais
											"RD6"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRd6NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRd6Recnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD6"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											bRd6Skip		 ;	//11 -> Bloco para Skip no Loop While
									    );
						  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Nao Existem Avaliacoes para Este Participante 			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF Empty( aRd6Recnos )
		MsgInfo( STR0007 )	//"NЦo Existem AvaliaГУes para este Participante"
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos que nao serao carregados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRd7NotFields , "RD7_FILIAL"  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array com os Campos Auxiliares    					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( Altera )
		aRd7FldsAux := { { "GHOSTCOL" , "Rd7NumGhostCol()" } }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd7Query		:= Array( 05 )
	aRd7Query[01]	:= "RD7_FILIAL='"+cRd6Filial+"'"
	aRd7Query[02]	:= " AND "
	aRd7Query[03]	:= "RD7_CODADO='"+cRd0Codigo+"'"
	aRd7Query[04]	:= " AND "
	aRd7Query[05]	:= "D_E_L_E_T_=' ' "

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega Informacoes do RD7									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RD7->( dbSetOrder( nRd7Order ) )
		cKeySeek	:= ( xFilial( "RD7" , cRd6Filial ) + cRd0Codigo )

		aRd7Cols := RD7->(;
							GdBuildCols(	@aRd7Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											@nRd7Usado		,;	//02 -> Numero de Campos em Uso
											@aRd7VirtGd		,;	//03 -> [@]Array com os Campos Virtuais
											@aRd7VisuGd		,;	//04 -> [@]Array com os Campos Visuais
											"RD7"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRd7NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRd7Recnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD0"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											NIL				,;	//11 -> Bloco para Skip no Loop While
											NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
											NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
											NIL				,;	//14 -> Opcional, Carregar Todos os Campos
											NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
											aRd7Query		,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
											.F.				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
											.F.				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
											aRd7FldsAux		,;	//19 -> Carregar Coluna Fantasma
											NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
											NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
											NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
											NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
											@aRd7Keys		,;	//24 -> [@]Array que contera as chaves conforme recnos
											NIL				,;	//25 -> [@]Se devera efetuar o Lock dos Registros
											NIL				,;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
											nRd7MaxLocks	,;	//27 -> Numero maximo de Locks a ser efetuado
											Altera			 ;	//28 -> Utiliza Numeracao na GhostCol
									    );
				  		)

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSe ja houver informacoes no RD7 nao Permite a Inclusao, apenasЁ
	Ёalteracao ou Exclusao										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( ( nOpc <> 3 ) .and. ( Len( aRd7Recnos ) == 0 ) )
		//"NЦo existem refinamentos cadastrados para este participante. Selecione a op┤└o de InclusЦo"
		MsgInfo(  OemToAnsi( STR0023 ) , cCadastro )
		Break
	ElseIF ( ( nOpc == 3 ) .and. ( Len( aRd7Recnos ) > 0 ) )
		//"JА existem refinamentos cadastrados para este participante. Selecione a opГЦo de AlteraГЦo"
		MsgInfo(  OemToAnsi( STR0024 ) , cCadastro )
		Break
	ElseIF ( nOpc == 5 )
    	//Verificar aqui se pode haver exclusao
	EndIF

	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁObtem o Pocisionamento no GHOSTCOL							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	nRd7GhostCol	:= GdFieldPos( "GHOSTCOL" , aRd7Header )
	IF ( nRd7GhostCol > 0 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem a ultima numeracao Gerada							   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cRd7NumGhostCol	:= aRd7Cols[ Len( aRd7Cols ) , nRd7GhostCol ]
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define Bloco para Sorteio das Informacoes Antes da Gravacao  Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		bRd7Sort := { || CursorWait() , aSort( aRd7Cols , NIL , NIL , { |x,y| ( x[ nRd7GhostCol ] < y[ nRd7GhostCol ] ) } ) , CursorArrow() }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁEfetuo Copia para Comparacao na Saida						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvRd7Cols	:= aClone( aRd7Cols )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RD7" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos nao Editaveis na GetDados 				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd7GdNaoAlt := { "RD7_CODAVA" , "RD7_CODADO" , "RD7_CODCOM" }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Campos Editaveis para a GetDados				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1	To nRd7Usado
		//SetMemVar( aRd7Header[ nLoop , 02 ] , GetValType( aRd7Header[ nLoop , 08 ] , aRd7Header[ nLoop , 04 ] ) , .T. )
		//SetMemVar( aRd0Header[ nLoop , 02 ] , aRd0Cols[ 01 , nLoop ] , .T. )
		SetMemVar( aRd7Header[ nLoop , 02 ] , aRd7Cols[ 01 , nLoop ] , .T. )
		IF (;
				( aScan( aRd7VirtGd		, aRd7Header[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRd7VisuGd		, aRd7Header[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRd7NotFields	, aRd7Header[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRd7GdNaoAlt	, aRd7Header[ nLoop , 02 ] ) == 0 )			;
		  	)
			aAdd( aRd7GdAltera , aRd7Header[ nLoop , 02 ] )
		EndIF
	Next nLoop


	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para o TudoOk da GetDados do RD7			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bRd7GdTudOk		:= { || oGdRd7:TudoOk() }						//Valida as Informacoes da GetDados RD7

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-O>						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet15		:= { || IF(;
								(;
									( nOpc == 3 );	//Inclusao
									.or.;
									( nOpc == 4 );	//Alteracao
								);
								.and.;
								Eval( bRd7GdTudOk ),;							//Valida as Informacoes da GetDados
								(;
									Eval( oGdRd6:bChange , .T. ),;				//Transere as informacoes Atuais para o aRd7Cols
									nOpcAlt := 1 ,;
									RestKeys( aSvKeys , .T. ),;
									oDlg:End();
							 	),;
							 	IF(;
							 		(;
							 			( nOpc == 3 );	//Inclusao
							 			.or.;
							 			( nOpc == 4 );	//Alteracao
							 		),;
							 			(;
							 				nOpcAlt := 0 ,;
							 				.F.;
							 			 ),;
									(;
										nOpcAlt := IF( nOpc == 2 , 0 , 1 ) ,;	//Visualizacao ou Exclusao
										RestKeys( aSvKeys , .T. ),;
										oDlg:End();
							 		);
							 	  );
						   );
					 }
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-X>     	   				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet24		:= { || ( nOpcAlt := 0 , RestKeys( aSvKeys , .T. ) , oDlg:End() ) }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Botao de Pesquisa na GetDados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bGdSeek := { ||	Apda180GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )	,;
					SetKey( VK_F4 , bGdSeek ) ;
			   }
	aAdd(;
			aButtons	,;
							{;
								"pesquisa",;
	   							bGdSeek,;
	       	   					OemToAnsi( STR0001 + "...<F4>"  ),;	//"Pesquisar"
	       	   					OemToAnsi( STR0001 );				//"Pesquisar"
	           				};
	     )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Inicializacao do Dialog            	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bDialogInit		:= { ||;
								oGdRd6:Hide()											,;
								oGdRd7:Hide()											,;
								aObjFolder[01,01,01] := oEndRd0							,;
								aObjFolder[01,01,02] := { || .T. }						,;
								aObjFolder[01,01,03] := NIL								,;
								aObjFolder[02,01,01] := oGdRd6							,;
								aObjFolder[02,01,02] := { || .T. }						,;
								aObjFolder[02,01,03] := NIL								,;
								aObjFolder[02,02,01] := oGdRd7							,;
								aObjFolder[02,02,02] := bRd7GdTudOk						,;
								aObjFolder[02,02,03] := NIL								,;
								EnchoiceBar( oDlg , bSet15 , bSet24 , NIL , aButtons )	,;
								SetKey( VK_F4 , bGdSeek )								,;
								aGdObjects := {}										,;
								aRotSetOpc( cAlias , NIL , nOpc , .F. )					 ;
					   }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aPages								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aPages[ 01 ]   		:= OemToAnsi( IF( cModulo == "APD" , STR0010 /*"Participante"*/ , STR0011 /*"Pessoa"*/ ) )
	aPages[ 02 ]		:= OemToAnsi( STR0025 /*"Refinamentos"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aFolders								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aFolders[ 01 ] 		:= OemToAnsi( "&"+IF( cModulo == "APD" , STR0010 /*"Participante"*/ , STR0011 /*"Pessoa"*/ ) )
	aFolders[ 02 ] 		:= OemToAnsi( "&"+STR0025 /*"Refinamentos"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Elementos para o Array do Objeto Folder        	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aObjFolder[ 01 ]	:= Array( 01 , 03 )
	aObjFolder[ 02 ]	:= Array( 02 , 03 )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta as Dimensoes dos Objetos         					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdvSize		:= MsAdvSize()
	aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 1 , 1}
	aAdd( aObjCoords , { 000 , 000 , .T. , .T., .T.  } )
	aObjSize		:= MsObjSize( aInfoAdvSize , aObjCoords )

	aAdvSize		:= MsAdvSize(.f.)
    aAdvSize[4]		-=	27 // ALTURA
    aAdvSize[3]		-=	4 // Largura

	aInfo1AdvSize	:= { aAdvSize[1] , 1 , aAdvSize[3] , aAdvSize[4] , 1 , 1 }
	aAdd( aObj1Coords , { 000 , 000 , .T. , .T. } )
	aObj1Size 		:= MsObjSize( aInfo1AdvSize , aObj1Coords )

	aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )
	aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )
	aObj2Size 		:= MsObjSize( aInfo1AdvSize , aObj2Coords )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta o Dialogo Principal para a Manutencao das Formulas	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	DEFINE MSDIALOG oDlg TITLE cCadastro From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF GetWndDefault() PIXEL

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega o Objeto Folder               					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oFolders := TFolder():New(	aObjSize[ 1 , 1 ]		,;
									aObjSize[ 1 , 2 ]		,;
									aFolders				,;
									aPages					,;
									oDlg					,;
									NIL						,;
									NIL						,;
									NIL						,;
									.T.						,;
									.F.						,;
									aObjSize[ 1 , 3 ]		,;
									aObjSize[ 1 , 4 ]		 ;
								 )
		oFolders:bSetOption := { |nNewFolder| FolderSetOption( nNewFolder , oFolders:nOption , aObjFolder , @aGdObjects , @nActFolder ) }

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto Enchoice para o RD0                      	   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oEndRd0	:= MsmGet():New(	cAlias					,;
									nReg					,;
									2						,;
									NIL						,;
									NIL						,;
									NIL						,;
									aRd0Fields				,;
									aObj1Size[1]			,;
									aRd0Altera				,;
									NIL						,;
									NIL						,;
									NIL						,;
                                   	NIL						,;
									oFolders:aDialogs[1]	,;
									.F.						,;
									NIL						,;
									.F.			 			,,,,,oFolders:aDialogs[1],,.F.,, ;
								)

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RD7						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRd6	:= MsNewGetDados():New(	aObj2Size[1,1]				,;
										aObj2Size[1,2]				,;
										aObj2Size[1,3]				,;
										aObj2Size[1,4] 				,;
										0							,;
										NIL							,;
										NIL							,;
										""							,;
										{}							,;
										0							,;
										9999						,;
										NIL							,;
										NIL							,;
										NIL							,;
										oFolders:aDialogs[ 02 ]		,;
										aRd6Header					,;
										aRd6Cols		 			;
									 )
		oGdRd6:oBrowse:bGotFocus := { || Rd6GotFocus( oGdRd6 ) }
		oGdRd6:bChange := { |lColsToAll| Rd62Rd7Chg( oGdRd6 , @oGdRd7 , @aRd7Cols , lColsToAll ) }
		oGdRd6:oBrowse:cToolTip := OemToAnsi( STR0014 ) //"Avalia┤oes"

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RD7						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRd7	:= MsNewGetDados():New(	aObj2Size[2,1]											,;
										aObj2Size[2,2]											,;
										aObj2Size[2,3]											,;
										aObj2Size[2,4]											,;
										nOpcNewGd												,;
										"Rd7GdLinOk"											,;
										"Rd7GdTudOk"											,;
										""														,;
										aRd7GdAltera											,;
										0														,;
										999999													,;
										NIL														,;
										NIL														,;
										bRd7GdDelOk												,;
										oFolders:aDialogs[ 02 ]									,;
										aRd7Header												,;
										GdRmkaCols( aRd7Header , .F. , .T. , .F. , NIL , .F. )	 ;
									 )
		oGdRd7:oBrowse:cToolTip := OemToAnsi( STR0025 )	//"Refinamentos"

	ACTIVATE MSDIALOG oDlg ON INIT Eval( bDialogInit ) CENTERED

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁQuando Confirmada a Opcao e Nao for Visualizacao Grava ou   ExЁ
	Ёclui as Informacoes do RD0 e RD7							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF( nOpcAlt == 1 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Apenas se nao For Visualizacao              				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
 		IF ( nOpc != 2 )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Gravando/Incluido ou Excluindo Informacoes do SRY/RD7        Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			MsAguarde(;
							{ ||;
									Eval( bRd7Sort  ),;				//Sorteia o aRd7Cols para Comparacao na Gravacao
									Apda180Grava(;
													nOpc		,;	//Opcao de Acordo com aRotina
							 						nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 						aRd7Header	,;	//Campos do Arquivo de Sub-Itens ( RD7 )
							 						aRd7Cols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RD7 )
							 						aSvRd7Cols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RD7 )
							 						aRd7VirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RD7 )
							 						aRd7Recnos	 ;	//Recnos do Arquivo de Sub-Itens ( RD7 )
							 					);
		 					 };
						)
		EndIF
	Else
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё RollBack da Numeracao Automatica            				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			RollBackSX8()
		End While
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura os Dados de Entrada								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestArea( aArea )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura as Teclas de Atalho											 Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestKeys( aSvKeys , .T. )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Estado do Ponteiro do Mouse						   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( MbrChgLoop( .F. ) )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda180GdSeekЁAutorЁMarinaldo de Jesus    Ё Data Ё11/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁEfetuar Pesquisa na GetDados                               	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080                                                		Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda180GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )

Local aSvKeys 		:= GetKeys()
Local cProcName3	:= Upper( AllTrim( ProcName( 3 ) ) )
Local cProcName5	:= Upper( AllTrim( ProcName( 5 ) ) )

Local cMsgInfo
Local cTitle
Local nPosGdObj

DEFAULT aGdObjects	:= {}

Begin Sequence

	IF !( "APDA180MNT" $ ( cProcName3 + cProcName5 ) )
		Break
	EndIF

	IF (;
			Empty( aGdObjects );
			.or.;
			( ( nPosGdObj := aScan( aGdObjects[ nActFolder ] , .T. ) ) == 0 );
		)
		cMsgInfo := STR0013	//"OpГЦo disponМvel apenas para pesquisa na(s) Pasta(s):"
		cMsgInfo += CRLF
		cMsgInfo += aPages[ 02 ]
		MsgInfo( OemToAnsi( cMsgInfo ) , cCadastro )
		Break
	EndIF

	nObj := GetObjGdSeek( aGdObjects , nActFolder , aObjFolder , @cTitle )
	IF ( nObj == 0 )
		Break
	EndIF
	GdSeek( aObjFolder[ nActFolder , nObj , 01 ] , OemToAnsi( cTitle ) )

End Sequence

RestKeys( aSvKeys , .T. )

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd62Rd7Chg	 	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁChange da GetDados Avaliados/Rede no Folder Avaliadores  	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Rd62Rd7Chg( oGdRd6 , oGdRd7 , aRd7Cols , lColsToAll )

Local aRd7CposPes
Local aRd7CposSrt

Local bColsToAll

Local nRd6SvAt

DEFAULT lColsToAll	:= .F.

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RD7" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁVerifica se Deve Transferir para do aCols para o aColsAll     Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF (;
			(;
				( Inclui );
				.or.;
				( Altera );
			);
		)

		nRd6SvAt	:= oGdRd6:oBrowse:nAt

		IF (;
				!Empty( __nRd7Rd6AtAnt );
				.and.;
				( __nRd7Rd6AtAnt <> nRd6SvAt );
			)

			oGdRd6:Goto( __nRd7Rd6AtAnt )

			IF !( oGdRd7:TudoOk() )
				oGdRd7:oBrowse:SetFocus()
				oGdRd6:Refresh()
				Break
			EndIF

			lColsToAll	:= .T.

		EndIF

		IF ( lColsToAll )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			ЁObtem as Informacoes para o GdColsExChange para o Rd7         Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			Rd7InfTrf(	oGdRd6			,;
						oGdRd7			,;
						@aRd7CposPes	,;
						@aRd7CposSrt	,;
						@bColsToAll		 ;
				  )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			ЁTransfiro os Dados do aCols para o aColsAll				   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			GdColsExChange(	@aRd7Cols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
							@oGdRd7:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
							oGdRd7:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
							NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
							NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
							aRd7CposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
							aRd7CposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
							NIL				,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
							.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
							.T.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
							.F.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
							.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
							.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
							bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
						 )

		EndIF

		IF ( __nRd7Rd6AtAnt <> nRd6SvAt )

			oGdRd6:Goto( nRd6SvAt )

			__nRd7Rd6AtAnt := nRd6SvAt

		EndIF

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem as Informacoes para o GdColsExChange para o Rd7         Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		Rd7InfTrf(	oGdRd6			,;
					oGdRd7			,;
					@aRd7CposPes	,;
					@aRd7CposSrt	,;
					@bColsToAll		 ;
			 	 )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁTransfiro os Dados do aColsAll para o aCols				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdColsExChange(	@aRd7Cols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
						@oGdRd7:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
						oGdRd7:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
						NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
						NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
						aRd7CposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
						aRd7CposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
						NIL				,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
						.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
						.F.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
						.T.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
						.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
						.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
						bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
					 )

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem as Informacoes para o GdColsExChange para o Rd7         Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		Rd7InfTrf(	oGdRd6			,;
					oGdRd7			,;
					@aRd7CposPes	,;
					@aRd7CposSrt	,;
					@bColsToAll		 ;
			 	 )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁTransfiro os Dados do aColsAll para o aCols				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdColsExChange(	@aRd7Cols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
						@oGdRd7:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
						oGdRd7:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
						NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
						NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
						aRd7CposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
						aRd7CposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
						oGdRd7:aHeader	,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
						.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
						.F.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
						.T.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
						.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
						.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
						bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
					 )
	EndIF

	oGdRd7:Goto( 1 )
	oGdRd7:Refresh()

End Sequence

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7InfTrf		 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁMonta as informacoes que serao utilizadas para a  transferenЁ
Ё          Ёcia de informacoes no GdColsExChange do RD7                 Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Rd7InfTrf(	oGdRd6		,;
							oGdRd7		,;
							aRd7CposPes	,;
							aRd7CposSrt	,;
							bColsToAll	 ;
				  		)

Local cRd0Codigo		:= GetMemVar( "RD0_CODIGO" )
Local cRd6Codigo		:= GdFieldGet( "RD6_CODIGO" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Local cRd6CodCom		:= GdFieldGet( "RD6_CODCOM" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )

Local nRd7CodAva		:= GdFieldPos( "RD7_CODAVA"	, oGdRd7:aHeader )
Local nRd7CodAdo		:= GdFieldPos( "RD7_CODADO"	, oGdRd7:aHeader )
Local nRd7CodCom		:= GdFieldPos( "RD7_CODCOM"	, oGdRd7:aHeader )
Local nRd7IteCom		:= GdFieldPos( "RD7_ITECOM"	, oGdRd7:aHeader )
Local nRd7Escala		:= GdFieldPos( "RD7_ESCALA"	, oGdRd7:aHeader )
Local nRd7IteEsc		:= GdFieldPos( "RD7_ITEESC"	, oGdRd7:aHeader )
Local nRd7GhostCol		:= GdFieldPos( "GHOSTCOL"	, oGdRd7:aHeader )

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCarrega Array a Posicao dos Campos para o "Sort"			  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
aRd7CposSrt := {}
aAdd( aRd7CposSrt	, nRd7CodAva 	)
aAdd( aRd7CposSrt	, nRd7CodAdo 	)
aAdd( aRd7CposSrt	, nRd7CodCom 	)
aAdd( aRd7CposSrt	, nRd7IteCom 	)
IF ( nRd7GhostCol > 0 )
	aAdd( aRd7CposSrt	, nRd7GhostCol	)
EndIF

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCarrega Array com a Posicao dos Campos e as Chaves  CorresponЁ
Ёdentes														  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
aRd7CposPes := {}
aAdd( aRd7CposPes  	, { nRd7CodAva	, cRd6Codigo } )
aAdd( aRd7CposPes  	, { nRd7CodAdo	, cRd0Codigo } )
aAdd( aRd7CposPes  	, { nRd7CodCom	, cRd6CodCom } )

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁDefine os Blocos para Validacao da Transferencia do aCols  paЁ
Ёra o aColsAll												  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
bColsToAll	:= bColsToAll	:= { | aCols , aHeader , nItem |;
												!Empty( aCols[ nItem , nRd7CodAva ] );
												.and.;
												!Empty( aCols[ nItem , nRd7CodAdo ] );
												.and.;
												!Empty( aCols[ nItem , nRd7CodCom ] );
												.and.;
												!Empty( aCols[ nItem , nRd7IteCom ] );
												.and.;
												!Empty( aCols[ nItem , nRd7Escala ] );
												.and.;
												!Empty( aCols[ nItem , nRd7IteEsc ] );
				}

Return( NIL )

/*/
зддддддддддбддддддддддддбдддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7GdLinOk	ЁAutorЁMarinaldo de Jesus     Ё Data Ё11/08/2004Ё
цддддддддддеддддддддддддадддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁLinha Ok do RD7                                             Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRd7GdLinOk( oBrowse )									    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda180()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7GdLinOk( oBrowse )

Local lLinOk		:= .T.

Local aCposKey

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	Begin Sequence

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Se a Linha da GetDados Nao Estiver Deletada				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		IF !( GdDeleted() )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Verifica Itens Duplicados na GetDados						   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			aCposKey := GetArrUniqe( "RD7" )
			IF !( lLinOk := GdCheckKey( aCposKey , 4 ) )
				Break
			EndIF

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Verifica Se o Campos Estao Devidamente Preenchidos		   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			aCposKey := GdObrigat( aHeader )
			IF !( lLinOk := GdNoEmpty( aCposKey ) )
		    	Break
			EndIF

		EndIF

	End Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSe Houver Alguma Inconsistencia na GetDados, Seta-lhe o Foco  Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( lLinOk )
		IF ( ValType( "oBrowse" ) == "O" )
			oBrowse:SetFocus()
		EndIF
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RD7" )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( lLinOk )

/*/
зддддддддддбддддддддддддбдддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7GdTudOk	ЁAutorЁMarinaldo de Jesus     Ё Data Ё11/08/2004Ё
цддддддддддеддддддддддддадддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁTudo Ok do RD7                                              Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRd7GdTudOk( oBrowse )									    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda180()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7GdTudOk( oBrowse )

Local lTudoOk := .T.

Local nLoop

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	Begin Sequence

	    /*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Percorre Todas as Linhas para verificar se Esta Tudo OK      Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		For nLoop := 1 To Len( aCols )
			n := nLoop
			IF !( lTudoOk := Rd7GdLinOk( oBrowse ) )
				IF ( ValType( "oBrowse" ) == "O" )
					oBrowse:Refresh()
				EndIF
				Break
			EndIF
		Next nLoop

	End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( lTudoOk  )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7GdDelOk   ЁAutorЁMarinaldo de Jesus    Ё Data Ё11/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar a Delecao na GetDados RD7                           Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRd7GdDelOk( nOpc , oGdRd6 )									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda180()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7GdDelOk( nOpc )

Local lDelOk 		:= .T.
Local lStatusDel	:= .F.

Static lFirstDelOk
Static lLstDelOk

DEFAULT lFirstDelOk	:= .T.
DEFAULT lLstDelOk	:= .T.

Begin Sequence

	//Quando for Visualizacao ou Exclusao Abandona
	IF (;
			( nOpc == 2 ) .or. ;	//Visualizacao
			( nOpc == 5 );			//Exclusao
		)
		Break
	EndIF

	//Apenas se for a primeira vez
	IF !( lFirstDelOk )
		lFirstDelOk	:= .T.
		lDelOk 		:= lLstDelOk
		lLstDelOk	:= .T.
		Break
	EndIF

	lStatusDel	:= !( GdDeleted() ) //Inverte o Estado

	IF ( lStatusDel )	//Deletar
   		lDelOk	  := .T.
   		lLstDelOk := lDelOk
		//Ja Passou pela funcao
		lFirstDelOk := .F.
   		Break
	Else				//Restaurar
    	lDelOk := .T.
    	IF !( lDelOk )
    	EndIF
   		lLstDelOk := lDelOk
		//Ja Passou pela funcao
		lFirstDelOk := .F.
   		Break
	EndIF

	//Ja Passou pela funcao
	lFirstDelOk := .F.

End Sequence

Return( lDelOk )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7NumGhostCol	ЁAutorЁMarinaldo de Jesus Ё Data Ё11/08/2004Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁFuncao de Inicializacao da Numeracao Automatica do GHOSTCOL Ё
Ё          Ёdo RD7														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080  	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7NumGhostCol()

Local cNumGhostCol	:= ""

IF (;
		( Type( "aRd7Header" ) == "A" );
		.and.;
		( Type( "aRd7Cols" ) == "A" );
		.and.;
		( GdFieldPos( "GHOSTCOL" , aRd7Header ) > 0 );
	)
	IF ( Type( "cRd7NumGhostCol" ) == "U" )
		Private cRd7NumGhostCol := ""
	EndIF
	cNumGhostCol	:= GdNumItem( "GHOSTCOL" , @cRd7NumGhostCol , NIL , aRd7Header , aRd7Cols )
EndIF

Return( cNumGhostCol )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda180Grava ЁAutorЁMarinaldo de Jesus    Ё Data Ё11/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o Ё                                                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda180()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda180Grava(	nOpc		,;	//Opcao de Acordo com aRotina
							 	nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 	aRd7Header	,;	//Campos do Arquivo de Sub-Itens ( RD7 )
							 	aRd7Cols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RD7 )
							 	aSvRd7Cols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RD7 )
							 	aRd7VirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RD7 )
							 	aRd7Recnos	 ;	//Recnos do Arquivo de Sub-Itens ( RD7 )
							  )

/*/
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Variaveis de Inicializacao Obrigatoria					  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Local aMestre	:= GdPutIStrMestre( 01 )
Local aItens	:= {}
Local cOpcao	:= IF( ( nOpc == 5 ) , "DELETE" , IF( ( ( nOpc == 3 ) .or. ( nOpc == 4 ) ) , "PUT" , NIL ) )
Local lModItens	:= .F.
Local lRd7Modif	:= .F.
Local lRd7Delet	:= .F.
Local lSuperDel	:= .T.
Local nPosRec	:= Ascan(aRd7Header,{ |x| x[2] = "RD7_REC_WT"})
Local aRd7ColDel
Local aRd7RecDel
Local nItens

//Certifica-se que o array estarА ordenado pelo Recno
aSort( aRd7Cols , NIL , NIL , { |x,y| ( x[nPosRec] < y[ nPosRec] ) } )
//Certifica-se que o array de recnos esteja ordenado
aSort(aRd7Recnos)

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	IF ( cOpcao == "DELETE" )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁSimulo aqui uma Alteracao onde Todos os Itens Foram Deletados Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cOpcao 		:= "PUT"
		lSuperDel	:= .F.
		GdSuperDel( aRd7Header , @aRd7Cols , NIL , .T. )
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Verifica se Houveram Modificacoes no RD7					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( lRd7Modif := !ArrayCompare( aRd7Cols , aSvRd7Cols ) )
		IF ( lSuperDel )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Deleto todos os Itens que nao Estao OK					   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			GdSuperDel( aRd7Header , @aRd7Cols , NIL , .T. , GdGetBlock( "RD7" , aRd7Header , .F. ) )
		EndIF
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Separa os Itens que foram Deletados     					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		lRd7Delet := GdSplitDel( aRd7Header , @aRd7Cols , @aRd7Recnos , @aRd7ColDel , @aRd7RecDel  )
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Verifica se eh Delecao ou se Houveram Modificacoes       	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	lModItens := ( lRd7Modif )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Itens Apenas se Houveram Alteracoes ou na ExclusaoЁ
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( lModItens )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega as Informacoes deletadas RD7                   	   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		IF ( lRd7Delet )

			aAdd( aItens , GdPutIStrItens() )
			nItens := Len( aItens )

			aItens[ nItens , 01 ] := "RD7"
			aItens[ nItens , 02 ] := NIL
			aItens[ nItens , 03 ] := aClone( aRd7Header )
			aItens[ nItens , 04 ] := aClone( aRd7ColDel )
			aItens[ nItens , 05 ] := aClone( aRd7VirtGd )
			aItens[ nItens , 06 ] := aClone( aRd7RecDel )

		EndIF

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega as Informacoes do RD7                   			   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		aAdd( aItens , GdPutIStrItens() )
		nItens := Len( aItens )

		aItens[ nItens , 01 ] := "RD7"
		aItens[ nItens , 02 ] := {;
									{ "FILIAL" , xFilial( "RD7" , RD6->RD6_FILIAL ) },;
									{ "CODPAR" , GetMemVar( "RD0_CODIGO" ) };
					 		 	 }
		aItens[ nItens , 03 ] := aClone( aRd7Header )
		aItens[ nItens , 04 ] := aClone( aRd7Cols   )
		aItens[ nItens , 05 ] := aClone( aRd7VirtGd )
		aItens[ nItens , 06 ] := aClone( aRd7Recnos )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define as Informacoes para o Arquivo Mestre RD0			   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		aMestre[ 01 , 01 ]	:= "RD0"
		aMestre[ 01 , 02 ]	:= nReg
		aMestre[ 01 , 03 ]	:= .F.
		aMestre[ 01 , 04 ]	:= {}
		aMestre[ 01 , 05 ]	:= {}
		aMestre[ 01 , 06 ]	:= {}
		aMestre[ 01 , 07 ]	:= aClone( aItens )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Grava as Informacoes                        				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdPutInfoData( aMestre , cOpcao , .T. , .F.  )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Confirmando a Numeracao Automatica          				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			ConfirmSX8()
		End While

	EndIF

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7CodAvaVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RD7_CODAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RD7_CODAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7CodAvaVld()

Local lRd7CodAvaOk := .T.

Begin Sequence

	IF !( lRd7CodAvaOk := NaoVazio() )
		Break
	EndIF

	IF !( lRd7CodAvaOk := ExistCpo( "RD6" ) )
		Break
	EndIF

End Sequence

Return( lRd7CodAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7CodAvaInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RD7_CODAVA					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RD7_CODAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7CodAvaInit()

Local cRd7CodAvaInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODIGO" , oGdRd6:aHeader ) > 0 );
	)
	cRd7CodAvaInit := GdFieldGet( "RD6_CODIGO" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRd7CodAvaInit := Space( GetSx3Cache( "RD7_CODAVA" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RD7_CODAVA" , cRd7CodAvaInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7CodAdoVld 	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RD7_CODADO									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RD7_CODADO									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7CodAdoVld()

Local lRd7CodAdoOk	:= .T.

Begin Sequence

	IF !( lRd7CodAdoOk := NaoVazio() )
		Break
	EndIF

	IF !( lRd7CodAdoOk := ExistCpo( "RD0" ) )
		Break
	EndIF

End Sequence

Return( lRd7CodAdoOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7CodAdoInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RD7_CODADO					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RD7_CODADO								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7CodAdoInit()
Return( GetMemVar( "RD0_CODIGO" ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7CodComVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RD7_CODCOM									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RD7_CODCOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7CodComVld()

Local lRd7CodComOk := .T.

Begin Sequence
	IF !( lRd7CodComOk := NaoVazio() )
		Break
	EndIF
	IF !( lRd7CodComOk := ExistCpo( "RDM" ) )
		Break
	EndIF
End Sequence

Return( lRd7CodComOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7CodComInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RD7_CODCOM					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RD7_CODCOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7CodComInit()

Local cRd7CodComInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODCOM" , oGdRd6:aHeader ) > 0 );
	)
	cRd7CodComInit := GdFieldGet( "RD6_CODCOM" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRd7CodComInit := Space( GetSx3Cache( "RD7_CODCOM" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RD7_CODCOM" , cRd7CodComInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7IteComVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RD7_ITECOM									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RD7_ITECOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7IteComVld()

Local lRd7IteComOk	:= .T.

Begin Sequence

	IF !( lRd7IteComOk := NaoVazio() )
		Break
	EndIF

	IF !( lRd7IteComOk := ExistCpo( "RD2" , ( GetMemVar( "RD7_CODCOM" ) + GetMemVar( "RD7_ITECOM" ) ) ) )
    	Break
	EndIF

End Sequence

Return( lRd7IteComOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7IteComInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RD7_ITECOM					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RD7_ITECOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7IteComInit()
Return( SetMemVar( "RD7_ITECOM" , Space( GetSx3Cache( "RD7_ITECOM" , "X3_TAMANHO" ) ) ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7EscalaVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RD7_ESCALA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RD7_ESCALA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7EscalaVld()

Local lRd7EscalaVld := .T.

Begin Sequence

	IF !( lRd7EscalaVld := NaoVazio() )
		Break
	EndIF

	IF !( lRd7EscalaVld := ExistCpo( "RBK" ) )
		Break
	EndIF

End Sequence

Return( lRd7EscalaVld )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7EscalaInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RD7_ESCALA					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RD7_ESCALA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7EscalaInit()
Return( SetMemVar( "RD7_ESCALA" , Space( GetSx3Cache( "RD7_ESCALA" , "X3_TAMANHO" ) ) ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7IteEscVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RD7_ITEESC									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RD7_ITEESC								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7IteEscVld()

Local lRd7IteEscOk	:= .T.

Begin Sequence

	IF !( lRd7IteEscOk := NaoVazio() )
		Break
	EndIF

	IF !( lRd7IteEscOk := ExistCpo( "RBL" , ( GetMemVar( "RD7_ESCALA" ) + GetMemVar( "RD7_ITEESC" ) ) ) )
		Break
	EndIF

End Sequence

Return( lRd7IteEscOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd7IteEscInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё11/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RD7_ITEESC					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RD7_ITEESC								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Rd7IteEscInit()
Return( SetMemVar( "RD7_ITEESC" , Space( GetSx3Cache( "RD7_ITEESC" , "X3_TAMANHO" ) ) ) )


/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁAp190Ant    ЁAutorЁEmerson Campos         Ё Data Ё07/01/2013Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o Ё                                                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda260()	                                                Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObservaГЦoЁDevido ao desenvolvimento da nova tela contendo as manuten- Ё
Ё          ЁГУes de Resposta, Refinamento e Resultados em uma Зnica telaЁ
Ё          Ёo conteudo do fonte APDA190 foi anexado ao fonte APDA260 comЁ
Ё          Ёo intuito de auxiliar o analista nas manutenГУes futuras,   Ё
Ё          ЁjА que ao estar tudo junto, reduz o nro de funГУes repetidasЁ
Ё          ЁApenas ficar atento ao fato que as telas agora utilizam as  Ё
Ё          Ёmesmas funГУes em comum.                                    Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Ap190Ant( cAlias , nReg , nOpc , lExecAuto )

Local aArea		:= GetArea()
Local aAreaRd6	:= RD6->( GetArea() )
Local aAreaRdb	:= RDB->( GetArea() )
Local aAreaRd0	:= RD0->( GetArea() )
Local lExistOpc	:= ( ValType( nOpc ) == "N" )

Local bBlock
Local nPos


Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSo Executa se o Modo de Acesso dos Arquivos do Modulo APD estiЁ
	Ёverem OK													   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( ApdRelationFile() )
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁRedefine o Alias                                              Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	cAlias	:= "RD0"

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array contendo as Rotinas a executar do programa      Ё
	Ё ----------- Elementos contidos por dimensao ------------     Ё
	Ё 1. Nome a aparecer no cabecalho                              Ё
	Ё 2. Nome da Rotina associada                                  Ё
	Ё 3. Usado pela rotina                                         Ё
	Ё 4. Tipo de Transa┤└o a ser efetuada                          Ё
	Ё    1 - Pesquisa e Posiciona em um Banco de Dados             Ё
	Ё    2 - Simplesmente Mostra os Campos                         Ё
	Ё    3 - Inclui registros no Bancos de Dados                   Ё
	Ё    4 - Altera o registro corrente                            Ё
	Ё    5 - Remove o registro corrente do Banco de Dados          Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	Private aRotina := MenuDef("APDA190") // ajuste para versao 9.12 - chamada da funcao MenuDef() que contem aRotina

	Private cCadastro	:= OemToAnsi( STR0006 )	//"Resultados de AvaliaГУes por Participantes"

	IF ( lExistOpc )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁGarante o Posicinamento do Recno                              Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		DEFAULT nReg	:= ( cAlias )->( Recno() )
		IF !Empty( nReg )
			( cAlias )->( MsGoto( nReg ) )
		EndIF

		DEFAULT lExecAuto := .F.
		IF ( lExecAuto )

			nPos := aScan( aRotina , { |x| x[4] == nOpc } )
			IF ( nPos == 0 )
				Break
			EndIF
			bBlock := &( "{ |a,b,c,d| " + aRotina[ nPos , 2 ] + "(a,b,c,d) }" )
			Eval( bBlock , cAlias , nReg , nPos )

		Else

			Apda190Mnt( cAlias , nReg , nOpc , .T. )

		EndIF

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Chama a Funcao de Montagem do Browse                                   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RD0->( dbSetOrder( RetOrdem( cAlias , "RD0_FILIAL+RD0_CODIGO" ) ) )
		mBrowse( 6 , 1 , 22 , 75 , cAlias , NIL , NIL , NIL , "RD0->RD0_MSBLQL=='2'")
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁColoca o Ponteiro do Mouse em Estado de Espera			   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

RestArea( aAreaRdb )
RestArea( aAreaRd6 )
RestArea( aAreaRd0 )
RestArea( aArea    )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Cursor do Mouse                				   	   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбддддддддддддддбддддддбдддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    ЁInApda190Exec ЁAutor ЁMarinaldo de Jesus   Ё Data Ё24/08/2004Ё
цддддддддддеддддддддддддддаддддддадддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁExecutar Funcoes Dentro de APDA190                           Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁInApda190Exec( cExecIn , aFormParam )						 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									 Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁuRet                                                 	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁObserva┤└oЁ                                                      	     Ё
цддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁGenerico 													 Ё
юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function InApda190Exec( cExecIn , aFormParam )

Local uRet

DEFAULT cExecIn		:= ""
DEFAULT aFormParam	:= {}

IF !Empty( cExecIn )
	cExecIn	:= BldcExecInFun( cExecIn , aFormParam )
	uRet	:= &( cExecIn )
EndIF

Return( uRet )

/*/
зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda190MntЁ Autor ЁMarinaldo de Jesus     Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁCadastro de Participantes/Pessoas (Manutencao)				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁApda190Mnt( cAlias , nReg , nOpc , lDlgPadSiga )			Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁcAlias 		= Alias do arquivo                              Ё
Ё          ЁnReg   		= Numero do registro                            Ё
Ё          ЁnOpc   		= Numero da opcao selecionada                   Ё
Ё          ЁlDlgPadSiga = Numero da opcao selecionada                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda190()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Apda190Mnt( cAlias , nReg , nOpc , lDlgPadSiga )

Local aArea				:= GetArea(Alias())
Local aSvKeys			:= GetKeys()

Local aAdvSize			:= {}
Local aInfoAdvSize		:= {}
Local aObjSize			:= {}
Local aObjCoords		:= {}

Local aAdv1Size			:= {}
Local aInfo1AdvSize		:= {}
Local aObj1Size			:= {}
Local aObj1Coords		:= {}

Local aAdv2Size			:= {}
Local aInfo2AdvSize		:= {}
Local aObj2Size			:= {}
Local aObj2Coords		:= {}

Local aRd0Header		:= {}
Local aRd0Cols			:= {}
Local aRd0Fields		:= {}
Local aRd0Altera		:= {}
Local aRd0NaoAlt		:= {}
Local aRd0VirtEn		:= {}
Local aRd0NotFields		:= {}
Local aRd0Keys			:= {}
Local aRd0VisuEn		:= {}
Local aRd6Recnos		:= {}
Local aRd6NotFields		:= {}
Local aRd6Header		:= {}
Local aRd6Cols			:= {}
Local aRdbGdAltera  	:= {}
Local aRdbGdNaoAlt		:= {}
Local aRdbRecnos		:= {}
Local aRdbKeys			:= {}
Local aRdbNotFields		:= {}
Local aRdbVirtGd		:= {}
Local aRdbVisuGd		:= {}
Local aRdbMemoGd		:= {}
Local aRdbFldsAux		:= {}
Local aSvRDBCols		:= {}
Local aRdbQuery			:= {}
Local aRdyRecnos		:= {}
Local aRdyKeys			:= {}
Local aFolders			:= Array( 02 )
Local aPages			:= Array( 02 )
Local aObjFolder		:= Array( 02 )
Local aSvSetModulo		:= {}
Local aButtons			:= {}
Local aFreeLocks		:= {}
Local aGdObjects		:= {}
Local bRdbGdDelOk		:= { |lDelOk| CursorWait() , lDelOk := RdbGdDelOk( nOpc ) , CursorArrow() , lDelOk }
Local bRDBSort			:= { || NIL }
Local bSet15			:= { || NIL }
Local bSet24			:= { || NIL }
Local bDialogInit		:= { || NIL }
Local bGdSeek			:= { || NIL }
Local bGetRd0			:= { || NIL }
Local bGetRDB			:= { || NIL }
Local bSvblDblClick 	:= { || NIL }
Local cRdBFilial		:= ""
Local cRd0Filial		:= ""
Local cRd6Filial		:= ""
Local cRd0Codigo		:= ""
Local cKeySeek			:= ""
Local cRd9Filial		:= ""
Local lLocks			:= .F.
Local lExecLock			:= ( ( nOpc <> 2 ) .and. ( nOpc <> 3 ) )
Local nRd6Order			:= RetOrdem( "RD6" , "RD6_FILIAL+RD6_CODPAR+RD6_CODOBJ+RD6_CODPER" )
Local nRdbOrder			:= RetOrdem( "RDB" , "RDB_FILIAL+RDB_CODADO" )
Local nRd9Order			:= RetOrdem( "RD9" , "RD9_FILIAL+RD9_CODADO" )
Local nRd9Bytes			:= ( GetSx3Cache( "RD9_CODADO" , "X3_TAMANHO" ) + GetSx3Cache( "RD9_CODAVA" , "X3_TAMANHO" ) )
Local nActFolder		:= 0
Local nOpcAlt			:= 0
Local nRd0Usado			:= 0
Local nRdbUsado			:= 0
Local nLoop				:= 0
Local nOpcNewGd			:= IF( ( ( nOpc == 2 ) .or. ( nOpc == 5 ) ) , 0 , GD_UPDATE + GD_DELETE )
Local nRdbMaxLocks		:= 5
Local nRdbGhostCol		:= 0
Local oDlg				:= NIL
Local oEndRd0			:= NIL
Local oFolders			:= NIL
Local cMsgYesNo			:= STR0032 //"EstА operaГЦo excluirА todas as avaliaГУes deste participante. Confirma a exclusЦo de todas as avaliaГУes?"

Private nGetSX8Len		:= GetSX8Len()
Private __nRddRd6AtAnt	:= 0
Private __nRd7Rd6AtAnt	:= 0
Private __nRdbRd6AtAnt	:= 0

Private aGets
Private aTela
Private aRdbHeader
Private aRdbCols
Private cRDBNumGhostCol
Private oGdRd6
Private oGdRdb

CursorArrow()
If nOpc == 5
	IF !(MsgYesNo( OemToAnsi( cMsgYesNo ) , cCadastro ))
		CursorWait()
		Return
	EndIf
EndIf

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁPoe o cursor do Mouse em Estado de Espera					   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCheca a Opcao Selecionada									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRotSetOpc( cAlias , NIL , nOpc , .F. )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a Enchoice							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRd0NotFields	:= { "RD0_FILIAL" }
	aRd0Cols := RD0->(;
						GdBuildCols(	@aRd0Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
										@nRd0Usado		,;	//02 -> Numero de Campos em Uso
										@aRd0VirtEn		,;	//03 -> [@]Array com os Campos Virtuais
										@aRd0VisuEn		,;	//04 -> [@]Array com os Campos Visuais
										"RD0"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
										aRd0NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
										NIL         	,;	//07 -> [@]Array unidimensional contendo os Recnos
										"RD0"		   	,;	//08 -> Alias do Arquivo Pai
										NIL				,;	//09 -> Chave para o Posicionamento no Alias Filho
										NIL				,;	//10 -> Bloco para condicao de Loop While
										NIL				,;	//11 -> Bloco para Skip no Loop While
										NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
										NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
										NIL				,;	//14 -> Opcional, Carregar Todos os Campos
										NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
										NIL				,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
										NIL				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
										NIL				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
										NIL				,;	//19 -> Carregar Coluna Fantasma
										NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
										NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
										NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
										NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
										@aRd0Keys		,;	//24 -> [@]Array que contera as chaves conforme recnos
										NIL   			,;	//25 -> [@]Se devera efetuar o Lock dos Registros
								    );
					  )
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto o Posicionamento do Recno no RD0					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	CursorWait()
	cRd0Filial		:= RD0->RD0_FILIAL
	cRd0Codigo		:= RD0->RD0_CODIGO
	cRd6Filial		:= xFilial( "RD6" )
	cRdbFilial		:= xFilial("RDB")
	cKeySeek		:= ( cRdbFilial + cRd0Codigo )
	cRd9Filial		:= xFilial( "RD9" , cRdbFilial )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Cria as Variaveis de Memoria e Carrega os Dados Conforme o arЁ
	Ё quivo														   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1 To nRd0Usado
		aAdd( aRd0Fields , aRd0Header[ nLoop , 02 ] )
		SetMemVar( aRd0Header[ nLoop , 02 ] , aRd0Cols[ 01 , nLoop ] , .T. )
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRd6NotFields , "RD6_FILIAL"  )
	RD6->( dbSetOrder( nRd6Order ) )
	bRd6Skip	:= { || ( fDesc( "RD9" , ( cRd0Codigo + RD6->RD6_CODIGO ) , "RD9_CODADO+RD9_CODAVA" , nRd9Bytes , cRd9Filial , nRd9Order , .F. ) <> ( cRd0Codigo + RD6->RD6_CODIGO ) ) }
	cKeySeek	:= xFilial( "RD6" , cRdbFilial )
	aRd6Cols	:= RD6->(;
							GdBuildCols(	@aRd6Header		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											NIL       		,;	//02 -> Numero de Campos em Uso
											NIL				,;	//03 -> [@]Array com os Campos Virtuais
											NIL         	,;	//04 -> [@]Array com os Campos Visuais
											"RD6"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRd6NotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRd6Recnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD6"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											bRd6Skip		 ;	//11 -> Bloco para Skip no Loop While
									    );
						  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Nao Existem Avaliacoes para Este Participante 			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF Empty( aRd6Recnos )
		MsgInfo( STR0007 )	//"NЦo Existem AvaliaГУes para este Participante"
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos que nao serao carregados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRdbNotFields , "RDB_FILIAL"  )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define Array com os Campos Auxiliares    					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( Altera )
		aRdbFldsAux := { { "GHOSTCOL" , "RDBNumGhostCol()" } }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta os Dados para a GetDados							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRdbQuery		:= Array( 05 )
	aRdbQuery[01]	:= "RDB_FILIAL='"+cRdbFilial+"'"
	aRdbQuery[02]	:= " AND "
	aRdbQuery[03]	:= "RDB_CODADO='"+cRd0Codigo+"'"
	aRdbQuery[04]	:= " AND "
	aRdbQuery[05]	:= "D_E_L_E_T_=' ' "

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega Informacoes do RDB									   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDB->( dbSetOrder( nRdbOrder ) )
		cKeySeek	:= ( xFilial( "RDB" , cRdbFilial ) + cRd0Codigo )
		aRdbCols := RDB->(;
							GdBuildCols(	@aRdbHeader		,;	//01 -> Array com os Campos do Cabecalho da GetDados
											@nRdbUsado		,;	//02 -> Numero de Campos em Uso
											@aRdbVirtGd		,;	//03 -> [@]Array com os Campos Virtuais
											@aRdbVisuGd		,;	//04 -> [@]Array com os Campos Visuais
											"RDB"			,;	//05 -> Opcional, Alias do Arquivo Carga dos Itens do aCols
											aRdbNotFields	,;	//06 -> Opcional, Campos que nao Deverao constar no aHeader
											@aRdbRecnos		,;	//07 -> [@]Array unidimensional contendo os Recnos
											"RD0"		   	,;	//08 -> Alias do Arquivo Pai
											cKeySeek		,;	//09 -> Chave para o Posicionamento no Alias Filho
											NIL				,;	//10 -> Bloco para condicao de Loop While
											NIL				,;	//11 -> Bloco para Skip no Loop While
											NIL				,;	//12 -> Se Havera o Elemento de Delecao no aCols
											NIL				,;	//13 -> Se Sera considerado o Inicializador Padrao
											NIL				,;	//14 -> Opcional, Carregar Todos os Campos
											NIL				,;	//15 -> Opcional, Nao Carregar os Campos Virtuais
											aRdbQuery		,;	//16 -> Opcional, Utilizacao de Query para Selecao de Dados
											.F.				,;	//17 -> Opcional, Se deve Executar bKey  ( Apenas Quando TOP )
											.F.				,;	//18 -> Opcional, Se deve Executar bSkip ( Apenas Quando TOP )
											aRdbFldsAux		,;	//19 -> Carregar Coluna Fantasma
											NIL				,;	//20 -> Inverte a Condicao de aNotFields carregando apenas os campos ai definidos
											NIL				,;	//21 -> Verifica se Deve Checar se o campo eh usado
											NIL				,;	//22 -> Verifica se Deve Checar o nivel do usuario
											NIL				,;	//23 -> Verifica se Deve Carregar o Elemento Vazio no aCols
											@aRdbKeys		,;	//24 -> [@]Array que contera as chaves conforme recnos
											NIL				,;	//25 -> [@]Se devera efetuar o Lock dos Registros
											NIL				,;	//26 -> [@]Se devera obter a Exclusividade nas chaves dos registros
											nRdbMaxLocks	,;	//27 -> Numero maximo de Locks a ser efetuado
											Altera			 ;	//28 -> Utiliza Numeracao na GhostCol
									    );
				  		)
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSe ja houver informacoes no RDB nao Permite a Inclusao, apenasЁ
	Ёalteracao ou Exclusao										   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( ( nOpc <> 3 ) .and. ( Len( aRdbRecnos ) == 0 ) )
		//"NЦo existem respostas cadastradas para este participante. Selecione a op┤└o de InclusЦo"
		MsgInfo(  OemToAnsi( STR0029 ) , cCadastro )
		Break
	ElseIF ( ( nOpc == 3 ) .and. ( Len( aRdbRecnos ) > 0 ) )
		//"JА existem respostas cadastradas para este participante. Selecione a opГЦo de AlteraГЦo"
		MsgInfo(  OemToAnsi( STR0030 ) , cCadastro )
		Break
	ElseIF ( nOpc == 5 )
    	//Verificar aqui se pode haver exclusao
	EndIF

	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁObtem o Pocisionamento no GHOSTCOL							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	nRdbGhostCol	:= GdFieldPos( "GHOSTCOL" , aRdbHeader )
	IF ( nRdbGhostCol > 0 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem a ultima numeracao Gerada							   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cRDBNumGhostCol	:= aRdbCols[ Len( aRdbCols ) , nRdbGhostCol ]
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define Bloco para Sorteio das Informacoes Antes da Gravacao  Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		bRDBSort := { || CursorWait() , aSort( aRdbCols , NIL , NIL , { |x,y| ( x[ nRdbGhostCol ] < y[ nRdbGhostCol ] ) } ) , CursorArrow() }
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁEfetuo Copia para Comparacao na Saida						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvRDBCols	:= aClone( aRdbCols )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDB" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos nao Editaveis na GetDados 				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aRdbGdNaoAlt := { "RDB_CODAVA" , "RDB_CODADO" , "RDB_CODCOM",  "RDB_CODMEM" }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Campos Memos                     				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdd( aRdbMemoGd , { "RDB_MEMO" 	, "RDB_CODMEM" } )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Campos Editaveis para a GetDados				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	For nLoop := 1	To nRdbUsado
		SetMemVar( aRdbHeader[ nLoop , 02 ] , GetValType( aRdbHeader[ nLoop , 08 ] , aRdbHeader[ nLoop , 04 ] ) , .T. )
		IF (;
				( aScan( aRdbVirtGd		, aRdbHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRdbVisuGd		, aRdbHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRdbNotFields	, aRdbHeader[ nLoop , 02 ] ) == 0 ) .and.	;
	   			( aScan( aRdbGdNaoAlt	, aRdbHeader[ nLoop , 02 ] ) == 0 )			;
		  	)
			aAdd( aRdbGdAltera , aRdbHeader[ nLoop , 02 ] )
		EndIF
	Next nLoop

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁCarrega os Recnos e as Chaves correspondentes dos campos MemosЁ
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( ( nOpc <> 2 ) .and. ( nOpc <> 3 ) )
		IF !( lLocks := ApdMemRec( "RDB" , aRdbRecnos , aRdbMemoGd , @aRdyRecnos , @aRdyKeys , .T. ) )
			Break
		EndIF
    EndIF


	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para o TudoOk da GetDados do RDB			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bRdbGdTudOk		:= { || oGdRdb:TudoOk() }						//Valida as Informacoes da GetDados RDB

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-O>						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet15		:= { || IF(;
								(;
									( nOpc == 3 );	//Inclusao
									.or.;
									( nOpc == 4 );	//Alteracao
								);
								.and.;
								Eval( bRdbGdTudOk ),;							//Valida as Informacoes da GetDados
								(;
									Eval( oGdRd6:bChange , .T. ),;				//Transere as informacoes Atuais para o aRdbCols
									nOpcAlt := 1 ,;
									RestKeys( aSvKeys , .T. ),;
									oDlg:End();
							 	),;
							 	IF(;
							 		(;
							 			( nOpc == 3 );	//Inclusao
							 			.or.;
							 			( nOpc == 4 );	//Alteracao
							 		),;
							 			(;
							 				nOpcAlt := 0 ,;
							 				.F.;
							 			 ),;
									(;
										nOpcAlt := IF( nOpc == 2 , 0 , 1 ) ,;	//Visualizacao ou Exclusao
										RestKeys( aSvKeys , .T. ),;
										oDlg:End();
							 		);
							 	  );
						   );
					 }
	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-X>     	   				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet24		:= { || ( nOpcAlt := 0 , RestKeys( aSvKeys , .T. ) , oDlg:End() ) }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Botao de Pesquisa na GetDados					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bGdSeek := { ||	Apda190GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )	,;
					SetKey( VK_F4 , bGdSeek ) ;
			   }
	aAdd(;
			aButtons	,;
							{;
								"pesquisa",;
	   							bGdSeek,;
	       	   					OemToAnsi( STR0001 + "...<F4>"  ),;	//"Pesquisar"
	       	   					OemToAnsi( STR0001 );				//"Pesquisar"
	           				};
	     )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Inicializacao do Dialog            	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bDialogInit		:= { ||;
								oGdRd6:Hide()											,;
								oGdRdb:Hide()											,;
								aObjFolder[01,01,01] := oEndRd0							,;
								aObjFolder[01,01,02] := { || .T. }						,;
								aObjFolder[01,01,03] := NIL								,;
								aObjFolder[02,01,01] := oGdRd6							,;
								aObjFolder[02,01,02] := { || .T. }						,;
								aObjFolder[02,01,03] := NIL								,;
								aObjFolder[02,02,01] := oGdRdb							,;
								aObjFolder[02,02,02] := bRdbGdTudOk						,;
								aObjFolder[02,02,03] := NIL								,;
								EnchoiceBar( oDlg , bSet15 , bSet24 , NIL , aButtons )	,;
								SetKey( VK_F4 , bGdSeek )								,;
								aGdObjects := {}										,;
								aRotSetOpc( cAlias , NIL , nOpc , .F. )					 ;
					   }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aPages								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aPages[ 01 ]   		:= OemToAnsi( IF( cModulo == "APD" , STR0010 /*"Participante"*/ , STR0011 /*"Pessoa"*/ ) )
	aPages[ 02 ]		:= OemToAnsi( STR0031 /*"Respostas"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Conteudo do aFolders								   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aFolders[ 01 ] 		:= OemToAnsi( "&"+IF( cModulo == "APD" , STR0010 /*"Participante"*/ , STR0011 /*"Pessoa"*/ ) )
	aFolders[ 02 ] 		:= OemToAnsi( "&"+STR0031 /*"Respostas"*/ )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define os Elementos para o Array do Objeto Folder        	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aObjFolder[ 01 ]	:= Array( 01 , 03 )
	aObjFolder[ 02 ]	:= Array( 02 , 03 )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )


	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta as Dimensoes dos Objetos         					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdvSize		:= MsAdvSize()
	aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 1 , 1}
	aAdd( aObjCoords , { 000 , 000 , .T. , .T., .T.  } )
	aObjSize		:= MsObjSize( aInfoAdvSize , aObjCoords )


	aAdvSize		:= MsAdvSize(.f.)
    aAdvSize[4]		-=	27 // ALTURA
    aAdvSize[3]		-=	4 // Largura

	aInfo1AdvSize	:= { aAdvSize[1] , 1 , aAdvSize[3] , aAdvSize[4] , 1 , 1 }
	aAdd( aObj1Coords , { 000 , 000 , .T. , .T. } )
	aObj1Size 		:= MsObjSize( aInfo1AdvSize , aObj1Coords )

	aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )
	aAdd( aObj2Coords , { 000 , 000 , .T. , .T. } )
	aObj2Size 		:= MsObjSize( aInfo1AdvSize , aObj2Coords )



	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta o Dialogo Principal para a Manutencao das Formulas	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	DEFINE MSDIALOG oDlg TITLE cCadastro From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF GetWndDefault() PIXEL



		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega o Objeto Folder               					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oFolders := TFolder():New(	aObjSize[ 1 , 1 ]		,;
									aObjSize[ 1 , 2 ]		,;
									aFolders				,;
									aPages					,;
									oDlg					,;
									NIL						,;
									NIL						,;
									NIL						,;
									.T.						,;
									.F.						,;
									aObjSize[ 1 , 3 ]		,;
									aObjSize[ 1 , 4 ]		 ;
								 )
		oFolders:bSetOption := { |nNewFolder| FolderSetOption( nNewFolder , oFolders:nOption , aObjFolder , @aGdObjects , @nActFolder ) }

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta as Dimensoes para o Objeto Enchoice 				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto Enchoice para o RD0                      	   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oEndRd0	:= MsmGet():New(	cAlias					,;
									nReg					,;
									2						,;
									NIL						,;
									NIL						,;
									NIL						,;
									aRd0Fields				,;
									aObj1Size[1]			,;
									aRd0Altera				,;
									NIL						,;
									NIL						,;
									NIL						,;
									NIL						,;
									oFolders:aDialogs[ 01 ]	,;
									.F.						,;
									NIL						,;
									.F.			 			,,,,,oFolders:aDialogs[1],,.F.,, ;
								)

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDB						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		oGdRd6	:= MsNewGetDados():New(	aObj2Size[1,1]	,;
										aObj2Size[1,2]	,;
										aObj2Size[1,3]	,;
										aObj2Size[1,4]	,;
										0				,;
										NIL				,;
										NIL				,;
										""				,;
										{}				,;
										0				,;
										9999			,;
										NIL				,;
										NIL				,;
										NIL				,;
										oFolders:aDialogs[ 02 ]		,;
										aRd6Header		,;
										aRd6Cols		 ;
									 )
		oGdRd6:oBrowse:bGotFocus := { || Rd6GotFocus( oGdRd6 ) }
		oGdRd6:bChange := { |lColsToAll| Rd62RDBChg( oGdRd6 , @oGdRdb , @aRdbCols , lColsToAll ) }
		oGdRd6:oBrowse:cToolTip := OemToAnsi( STR0014 ) //"Avalia┤oes"


		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Monta o Objeto GetDados para o RDB						   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/

		oGdRdb	:= MsNewGetDados():New(	aObj2Size[2,1]											,;
										aObj2Size[2,2]											,;
										aObj2Size[2,3]											,;
										aObj2Size[2,4]											,;
										nOpcNewGd												,;
										"RdbGdLinOk"											,;
										"RdbGdTudOk"											,;
										""														,;
										aRdbGdAltera											,;
										0														,;
										999999													,;
										NIL														,;
										NIL														,;
									   	bRdbGdDelOk												,;
										oFolders:aDialogs[ 02 ]												,;//	oDlg	,;
										aRdbHeader												,;
										GdRmkaCols( aRdbHeader , .F. , .T. , .T. , NIL , .F. )	 ;
									 )
		oGdRdb:oBrowse:cToolTip := OemToAnsi( STR0031 )	//"Respostas"
	    oGdRdb:oBrowse:bGotFocus	:={||	ChangeF3()	}
	    oGdRdb:bChange				:={||	ChangeF3()	}
	    oGdRdb:oBrowse:bMoved		:={||	ChangeF3()	}
		bSvblDblClick := oGdRdb:oBrowse:blDblClick
		//-- somente permite a modificacao se for inclusao ou alteracao e a questao for dissertativa
		oGdRdb:oBrowse:blDblClick := { || Apda190EdtMem( oGdRdb , bSvblDblClick ,;
																 ( ( ( nOpc == 3 ) .or. ( nOpc == 4 ) ) .and. ;
																      RdbMemoWhen()  ;
																 ) ;
																 ) }

	ACTIVATE MSDIALOG oDlg ON INIT Eval( bDialogInit ) CENTERED

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	CursorWait()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGarante o Posicionamento do RD0							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	RD0->( MsGoto( nReg ) )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁQuando Confirmada a Opcao e Nao for Visualizacao Grava ou   ExЁ
	Ёclui as Informacoes do RD0 e RDB							   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF( nOpcAlt == 1 )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Apenas se nao For Visualizacao              				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
 		IF ( nOpc != 2 )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Gravando/Incluido ou Excluindo Informacoes do SRY/RDB        Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			MsAguarde(;
							{ ||;
									Eval( bRDBSort  ),;				//Sorteia o aRdbCols para Comparacao na Gravacao
									Apda190Grava(;
													nOpc		,;	//Opcao de Acordo com aRotina
							 						nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 						aRdbHeader	,;	//Campos do Arquivo de Sub-Itens ( RDB )
							 						aRdbCols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RDB )
							 						aSvRDBCols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RDB )
							 						aRdbVirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RDB )
							 						aRdbRecnos	,;	//Recnos do Arquivo de Sub-Itens ( RDB )
							 						aRdbMemoGd	 ;	//Campos Memo na de Sub-Itens ( RDB )
							 					);
		 					 };
						)
		EndIF
	Else
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё RollBack da Numeracao Automatica            				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			RollBackSX8()
		End While
	EndIF

End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Coloca o Ponteiro do Mouse em Estado de Espera			   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura os Dados de Entrada								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestArea( aArea )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura as Teclas de Atalho											 Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
RestKeys( aSvKeys , .T. )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁRestaura o Estado do Ponteiro do Mouse						   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( MbrChgLoop( .F. ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda190EdtMem	 ЁAutorЁEmerson Campos    Ё Data Ё07/01/2013Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁEncapsulamento da funГЦo Apd190EdtMem - Edit de Campo Memo	Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function Apd190EdtMem( oGdRdb , blDblClick , lModify , cMemoEdit )
	Apda190EdtMem( oGdRdb , blDblClick , lModify , cMemoEdit )
Return Nil

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda190EdtMem	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/10/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁEdit de Campo Memo                       					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁoGdRdb:oBrowse:blDblClick									Ё
Ё          ЁFontes APDA260 e;                                           Ё
Ё          ЁAPDA250(Encapsulamento atravИs da funГЦo:Apd190EdtMem    	Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda190EdtMem( oGdRdb , blDblClick , lModify , cMemoEdit )

/*/
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Variaveis de Inicializacao Obrigatoria					  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Local nColDesMem	:= GdFieldPos( "RDB_MEMO" , oGdRdb:aHeader )
Local nColJusMem	:= GdFieldPos( "RDB_JUSMEM" , oGdRdb:aHeader )

/*/
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Variaveis que serao inicializadas no Corpo da Funcao		  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Local aSvKeys
Local aAdvSize
Local aInfoAdvSize
Local aObjSize
Local aObjCoords
Local bSet15
Local bSet24
Local cTitCompl
Local cSvMemoEdit
Local lConfOk
Local lDesMem		:= oGdRdb:oBrowse:nColPos == nColDesMem
Local lJusMem		:= oGdRdb:oBrowse:nColPos == nColJusMem
Local oMemoEdit
Local oFont
Local oDlg

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Se a Coluna Posicionada nao for a Coluna do Memo             Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( lDesMem .Or. lJusMem )
		GdRstDblClick( oGdRdb , blDblClick )
		Break
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Obtem o Memo                               				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF Empty( cMemoEdit )
		If lDesMem
			cMemoEdit := GdFieldGet( "RDB_MEMO" , oGdRdb:oBrowse:nAt , .F. , oGdRdb:aHeader , oGdRdb:aCols )
		Else
			cMemoEdit := GdFieldGet( "RDB_JUSMEM" , oGdRdb:oBrowse:nAt , .F. , oGdRdb:aHeader , oGdRdb:aCols )
		EndIf
	EndIF
	cSvMemoEdit := cMemoEdit

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta as Dimensoes dos Objetos             				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aAdvSize		:= MsAdvSize( , .T., 300 )
	aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 5 , 5 }
	aObjCoords		:= { { 000 , 000 , .T. , .T. , .T. } }
	aObjSize := MsObjSize( aInfoAdvSize , aObjCoords )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Salva as Teclas de Atalho                  				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	aSvKeys := GetKeys()

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-O>						   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet15	:= { || RestKeys( aSvKeys , .T. ) , lConfOk := .T. , oDlg:End() }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Define o Bloco para a Tecla <CTRL-X>     	   				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	bSet24	:= { || RestKeys( aSvKeys , .T. ) , lConfOk := .F. , oDlg:End() }

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega o Complemento do Titulo          	   				   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	If lDesMem
		cTitCompl := AllTrim( oGdRdb:aHeader[ GdFieldPos( "RDB_MEMO" , oGdRdb:aHeader ) , 01 ] )
	Else
		cTitCompl := AllTrim( oGdRdb:aHeader[ GdFieldPos( "RDB_JUSMEM" , oGdRdb:aHeader ) , 01 ] )
	EndIf

	DEFINE FONT oFont NAME "Arial" SIZE 0,-15 //BOLD
	DEFINE MSDIALOG oDlg TITLE cCadastro + OemToAnsi( " - " + cTitCompl ) From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF GetWndDefault() STYLE DS_MODALFRAME STATUS PIXEL

		@ aObjSize[1,1],aObjSize[1,2] GET oMemoEdit VAR cMemoEdit MEMO SIZE aObjSize[1,3],(aObjSize[1,4]) FONT oFont OF oDlg PIXEL WHEN ( .T. )
		oMemoEdit:lReadOnly := !( lModify )
		oDlg:lEscClose := .F. //Nao permite sair ao se pressionar a tecla ESC.

	ACTIVATE MSDIALOG oDlg ON INIT EnchoiceBar( oDlg , bSet15 , bSet24 ) CENTERED
	RestKeys( aSvKeys , .T. )

	IF ( lModify )
		IF ( lConfOk )		//<CTRL-O>
			If lDesMem
				GdFieldPut( "RDB_MEMO" , cMemoEdit , oGdRdb:oBrowse:nAt , oGdRdb:aHeader , oGdRdb:aCols , .F. )
			Else
				GdFieldPut( "RDB_JUSMEM" , cMemoEdit , oGdRdb:oBrowse:nAt , oGdRdb:aHeader , oGdRdb:aCols , .F. )
			EndIf
			Private n := oGdRdb:oBrowse:nAt
			If lDesMem
				GdFieldPut( "RDB_MEMO" , cMemoEdit , oGdRdb:oBrowse:nAt , oGdRdb:aHeader , oGdRdb:aCols , .T. )
			Else
				GdFieldPut( "RDB_JUSMEM" , cMemoEdit , oGdRdb:oBrowse:nAt , oGdRdb:aHeader , oGdRdb:aCols , .T. )
			EndIf
		ElseIF !( lConfOk )	//<CTRL-X>
			IF !( cSvMemoEdit == cMemoEdit )
				//"Abandonar as altera┤■es?"
				IF !( MsgNoYes( OemToAnsi( STR0021 ) , cCadastro ) )
					Apda190EdtMem( oGdRdb , blDblClick , lModify , @cMemoEdit )
				EndIF
			EndIF
		EndIF
	EndIF

End Sequence

Return( NIL )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda190GdSeekЁAutorЁMarinaldo de Jesus    Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁEfetuar Pesquisa na GetDados                               	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080                                                		Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda190GdSeek( aGdObjects , nActFolder , aPages , aObjFolder )

Local aSvKeys 		:= GetKeys()
Local cProcName3	:= Upper( AllTrim( ProcName( 3 ) ) )
Local cProcName5	:= Upper( AllTrim( ProcName( 5 ) ) )

Local cMsgInfo
Local cTitle
Local nPosGdObj

DEFAULT aGdObjects	:= {}

Begin Sequence

	IF !( "APDA190MNT" $ ( cProcName3 + cProcName5 ) )
		Break
	EndIF

	IF (;
			Empty( aGdObjects );
			.or.;
			( ( nPosGdObj := aScan( aGdObjects[ nActFolder ] , .T. ) ) == 0 );
		)
		cMsgInfo := STR0013	//"OpГЦo disponМvel apenas para pesquisa na(s) Pasta(s):"
		cMsgInfo += CRLF
		cMsgInfo += aPages[ 02 ]
		MsgInfo( OemToAnsi( cMsgInfo ) , cCadastro )
		Break
	EndIF

	nObj := GetObjGdSeek( aGdObjects , nActFolder , aObjFolder , @cTitle )
	IF ( nObj == 0 )
		Break
	EndIF
	GdSeek( aObjFolder[ nActFolder , nObj , 01 ] , OemToAnsi( cTitle ) )

End Sequence

RestKeys( aSvKeys , .T. )

Return( NIL )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o	   ЁGetApd250ObjGdSeek  ЁAutorЁEmerson Campos  ЁData Ё11/01/2013Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁFunГЦo de encapsulamento da funГЦo GetObjGdSeek - Retorna   Ё
Ё          Ёas Opcoes para Pesquisa na GetDados                         Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNumero do Objeto para Pesquisa na GetDados                  Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso	   ЁApda250GdSeek() em APDA250()							    Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function GetApd250ObjGdSeek( aGdObjects , nActFolder , aObjFolder , cTitle )
Return GetObjGdSeek( aGdObjects , nActFolder , aObjFolder , cTitle )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o	   ЁGetObjGdSeek	ЁAutorЁMarinaldo de Jesus Ё Data Ё12/08/2004Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁRetorna as Opcoes para Pesquisa na GetDados                 Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<vide parametros formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁRetorno   ЁNumero do Objeto para Pesquisa na GetDados                  Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso	   ЁApda108GdSeek() em APDA080()							    Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function GetObjGdSeek( aGdObjects , nActFolder , aObjFolder , cTitle )

Local aSvKeys		:= GetKeys()
Local aItens		:= {}
Local aObjs			:= {}
Local bSet15		:= { || lOpcOk	:= .T.	, RestKeys( aSvKeys , .T. ) , oDlg:End() }
Local bSet24		:= { || nOpcRel	:= 0	, RestKeys( aSvKeys , .T. ) , oDlg:End() }
Local lOpcOk		:= .F.
Local nOpjGdSeek	:= 1

Local aAdvSize		:= {}
Local aInfoAdvSize	:= {}
Local aObjSize		:= {}
Local aObjCoords	:= {}

Local aAdv1Size		:= {}
Local aInfo1AdvSize	:= {}
Local aObj1Size		:= {}
Local aObj1Coords	:= {}


Local nLoop
Local nLoops
Local oRadio
Local oDlg
Local oGroup
Local oFont
Local nTam

Begin Sequence

	DEFAULT cTitle := STR0001 + " "	//Pesquisar
	nLoops := Len( aObjFolder[ nActFolder ] )
	For nLoop := 1 To nLoops
		IF aGdObjects[ nActFolder , nLoop ]
			aAdd( aObjs , nLoop )
			aAdd( aItens , aObjFolder[ nActFolder , nLoop , 1 ]:oBrowse:cToolTip )
		EndIF
	Next nLoop

	/*
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Monta as Dimensoes dos Objetos         					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
	//As formulas a seguir para contemplar n. de itens variaveis
	nTam:= len(aItens)
    aAdvSize		:= MsAdvSize(,.T.,250)
  	aAdvSize[4]		:= (aAdvSize[4]*0.7) + (nTam*4)
	aAdvSize[6]		:= (aAdvSize[6]*0.85) + (nTam*6)
	aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 5 , 5 }
	aAdd( aObjCoords , { 000 , 000 , .T. , .T. } )
	aObjSize	:= MsObjSize( aInfoAdvSize , aObjCoords )

	aAdv1Size		:= aClone(aObjSize[1])
	aInfo1AdvSize	:= { aAdv1Size[2] , aAdv1Size[1] , aAdv1Size[4] , aAdv1Size[3] , 15 , 1 }
	aAdd( aObj1Coords , { 000 , 000 , .T. , .T. } )
	aAdd( aObj1Coords , { 000 , nTam*8 , .T. , .F. } )
	aAdd( aObj1Coords , { 000 , 000 , .T. , .T. } )
	aObj1Size	:= MsObjSize( aInfo1AdvSize , aObj1Coords )

	DEFINE FONT oFont NAME "Arial" SIZE 0,-11 BOLD
	DEFINE MSDIALOG oDlg TITLE TITLE OemToAnsi( STR0001 ) From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF GetWndDefault() PIXEL

		@ aObjSize[1,1] , aObjSize[1,2]	GROUP oGroup TO aObjSize[1,3] , aObjSize[1,4]  LABEL OemToAnsi(STR0015) OF oDlg PIXEL //"Selecione o Objeto da Pesquisa"
		oGroup:oFont:=oFont

 		oRadio 			:= TRadMenu():New( aObj1Size[2,1] , aObj1Size[2,2] , aItens , NIL , oDlg , NIL , NIL , NIL , NIL , NIL , NIL , NIL , 115 , 010)
		oRadio:bSetGet	:= { |nItem| IF( nItem <> NIL , nOpjGdSeek := nItem , nOpjGdSeek ) }
		oDlg:lEscClose	:= .F. //Nao permite sair ao se pressionar a tecla ESC.

	ACTIVATE MSDIALOG oDlg CENTERED ON INIT EnchoiceBar( oDlg , bSet15 , bSet24 )
	RestKeys( aSvKeys , .T. )

	IF !( lOpcOk )
		nOpjGdSeek := 0
	Else
		cTitle 		+= aItens[ nOpjGdSeek ]
		nOpjGdSeek  := aObjs[ nOpjGdSeek ]
	EndIF

End Sequence

Return( nOpjGdSeek )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd6GotFocus	 	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁGotFocus para os Objetos GetDados do RD6					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Rd6GotFocus( oGdRd6 )

IF Empty( __nRdbRd6AtAnt )
	__nRdbRd6AtAnt := oGdRd6:oBrowse:nAt
EndIF

IF Empty( __nRddRd6AtAnt )
	__nRddRd6AtAnt := oGdRd6:oBrowse:nAt
EndIF

IF Empty( __nRd7Rd6AtAnt )
	__nRd7Rd6AtAnt := oGdRd6:oBrowse:nAt
EndIF

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRd62RDBChg	 	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁChange da GetDados Avaliados/Rede no Folder Avaliadores  	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Rd62RDBChg( oGdRd6 , oGdRdb , aRdbCols , lColsToAll )

Local aRdbCposPes
Local aRdbCposSrt

Local bColsToAll

Local nRd6SvAt

DEFAULT lColsToAll	:= .F.

Begin Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDB" )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁVerifica se Deve Transferir para do aCols para o aColsAll     Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF (;
			(;
				( Inclui );
				.or.;
				( Altera );
			);
		)

		nRd6SvAt	:= oGdRd6:oBrowse:nAt

		IF (;
				!Empty( __nRdbRd6AtAnt );
				.and.;
				( __nRdbRd6AtAnt <> nRd6SvAt );
			)

			oGdRd6:Goto( __nRdbRd6AtAnt )

			IF !( oGdRdb:TudoOk() )
				oGdRdb:oBrowse:SetFocus()
				oGdRd6:Refresh()
				Break
			EndIF

			lColsToAll	:= .T.

		EndIF

		IF ( lColsToAll )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			ЁObtem as Informacoes para o GdColsExChange para o RDB         Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			RDBInfTrf(	oGdRd6			,;
						oGdRdb			,;
						@aRdbCposPes	,;
						@aRdbCposSrt	,;
						@bColsToAll		 ;
				  )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			ЁTransfiro os Dados do aCols para o aColsAll				   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			GdColsExChange(	@aRdbCols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
							@oGdRdb:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
							oGdRdb:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
							NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
							NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
							aRdbCposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
							aRdbCposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
							NIL				,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
							.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
							.T.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
							.F.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
							.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
							.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
							bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
						 )

		EndIF

		IF ( __nRdbRd6AtAnt <> nRd6SvAt )

			oGdRd6:Goto( nRd6SvAt )

			__nRdbRd6AtAnt := nRd6SvAt

		EndIF

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem as Informacoes para o GdColsExChange para o RDB         Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDBInfTrf(	oGdRd6			,;
					oGdRdb			,;
					@aRdbCposPes	,;
					@aRdbCposSrt	,;
					@bColsToAll		 ;
			 	 )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁTransfiro os Dados do aColsAll para o aCols				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdColsExChange(	@aRdbCols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
						@oGdRdb:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
						oGdRdb:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
						NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
						NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
						aRdbCposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
						aRdbCposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
						NIL				,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
						.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
						.F.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
						.T.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
						.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
						.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
						bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
					 )

	Else

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁObtem as Informacoes para o GdColsExChange para o RDB         Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		RDBInfTrf(	oGdRd6			,;
					oGdRdb			,;
					@aRdbCposPes	,;
					@aRdbCposSrt	,;
					@bColsToAll		 ;
			 	 )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁTransfiro os Dados do aColsAll para o aCols				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdColsExChange(	@aRdbCols		,;	//01 -> Array com a Estrutura do aCols Contendo todos os Dados
						@oGdRdb:aCols 	,;	//02 -> Array com a Estrutura do aCols Contendo Dados Especificos
						oGdRdb:aHeader	,;	//03 -> Array com a Estrutura do aHeader Contendo Informacoes dos Campos
						NIL				,;	//04 -> Array com as Posicoes dos Campos para Pesquisa
						NIL				,;	//05 -> Chave para Busca no aColsAll para Carga do aCols
						aRdbCposSrt		,;	//06 -> Array com as Posicoes dos Campos para Ordenacao
						aRdbCposPes		,;	//07 -> Array com as Posicoes dos Campos e Chaves para Pesquisa
						oGdRdb:aHeader	,;	//08 -> Array com a Estrutura do aHeaderAll Contendo Informacoes dos Campos
						.T.				,;	//09 -> Conteudo do Elemento "Deleted" a ser Carregado na Remontagem dos aCols
						.F.				,;	//10 -> Se deve Transferir do aCols para o aColsAll
						.T.				,;	//11 -> Se deve Transferir do aColsAll para o aCols
						.T.				,;	//12 -> Se Existe o Elemento de Delecao no aCols
						.T.				,;	//13 -> Se deve Carregar os Inicializadores padroes
						bColsToAll		 ;	//14 -> Condicao para a Transferencia do aCols para o aColsAll
					 )
	EndIF

	oGdRdb:Goto( 1 )
	oGdRdb:Refresh()

End Sequence

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbInfTrf		 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁMonta as informacoes que serao utilizadas para a  transferenЁ
Ё          Ёcia de informacoes no GdColsExChange do RDB                 Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080()													Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function RdbInfTrf(	oGdRd6		,;
							oGdRdb		,;
							aRdbCposPes	,;
							aRdbCposSrt	,;
							bColsToAll	 ;
				  		)

Local cRd0Codigo		:= GetMemVar( "RD0_CODIGO" )
Local cRd6Codigo		:= GdFieldGet( "RD6_CODIGO" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Local cRd6CodCom		:= GdFieldGet( "RD6_CODCOM" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )

Local nRdbCodAva		:= GdFieldPos( "RDB_CODAVA"	, oGdRdb:aHeader )
Local nRdbCodAdo		:= GdFieldPos( "RDB_CODADO"	, oGdRdb:aHeader )
Local nRdbTipoAv		:= GdFieldPos( "RDB_TIPOAV"	, oGdRdb:aHeader )
Local nRdbDtiAva		:= GdFieldPos( "RDB_DTIAVA"	, oGdRdb:aHeader )
Local nRdbDtfAva		:= GdFieldPos( "RDB_DTFAVA"	, oGdRdb:aHeader )
Local nRdbCodMod		:= GdFieldPos( "RDB_CODMOD"	, oGdRdb:aHeader )
Local nRdbCodCom		:= GdFieldPos( "RDB_CODCOM"	, oGdRdb:aHeader )
Local nRdbIteCom		:= GdFieldPos( "RDB_ITECOM"	, oGdRdb:aHeader )
Local nRdbCodTip		:= GdFieldPos( "RDB_CODTIP"	, oGdRdb:aHeader )
Local nRdbCodNet		:= GdFieldPos( "RDB_CODNET"	, oGdRdb:aHeader )
Local nRdbCodQue		:= GdFieldPos( "RDB_CODQUE"	, oGdRdb:aHeader )
Local nRdbId			:= GdFieldPos( "RDB_ID"		, oGdRdb:aHeader )
Local nRdbGhostCol		:= GdFieldPos( "GHOSTCOL"	, oGdRdb:aHeader )

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCarrega Array a Posicao dos Campos para o "Sort"			  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
aRdbCposSrt := {}
aAdd( aRdbCposSrt	, nRdbCodAva 	)
aAdd( aRdbCposSrt	, nRdbCodAdo 	)
aAdd( aRdbCposSrt	, nRdbCodCom 	)
IF ( nRdbGhostCol > 0 )
	aAdd( aRdbCposSrt	, nRdbGhostCol	)
EndIF

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁCarrega Array com a Posicao dos Campos e as Chaves  CorresponЁ
Ёdentes														  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
aRdbCposPes := {}
aAdd( aRdbCposPes  	, { nRdbCodAva	, cRd6Codigo } )
aAdd( aRdbCposPes  	, { nRdbCodAdo	, cRd0Codigo } )
aAdd( aRdbCposPes  	, { nRdbCodCom	, cRd6CodCom } )

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁDefine os Blocos para Validacao da Transferencia do aCols  paЁ
Ёra o aColsAll												  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
bColsToAll	:= bColsToAll	:= { | aCols , aHeader , nItem |;
												!Empty( aCols[ nItem , nRdbCodAva ] );
												.and.;
												!Empty( aCols[ nItem , nRdbCodAdo ] );
												.and.;
												!Empty( aCols[ nItem , nRdbTipoAv ] );
												.and.;
												!Empty( aCols[ nItem , nRdbDtiAva ] );
												.and.;
												!Empty( aCols[ nItem , nRdbDtfAva ] );
												.and.;
												!Empty( aCols[ nItem , nRdbCodMod ] );
												.and.;
												!Empty( aCols[ nItem , nRdbCodCom ] );
												.and.;
												!Empty( aCols[ nItem , nRdbIteCom ] );
												.and.;
												!Empty( aCols[ nItem , nRdbCodTip ] );
												.and.;
												!Empty( aCols[ nItem , nRdbCodNet ] );
												.and.;
												!Empty( aCols[ nItem , nRdbCodQue ] );
												.and.;
												!Empty( aCols[ nItem , nRdbId ] );
				}

Return( NIL )

/*/
зддддддддддбддддддддддддбдддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbGdLinOk	ЁAutorЁMarinaldo de Jesus     Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддддадддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁLinha Ok do RDB                                             Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRdbGdLinOk( oBrowse )									    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda190()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbGdLinOk( oBrowse )

Local lLinOk		:= .T.

Local aCposKey

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	Begin Sequence

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Se a Linha da GetDados Nao Estiver Deletada				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		IF !( GdDeleted() )

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Verifica Itens Duplicados na GetDados						   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			aCposKey := GetArrUniqe( "RDB" )
			IF Empty( aCposKey )
				aAdd( aCposKey , "RDB_FILIAL" )
				aAdd( aCposKey , "RDB_CODAVA" )
				aAdd( aCposKey , "RDB_CODADO" )
				aAdd( aCposKey , "RDB_CODPRO" )
				aAdd( aCposKey , "RDB_CODDOR" )
				aAdd( aCposKey , "RDB_DTIAVA" )
				aAdd( aCposKey , "RDB_CODCOM" )
				aAdd( aCposKey , "RDB_ITECOM" )
				aAdd( aCposKey , "RDB_CODNET" )
				aAdd( aCposKey , "RDB_CODQUE" )
				aAdd( aCposKey , "RDB_TIPOAV" )
			EndIF
			IF !( lLinOk := GdCheckKey( aCposKey , 4 ) )
				Break
			EndIF

			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Verifica Se o Campos Estao Devidamente Preenchidos		   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			aCposKey := GdObrigat( aHeader )
			IF !( lLinOk := GdNoEmpty( aCposKey ) )
		    	Break
			EndIF

		EndIF

	End Sequence

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁSe Houver Alguma Inconsistencia na GetDados, Seta-lhe o Foco  Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF !( lLinOk )
		IF ( ValType( "oBrowse" ) == "O" )
			oBrowse:SetFocus()
		EndIF
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	ЁGaranto que o Ponteiro Estara no Final do Arquivo para que naoЁ
	ЁCarregue Conteudo Invalido nos Inicializadores Padroes        Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	PutFileInEof( "RDB" )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( lLinOk )

/*/
зддддддддддбддддддддддддбдддддбдддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbGdTudOk	ЁAutorЁMarinaldo de Jesus     Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддддадддддадддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁTudo Ok do RDB                                              Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRdbGdTudOk( oBrowse )									    Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda190()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbGdTudOk( oBrowse )

Local lTudoOk := .T.

Local nLoop

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	Begin Sequence

	    /*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Percorre Todas as Linhas para verificar se Esta Tudo OK      Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		For nLoop := 1 To Len( aCols )
			n := nLoop
			IF !( lTudoOk := RdbGdLinOk( oBrowse ) )
				IF ( ValType( "oBrowse" ) == "O" )
					oBrowse:Refresh()
				EndIF
				Break
			EndIF
		Next nLoop

	End Sequence

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( lTudoOk  )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbGdDelOk   ЁAutorЁMarinaldo de Jesus    Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar a Delecao na GetDados RDB                           Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   ЁRdbGdDelOk( nOpc , oGdRd6 )									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ 															Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda190()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbGdDelOk( nOpc )

Local lDelOk 		:= .T.
Local lStatusDel	:= .F.

Local nRdbCodAva		:= GdFieldPos( "RDB_CODAVA"	, oGdRdb:aHeader )
Local nRdbCodAdo		:= GdFieldPos( "RDB_CODADO"	, oGdRdb:aHeader )
Local nRdbTipoAv		:= GdFieldPos( "RDB_TIPOAV"	, oGdRdb:aHeader )
Local nRdbDtiAva		:= GdFieldPos( "RDB_DTIAVA"	, oGdRdb:aHeader )
Local nRdbDtfAva		:= GdFieldPos( "RDB_DTFAVA"	, oGdRdb:aHeader )
Local nRdbCodMod		:= GdFieldPos( "RDB_CODMOD"	, oGdRdb:aHeader )
Local nRdbCodCom		:= GdFieldPos( "RDB_CODCOM"	, oGdRdb:aHeader )
Local nRdbIteCom		:= GdFieldPos( "RDB_ITECOM"	, oGdRdb:aHeader )
Local nRdbCodTip		:= GdFieldPos( "RDB_CODTIP"	, oGdRdb:aHeader )
Local nRdbCodNet		:= GdFieldPos( "RDB_CODNET"	, oGdRdb:aHeader )
Local nRdbCodQue		:= GdFieldPos( "RDB_CODQUE"	, oGdRdb:aHeader )
Local nRdbId			:= GdFieldPos( "RDB_ID"		, oGdRdb:aHeader )



Static lFirstDelOk
Static lLstDelOk

DEFAULT lFirstDelOk	:= .T.
DEFAULT lLstDelOk	:= .T.

Begin Sequence

	//Quando for Visualizacao ou Exclusao Abandona
	IF (;
			( nOpc == 2 ) .or. ;	//Visualizacao
			( nOpc == 5 );			//Exclusao
		)
		Break
	EndIF

	//-- Somente avaliacoes abertas poderЦo ser eliminadas
	IF (oGdRd6:aCols[oGdRd6:oBrowse:nAt,GdFieldPos( "RD6_STATUS"	, oGdRd6:aHeader )]  == "2" )
  	   lDelOk 		:= .F.
	   Break
	Endif

	//Apenas se for a primeira vez
	IF !( lFirstDelOk )
		lFirstDelOk	:= .T.
		Break
	EndIF



 	lStatusDel	:= !( GdDeleted() ) //Inverte o Estado
    //-- Esse grupo de campos esta baseado na chave unica
	aRdbColPos	:= {;
					 {;
					  GdFieldPos( "RDB_CODAVA" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODADO" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODPRO" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODDOR" , aRdbHeader ),;
				      GdFieldPos( "RDB_DTIAVA" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODCOM" , aRdbHeader ),;
					  GdFieldPos( "RDB_ITECOM" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODNET" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODQUE" , aRdbHeader ),;
					  GdFieldPos( "RDB_TIPOAV" , aRdbHeader ),;
					  GdFieldPos( "RDB_CODALT" , aRdbHeader ),;
					  GdFieldPos( "RDB_ESCALA" , aRdbHeader ),;
					  GdFieldPos( "RDB_ITEESC" , aRdbHeader ),;
					  GdFieldPos( "RDB_ID" 	   , aRdbHeader );
					 },;
					 {;
					  GdFieldPos( "RDB_CODAVA" ),;
					  GdFieldPos( "RDB_CODADO" ),;
					  GdFieldPos( "RDB_CODPRO" ),;
					  GdFieldPos( "RDB_CODDOR" ),;
				      GdFieldPos( "RDB_DTIAVA" ),;
					  GdFieldGet( "RDB_CODCOM" ),;
					  GdFieldGet( "RDB_ITECOM" ),;
					  GdFieldGet( "RDB_CODNET" ),;
					  GdFieldGet( "RDB_CODQUE" ),;
					  GdFieldGet( "RDB_TIPOAV" ),;
					  GdFieldGet( "RDB_CODALT" ),;
					  GdFieldGet( "RDB_ESCALA" ),;
					  GdFieldGet( "RDB_ITEESC" ),;
					  GdFieldGet( "RDB_ID" 	    );
					 },;
					   GdFieldPos( "GDDELETED" , aRdbHeader );
					}

	IF ( lStatusDel )	//Deletar
   		lDelOk	  := .T.
   		lLstDelOk := lDelOk
		//Ja Passou pela funcao
		lFirstDelOk := .F.

		GdDelItens(@aCols 			, aRdbColPos )

 		Break
	Else				//Restaurar
    	lDelOk := .T.
    	lLstDelOk := lDelOk
		//Ja Passou pela funcao
		lFirstDelOk := .F.

        aCols[n,GdFieldPos( "GDDELETED" , aRdbHeader )]:=.F.


		nRdbCodAdo  := GdFieldPos( "RDB_CODADO" , aRdbHeader )


		bGdRstOk		:= { | aColsnLin , nLin | ;
													!Empty( aColsnLin[ nRdbCodAva ] );
													.and.;
													!Empty( aColsnLin[ nRdbCodAdo ] );
													.and.;
													!Empty( aColsnLin[ nRdbTipoAv ] );
													.and.;
													!Empty( aColsnLin[ nRdbDtiAva ] );
													.and.;
													!Empty( aColsnLin[ nRdbDtfAva ] );
													.and.;
													!Empty( aColsnLin[ nRdbCodMod ] );
													.and.;
													!Empty( aColsnLin[ nRdbCodCom ] );
													.and.;
													!Empty( aColsnLin[ nRdbIteCom ] );
													.and.;
													!Empty( aColsnLin[ nRdbCodTip ] );
													.and.;
													!Empty( aColsnLin[ nRdbCodNet ] );
													.and.;
													!Empty( aColsnLin[ nRdbCodQue ] );
													.and.;
													!Empty( aColsnLin[ nRdbId ] );
							}


		GdRstItens(aCols, aRdbColPos , bGdRstOk )

   		Break
	EndIF

	//Ja Passou pela funcao
	lFirstDelOk := .F.

End Sequence
oGdRdb:Refresh()
Return( lDelOk )

/*/
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbNumGhostCol	ЁAutorЁMarinaldo de Jesus Ё Data Ё14/08/2004Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁFuncao de Inicializacao da Numeracao Automatica do GHOSTCOL Ё
Ё          Ёdo RDB														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA080  	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbNumGhostCol()

Local cNumGhostCol	:= ""
Local laRdBCols 	:=  ( Type( "aRdbCols" ) == "A" )

IF (;
		( Type( "aRdbHeader" ) == "A" );
		.and.;
		( laRdBCols .or. Type( "aCols" ) == "A" );
		.and.;
		( GdFieldPos( "GHOSTCOL" , aRdbHeader ) > 0 );
	)
	IF ( Type( "cRDBNumGhostCol" ) == "U" )
		Private cRDBNumGhostCol := ""
	EndIF
	cNumGhostCol	:= GdNumItem( "GHOSTCOL" , @cRDBNumGhostCol , NIL , aRdbHeader , If(laRdBCols, aRdbCols,aCols) )
EndIF

Return( cNumGhostCol )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁApda190Grava ЁAutorЁMarinaldo de Jesus    Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o Ё                                                            Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁApda190()	                                                Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function Apda190Grava(	nOpc		,;	//Opcao de Acordo com aRotina
							 	nReg		,;	//Numero do Registro do Arquivo Pai ( RD0 )
							 	aRdbHeader	,;	//Campos do Arquivo de Sub-Itens ( RDB )
							 	aRdbCols	,;	//Sub-Itens Atuis do Arquivo de Sub-Itens ( RDB )
							 	aSvRDBCols	,;	//Sub-Itens Anteriores do Arquivo de Sub-Itens ( RDB )
							 	aRdbVirtGd	,;	//Campos Virtuais do Arquivo de Sub-Itens ( RDB )
							 	aRdbRecnos	,;	//Recnos do Arquivo de Sub-Itens ( RDB )
							 	aRdbMemoGd	 ;	//Campos Memo na de Sub-Itens ( RDB )
							  )

/*/
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Variaveis de Inicializacao Obrigatoria					  Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Local aMestre	:= GdPutIStrMestre( 01 )
Local aItens	:= {}
Local cOpcao	:= IF( ( nOpc == 5 ) , "DELETE" , IF( ( ( nOpc == 3 ) .or. ( nOpc == 4 ) ) , "PUT" , NIL ) )
Local lModItens	:= .F.
Local lRDBModif	:= .F.
Local lRDBDelet	:= .F.
Local lSuperDel	:= .T.
//Local nPosRec	:= Ascan(aRdbHeader,{ |x| x[2] = "RDB_REC_WT"})

Local aRdbColDel
Local aRdbRecDel
Local nItens

//Certifica-se que o array estarА ordenado pelo Recno
//aSort( aRdbCols , NIL , NIL , { |x,y| ( x[nPosRec] < y[ nPosRec] ) } )

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Altera o Estado do Cursor  								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()

	IF ( cOpcao == "DELETE" )
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁSimulo aqui uma Alteracao onde Todos os Itens Foram Deletados Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		cOpcao 		:= "PUT"
		lSuperDel	:= .F.
		GdSuperDel( aRdbHeader , @aRdbCols , NIL , .T. )
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Verifica se Houveram Modificacoes no RDB					   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( lRDBModif := !ArrayCompare( aRdbCols , aSvRDBCols ) )
		IF ( lSuperDel )
			/*/
			здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			Ё Deleto todos os Itens que nao Estao OK					   Ё
			юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
			GdSuperDel( aRdbHeader , @aRdbCols , NIL , .T. , GdGetBlock( "RDB" , aRdbHeader , .F. ) )
		EndIF
		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Separa os Itens que foram Deletados     					   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		lRDBDelet := GdSplitDel( aRdbHeader , @aRdbCols , @aRdbRecnos , @aRdbColDel , @aRdbRecDel  )
	EndIF

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Verifica se eh Delecao ou se Houveram Modificacoes       	   Ё
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	lModItens := ( lRDBModif )

	/*/
	здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	Ё Carrega os Itens Apenas se Houveram Alteracoes ou na ExclusaoЁ
	юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
	IF ( lModItens )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega as Informacoes deletadas RDB                   	   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		IF ( lRDBDelet )

			aAdd( aItens , GdPutIStrItens() )
			nItens := Len( aItens )

			aItens[ nItens , 01 ] := "RDB"
			aItens[ nItens , 02 ] := NIL
			aItens[ nItens , 03 ] := aClone( aRdbHeader )
			aItens[ nItens , 04 ] := aClone( aRdbColDel )
			aItens[ nItens , 05 ] := aClone( aRdbVirtGd )
			aItens[ nItens , 06 ] := aClone( aRdbRecDel )
			aItens[ nItens , 07 ] := aClone( aRdbMemoGd )
			aItens[ nItens , 08 ] := NIL
			aItens[ nItens , 09 ] := NIL
			aItens[ nItens , 10 ] := "RDY"

		EndIF

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Carrega as Informacoes do RDB                   			   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		aAdd( aItens , GdPutIStrItens() )
		nItens := Len( aItens )

		aItens[ nItens , 01 ] := "RDB"
		aItens[ nItens , 02 ] := {;
									{ "FILIAL" , xFilial( "RDB" , RD6->RD6_FILIAL ) },;
									{ "CODPAR" , GetMemVar( "RD0_CODIGO" ) };
					 		 	 }
		aItens[ nItens , 03 ] := aClone( aRdbHeader )
		aItens[ nItens , 04 ] := aClone( aRdbCols   )
		aItens[ nItens , 05 ] := aClone( aRdbVirtGd )
		aItens[ nItens , 06 ] := aClone( aRdbRecnos )
		aItens[ nItens , 07 ] := aClone( aRdbMemoGd )
		aItens[ nItens , 08 ] := NIL
		aItens[ nItens , 09 ] := NIL
		aItens[ nItens , 10 ] := "RDY"

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Define as Informacoes para o Arquivo Mestre RD0			   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		aMestre[ 01 , 01 ]	:= "RD0"
		aMestre[ 01 , 02 ]	:= nReg
		aMestre[ 01 , 03 ]	:= .F.
		aMestre[ 01 , 04 ]	:= {}
		aMestre[ 01 , 05 ]	:= {}
		aMestre[ 01 , 06 ]	:= {}
		aMestre[ 01 , 07 ]	:= aClone( aItens )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Grava as Informacoes                        				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		GdPutInfoData( aMestre , cOpcao , .T. , .F.  )

		/*/
		здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		Ё Confirmando a Numeracao Automatica          				   Ё
		юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
		While ( GetSX8Len() > nGetSX8Len )
			ConfirmSX8()
		End While

	EndIF

/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Restaura o Estado do Cursor								   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorArrow()

Return( NIL )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAvaVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_CODAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAvaVld()

Local lRdbCodAvaOk := .T.

Begin Sequence

	IF !( lRdbCodAvaOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbCodAvaOk := ExistCpo( "RD6" ) )
		Break
	EndIF

End Sequence

Return( lRdbCodAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAvaInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODAVA					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAvaInit()

Local cRdbCodAvaInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODIGO" , oGdRd6:aHeader ) > 0 );
	)
	cRdbCodAvaInit := GdFieldGet( "RD6_CODIGO" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRdbCodAvaInit := Space( GetSx3Cache( "RDB_CODAVA" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDB_CODAVA" , cRdbCodAvaInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAdoVld 	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODADO									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_CODADO									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAdoVld()

Local lRdbCodAdoOk	:= .T.

	IF !( lRdbCodAdoOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbCodAdoOk := ExistCpo( "RD0" ) )
		Break
	EndIF

Return( lRdbCodAdoOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAdoInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODADO					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODADO								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAdoInit()
Return( GetMemVar( "RD0_CODIGO" ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodProVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid para o Campo RDB_CODPRO            					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_CODPRO   								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodProVld()

Local lRdbCodProOk := .T.

Begin Sequence

	IF ( Vazio() )
		Break
	EndIF

	IF !( lRdbCodProOk := ExistCpo( "RDN" ) )
		Break
	EndIF

End Sequence

Return( lRdbCodProOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodProInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializador padrao para o campo RDB_CODPRO				Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO DO campo RDB_CODPRO   							Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodProInit()

Local cRdbCodProIni

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODPRO" , oGdRd6:aHeader ) > 0 );
	)
	cRdbCodProIni := GdFieldGet( "RD6_CODPRO" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRdbCodProIni := Space( GetSx3Cache( "RDB_CODPRO" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDB_CODPRO" , cRdbCodProIni ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodDorVld     ЁAutorЁMarinaldo de JesusЁ Data Ё21/11/2002Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODDOR									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_CODDOR									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodDorVld()

Local lRdbCodDorOk  := .T.
Local cFunName      := FunName()
Local cCodAva       := cCodAdo       := ""

Begin Sequence

	IF !( lRdbCodDorOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbCodDorOk := ExistCpo( "RD0" ) )
		Break
	EndIF

	IF ( cFunName $ "APDA250|APDA260" .And. ValType(oGdRdb) <> "U" )
		nGdAt := oGdRDB:nAt
		nPosAva   := GdFieldPos("RDB_CODAVA",oGdRdb:aHeader)
		nPosAdo   := GdFieldPos("RDB_CODADO",oGdRdb:aHeader)

		cCodAva	:= oGdRdb:aCols[nGdAt][nPosAva]
		cCodAdo	:= oGdRdb:aCols[nGdAt][nPosAdo]

		If !( lRdbCodDorOk := aScan( fAprovador(cCodAva, cCodAdo), M->RDB_CODDOR) > 0 )
			Break
		EndIf
	EndIf

End Sequence

Return( lRdbCodDorOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodDorInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODDOR					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODDOR								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodDorInit()
Return( SetMemVar( "RDB_CODDOR" , Space( GetSx3Cache( "RDB_CODDOR" , "X3_TAMANHO" ) ) ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbDtiAvaVld     ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_DTIAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_DTIAVA									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbDtiAvaVld()

Local lRdbDtiAvaOk := .T.

Begin Sequence

	IF !( lRdbDtiAvaOk := NaoVazio() )
		Break
	EndIF

End Sequence

Return( lRdbDtiAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbDtiAvaInit    ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInit do Campo RDB_DTIAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do Campo RDB_DTIAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbDtiAvaInit()

Local dRdbDtiAvaInit := Ctod( "//" )
Return( dRdbDtiAvaInit )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbDtfAvaVld     ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_DTFAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_DTFAVA									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbDtfAvaVld()

Local lRdbDtfAvaOk := .T.

Begin Sequence

	IF !( lRdbDtfAvaOk := NaoVazio() )
		Break
	EndIF

End Sequence

Return( lRdbDtfAvaOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbDtfAvaInit    ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInit do Campo RDB_DTFAVA									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do Campo RDB_DTFAVA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbDtfAvaInit()

Local dRdbDtfAvaInit := Ctod( "//" )

Return( dRdbDtfAvaInit )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodModVld     ЁAutorЁMarinaldo de JesusЁ Data Ё21/11/2002Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODMOD									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_CODMOD									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodModVld()

Local lRdbCodModOk := .T.

Begin Sequence

	IF !( lRdbCodModOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbCodModOk := ExistCpo( "RD3" ) )
		Break
	EndIF

End Sequence

Return( lRdbCodModOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodModInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODMOD					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODMOD								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodModInit()

Local cRdbCodModInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODMOD" , oGdRd6:aHeader ) > 0 );
	)
	cRdbCodModInit := GdFieldGet( "RD6_CODMOD" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRdbCodModInit := Space( GetSx3Cache( "RDB_CODMOD" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDB_CODMOD" , cRdbCodModInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodComVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDB_CODCOM									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_CODCOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodComVld()

Local lRDBCodComOk := .T.

Begin Sequence
	IF !( lRdbCodComOk := NaoVazio() )
		Break
	EndIF
	IF !( lRdbCodComOk := ExistCpo( "RDM" ) )
		Break
	EndIF
End Sequence

Return( lRdbCodComOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodComInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODCOM					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODCOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodComInit()

Local cRdbCodComInit

IF (;
		( Type( "oGdRd6" ) == "O" );
		.and.;
		( GdFieldPos( "RD6_CODCOM" , oGdRd6:aHeader ) > 0 );
	)
	cRdbCodComInit := GdFieldGet( "RD6_CODCOM" , oGdRd6:oBrowse:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Else
	cRdbCodComInit := Space( GetSx3Cache( "RDB_CODCOM" , "X3_TAMANHO" ) )
EndIF

Return( SetMemVar( "RDB_CODCOM" , cRdbCodComInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbIteComVld     ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODCOM									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_CODCOM									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbIteComVld()

Local lRdbIteComOk := .T.

Begin Sequence

	IF !( lRdbIteComOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbIteComOk := ExistCpo( "RD2" , ( GetMemVar( "RDB_CODCOM" ) + GetMemVar( "RDB_ITECOM" ) ) ) )
		Break
	EndIF

End Sequence

Return( lRdbIteComOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbIteComInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_ITECOM					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_ITECOM								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbIteComInit()
Return( SetMemVar( "RDB_ITECOM" , Space( GetSx3Cache( "RDB_ITECOM" , "X3_TAMANHO" ) ) ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodTipVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDB_CODTIP									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_CODTIP								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodTipVld()

Local lRdbCodTipOk := .T.

Begin Sequence

	IF !( lRdbCodTipOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbCodTipOk := ExistCpo( "RD5" ) )
		Break
	EndIF

End Sequence

Return( lRdbCodTipOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodTipInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODTIP					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODTIP								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodTipInit()
Return( GetMemVar( "RD6_CODTIP" ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodNetVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDB_CODNET									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_CODNET								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodNetVld()

Local lRdbCodNetOk := .T.

Begin Sequence

	IF !( lRdbCodNetOk := NaoVazio() )
		Break
	EndIF


	If Type("aHeader") <> "A" .and. Type("oGdRdb:aHeader") = "A"
	   Private aCols 	:= aClone(oGdRdb:aCols)
	   Private aHeader 	:= aClone(oGdRdb:aHeader)
	   Private n 		:= oGdRdb:oBrowse:nAt
	Endif

	IF ( IsInGetDados( { "RDB_CODTIP" } ) )
		cRdbCodTip := GdFieldGet( "RDB_CODTIP" )
	Else
		cRdbCodTip := GetMemVar( "RDB_CODTIP" )
	EndIF
	cRdbCodNet := GetMemVar( ReadVar() )

	nRdhOrder := RetOrdem( "RDH" , "RDH_FILIAL+RDH_CODTIP+RDH_CODNET" )
	IF !( lRdbCodNetOk := ExistCpo( "RDH" , cRdbCodTip + cRdbCodNet , nRdhOrder ) )
		Break
	EndIF

End Sequence

Return( lRdbCodNetOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodNetInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODNET					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODNET								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodNetInit()

Local cRdbCodNetInit := Space( GetSx3Cache( "RDB_CODNET" , "X3_TAMANHO" ) )

Return( SetMemVar( "RDB_CODNET" , cRdbCodNetInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbResObtVld	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValidar o Campo RDB_RESOBT									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_RESOBT								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbResObtVld()

Local lRdbResObtOk := .T.

Begin Sequence


	IF !( lRdbResObtOk := Positivo() )
		Break
	EndIF

End Sequence

Return( lRdbResObtOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbResObtInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_RESOBT					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_RESOBT								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbResObtInit()

Local nRdbResObtInit := GetValType( GetSx3Cache( "RDB_RESOBT" , "X3_TIPO" ) )

Return( SetMemVar( "RDB_RESOBT" , nRdbResObtInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodQueVld     ЁAutorЁMarinaldo de JesusЁ Data Ё21/11/2002Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODQUE									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_CODQUE									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodQueVld()

Local lRdbCodQueOk := .T.

Begin Sequence

	IF !( lRdbCodQueOk := NaoVazio() )
		Break
	EndIF

	IF !( lRdbCodQueOk := ExistCpo( "SQO" ) )
		Break
	EndIF

End Sequence

Return( lRdbCodQueOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodQueInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODQUE					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODQUE								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodQueInit()

Local cRdbCodQueInit := Space( GetSx3Cache( "RDB_CODQUE" , "X3_TAMANHO" ) )

Return( SetMemVar( "RDB_CODQUE" , cRdbCodQueInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAltVld     ЁAutorЁMarinaldo de JesusЁ Data Ё21/11/2002Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_CODALT									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_CODALT									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAltVld()

Local lRdbCodAltOk := .T.
Local cEscala		:= ""

Begin Sequence

	IF !( lRdbCodAltOk := NaoVazio() )
		Break
	EndIF

    IF fQuestEscala(@cEscala)
		IF !( lRdbCodAltOk := ExistCpo( "RBL"  , ( cEscala + GetMemVar( "RDB_CODALT" ) ) ) )
			Break
		EndIF
	ELSE
		IF !( lRdbCodAltOk := ExistCpo( "SQP"  , ( GdFieldGet( "RDB_CODQUE" ) + GetMemVar( "RDB_CODALT" ) ) ) )
			Break
		EndIF
	EndIF

End Sequence


Return( lRdbCodAltOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAltInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_CODALT					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_CODALT								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAltInit()

Local cRdbCodAltInit := Space( GetSx3Cache( "RDB_CODALT" , "X3_TAMANHO" ) )

Return( SetMemVar( "RDB_CODALT" , cRdbCodAltInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbCodAltWhen 	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁWhen do Campo RDB_CODALT									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_WHEN do Campo RDB_CODALT									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbCodAltWhen()

Local lRdbCodAltWhen := .F.

IF !fDissertativa()
	lRdbCodAltWhen := .T.
Endif

ChangeF3()

Return( lRdbCodAltWhen )



/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁfDissertativaЁAutorЁMauricio MR			  Ё Data Ё23/01/2006Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁVerifica se uma questao possui resposta dissertativa     	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA190														Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function fDissertativa()
Local lRet	:= .F.

//-- Bloco que identifica se o tipo da questao eh alternativa
Local bPesq			 := { |cCodQue| (fDesc( "SQO" , cCodQue , "QO_TIPOOBJ" , ;
                                                    GetSx3Cache( "QO_TIPOOBJ" , "X3_TAMANHO" ) ,;
                                                    NIL , NIL , .F. ;
                                            ) ;
                                     ) == "3";
                         }

If Type("aHeader") <> "A" .and. Type("oGdRdb:aHeader") = "A"
   Private aCols 	:= aClone(oGdRdb:aCols)
   Private aHeader 	:= aClone(oGdRdb:aHeader)
   Private n 		:= oGdRdb:oBrowse:nAt
Endif

//-- Verifica se a GetDados esta ativa ou a Enchoice
IF IsInGetDados( {  "RDB_CODQUE" } )

	//-- Verifica se a questao eh dissertativa
	lRet := Eval(bPesq, GdFieldGet( "RDB_CODQUE" )  )

Else
	//-- Verifica se a questao eh dissertativa
	lRet := Eval(bPesq, GetMemVar( "RDB_CODQUE" )  )

EndIF

Return (lRet)

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁfQuestEscala ЁAutorЁMauricio MR			  Ё Data Ё23/01/2006Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁVerifica se uma questao possui escala				     	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁAPDA190														Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function fQuestEscala(cEscala)
Local lRet	:= .F.

//-- Bloco que identifica se existe escala para a questao
Local bPesq			 := { |cCodQue| !Empty(cEscala:=fDesc( "SQO" , cCodQue , "QO_ESCALA" , ;
                                                    GetSx3Cache( "QO_ESCALA" , "X3_TAMANHO" ) ,;
                                                    NIL , NIL , .F. ;
                                            ) ;
                                     );
                         }

DEFAULT cEscala	:= ""

If Type("aHeader") <> "A" .and. Type("oGdRdb:aHeader") = "A"
   Private aCols 	:= aClone(oGdRdb:aCols)
   Private aHeader 	:= aClone(oGdRdb:aHeader)
   Private n 		:= oGdRdb:oBrowse:nAt
Endif

//-- Verifica se a GetDados esta ativa ou a Enchoice
IF IsInGetDados( {  "RDB_CODQUE" } )

	//-- Verifica se a questao tem escala
	lRet := Eval(bPesq, GdFieldGet( "RDB_CODQUE" ) )

Else
	//-- Verifica se a questao tem escala
	lRet := Eval(bPesq, GetMemVar( "RDB_CODQUE" )  )

EndIF

Return (lRet)


/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁChangeF3     ЁAutorЁMauricio MR			  Ё Data Ё27/01/2009Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁAltera a Consulta padrao 						     		Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_F3 							                         	Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Static Function ChangeF3()
Local cAlias
Local nF3

If Type("aHeader") <> "A" .and. Type("oGdRdb:aHeader") = "A"
   Private aCols 	:= aClone(oGdRdb:aCols)
   Private aHeader 	:= aClone(oGdRdb:aHeader)
   Private n 		:= oGdRdb:oBrowse:nAt
Endif

//Trata F3 para o campo RDB_CODALT
cAlias := IF(fQuestEscala(),"RBL","SQP")
nF3:= GdFieldPos( "RDB_CODALT" , aRdbHeader )
oGdRdb:aHeader[nF3, 9]:= cAlias

Return(Nil)


/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbEscalaVld ЁAutorЁMarinaldo de Jesus    Ё Data Ё16/08/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid para o campo RDB_ESCALA   			          		Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID para o campo RDB_ESCALA                         	Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbEscalaVld()

Local lRdbEscalaVld := .T.

Begin Sequence

	IF !( lRdbEscalaVld := NaoVazio() )
		Break
	EndIF

	IF !( lRdbEscalaVld := ExistCpo( "RBK" ) )
		Break
	EndIF

End Sequence

Return( lRdbEscalaVld )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbEscalaInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_ESCALA					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_ESCALA								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbEscalaInit()

Local cRdbEscalaInit := Space( GetSx3Cache( "RDB_ESCALA" , "X3_TAMANHO" ) )

Return( SetMemVar( "RDB_ESCALA" , cRdbEscalaInit ) )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbIteEscVld ЁAutorЁMarinaldo de Jesus    Ё Data Ё02/02/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do campo RD0_ITEESC                                   Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do campo RDB_ITEESC								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbIteEscVld()

Local lRdbIteEscVld := .T.

Begin Sequence

	IF ( Vazio() )
		Break
	EndIF

	lRdbIteEscVld := ExistCpo( "RBL" , ( GetMemVar( "RDB_ESCALA" ) + GetMemVar( "RDB_ITEESC" ) ) )

End Sequence

Return( lRdbIteEscVld )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbIteEscInit	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_ITEESC					Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_ITEESC								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbIteEscInit()

Local cRdbIteEscInit := Space( GetSx3Cache( "RDB_ITEESC" , "X3_TAMANHO" ) )

Return( SetMemVar( "RDB_ITEESC" , cRdbIteEscInit ) )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbIteEscWhen 	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁWhen do Campo RDB_ITEESC									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_WHEN do Campo RDB_ITEESC									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbIteEscWhen()

Local lRdbIteEscWhen 	:= .F.
Local nColCodEsc		:= GdFieldPos( "RDB_ESCALA" , oGdRdb:aHeader )
Local nColIteEsc		:= GdFieldPos( "RDB_ITEESC" , oGdRdb:aHeader )

IF ( Upper( AllTrim( ReadVar() ) ) == "M->RDB_ITEESC" ) .or. ( oGdRdb:oBrowse:nColPos == nColIteEsc )
	If !Empty( oGdRdb:aCols[oGdRdb:nAt, nColCodEsc] )
		lRdbIteEscWhen := .T.
	Else
		lRdbIteEscWhen := .F.
	EndIf
EndIF

Return( lRdbIteEscWhen )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbMemoVld     	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/08/2002Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_MEMO										Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁValid do Campo RDB_MEMO										Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbMemoVld()

Local lRdbMemoOk := .T.

Begin Sequence

	IF !( lRdbMemoOk := RdbMemoWhen() )
		Break
	EndIF

End Sequence

Return( lRdbMemoOk )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbMemoInit	 ЁAutorЁMarinaldo de Jesus	  Ё Data Ё14/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_MEMO						Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do campo RDB_MEMO								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbMemoInit()

Local cRdbDesMemInit := ""
Local aArea 	:= GetArea()

IF !( Inclui := IF( ( Type( "Inclui" ) == "L" ) , Inclui , .F. ) )

	dbSelectArea("RDB")
	cRdbDesMemInit := ApdMsMm( RDB->RDB_CODMEM )

EndIF

RestArea( aArea )
Return( cRdbDesMemInit )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbJusMemoInit	 ЁAutorЁEmerson Campos	  Ё Data Ё23/04/2012Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInicializadora Padrao do Campo RDB_JUSMEM			    	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO e VALID do campo RDB_JUSMEM						Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbJusMemoInit()

Local cRdbJusMemInit := ""
Local aArea 	:= GetArea()

IF !( Inclui := IF( ( Type( "Inclui" ) == "L" ) , Inclui , .F. ) )

	dbSelectArea("RDB")
	cRdbJusMemInit := ApdMsMm( RDB->RDB_CODJUS )

EndIF

RestArea( aArea )
Return( cRdbJusMemInit )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbMemoWhen 	 ЁAutorЁMarinaldo de JesusЁ Data Ё16/08/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁWhen do Campo RDB_MEMO										Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_WHEN do Campo RDB_MEMO									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbMemoWhen()

Local lRdbMemoWhen 	:= .T.
Local nColDesMem	:= GdFieldPos( "RDB_MEMO" , oGdRdb:aHeader )

IF ( Upper( AllTrim( ReadVar() ) ) == "M->RDB_MEMO" ) .or. ( oGdRdb:oBrowse:nColPos == nColDesMem )
		lRdbMemoWhen := fDissertativa()
EndIF

Return( lRdbMemoWhen )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbTipoAvVld 	 ЁAutorЁMarinaldo de JesusЁ Data Ё02/05/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁValid do Campo RDB_TIPOAV									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID do Campo RDB_TIPOAV								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbTipoAvVld()

Local lRdbTipoAvOK := .T.

Begin Sequence

	IF !( lRdbTipoAvOK := NaoVazio() )
		Break
	EndIF

	IF !( lRdbTipoAvOK := Pertence( OpBxTipoAv( .T. ) ) )
		Break
	EndIF

End Sequence

Return( lRdbTipoAvOK )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbTipoAvInit 	 ЁAutorЁMarinaldo de JesusЁ Data Ё02/05/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁInit do Campo RDB_TIPOAV									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_RELACAO do Campo RDB_TIPOAV								Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbTipoAvInit()
Return( GetTpAvDor() )

/*/
зддддддддддбдддддддддддддддддбдддддбддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbTipoAvBox 	 ЁAutorЁMarinaldo de JesusЁ Data Ё02/05/2004Ё
цддддддддддедддддддддддддддддадддддаддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁOpcBox do Campo RDB_TIPOAV									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_CBOX do Campo RDB_TIPOAV									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbTipoAvBox()
Return( OpBxTipoAv( .F. ) )

/*/
зддддддддддбдддддддддддддбдддддбддддддддддддддддддддддбддддддбдддддддддд©
ЁFun┤┘o    ЁRdbIdVld	 ЁAutorЁMarinaldo de Jesus    Ё Data Ё22/09/2004Ё
цддддддддддедддддддддддддадддддаддддддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤┘o ЁFuncao para Validar o Conteudo do Campo RDB_ID          	Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ<Vide Parametros Formais>									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁUso       ЁX3_VALID para o campo RDB_ID                         		Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
Function RdbIdVld()

Local lRdbIDOk	:= .T.

Begin Sequence

	IF !( lRdbIdOk := ExistCpo( "RDC", GetMemVar( "RDB_ID" ) + GetMemVar( "RDB_CODAVA" ), RetOrdem( "RDC", "RDC_FILIAL+RDC_ID+RDC_CODAVA" ) ) )
		Break
	EndIF

End Sequence

Return( lRdbIdOk )

/*
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFun┤└o    Ё MenuDef		ЁAutorЁ Emerson Campos    Ё Data Ё04/01/2013Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescri┤└o ЁIsola opcoes de menu para que as opcoes da rotina possam    Ё
Ё          Ёser lidas pelas bibliotecas Framework da Versao 9.12 .      Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё< Vide Parametros Formais >									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Uso      ЁAPDA260                                                     Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Retorno  ЁaRotina														Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ< Vide Parametros Formais >									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
Static Function MenuDef(cTela)
 Local aRotina	:= {}

Do Case
	Case  cTela == "APDA260"
		aRotina := {;
						{ STR0001 , "AxPesqui"	 ,0 ,1 , ,.F. } ,; //"Pesquisar"
						{ STR0002 , "Apda260Mnt" ,0 ,2 , ,.F. } ,; //"Visualizar"
						{ STR0004 , "Apda260Mnt" ,0 ,4 , ,.F. } ,; //"Alterar"
  						{ STR0016 , "Apda020Leg" ,0 ,5 , ,.F. }  ; //"Legenda"
				    }
	Case cTela == "APDA090"
		aRotina := {;
						{ STR0001 , "AxPesqui"	 , 0 , 01,,.F.} ,; //"Pesquisar"
						{ STR0002 , "Apda090Mnt" , 0 , 02 } 	,; //"Visualizar"
						{ STR0003 , "Apda090Mnt" , 0 , 04 } 	,; //"Incluir"
						{ STR0004 , "Apda090Mnt" , 0 , 04 } 	,; //"Alterar"
 						{ STR0005 , "Apda090Mnt" , 0 , 05 } 	,; //"Excluir"
  						{ STR0016 , "Apda020Leg" , 0 , 05, ,.F.} ; //"Legenda"
					}
	Case cTela == "APDA180"
		aRotina := {;
						{ STR0001 , "AxPesqui"	 , 0 , 01,,.F.} ,; //"Pesquisar"
						{ STR0002 , "Apda180Mnt" , 0 , 02 } 	,; //"Visualizar"
						{ STR0003 , "Apda180Mnt" , 0 , 04 } 	,; //"Incluir"
						{ STR0004 , "Apda180Mnt" , 0 , 04 } 	,; //"Alterar"
						{ STR0005 , "Apda180Mnt" , 0 , 05 } 	,; //"Excluir"
						{ STR0016 , "Apda020Leg" , 0 , 05, ,.F.} ; //"Legenda"
 	    		    }
 	Case cTela == "APDA190"
 		aRotina := {;
						{ STR0001 , "AxPesqui"	 , 0 , 01,,.F.} ,; //"Pesquisar"
						{ STR0002 , "Apda190Mnt" , 0 , 02 } 	,; //"Visualizar"
						{ STR0003 , "Apda190Mnt" , 0 , 04 } 	,; //"Incluir"
						{ STR0004 , "Apda190Mnt" , 0 , 04 } 	,; //"Alterar"
						{ STR0005 , "Apda190Mnt" , 0 , 05 }		,; //"Excluir"
						{ STR0016 , "Apda020Leg" , 0 , 05, ,.F.} ; //"Legenda"
					}
EndCase
Return aRotina

/*
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFunГЦo    Ё GdDelSons		ЁAutorЁ Emerson Campos    Ё Data Ё15/01/2013Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescriГЦo ЁControle de deleГЦo por linha do RD6, setando os filhos RD7 Ё
Ё          ЁRDB e RDD com .T. ou .F. dependendo da aГЦo (deletar ou     Ё
Ё          Ёremover deleГЦo).                                           Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё< Vide Parametros Formais >									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Uso      ЁAPDA260                                                     Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Retorno  ЁNil     													Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ< Vide Parametros Formais >									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
Function GdDelSons( oGdRd6, oGdRd7, oGdRdb, oGdRdd )
Local nCont	  		:= 0
Local nTamRdd  		:= Len(aRddCols)
Local nTamRdb  		:= Len(aRdbCols)
Local nTamRd7  		:= Len(aRd7Cols)
Local nHeadRdd  	:= (Len(oGdRdd:aHeader) + 1)
Local nHeadRdb  	:= (Len(oGdRdb:aHeader) + 1)
Local nHeadRd7		:= (Len(oGdRd7:aHeader) + 1)
Local nHeadRd6		:= (Len(oGdRd6:aHeader) + 1)
Local cRd0Codigo	:= GetMemVar( "RD0_CODIGO" )
Local cRd0Nome		:= GetMemVar( "RD0_NOME" )
Local cRd6Codigo	:= GdFieldGet( "RD6_CODIGO" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Local cRd6Desc		:= GdFieldGet( "RD6_DESC" , oGdRd6:nAt , .F. , oGdRd6:aHeader , oGdRd6:aCols )
Local lColsToAll	:= .F.
Local nRddCodAva	:= GdFieldPos( "RDD_CODAVA"	, oGdRdd:aHeader )
Local nRddCodAdo	:= GdFieldPos( "RDD_CODADO"	, oGdRdd:aHeader )
Local nRdbCodAva	:= GdFieldPos( "RDB_CODAVA"	, oGdRdb:aHeader )
Local nRdbCodAdo	:= GdFieldPos( "RDB_CODADO"	, oGdRdb:aHeader )
Local nRd7CodAva	:= GdFieldPos( "RD7_CODAVA"	, oGdRd7:aHeader )
Local nRd7CodAdo	:= GdFieldPos( "RD7_CODADO"	, oGdRd7:aHeader )
Local nRecRd7		:= GdFieldPos( "RD7_REC_WT"	, oGdRd7:aHeader )
Local nRecRdb       := GdFieldPos( "RDB_REC_WT"	, oGdRdb:aHeader )
Local nRecRdd		:= GdFieldPos( "RDD_REC_WT"	, oGdRdd:aHeader )
Local cMsgYesNo		:= ""
Local cCadastro		:= ""
Local lDelSons		:= .T.
Local aOfusca	:= If(FindFunction('ChkOfusca'), ChkOfusca(), { .T., .F. }) //[2]Ofuscamento
Local aFldRel	:= Iif( aOfusca[2], FwProtectedDataUtil():UsrNoAccessFieldsInList( {"RD0_NOME"} ), {} )
Local lOfusca	:= Len(aFldRel) > 0

CursorArrow()

If oGdRd6:aCols[oGdRd6:oBrowse:nAt,nHeadRd6] == .F.
	lDelSons	:= .T.
	//"Esta operaГЦo excluirА os itens da Resposta, Refinamento e Resultado relativo a avaliaГЦo"
	//"do participante"
	//"Confirma a exclusЦo de todos os itens?"
	cRd0Nome		:= Iif(lOfusca, Replicate('*',15), cRd0Nome)
	cMsgYesNo		:= STR0034+" ("+cRd6Codigo+" - "+AllTrim(cRd6Desc)+") "+STR0035+" ("+cRd0Codigo+" - "+AllTrim(cRd0Nome)+"). "+STR0036
	//"ConfirmaГЦo de exclusЦo"
	cCadastro		:= STR0037
Else
	lDelSons	:= .F.
	//"Esta operaГЦo removerА a exclusЦo dos itens da Resposta, Refinamento e Resultado. Confirma o cancelamento da exclusЦo?"
	cMsgYesNo		:= STR0038
	//"Cancelamento de exclusЦo"
	cCadastro		:= STR0039
EndIf

IF (MsgYesNo( OemToAnsi( cMsgYesNo ) , cCadastro ))
	CursorWait()
	__nRddRd6AtAnt	:= 0
	__nRd7Rd6AtAnt	:= 0
	__nRdbRd6AtAnt	:= 0

	For nCont := 1 To nTamRdd
		If aRddCols[nCont,nRddCodAva] == cRd6Codigo .AND. aRddCols[nCont,nRddCodAdo] == cRd0Codigo
			aRddCols[nCont,nHeadRdd]	:= lDelSons
		EndIf
	Next nCont

	For nCont := 1 To nTamRdb
		If aRdbCols[nCont,nRdbCodAva] == cRd6Codigo .AND. aRdbCols[nCont,nRdbCodAdo] == cRd0Codigo
			aRdbCols[nCont,nHeadRdb]	:= lDelSons
		EndIf
	Next nCont

	For nCont := 1 To nTamRd7
		If aRd7Cols[nCont,nRd7CodAva] == cRd6Codigo .AND. aRd7Cols[nCont,nRd7CodAdo] == cRd0Codigo
			aRd7Cols[nCont,nHeadRd7]	:= lDelSons
		EndIf
	Next nCont

	Rd62RDDChg( oGdRd6 , @oGdRdd , @aRddCols , lColsToAll )
	Rd62Rd7Chg( oGdRd6 , @oGdRd7 , @aRd7Cols , lColsToAll )
	Rd62RDBChg( oGdRd6 , @oGdRdb , @aRdbCols , lColsToAll )
EndIf
/*/
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
ЁPoe o cursor do Mouse em Estado de Espera					   Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды/*/
CursorWait()
Return .T.

/*
зддддддддддбддддддддддддддддбдддддбдддддддддддддддддддбддддддбдддддддддд©
ЁFunГЦo    Ё Apda260Grava	ЁAutorЁ Emerson Campos    Ё Data Ё15/01/2013Ё
цддддддддддеддддддддддддддддадддддадддддддддддддддддддаддддддадддддддддд╢
ЁDescriГЦ└o Ёanalisa o Acols do objeto do RD6 para verificar se alguma   Ё
Ё          Ёlinha foi deletada.                                         Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁSintaxe   Ё< Vide Parametros Formais >									Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Uso      ЁAPDA260                                                     Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё Retorno  ЁNil     													Ё
цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
ЁParametrosЁ< Vide Parametros Formais >									Ё
юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
Function Apda260Grava()
Local nTamRd6		:= Len(oGdRd6:aCols)
Local nHeadRd6		:= (Len(oGdRd6:aHeader) + 1)
Local nRd6CodAva	:= GdFieldPos( "RD6_CODIGO"	, oGdRd6:aHeader )
Local nCont			:= 0
Local nOrdRd9		:= RetOrdem("RD9","RD9_FILIAL+RD9_CODAVA+RD9_CODADO+RD9_CODPRO+DTOS(RD9_DTIAVA)")
Local cRd0Codigo	:= GetMemVar( "RD0_CODIGO" )
Local cRd6Filial	:= xFilial( "RD6" )

For nCont := 1 To nTamRd6
	If oGdRd6:aCols[nCont,nHeadRd6] == .T.
		DbSelectArea("RD9")
		RD9->( DbSetOrder(nOrdRD9) )
		RD9->( DbSeek(xFilial( "RD9" ,cRd6Filial ) + AllTrim(oGdRd6:aCols[nCont,nRd6CodAva]) + AllTrim(cRd0Codigo)) )
		While RD9->( !EOF() ) .And. RD9->RD9_FILIAL == xFilial( "RD9" ,cRd6Filial );
		                      .And. RD9->RD9_CODAVA == oGdRd6:aCols[nCont,nRd6CodAva];
		                      .And. RD9->RD9_CODADO == cRd0Codigo
			RD9->( RecLock("RD9",.F.) )
			RD9->( DbDelete() )
			RD9->( MsUnlock() )
			RD9->( DbSkip() )
		Enddo
	EndIf
Next nCont
Return Nil
