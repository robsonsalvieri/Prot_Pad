#INCLUDE "PROTHEUS.CH"
#INCLUDE "PONXRDM.CH"

Function PONXRDM()
Return

Function PONXABSENT()
If ExistBlock("ABSENT")
    ExecBlock( "ABSENT", .F., .F. )
ElseIf FindFunction("PONR210") .And. fTemSX1("PONR210")
    PONR210()
Else
   PONR180()
EndIf
Return

Function PONXEXTRBH()
If ExistBlock("EXTRABH")
    ExecBlock( "EXTRABH", .F., .F. )
Else
	PONR190()
EndIf
Return

Function PONXQDHR()
If ExistBlock("PONQDHR")
    ExecBlock( "PONQDHR", .F., .F. )
Else
	PONR200()
EndIf
Return

/*/{Protheus.doc} nomeFunction
Retorna se um grupo de perguntas está cadastro na tabela SX1
@type  Function
@author Cícero Alves
@since 21/08/2023
@param cGrupo, Caracter, Grupo de perguntas
@return lExiste, Lógico, Indica se o grupo está cadastrado na tabela SX1
@see https://tdn.totvs.com/x/JZw0Fg 
/*/
Function fTemSX1(cGrupo)
    
    Local lExiste   := .F.
    Local oSX1      := FWSX1Util():New()
	
	oSX1:AddGroup(cGrupo)
	oSX1:SearchGroup()
    
	If Len(oSX1:aGrupo) >= 1 .And. Len(oSX1:aGrupo[1][2]) >= 1
		lExiste := .T.
	EndIf
    
	FreeObj(oSX1)
    
Return lExiste
