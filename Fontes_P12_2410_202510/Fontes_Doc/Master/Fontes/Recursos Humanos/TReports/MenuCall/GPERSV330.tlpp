#INCLUDE "PROTHEUS.CH"    
#Include "FWBROWSE.CH"
#INCLUDE "FWLIBVERSION.CH"
#include "gpersv330.ch"

//-------------------------------------------------------------------
/*/{Protheus.doc} GPERSV330

Chamada do objeto de negócios rh.sv.gper330, 
@author  Bruno Costa
@since   30/12/2024
@version 1.0
/*/
Function GPERSV330()

    local oSmartView as object

    If lCfgSV() 
        
        oSmartView := totvs.framework.smartview.callSmartView():new("rh.sv.gpe.gper330")
        oSmartView:setParam("SEPDSR", "2")
        oSmartView:setParam("ORDER", "1")

        If(!oSmartView:executeSmartView(.T.), Conout(oSmartView:getError()), Nil)
        oSmartView:destroy()
    EndIf    

Return

//---------------------------------------------------------------------
/*/{Protheus.doc} lCfgSV
@author	Bruno Costa
@since	30/12/2024
@version 1.0
/*/
//---------------------------------------------------------------------
Static Function lCfgSV()

    Local nOpc as numeric
	Local lRet as logical
	
	If GetRpoRelease() >= "12.1.2310" .AND. FWLibVersion() >= "20240226" 
        If totvs.framework.smartview.util.isConfig()
			lRet := .T.
        Else
            nOpc := Aviso( STR0003, STR0004 + CRLF + CRLF +; //##"Smart View!" ##"Não existe configuração do Smart View."
								STR0005 + CRLF + CRLF +; //"Para atualização dessa funcionalidade, será necessário instalar e configurar o Smart View."
								STR0006, { STR0007, STR0008 }, 3 ) //##"Siga as instruções da documentação." ##"Sair" ##"Abrir"

			If nOpc == 2 //Doc
				ShellExecute( "Open", "https://tdn.totvs.com/pages/releaseview.action?pageId=626636542", "", "", 1 ) 
			EndIf
        EndIf           
	Else
		Aviso( STR0001, STR0002, { STR0007 }, 2 ) //##"Rotina indisponível" ##"Esta funcionalidade está disponível apenas para a versão igual ou superior a 12.1.2310 e LIB igual ou superior a 20240226."##"Sair"
	EndIf

Return lRet
