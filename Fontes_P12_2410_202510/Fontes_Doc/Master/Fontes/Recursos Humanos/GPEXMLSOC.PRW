#INCLUDE "PROTHEUS.CH"
#INCLUDE "FWMVCDEF.CH"

Static lMiddleware	:= If( cPaisLoc == 'BRA' .AND. Findfunction("fVerMW"), fVerMW(), .F. )

/*


Ŀ
Funo     GPEXMLSOC   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
            Gerar subtags do e-social (S1200, S1210)                   
                                                                         
   ATENCAO:                                                              
                                                                         
 Este fonte possui funcoes que montam subtags. Qdo for subtag do S1200   
 utilize:  S1200A01 at S1200A99                                         
 Existe tambm funoes de fechamento da tag:  S1200F01 at S1200F99      
 para tratar situacoes de excecao na qual a tag deve ser fechado em      
  um outro ponto do programa.                                            
                                                                         
 Quando for subtag do S1210 utilize: S1210A01 at S1210A99               
                                      S1210F01 at S1210A99              
                                                                         
  QUANTO AOS DADOS:                                                      
  O programador dever passar os dados j formatados e validados na      
  forma de um array. Os campos do array devero estar na ordem correta   
  do layout. O layout que adotamos data de 09-05-17 ( v2.2.02  )         
                                                                         
Ĵ
Programador  Data    FNC           Motivo da Alteracao               
Oswaldo L   27-07-17 DRHESOCP-699  Unificar opes da Tag undSalFixo 
Oswaldo L   27-07-17 DRHESOCP-592  Unificar a lista de opes da Tag 
                     SubTask 709   <estCiv>                          
Eduardo     11-08-17 DRHESOCP-592  Apenas para subir fonte ult.vers. 
Marcos Cout 29-08-17 DRHESOCP-708 Ajustes do estado civil do traba_  
                                  lhador. De-Para de Unio Estavel   
Marcos Cout 13-09-17DRHESOCP-1024 Ajuste para no levar verbas com   
                                  natureza de rubrica 1409, 4050,    
                                  4051, 1009 para funcionrios na    
                                  categoria bolsista e contribuinte  
                                  individual e incluir campo TPDEP   
                                  no evento S-1200.                  
Ĵ
ٱ

*/



/*


Ŀ
Funo      S1200A01   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A01  (cXml,lFechar)

cXml += "<eSocial>"

If lFechar
	S1200F01 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F01  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F01 (cXml)
	cXml += "</eSocial>"
return

/*


Ŀ
Funo      S1200A02   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A02 (cXml, aevtRemun, lFechar ,lGera1202, lGera1207)
Local aCabec := {"Id"}
Local nCount := 1

Default lGera1202 := .F.
Default lGera1207 := .F.

If lGera1202
	cXml += "<evtRmnRPPS>"
ElseIf lGera1207
	cXML += "<evtBenPrRP>"
Else
	cXml += "<evtRemun>"
Endif

For nCount := 1 to Len(aevtRemun)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aevtRemun[nCount] == Nil
		Loop
	EndIf

	If ValType(aevtRemun[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aevtRemun[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aevtRemun[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aevtRemun[nCount] ))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aevtRemun[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aevtRemun[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F02 (@cXml, lGera1202)
EndIf

return

/*


Ŀ
Funo      S1200F02   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                           
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F02 (cXml,lGera1202, lGera1207)
Default lGera1202 := .F.
Default lGera1207 := .F.

If lGera1202
	cXml += "</evtRmnRPPS>"
ElseIf lGera1207
	cXML += "</evtBenPrRP>"
Else
	cXml += "</evtRemun>"
Endif

return


/*


Ŀ
Funo      S1200A03   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A03 (cXml, aideEvento, lFechar) //ideEvento
Local aCabec := {"indRetif","nrRecibo","indApuracao","perApur","tpAmb","procEmi","verProc" }
Local nCount := 1

cXml += "<ideEvento>"

For nCount := 1 to Len(aideEvento)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aideEvento[nCount] == Nil
		Loop
	EndIf
	If ValType(aideEvento[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aideEvento[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEvento[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aideEvento[nCount] ))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEvento[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aideEvento[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F03 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F03   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                           
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F03 (cXml)
	cXml += "</ideEvento>"
return
//============================================================

/*


Ŀ
Funo     S1200A04    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A04  (cXml, aideEmpregador, lFechar) //ideEmpregador
Local aCabec := {"tpInsc","nrInsc" }
Local nCount := 1

cXml += "<ideEmpregador>"

For nCount := 1 to Len(aideEmpregador)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aideEmpregador[nCount] == Nil
		Loop
	EndIf
	If ValType(aideEmpregador[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aideEmpregador[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEmpregador[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aideEmpregador[nCount] ))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEmpregador[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aideEmpregador[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F04 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F04   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F04 (cXml)
	cXml += "</ideEmpregador>"
return

/*


Ŀ
Funo       S1200A05  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A05(cXml, aIdeTrabalhador,lFechar)//ideTrabalhador
Local aCabec   	 := {"cpfTrab","nisTrab","infoComplem"}  //montar apenas a partir do IdeTrabalhador em diante
Local nCount := 0

cXml += '<ideTrabalhador>'

For nCount := 1 to Len(aIdeTrabalhador)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aIdeTrabalhador[nCount] == Nil
		Loop
	EndIf
	If ValType(aIdeTrabalhador[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aIdeTrabalhador[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdeTrabalhador[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aIdeTrabalhador[nCount] ))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdeTrabalhador[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aIdeTrabalhador[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F05(@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F05  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F05(cXml)
cXml += '</ideTrabalhador>'
return
/*


Ŀ
Funo      S1200A06   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A06(cXml, aInfoMV, lFechar) //InfoMV
Local aCabec           	 := {"indMV"} //tipos: N
Local nCount := 0
cXml += '<infoMV>'

For nCount := 1 to Len(aInfoMV)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aInfoMV[nCount] == Nil
		Loop
	EndIf
	If ValType(aInfoMV[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aInfoMV[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aInfoMV[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(Str(aInfoMV[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aInfoMV[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aInfoMV[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F06(@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F06   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F06(cXml)

cXml += '</infoMV>'

return

/*


Ŀ
Funo       S1200A07  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A07(cXml, aRemunOutrEmpr, lFechar) //RemunOutrEmpr
Local aCabec 	 := {"tpInsc","nrInsc","codCateg","vlrRemunOE"} //Tipos N C N N    [PODE CONTER DE 1 ATE 10 REGISTROS]   *
Local nCount := 0

cXml += '<remunOutrEmpr>'

For nCount := 1 to Len(aRemunOutrEmpr)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aRemunOutrEmpr[nCount] == Nil
		Loop
	EndIf
	If ValType(aRemunOutrEmpr[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aRemunOutrEmpr[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aRemunOutrEmpr[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(Str(aRemunOutrEmpr[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aRemunOutrEmpr[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] $ "vlrRemunOE", StrTran(Alltrim(aRemunOutrEmpr[nCount]), ",", "."), aRemunOutrEmpr[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F07(@cXml)
EndIf

return

/*


Ŀ
Funo     S1200F07    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F07(cXml)

cXml += '</remunOutrEmpr>'
return

/*


Ŀ
Funo      S1200A08   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A08 (cXml, aInfocomplem, lFechar) //Infocomplem
Local aCabec      	 := {"nmTrab","dtNascto"} //C D C N N
Local nCount := 0

cXml += '<infoComplem>'

For nCount := 1 to Len(aInfocomplem)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aInfocomplem[nCount] == Nil
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] == "dtNascto"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(dToS(aInfocomplem[nCount]), 1, 4) + "-" + SubStr(dToS(aInfocomplem[nCount]), 5, 2) + "-" + SubStr(dToS(aInfocomplem[nCount]), 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(aInfocomplem[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtos(aInfocomplem[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(aInfocomplem[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(Str(aInfocomplem[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(aInfocomplem[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aInfocomplem[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1200F08 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F08   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F08 (cXml)

cXml += '</infoComplem>'

return

/*


Ŀ
Funo      S1200A09   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A09 (cXml, aProcJudTrab, lFechar) //ProcJudTrab
Local aCabec      	 := {"tpTrib","nrProcJud","codSusp"} //N C N                       [PODE CONTER DE 0 ATE 99 REGISTROS]
Local nCount := 0

cXml += '<procJudTrab>'

For nCount := 1 to Len(aProcJudTrab)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aProcJudTrab[nCount] == Nil
		Loop
	EndIf
	If ValType(aProcJudTrab[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aProcJudTrab[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aProcJudTrab[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aProcJudTrab[nCount] )) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aProcJudTrab[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aProcJudTrab[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F09 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F09   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F09 (cXml)

cXml += '</procJudTrab>'

return

/*


Ŀ
Funo      S1200A10   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                           
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A10 (cXml, aDmDev, lFechar, lGera1207) //DmDev
Local aCabec := {"ideDmDev","codCateg"} // C N                                 [PODE CONTER DE 1 ATE 99 REGISTROS]
Local nCount := 0

Default lGera1207 := .F.

If lGera1207
	aCabec := {"ideDmDev","nrBeneficio"}
EndIf

cXml += '<dmDev>'

For nCount := 1 to Len(aDmDev)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDmDev[nCount] == Nil
		Loop
	EndIf
	If ValType(aDmDev[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aDmDev[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDmDev[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aDmDev[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDmDev[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(aDmDev[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F10 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F10   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F10 (cXml)

cXml += '</dmDev>'

return
/*


Ŀ
Funo      S1200A11   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A11(cXml, lFechar) //infoPerApur
cXml += "<infoPerApur>"

If lFechar
	S1200F11(@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F11   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F11(cXml)
cXml += "</infoPerApur>"

return

/*


Ŀ
Funo      S1200A12   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A12 ( cXml, aIdeEstabLot, lFechar, lGera1202) //IdeXEstabLot e IdeEstabLot contem qtde de parametros diferentes
Local aCabec      	 := {"tpInsc","nrInsc","codLotacao","qtdDiasAv"} // N C C N	       [PODE CONTER DE 1 ATE 24 REGISTROS]
Local nCount := 0
Default lGera1202 := .F.

If lGera1202
	cXml += '<ideEstab>'
	aCabec  := {"tpInsc","nrInsc"}
Else
	cXml += '<ideEstabLot>'
Endif

For nCount := 1 to Len(aIdeEstabLot)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf


	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aIdeEstabLot[nCount] == Nil
		Loop
	EndIf
	If ValType(aIdeEstabLot[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aIdeEstabLot[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdeEstabLot[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aIdeEstabLot[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdeEstabLot[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. Alltrim(aCabec[nCount]) == "codLotacao", alltrim(aIdeEstabLot[nCount]), aIdeEstabLot[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F12 ( @cXml,lGera1202)
EndIf

return
/*


Ŀ
Funo      S1200F12   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/

Function S1200F12 ( cXml,lGera1202)
Default lGera1202 := .F.

If lGera1202
	cXml += '</ideEstab>'
Else
	cXml += '</ideEstabLot>'
Endif

return
/*


Ŀ
Funo      S1200A13  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                         
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A13 ( cXml, aRemunPer, cTag, lFechar, lGera1202, lRemunSuc)//remunPerApur e remunPerAnt
Local aCabec     	 := {"matricula","indSimples"} // C N                              [PODE CONTER DE 1 ATE  8 REGISTROS]
Local nCount := 0

Default lGera1202 := .F.
Default lRemunSuc := .F.

If lGera1202
	aCabec     	 := {"matricula"}
Endif

cXml += '<' + cTag + '>'

For nCount := If(lRemunSuc , 2, 1) to Len(aRemunPer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aRemunPer[nCount] == Nil .Or. lMiddleware .And. Empty(aRemunPer[nCount])
		Loop
	EndIf
	If ValType(aRemunPer[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aRemunPer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aRemunPer[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(aRemunPer[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aRemunPer[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aRemunPer[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F13 (@cXml,cTag)
EndIf

return

/*


Ŀ
Funo      S1200F13   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F13 (cXml, cTag)//remunPerApur e remunPerAnt

cXml += '</' + cTag + '>'

return

/*


Ŀ
Funo      S1200A14   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function  S1200A14 ( cXml, aItensRemun, lFechar, cVersEnv, cPerApur, aEConsig) //itensRemun
	Local aCabec := {"codRubr","ideTabRubr","qtdRubr","fatorRubr","vrUnit","vrRubr"} // C C N N N C  [PODE CONTER DE 1 ATE 200 REGISTROS]
	Local nCount := 0
	Local nPos	 := 0	

	Default lFechar		:= .F.
	Default	cVersEnv	:= ""
	Default cPerApur	:= ""
	Default aEConsig    := {}

	If Val(aItensRemun[6]) > 0
		cXml += '<itensRemun>'

		For nCount := 1 to Len(aItensRemun)
			If nCount > Len(aCabec)
				exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
			EndIf

			//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
			If aItensRemun[nCount] == Nil .Or. (lMiddleware .And. aCabec[nCount] $ "qtdRubr/fatorRubr" .And. Iif(ValType(aItensRemun[nCount]) == 'N', Empty(aItensRemun[nCount]), Val(aItensRemun[nCount]) == 0))
				Loop
			EndIf
			If ValType(aItensRemun[nCount]) == 'D'
				cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aItensRemun[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
			EndIf
			If ValType(aItensRemun[nCount]) == 'N'
				cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aItensRemun[nCount] )) + '</' + Alltrim(aCabec[nCount]) + '>'
			EndIf
			If ValType(aItensRemun[nCount]) == 'C'
				cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] $ "qtdRubr*vrRubr*fatorRubr*codRubr*vrUnit", StrTran(Alltrim(aItensRemun[nCount]), ",", "."), aItensRemun[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
			EndIf
		Next

		// Informao obrigatria e exclusiva se perApur >= [2021-07] (se indApuracao = [1]) ou se perApur >= [2021] (se indApuracao = [2]).
		If cVersEnv >= "9.0.00" .And.;
		(( cTpFolha = "2" .And. Substr(StrTran(cPerApur,"-",""), 1, 4) >= "2021" ) .Or. ;
		( cTpFolha = "1" .And. Substr(StrTran(cPerApur,"-",""), 1, 6) >= "202107" ) )
			cXml += '<indApurIR>0</indApurIR>'
		EndIf

		If cVersEnv >= "9.3.00" .And. Len(aEConsig) > 0
			nPos := aScan(aEConsig, {|x| x[3] == aItensRemun[1] .And. x[4] == aItensRemun[2] .And. x[5] == aItensRemun[7] .And. x[6] == aItensRemun[8]})
			If nPos > 0
				cXml += '<descFolha>'
				cXml += '	<tpDesc>1</tpDesc>'
				If !Empty(aEConsig[nPos,7])
					cXml += '	<instFinanc>'+Alltrim(StrZero(Val(aEConsig[nPos,7]),3))+'</instFinanc>'
				Endif
				If !Empty(aEConsig[nPos,8])
					cXml += '	<nrDoc>'+ Alltrim(Substr(aEConsig[nPos,8], 1,15)) +'</nrDoc>'
				Endif
				If !Empty(aEConsig[nPos,9])
					cXml += '	<observacao>' + Alltrim(aEConsig[nPos,9]) +'</observacao>'
				Endif
				cXml += '</descFolha>'
			Endif
		Endif

		cXml += '</itensRemun>'
	EndIf

return

/*


Ŀ
Funo      S1200A15   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A15 ( cXml , lFechar )

cXml += '<infoSaudeColet>'

If lFechar
	S1200F15 ( @cXml  )
EndIf

return

/*


Ŀ
Funo     S1200F15    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F15 ( cXml  )

cXml += '</infoSaudeColet>'

return
/*


Ŀ
Funo      S1200A16   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A16  ( cXml, aDetOper, lFechar)
Local aCabec         	 := {"cnpjOper","regANS","vrPgTit"} // C C N                       [PODE CONTER DE 1 ATE 99 REGISTROS]
Local nCount := 0

cXml += '<detOper>'

For nCount := 1 to Len(aDetOper)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDetOper[nCount] == Nil
		Loop
	EndIf
	If ValType(aDetOper[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dToC(aDetOper[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetOper[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aDetOper[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetOper[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] == "vrPgTit", alltrim(aDetOper[nCount]), aDetOper[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F16 (@cXml)
EndIf

return

/*


Ŀ
Funo     S1200F16    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                           
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F16 (cXml)

cXml += '</detOper>'

return
/*


Ŀ
Funo      S1200A17   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A17  ( cXml, aDetPlano, lFechar)
Local aCabec        	 := {"tpDep","cpfDep","nmDep","dtNascto","vlrPgDep"} //C C D N             [PODE CONTER DE 0 ATE 99 REGISTROS]
Local nCount := 0

cXml += '<detPlano>'

For nCount := 1 to Len(aDetPlano)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDetPlano[nCount] == Nil
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] == "dtNascto"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(aDetPlano[nCount], 1, 4) + "-" + SubStr(aDetPlano[nCount], 5, 2) + "-" + SubStr(aDetPlano[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(aDetPlano[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aDetPlano[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(aDetPlano[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aDetPlano[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(aDetPlano[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] == "vlrPgDep", alltrim(aDetPlano[nCount]), aDetPlano[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1200F17 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F17   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F17 (cXml)
cXml += '</detPlano>'
return


/*


Ŀ
Funo     S1200A18    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function  S1200A18 ( cXml, aInfoAgNocivo, lFechar)
Local aCabec 	 := {"grauExp"}  // N
Local nCount := 0
cXml += '<infoAgNocivo>'

For nCount := 1 to Len(aInfoAgNocivo)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aInfoAgNocivo[nCount] == Nil
		Loop
	EndIf
	If ValType(aInfoAgNocivo[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aInfoAgNocivo[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aInfoAgNocivo[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aInfoAgNocivo[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aInfoAgNocivo[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aInfoAgNocivo[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F18 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F18   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F18 (cXml)
cXml += '</infoAgNocivo>'
return

/*


Ŀ
Funo      S1200A19   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A19 ( cXml, lFechar)
cXml += '<infoPerAnt>'

If lFechar
	S1200F19 ( @cXml )
EndIf

return

/*


Ŀ
Funo       S1200F19  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F19 ( cXml )
cXml += '</infoPerAnt>'
return

/*


Ŀ
Funo      S1200A20   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function  S1200A20 ( cXml, aIdeAdc, lFechar)
Local aCabec            	 := {"dtAcConv","tpAcConv","compAcConv","dtEfAcConv","dsc","remunSuc"}  //D C C D C C         [PODE CONTER DE 1 ATE 8 REGISTROS]
Local nCount := 0
cXml += '<ideADC>'

For nCount := 1 to Len(aIdeAdc)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aIdeAdc[nCount] == Nil .Or. Empty(aIdeAdc[nCount])
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] $ "dtAcConv/dtEfAcConv"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(aIdeAdc[nCount], 1, 4) + "-" + SubStr(aIdeAdc[nCount], 5, 2) + "-" + SubStr(aIdeAdc[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(aIdeAdc[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aIdeAdc[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(aIdeAdc[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aIdeAdc[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(aIdeAdc[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aIdeAdc[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1200F20 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F20   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F20 (cXml)
cXml += '</ideADC>'
return
/*


Ŀ
Funo      S1200A21   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function  S1200A21 ( cXml, aIdePeriodo, lFechar)
Local aCabec        	 := {"perRef"} //C                                                 [PODE CONTER DE 1 ATE 180 REGISTROS]
Local nCount := 0

cXml += '<idePeriodo>'

For nCount := 1 to Len(aIdePeriodo)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aIdePeriodo[nCount] == Nil
		Loop
	EndIf
	If ValType(aIdePeriodo[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aIdePeriodo[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdePeriodo[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aIdePeriodo[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdePeriodo[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aIdePeriodo[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F21(@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F21   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F21 (cXml)

cXml += '</idePeriodo>'

return
/*


Ŀ
Funo      S1200A22   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A22  ( cXml, aIdeXEstabLot, lFechar) //IdeXEstabLot e IdeEstabLot contem qtde de parametros diferentes
Local aCabec      	 := {"tpInsc","nrInsc","codLotacao"} // N C C                      [PODE CONTER DE 1 ATE 24 REGISTROS]
Local nCount := 0
cXml += '<ideEstabLot>'

For nCount := 1 to Len(aIdexEstabLot)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aIdexEstabLot[nCount] == Nil
		Loop
	EndIf
	If ValType(aIdexEstabLot[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aIdexEstabLot[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdexEstabLot[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aIdexEstabLot[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aIdexEstabLot[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aIdexEstabLot[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F22 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1200F22   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F22 (cXml)
cXml += '</ideEstabLot>'

return

/*


Ŀ
Funo      S1200A23   Autor  Rafael Reis          Data  24.08.18 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A23( cXml, nQtdeDias, lFechar) //IdeXEstabLot e IdeEstabLot contem qtde de parametros diferentes

cXml += '<infoInterm>'
cXml += '<qtdDiasInterm>'
cXml += cValToChar(nQtdeDias)
cXml += '</qtdDiasInterm>'

If lFechar
	S1200F23(@cXml)
EndIf
return




/*


Ŀ
Funo      S1200F23   Autor  Rafael Reis          Data  24.08.18 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F23(cXml)
cXml += '</infoInterm>'

return

/*


Ŀ
Funo      S1200A24   Autor  Rafael Reis          Data  24.08.18 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A24( cXml, aConvocs ) //IdeXEstabLot e IdeEstabLot contem qtde de parametros diferentes
Local nCount	:= 0

If Len(aConvocs) > 0
	For nCount := 1 to Len(aConvocs)
	cXml += '<infoTrabInterm>'
	cXml += '<codConv>'
	cXml += aConvocs[nCount]
	cXml += '</codConv>'
	S1200F24(@cXml)
	Next
Endif

Return




/*


Ŀ
Funo      S1200F24   Autor  Rafael Reis          Data  24.08.18 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F24(cXml)
cXml += '</infoTrabInterm>'

return

/*


Ŀ
Funo      S1200A25   Autor  Allyson Mesashi      Data  04.03.20 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A25( cXml, aProc )
Local nCount	:= 0

For nCount := 1 to Len(aProc)
	cXml += '<procJudTrab>'
	cXml += '<tpTrib>'+AllTrim(aProc[nCount, 1])+'</tpTrib>'
	cXml += '<nrProcJud>'+AllTrim(aProc[nCount, 2])+'</nrProcJud>'
	If !Empty(aProc[nCount, 3])
		cXml += '<codSusp>'+AllTrim(aProc[nCount, 3])+'</codSusp>'
	EndIf
	cXml += '</procJudTrab>'
Next

Return

/*


Ŀ
Funo      S1200A26   Autor  Lidio Oliveira      Data  22.04.21 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A26( cXml, aSucVinc )

Default cXml 		:= ""
Default aSucVinc	:= {}

If Len(aSucVinc) > 5
	cXml += '<sucessaoVinc>'
	cXml += '<tpInsc>'+AllTrim(aSucVinc[1])+'</tpInsc>'
	cXml += '<nrInsc>'+AllTrim(aSucVinc[2])+'</nrInsc>'
	If !Empty(aSucVinc[3])
		cXml += '<matricAnt>'+AllTrim(aSucVinc[3])+'</matricAnt>'
	EndIf
	cXml += '<dtAdm>'+AllTrim(aSucVinc[4])+'</dtAdm>'
	If !Empty(aSucVinc[5])
		cXml += '<observacao>'+AllTrim(aSucVinc[5])+'</observacao>'
	EndIf
	cXml += '</sucessaoVinc>'
EndIf

Return

/*


Ŀ
Funo      S1200A23   Autor  Lidio Oliveira       Data  26.01.21 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200A27( cXml, aDiasConv, lFechar) //IdeXEstabLot e IdeEstabLot contem qtde de parametros diferentes

Local nCount	:= 0

For nCount := 1 to Len(aDiasConv)
	cXml += '<infoInterm>'
	cXml += '<dia>' + alltrim(str(val(aDiasConv[nCount]))) + '</dia>'
	If lFechar
		S1200F23(@cXml)
	EndIf
Next

return

/*


Ŀ
Funo      S1200F27   Autor  Lidio Oliveira       Data  26.01.21 
Ĵ
Descrio  Gera subtag do e-social (S1200)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1200F27(cXml)
cXml += '</infoInterm>'

return

//---------- S1210 -----------------------------------------------

/*


Ŀ
Funo      S1210A01   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A01  (cXml,lFechar) //eSocial

cXml += "<eSocial>"

If lFechar
	S1210F01 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F01  Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F01 (cXml) //eSocial
	cXml += "</eSocial>"
return

/*


Ŀ
Funo      S1210A02   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A02 (cXml, aevtPgtos, lFechar) //evtRemun
Local aCabec := {"Id"}
Local nCount := 1

cXml += "<evtPgtos>"

For nCount := 1 to Len(aevtPgtos)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aevtPgtos[nCount] == Nil
		Loop
	EndIf
	If ValType(aevtPgtos[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aevtPgtos[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aevtPgtos[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aevtPgtos[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aevtPgtos[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aevtPgtos[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F02 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F02   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                           
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F02 (cXml)
	cXml += "</evtPgtos>"
return


/*


Ŀ
Funo      S1210A03   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A03 (cXml, aideEvento, lFechar)
Local aCabec := {"indRetif","nrRecibo","indApuracao","perApur","tpAmb","procEmi","verProc" }
Local nCount := 1

cXml += "<ideEvento>"

For nCount := 1 to Len(aideEvento)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aideEvento[nCount] == Nil
		Loop
	EndIf
	If ValType(aideEvento[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aideEvento[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEvento[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aideEvento[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEvento[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aideEvento[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1200F03 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F03   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                           
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F03 (cXml)
	cXml += "</ideEvento>"
return

/*


Ŀ
Funo     S1210A04    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A04  (cXml, aideEmpregador, lFechar)
Local aCabec := {"tpInsc","nrInsc" }
Local nCount := 1

cXml += "<ideEmpregador>"

For nCount := 1 to Len(aideEmpregador)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aideEmpregador[nCount] == Nil
		Loop
	EndIf
	If ValType(aideEmpregador[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aideEmpregador[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEmpregador[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aideEmpregador[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideEmpregador[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aideEmpregador[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F04 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F04   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F04 (cXml)
	cXml += "</ideEmpregador>"
return





/*


Ŀ
Funo     S1210A05    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A05  (cXml, aideBenef, lFechar)
Local aCabec := {"cpfBenef" }//C
Local nCount := 1

cXml += "<ideBenef>"

For nCount := 1 to Len(aideBenef)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aideBenef[nCount] == Nil
		Loop
	EndIf
	If ValType(aideBenef[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aideBenef[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideBenef[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aideBenef[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aideBenef[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aideBenef[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F05 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F05   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F05 (cXml)
	cXml += "</ideBenef>"
return





/*


Ŀ
Funo     S1210A06    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A06  (cXml, aDeps, lFechar)
Local aCabec := {"vrDedDep" }//N
Local nCount := 1

cXml += "<deps>"

For nCount := 1 to Len(aDeps)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDeps[nCount] == Nil
		Loop
	EndIf
	If ValType(aDeps[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aDeps[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDeps[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aDeps[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDeps[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aDeps[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F06 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F06   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F06 (cXml)
	cXml += "</deps>"
return





/*


Ŀ
Funo     S1210A07    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A07(cXml, ainfoPgto, lFechar, cVersao)
Local aCabec := {"dtPgto","tpPgto","indResBr", "classPgto"}//D N C C
Local nCount := 1

cXml += "<infoPgto>"

For nCount := 1 to Len(ainfoPgto)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If ainfoPgto[nCount] == Nil .Or. (aCabec[nCount] == "classPgto" .And. cVersao < "2.6.00")
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] == "dtPgto"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(ainfoPgto[nCount], 1, 4) + "-" + SubStr(ainfoPgto[nCount], 5, 2) + "-" + SubStr(ainfoPgto[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(ainfoPgto[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + DtoS(ainfoPgto[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(ainfoPgto[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(ainfoPgto[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(ainfoPgto[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + ainfoPgto[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1210F07 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F07   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F07 (cXml)
	cXml += "</infoPgto>"
return




/*


Ŀ
Funo     S1210A08    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A08  (cXml, adetPgtoFl, lFechar, cVersao) //ideEmpregador
Local aCabec := {"perRef", "ideDmDev", "indPgtoTt", "vrLiq", "nrRecArq", "indRRA"}//C C C N C C
Local nCount := 1

cXml += "<detPgtoFl>"

For nCount := 1 to Len(adetPgtoFl)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If adetPgtoFl[nCount] == Nil .Or. (aCabec[nCount] == "indRRA" .And. cVersao < "2.6.00")
		Loop
	EndIf
	If ValType(adetPgtoFl[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(adetPgtoFl[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetPgtoFl[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(adetPgtoFl[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetPgtoFl[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + adetPgtoFl[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F08 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F08   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F08 (cXml)
	cXml += "</detPgtoFl>"
return




/*


Ŀ
Funo     S1210A09    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A09  (cXml, aretPgtoTot, lFechar)
Local aCabec := {"codRubr","ideTabRubr","qtdRubr","fatorRubr","vrUnit","vrRubr" }//C C N N N N
Local nCount := 1

cXml += "<retPgtoTot>"

For nCount := 1 to Len(aretPgtoTot)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aretPgtoTot[nCount] == Nil
		Loop
	EndIf
	If ValType(aretPgtoTot[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aretPgtoTot[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aretPgtoTot[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aretPgtoTot[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aretPgtoTot[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aretPgtoTot[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F09 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F09   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F09 (cXml)
	cXml += "</retPgtoTot>"
return




/*


Ŀ
Funo     S1210A10    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A10  (cXml, apenAlim, lFechar)
Local aCabec := {"cpfBenef","dtNasctoBenef","nmBenefic","vlrPensao" }//C D C N
Local nCount := 1

cXml += "<penAlim>"

For nCount := 1 to Len(apenAlim)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If apenAlim[nCount] == Nil
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] == "dtNasctoBenef"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(apenAlim[nCount], 1, 4) + "-" + SubStr(apenAlim[nCount], 5, 2) + "-" + SubStr(apenAlim[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(apenAlim[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(apenAlim[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(apenAlim[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(apenAlim[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(apenAlim[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + apenAlim[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1210F10 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F10   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F10 (cXml)
	cXml += "</penAlim>"
return




/*


Ŀ
Funo     S1210A11    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A11  (cXml, ainfoPgtoParc, lFechar)
Local aCabec := {"codRubr","ideTabRubr","qtdRubr","fatorRubr","vrUnit","vrRubr" }//C D C N
Local nCount := 1

cXml += "<infoPgtoParc>"

For nCount := 1 to Len(ainfoPgtoParc)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If ainfoPgtoParc[nCount] == Nil
		Loop
	EndIf
	If ValType(ainfoPgtoParc[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(ainfoPgtoParc[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(ainfoPgtoParc[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(ainfoPgtoParc[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(ainfoPgtoParc[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + ainfoPgtoParc[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F11 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F11   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F11 (cXml)
	cXml += "</infoPgtoParc>"
return




/*


Ŀ
Funo     S1210A12    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A12  (cXml, adetPgtoBenPr, lFechar)
Local aCabec := {"perRef","ideDmDev","indPgtoTt","vrLiq" }//C C C N
Local nCount := 1

cXml += "<detPgtoBenPr>"

For nCount := 1 to Len(adetPgtoBenPr)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If adetPgtoBenPr[nCount] == Nil
		Loop
	EndIf
	If ValType(adetPgtoBenPr[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(adetPgtoBenPr[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetPgtoBenPr[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(adetPgtoBenPr[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetPgtoBenPr[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + adetPgtoBenPr[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F12 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F12   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F12 (cXml)
	cXml += "</detPgtoBenPr>"
return






/*


Ŀ
Funo     S1210A13    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A13  (cXml, adetPgtoFer, lFechar)
Local aCabec := {"codCateg","dtIniGoz","qtDias","vrLiq" }//C C C N
Local nCount := 1

cXml += "<detPgtoFer>"

For nCount := 1 to Len(adetPgtoFer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If adetPgtoFer[nCount] == Nil
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] == "dtIniGoz"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(adetPgtoFer[nCount], 1, 4) + "-" + SubStr(adetPgtoFer[nCount], 5, 2) + "-" + SubStr(adetPgtoFer[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(adetPgtoFer[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(adetPgtoFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(adetPgtoFer[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(adetPgtoFer[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(adetPgtoFer[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + adetPgtoFer[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1210F13 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F13   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F13 (cXml)
	cXml += "</detPgtoFer>"
return


/*


Ŀ
Funo     S1210A14    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A14  (cXml, adetRubrFer, lFechar)
Local aCabec := {"codRubr","ideTabRubr","qtdRubr","fatorRubr","vrUnit","vrRubr" }//C C N N N N
Local nCount := 1

cXml += "<detRubrFer>"

For nCount := 1 to Len(adetRubrFer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If adetRubrFer[nCount] == Nil
		Loop
	EndIf
	If ValType(adetRubrFer[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(adetRubrFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetRubrFer[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(adetRubrFer[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetRubrFer[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + adetRubrFer[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F14 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F14   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F14 (cXml)
	cXml += "</detRubrFer>"
return




/*


Ŀ
Funo     S1210A15    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A15( cXml, adetPgtoAnt, lFechar, cVersao )
Local aCabec := {"codCateg","indRRA" }//N C
Local nCount := 1

cXml += "<detPgtoAnt>"

For nCount := 1 to Len(adetPgtoAnt)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If adetPgtoAnt[nCount] == Nil .Or. (aCabec[nCount] == "indRRA" .And. cVersao < "2.6.00")
		Loop
	EndIf
	If ValType(adetPgtoAnt[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(adetPgtoAnt[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetPgtoAnt[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(adetPgtoAnt[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(adetPgtoAnt[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + adetPgtoAnt[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F15 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F15   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F15(cXml)
	cXml += "</detPgtoAnt>"
return




/*


Ŀ
Funo     S1210A16    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A16  (cXml, ainfoPgtoAnt, lFechar)
Local aCabec := {"tpBcIRRF","vrBcIRRF" }//C N
Local nCount := 1

cXml += "<infoPgtoAnt>"

For nCount := 1 to Len(ainfoPgtoAnt)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If ainfoPgtoAnt[nCount] == Nil
		Loop
	EndIf
	If ValType(ainfoPgtoAnt[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(ainfoPgtoAnt[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(ainfoPgtoAnt[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(ainfoPgtoAnt[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(ainfoPgtoAnt[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + ainfoPgtoAnt[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F16 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F16   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F16 (cXml)
	cXml += "</infoPgtoAnt>"
return



/*


Ŀ
Funo     S1210A17    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A17  (cXml,  lFechar)

cXml += "<idePgtoExt>"

If lFechar
	S1210F17 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F17   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F17 (cXml)
	cXml += "</idePgtoExt>"
return




/*


Ŀ
Funo     S1210A18    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A18  (cXml, aidePais, lFechar)
Local aCabec := { "indNIF", "nifBenef", "frmTribut" }//N C C
Local nCount := 1

cXml += "<infoPgtoExt>"

For nCount := 1 to Len(aidePais)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aidePais[nCount] == Nil
		Loop
	EndIf
	If ValType(aidePais[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aidePais[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aidePais[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aidePais[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aidePais[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aidePais[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F18 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F18   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F18 (cXml)
	cXml += "</infoPgtoExt>"
return


/*


Ŀ
Funo     S1210A19    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A19  (cXml, aendExt, lFechar)
Local aCabec := { "endDscLograd", "endNrLograd", "endComplem", "endBairro", "endCidade", "endEstado", "endCodPostal", "telef" }//C C C C C C C C
Local nCount := 1

cXml += "<endExt>"

For nCount := 1 to Len(aendExt)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aendExt[nCount] == Nil
		Loop
	EndIf
	If ValType(aendExt[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(aendExt[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aendExt[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(aendExt[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aendExt[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aendExt[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F19 (@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F19   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F19 (cXml)
	cXml += "</endExt>"
return


/*


Ŀ
Funo     S1210A20  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210A20  (cXml, ainfoPgto, lFechar)

Local aCabec := {"dtPgto","tpPgto","indResBr" }
Local nCount := 1

cXml += "<infoPgto>"

For nCount := 1 to Len(ainfoPgto)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If ainfoPgto[nCount] == Nil
		Loop
	EndIf
	If ValType(ainfoPgto[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(ainfoPgto[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(ainfoPgto[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(ainfoPgto[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(ainfoPgto[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + ainfoPgto[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F20 (@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F20  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210F20 (cXml)
	cXml += "</infoPgto>"
return

/*


Ŀ
Funo     S1210A21  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210A21  (cXml, detPgtoFer, lFechar) //ideEmpregador
Local aCabec := {"codCateg", "matricula", "dtIniGoz", "qtDias", "vrLiq"}//C C D N
Local nCount := 1

cXml += "<detPgtoFer>"

For nCount := 1 to Len(detPgtoFer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If detPgtoFer[nCount] == Nil
		Loop
	EndIf
	If lMiddleware .And. aCabec[nCount] == "dtIniGoz"
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(detPgtoFer[nCount], 1, 4) + "-" + SubStr(detPgtoFer[nCount], 5, 2) + "-" + SubStr(detPgtoFer[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
	Else
		If ValType(detPgtoFer[nCount]) == 'D'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(detPgtoFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(detPgtoFer[nCount]) == 'N'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(detPgtoFer[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
		If ValType(detPgtoFer[nCount]) == 'C'
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + detPgtoFer[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
		EndIf
	EndIf
Next

If lFechar
	S1210F21 (@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F21  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210F21 (cXml)
	cXml += "</detPgtoFer>"
return

/*


Ŀ
Funo     S1210A22  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210A22  (cXml, detPgtoFer, lFechar) //ideEmpregador
Local aCabec := {"codRubr", "ideTabRubr", "qtdRubr", "fatorRubr", "vrUnit", "vrRubr"}//C C D N
Local nCount := 1

cXml += "<detRubrFer>"

For nCount := 1 to Len(detPgtoFer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If detPgtoFer[nCount] == Nil .Or. (lMiddleware .And. aCabec[nCount] $ "qtdRubr/fatorRubr" .And. Iif(ValType(detPgtoFer[nCount]) == 'N', Empty(detPgtoFer[nCount]), Val(detPgtoFer[nCount]) == 0))
		Loop
	EndIf
	If ValType(detPgtoFer[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Dtoc(detPgtoFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(detPgtoFer[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(detPgtoFer[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(detPgtoFer[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] == "fatorRubr", StrTran(AllTrim(detPgtoFer[nCount]), ",", "."), detPgtoFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F22 (@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F22  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210F22 (cXml)
	cXml += "</detRubrFer>"
return

/*


Ŀ
Funo     S1210A23  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210A23  (cXml, detRubrFer, lFechar) //ideEmpregador
Local aCabec := {"cpfBenef", "dtNasctoBenef", "nmBenefic", "vlrPensao"}
Local nCount := 1

cXml += "<penAlim>"

For nCount := 1 to Len(detRubrFer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If detRubrFer[nCount] == Nil
		Loop
	EndIf
	If ValType(detRubrFer[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + DtoS(detRubrFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(detRubrFer[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(detRubrFer[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(detRubrFer[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + detRubrFer[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F23 (@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F23  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210F23 (cXml)
	cXml += "</penAlim>"
return

/*


Ŀ
Funo     S1210A25  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210A24( cXml, detRubrFer, lFechar ) //ideEmpregador
Local aCabec := { "codRubr", "ideTabRubr", "vrRubr", "dtLaudo", "tpBcIRRF","vrBcIRRF" }//C C N D N N
Local nCount := 1

cXml += "<infoPgtoAnt>"

For nCount := 1 to Len(detRubrFer)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If detRubrFer[nCount] == Nil
		Loop
	EndIf
	If ValType(detRubrFer[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + DtoS(detRubrFer[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(detRubrFer[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(detRubrFer[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(detRubrFer[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + detRubrFer[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F24 (@cXml)
EndIf
return

/*


Ŀ
Funo     S1210F24  Autor  M. Silveira            Data  03.05.18 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
ٱ

*/
Function S1210F24(cXml)
	cXml += "</infoPgtoAnt>"
return


/*


Ŀ
Funo     S1210A25  Autor  M. Silveira            Data  12.07.18 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
ٱ

*/
Function S1210A25  (cXml, infoComplCont, lFechar) //ideEmpregador
Local aCabec := {"codCBO", "natAtividade", "qtdDiasTrab"} //C D C N N
Local nCount := 0

cXml += '<infoComplCont>'

For nCount := 1 to Len(infoComplCont)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If infoComplCont[nCount] == Nil
		Loop
	EndIf
	If ValType(infoComplCont[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtos(infoComplCont[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(infoComplCont[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(Str(infoComplCont[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(infoComplCont[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + infoComplCont[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F25 (@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F25  Autor  M. Silveira            Data  12.07.18 
Ĵ
Descrio  Gera subtag do e-social (S1200)                            
ٱ

*/
Function S1210F25 (cXml)
	cXml += "</infoComplCont>"
return

/*


Ŀ
Funo      S1210A26   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A26( cXml, lFechar )

cXml += '<infoSaudeColet>'

If lFechar
	S1210F26(@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F26    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F26( cXml )

cXml += '</infoSaudeColet>'

return

/*


Ŀ
Funo      S1210A27   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A27( cXml, aDetOper, lFechar )
Local aCabec	:= {"cnpjOper","regANS","vrPgTit"} // C C N                       [PODE CONTER DE 1 ATE 99 REGISTROS]
Local nCount	:= 0

cXml += '<detOper>'

For nCount := 1 to Len(aDetOper)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDetOper[nCount] == Nil
		Loop
	EndIf
	If ValType(aDetOper[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dToC(aDetOper[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetOper[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aDetOper[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetOper[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] == "vrPgTit", alltrim(aDetOper[nCount]), aDetOper[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F27(@cXml)
EndIf

return

/*


Ŀ
Funo     S1210F27    Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                            
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F27( cXml )

cXml += '</detOper>'

return

/*


Ŀ
Funo      S1210A28   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A28( cXml, aDetPlano, lFechar )
Local aCabec	:= {"tpDep","cpfDep","nmDep","dtNascto","vlrPgDep"} //C C D N             [PODE CONTER DE 0 ATE 99 REGISTROS]
Local nCount 	:= 0

cXml += '<detPlano>'

For nCount := 1 to Len(aDetPlano)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDetPlano[nCount] == Nil
		Loop
	EndIf
	If ValType(aDetPlano[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aDetPlano[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetPlano[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aDetPlano[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetPlano[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + If(lMiddleware .And. aCabec[nCount] == "vlrPgDep", alltrim(aDetPlano[nCount]), aDetPlano[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F28(@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F28   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F28( cXml )

cXml += '</detPlano>'

return

/*


Ŀ
Funo      S1210A29   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210A29( cXml, aDetPrev, lFechar )
Local aCabec	:= {"cnpjEntid","contribPatroc"} //C N              [PODE CONTER DE 0 ATE 99 REGISTROS]
Local nCount 	:= 0

cXml += '<prevCompl>'

For nCount := 1 to Len(aDetPrev)
	If nCount > Len(aCabec)
		exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
	EndIf

	//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
	If aDetPrev[nCount] == Nil
		Loop
	EndIf
	If ValType(aDetPrev[nCount]) == 'D'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + dtoc(aDetPrev[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetPrev[nCount]) == 'N'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + Alltrim(STR(aDetPrev[nCount])) + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
	If ValType(aDetPrev[nCount]) == 'C'
		cXml += '<' + Alltrim(aCabec[nCount]) + '>' + aDetPrev[nCount] + '</' + Alltrim(aCabec[nCount]) + '>'
	EndIf
Next

If lFechar
	S1210F29(@cXml)
EndIf

return

/*


Ŀ
Funo      S1210F29   Autor  Oswaldo Leite        Data  02.06.17 
Ĵ
Descrio  Gera subtag do e-social (S1210)                  		  
Ĵ
Programador  Data    FNC    Motivo da Alteracao                     
Ĵ*/
Function S1210F29( cXml )

cXml += '</prevCompl>'

return

/*/{Protheus.doc} S1210A30
Gera subtag esocial (S-1210) leiaute S-1.0
@type  Function
@author isabel.noguti
@since 28/04/2021
@version 1.0
/*/
Function S1210A30(cXml, ainfoPgto, lFechar)
Local aCabec	:= {"dtPgto", "tpPgto", "perRef", "ideDmDev", "vrLiq", "paisResidExt"}//D N C C N C
Local nCount	:= 1

	cXml += "<infoPgto>"

	For nCount := 1 to Len(ainfoPgto)
		If nCount > Len(aCabec)
			exit //se programador passar indevidamente uma lista de dados diferente da lista de nomes pre-fixados de campos, aborto
		EndIf

		//caso desejar apenas omitir um campo da TAG, passar este como NIL na array
		If ainfoPgto[nCount] == Nil
			Loop
		EndIf
		If lMiddleware .And. aCabec[nCount] == "dtPgto"
			cXml += '<' + Alltrim(aCabec[nCount]) + '>' + SubStr(ainfoPgto[nCount], 1, 4) + "-" + SubStr(ainfoPgto[nCount], 5, 2) + "-" + SubStr(ainfoPgto[nCount], 7, 2) + '</' + Alltrim(aCabec[nCount]) + '>'
		Else
			If ValType(ainfoPgto[nCount]) == 'D'
				cXml += '<' + Alltrim(aCabec[nCount]) + '>' + DtoS(ainfoPgto[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
			EndIf
			If ValType(ainfoPgto[nCount]) == 'N'
				cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(STR(Abs(ainfoPgto[nCount])))+ '</' + Alltrim(aCabec[nCount]) + '>'
			EndIf
			If ValType(ainfoPgto[nCount]) == 'C'
				cXml += '<' + Alltrim(aCabec[nCount]) + '>' + AllTrim(ainfoPgto[nCount]) + '</' + Alltrim(aCabec[nCount]) + '>'
			EndIf
		EndIf
	Next

	If lFechar
		S1210F07 (@cXml)
	EndIf

return

/*


Ŀ
Funo    GpeUndSalFixo  Autor  Oswaldo Leite      Data  27.07.17 
Ĵ
Descrio  Lista padro para tag UndSalFixo  do e-social              
            S2100, S2200, S2205, S2300, S2206, S2306                   
Ĵ
Ĵ*/
Function GpeUndSalFixo ()
Local aLstPadrao := {{'H','1'},{'D','2'},{'S','3'},{'M','5'},{'T','6'},{'C','7'}, ;
                     {'P','5'},{'I','5'},{'J','5'},{'E','5'},{'A','5'},{'G','1'}}

return aLstPadrao

/*


Ŀ
Funo    GpeEstCivi  Autor  Oswaldo Leite      Data  27.07.17 
Ĵ
Descrio  Lista padro para tag UndSalFixo  do e-social              
            S2100, S2200, S2205, S2300, S2206, S2306                   
            Conforme drhesocp-592                                      
            Ajustar campo *RA_ESTCIVI * conforme Layout eSocial.       
            S - Solteiro 1 - Solteiro                                  
            C - Casado 2 - Casado                                      
            M  Unio Estvel                                          
            D - Divorciado 3 - Divorciado                              
            Q  Desquitado/Separado 4 - Separado                       
            V  Viuvo 5 - Viuvo                                        
            O - Outros No usado no esocial                            
Ĵ
Ĵ*/
Function GpeEstCivi (cParRet)
Local   RetVariavel
default cParRet := "1"

Do Case
	Case ( cParRet == "1" )
		 RetVariavel := {{'S','1'},{'C','2'},{'D','3'}, {'Q','4'},{'V','5'},{'O',' '}}
	Case ( cParRet == "2" )
		 RetVariavel := "%'S','C', 'M' ,'D', 'Q', 'V','O'%"
	Case ( cParRet == "3" )
		 RetVariavel := 'S|C|Q|D|V|M|O|Q|'
End Case

return RetVariavel

/*/{Protheus.doc} S1200A28
Gera subtag esocial (S-1200) leiaute S-1.1
@type  Function
@author Silvia Taguti
@since 23/11/2022
@version 1.0
/*/
Function S1200A28(cXml, aInfoRRA, nMesRRA)

Local nCount	:= 1
Default nMesRRA := 0
Default aInfoRRA := {}

cXml += '<indRRA>S</indRRA>'

	For nCount := 1 to Len(ainfoRRA)
		cXml += '<infoRRA>'
		cXml += 	'<tpProcRRA>'+AllTrim(ainfoRRA[nCount, 1])+'</tpProcRRA>'
		If !Empty(ainfoRRA[nCount, 2])
			cXml += 	'<nrProcRRA>'+AllTrim(ainfoRRA[nCount, 2])+'</nrProcRRA>'
		Endif
		cXml += 	'<descRRA>'+AllTrim(ainfoRRA[nCount, 3])+'</descRRA>'
		cXml += 	'<qtdMesesRRA>'+AllTrim(STR(nMesRRA))+'</qtdMesesRRA>'
		If !Empty(ainfoRRA[nCount,4])
			cXml += 	'<despProcJud>'
			cXml += 		'<vlrDespCustas>' +AllTrim(Transform(ainfoRRA[nCount,4], "@R 999999999.99"))+ '</vlrDespCustas>'
			cXml += 		'<vlrDespAdvogados>'+AllTrim(Transform(ainfoRRA[nCount,5], "@R 999999999.99"))+'</vlrDespAdvogados>'
			cXml += 	'</despProcJud>'
		Endif
		If !Empty(ainfoRRA[nCount, 6])
			cXml += 	'<ideAdv>'
			cXml += 		'<tpInsc>'+AllTrim(ainfoRRA[nCount, 6])+'</tpInsc>'
			cXml += 		'<nrInsc>'+AllTrim(ainfoRRA[nCount, 7])+'</nrInsc>'
			cXml += 		'<vlrAdv>'+AllTrim(Transform(ainfoRRA[nCount,8], "@R 999999999.99"))+'</vlrAdv>'
			cXml += 	'</ideAdv>'
		Endif
		cXml += '</infoRRA>'
Next

Return

/*/{Protheus.doc} S1210A31
Gera subtag esocial (S-1210) leiaute S-1.2
@type  Function
@author Silvia Taguti
@since 13/09/2023
@version 1.0
/*/
Function S1210A31(cXml, aDepen, aDedDep, aRetPensao,aInfoPrev,adadosRHS, aDadosRHP,cVersEnvio)

	Local nP            := 0
	Local nCtDep		:= 0
	Local cDtDep		:= ""
	Local nCntInfPrev   := 0
	Local nCntRetPens	:= 0
	Local nCntPla       := 0
	Local nPlaD         := 0
	Local nCntCop       := 0
	Local nD            := 0
	Local nT            := 0
	Local nCR			:= 0

	Default aDepen		:= {}
	Default aDedDep		:= {}
	Default aRetPensao  := {}
	Default aInfoPrev   := {}
	Default adadosRHS   := {}
	Default adadosRHP   := {}
	Default cVersEnvio  := ""

	cXml += "<infoIRComplem>"

	If !Empty(dtLaudo)
		cXml +=	"<dtLaudo>"+ If(!lMiddleware,dTOS(dtLaudo),(SubStr(dTOS(dtLaudo),1,4)+ "-"+SubStr(dTOS(dtLaudo),5,2)+"-"+SubStr(dTOS(dtLaudo),7,2)))+"</dtLaudo>"
	Endif

	If Len(aDepen) > 0
		For nP := 1 To Len(aDepen)
			If Empty(aDepen[nP,10])
				cXml += "	<infoDep>"
				cXml += "		<cpfDep>" + aDepen[nP,4]	+"</cpfDep>"
				cDtDep := IIf(ValType(aDepen[nP,3]) == "U", "", IIf(ValType(aDepen[nP,3]) == "D", DTOS(aDepen[nP,3]), aDepen[nP,3]))
				If !Empty(cDtDep)
					cXml += "		<dtNascto>" + If(!lMiddleware, cDtDep, (SubStr(cDtDep,1,4)+ "-"+SubStr(cDtDep,5,2)+"-"+SubStr(cDtDep,7,2))) +"</dtNascto>"
				EndIf
				cXml += "		<nome>" + Alltrim(aDepen[nP,2])+ "</nome>"
				If aDepen[nP,5] == "S"
					cXml += "		<depIRRF>" + aDepen[nP,5]+ "</depIRRF>"
					cXml += fTpDep(aDepen[nP],cVersEnvio)
					If !Empty(aDepen[nP,11])
						cXml += "		<descrDep>"+ aDepen[nP,11]+ "</descrDep>"
					EndIf
				Endif
				cXml += "	</infoDep>"
			Endif
		Next nP
	Endif

	For nCR := 1 to Len(aCodRece)
		If Len(aCodRece[nCR,2]) > 0 .Or. Len(aCodRece[nCR,3]) > 0  .Or. Len(aCodRece[nCR,4]) > 0
			cXml += "	<infoIRCR>"
			cXml += "		<tpCR>" +aCodRece[nCR,1]+ "</tpCR>"
			If Len(aCodRece[nCR,2]) > 0
				For nCtDep := 1 To Len(aCodRece[nCR,2])
					If !Empty(aCodRece[nCR,2,nCtDep,4]) //cpfDep est preenchido
						cXml += "		<dedDepen>"
						cXml += "			<tpRend>"+ aCodRece[nCR,2,nCtDep,5]+ "</tpRend>"
						cXml += "			<cpfDep>"+ aCodRece[nCR,2,nCtDep,4]+ "</cpfDep>"
						cXml += "			<vlrDedDep>" + AllTrim(STR(Abs(aCodRece[nCR,2,nCtDep,6]))) +  "</vlrDedDep>"
						cXml += "		</dedDepen>"
					EndIf
				Next nCtDep
			Endif

			If Len(aCodRece[nCR,3]) > 0
				For nCntRetPens	:= 1 To Len(aCodRece[nCR,3])
					cXml += "		<penAlim>
					cXml += "			<tpRend>"+ aCodRece[nCR,3,nCntRetPens,9] +"</tpRend>"
					cXml += "			<cpfDep>"+ aCodRece[nCR,3,nCntRetPens,4] +"</cpfDep>"
					cXml += "			<vlrDedPenAlim>"+ AllTrim(STR(Abs(aCodRece[nCR,3,nCntRetPens,5]))) + "</vlrDedPenAlim>"
					cXml += "		</penAlim>"
				Next nCntRetPens
			Endif

			If Len(aCodRece[nCR,4]) > 0
				For nCntInfPrev	:= 1 To Len(aCodRece[nCR,4])
					cXml += "		<previdCompl>"
					cXml += "			<tpPrev>" + aCodRece[nCR,4,nCntInfPrev,3]+ "</tpPrev>"
					cXml += "			<cnpjEntidPC>" +aCodRece[nCR,4,nCntInfPrev, 2]+ "</cnpjEntidPC>"
					If aCodRece[nCR,4,nCntInfPrev,3] <> "3"
						If aCodRece[nCR,4,nCntInfPrev,4] <> 0
							cXml += "			<vlrDedPC>" + AllTrim(STR(Abs(aCodRece[nCR,4,nCntInfPrev, 4])))+ "</vlrDedPC>"
						EndIf
						If aCodRece[nCR,4,nCntInfPrev,6] <> 0
							cXml += "			<vlrDedPC13>" + AllTrim(STR(Abs(aCodRece[nCR,4,nCntInfPrev,6]))) + "</vlrDedPC13>"
						EndIf
					Else
						If aCodRece[nCR,4,nCntInfPrev,4] <> 0
							cXml += "			<vlrPatrocFunp>" +AllTrim(STR(Abs(aCodRece[nCR,4,nCntInfPrev, 4])))+ "</vlrPatrocFunp>"
						EndIf
						If aCodRece[nCR,4,nCntInfPrev,6] <> 0
							cXml += "			<vlrPatrocFunp13>" + AllTrim(STR(Abs(aCodRece[nCR,4,nCntInfPrev,6]))) + "</vlrPatrocFunp13>"
						EndIf
					Endif
					cXml += "		</previdCompl>"
				Next nCntInfPrev
			Endif
			cXml += "	</infoIRCR>"
		Endif
	Next nCR

	If Len(adadosRHS) > 0
		For nCntPla := 1 to Len(aDadosRHS)
			cXml += "			<planSaude>"
			cXml += "				<cnpjOper>" +Alltrim(aDadosRHS[nCntPla,6])+ "</cnpjOper>"
			cXml += "				<regANS>" +Alltrim(aDadosRHS[nCntPla,7])+ "</regANS>"
			cXml += "				<vlrSaudeTit>" +AllTrim(STR(Abs(aDadosRHS[nCntPla,8])))+ "</vlrSaudeTit>"
			If Len(aDadosRHS[nCntPla,9]) > 0
				For nPlaD := 1 to Len(aDadosRHS[nCntPla,9])
					cXml += "				<infoDepSau>"
					cXml += "					<cpfDep>"+Alltrim(aDadosRHS[nCntPla,9,nPlaD,1])+ "</cpfDep>"
					cXml += "					<vlrSaudeDep>" +AllTrim(STR(Abs(aDadosRHS[nCntPla,9,nPlaD,2])))+ "</vlrSaudeDep>"
					cXml += "				</infoDepSau>"
				Next nPlaD
			Endif
			cXml += "			</planSaude>"
		nEXT nCntPla
	Endif

	If Len(adadosRHP) > 0
		For nCntCop := 1 to Len(aDadosRHP)
			cXml += "	<infoReembMed>
			cXml += "		<indOrgReemb>1</indOrgReemb>
			cXml += "		<cnpjOper>"+Alltrim(adadosRHP[nCntCop,6])+ "</cnpjOper>
			cXml += "		<regANS>"+Alltrim(adadosRHP[nCntCop,7])+ "</regANS>
			If cVersEnvio < "9.3"
				If Len(aDadosRHP[nCntCop,8]) > 0
					For nT := 1 to Len(adadosRHP[nT,8])
						cXml += "		<detReembTit>
						cXml += "			<tpInsc>"+Alltrim(adadosRHP[nCntCop,8,nt,3])+ "</tpInsc>
						cXml += "			<nrInsc>"+Alltrim(adadosRHP[nCntCop,8,nt,4])+ "</nrInsc>
						cXml += "			<vlrReemb>"+AllTrim(STR(Abs(adadosRHP[nCntCop,8,nt,5])))+"</vlrReemb>
						cXml += "		</detReembTit>
					Next nt
				Endif
				If Len(adadosRHP[nCntCop,9]) > 0 .And. !Empty(adadosRHP[nCntCop,9,1,1])
					For nD := 1 to Len(adadosRHP[nD,9])
						cXml += "		<infoReembDep>
						cXml += "			<cpfBenef>"+Alltrim(adadosRHP[nCntCop,9,nD,1])+ "</cpfBenef>
						cXml += "			<detReembDep>
						cXml += "				<tpInsc>"+Alltrim(adadosRHP[nCntCop,9,nD,5])+ "</tpInsc>
						cXml += "				<nrInsc>"+Alltrim(adadosRHP[nCntCop,9,nD,6])+ "</nrInsc>
						cXml += "				<vlrReemb>"+AllTrim(STR(Abs(adadosRHP[nCntCop,9,nD,2])))+ "</vlrReemb>
						cXml += "			</detReembDep>
						cXml += "		</infoReembDep>
					Next nD
				Endif
			Else
				If Len(adadosRHP[nCntCop,8]) > 0
					For nT := 1 to Len(adadosRHP[nCntCop,8])
						If Alltrim(adadosRHP[nCntCop,6]) == Alltrim(adadosRHP[nCntCop,8,nT,6]) .And. Alltrim(adadosRHP[nCntCop,7]) == Alltrim(adadosRHP[nCntCop,8,nT,7])
							cXml += "		<detReembTit>
							cXml += "			<tpInsc>"+Alltrim(adadosRHP[nCntCop,8,nT,3])+ "</tpInsc>
							cXml += "			<nrInsc>"+Alltrim(adadosRHP[nCntCop,8,nT,4])+ "</nrInsc>
							cXml += "			<vlrReemb>"+AllTrim(STR(Abs(adadosRHP[nCntCop,8,nT,5])))+"</vlrReemb>
							cXml += "		</detReembTit>
						Endif	
					Next nT	
				Endif	
				If Len(adadosRHP[nCntCop,9]) > 0 .And. !Empty(adadosRHP[nCntCop,9,1,1])
					For nD := 1 to Len(adadosRHP[nCntCop,9])
						If Alltrim(adadosRHP[nCntCop,6]) == Alltrim(adadosRHP[nCntCop,9,nD,7]) .And. Alltrim(adadosRHP[nCntCop,7]) == Alltrim(adadosRHP[nCntCop,9,nD,8])
							cXml += "		<infoReembDep>
							cXml += "			<cpfBenef>"+Alltrim(adadosRHP[nCntCop,9,nD,1])+ "</cpfBenef>
							cXml += "			<detReembDep>
							cXml += "				<tpInsc>"+Alltrim(adadosRHP[nCntCop,9,nD,5])+ "</tpInsc>
							cXml += "				<nrInsc>"+Alltrim(adadosRHP[nCntCop,9,nD,6])+ "</nrInsc>
							cXml += "				<vlrReemb>"+AllTrim(STR(Abs(adadosRHP[nCntCop,9,nD,2])))+ "</vlrReemb>
							cXml += "			</detReembDep>
							cXml += "		</infoReembDep>
						Endif	
					Next nD 
				Endif		
			Endif	
			cXml += "	</infoReembMed>
		Next nCntCop
	Endif

	cXml += "</infoIRComplem>"   //<infoIRComplem>

Return


/*/{Protheus.doc} S1202A01
Gera subtag esocial remunOrgSuc (S-1202)
@type  Function
@author lidio.oliveira
@since 17/12/2024
@version 1.0
/*/
Function S1202A01( cXml, cRemOrgSuc, lFechar)

	Default cXml 		:= ""
	Default cRemOrgSuc	:= ""
	Default lFechar		:= .F.

	cXml += '<remunOrgSuc>'
	cXml += cRemOrgSuc

	If lFechar
		S1202F01(@cXml)
	EndIf

Return


/*/{Protheus.doc} S1202F01
Gera subtag esocial fechamento remunOrgSuc (S-1202)
@type  Function
@author lidio.oliveira
@since 17/12/2024
@version 1.0
/*/
Function S1202F01(cXml) 

	Default cXml := ""

	cXml += '</remunOrgSuc>'

Return
