#include "tlpp-core.th"
#include "tlpp-rest.th"

namespace totvs.protheus.backoffice.pif.fiscal.insight.ncm
using namespace totvs.protheus.backoffice.pif.util

//------------------------------------------------------------------------------
/* {Protheus.doc} DashboardController
    API utilizada para retornar os dados do Dashboard de NCM

    @type Class
    @author Squad PIF
    @return Nil
*/
//------------------------------------------------------------------------------
Class DashboardController

	Public Method new() Constructor

	@Get("/api/pif/ncm/dashboard")
	Public Method getDashboard()

EndClass


//------------------------------------------------------------------------------
/* {Protheus.doc} new
    Metodo construtor

    @type Method
    @author Squad PIF
    @return Object, retorna o objeto criado
*/
//------------------------------------------------------------------------------
Method New() Class DashboardController
Return Self


//------------------------------------------------------------------------------
/* {Protheus.doc} getDashboard
    Método responsável por retornar os insights do dashboard de NCM

    @type Method
    @author Squad PIF
    @return Nil
*/
//------------------------------------------------------------------------------
Method getDashboard() class DashboardController

	Local oService       As Object
	Local oJResponse     As Json

	oJResponse := getNoAccessResponse()

	if canAccess("PIFA010")
		oService     := DashboardService():New()
		oJResponse   := oService:getDashboard()
	endIF

	answerRest(oJResponse)

	FWFreeObj(oService)
	FreeObj(oJResponse)

Return
